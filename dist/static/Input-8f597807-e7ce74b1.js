import{R as et,r as Ue,cs as sf,s as gr,d as Pr,F as Dr,S as qr,c as gd,ar as la,C as yd,f as lt,j as te,B as ni,i as vr,c9 as of,e as Rr,ct as Ed,cu as As,cv as bd,be as _d,aE as sn,h as lf,cw as uf,cp as df,at as cf,as as Td,L as hf,cx as Sd,cg as Ad,cy as Gl,cz as ll,cA as ff,cB as wd,b as pf,cC as vf,cD as mf,bY as ws,T as Vl,cE as Co,Q as Ki,cF as gf,cG as yf,cH as Ef,cI as bf,cJ as _f,by as Tf,co as kd,v as Sf,G as xo,cK as Af,c3 as wf,cL as Id,cM as Dd,cN as kf,cO as Kl,bO as If,bc as fs,br as Oo,cP as ji,cl as Ld,cQ as ul,cR as es,bq as Ni,bW as Df,bd as Lf,cS as Rf,cT as dl,cU as Cf,cV as xf,cW as Of,m as Mf,cX as Pf}from"./sanity-2e52752e.js";import{V as ps,A as Uf,g as cl,u as gi,a as Ff,_ as ql,b as Rd,c as Cd,d as Nf,T as Bf,C as Hf}from"./VideoSource.styled-626b50aa-fa6138ca.js";import{i as Wl}from"./hey-listen.es-6595251d.js";class jf{setAnimation(e){this.animation=e,e==null||e.finished.then(()=>this.clearAnimation()).catch(()=>{})}clearAnimation(){this.animation=this.generator=void 0}}function Gf(i,e){i.indexOf(e)===-1&&i.push(e)}const xd=(i,e,a)=>Math.min(Math.max(a,i),e),Xr={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},vs=i=>typeof i=="number",Sn=i=>Array.isArray(i)&&!vs(i[0]),Vf=(i,e,a)=>{const h=e-i;return((a-i)%h+h)%h+i};function Kf(i,e){return Sn(i)?i[Vf(0,i.length,e)]:i}const Od=(i,e,a)=>-a*i+a*e+i,Md=()=>{},Gi=i=>i,hl=(i,e,a)=>e-i===0?1:(a-i)/(e-i);function Pd(i,e){const a=i[i.length-1];for(let h=1;h<=e;h++){const m=hl(0,e,h);i.push(Od(a,1,m))}}function qf(i){const e=[0];return Pd(e,i-1),e}function Wf(i,e=qf(i.length),a=Gi){const h=i.length,m=h-e.length;return m>0&&Pd(e,m),T=>{let k=0;for(;k<h-2&&!(T<e[k+1]);k++);let A=xd(0,1,hl(e[k],e[k+1],T));return A=Kf(a,k)(A),Od(i[k],i[k+1],A)}}const Ud=i=>Array.isArray(i)&&vs(i[0]),Mo=i=>typeof i=="object"&&Boolean(i.createAnimation),kn=i=>typeof i=="function",$f=i=>typeof i=="string",ua={ms:i=>i*1e3,s:i=>i/1e3},Fd=(i,e,a)=>(((1-3*a+3*e)*i+(3*a-6*e))*i+3*e)*i,Yf=1e-7,zf=12;function Xf(i,e,a,h,m){let T,k,A=0;do k=e+(a-e)/2,T=Fd(k,h,m)-i,T>0?a=k:e=k;while(Math.abs(T)>Yf&&++A<zf);return k}function ta(i,e,a,h){if(i===e&&a===h)return Gi;const m=T=>Xf(T,0,1,i,a);return T=>T===0||T===1?T:Fd(m(T),e,h)}const Qf=(i,e="end")=>a=>{a=e==="end"?Math.min(a,.999):Math.max(a,.001);const h=a*i,m=e==="end"?Math.floor(h):Math.ceil(h);return xd(0,1,m/i)},$l={ease:ta(.25,.1,.25,1),"ease-in":ta(.42,0,1,1),"ease-in-out":ta(.42,0,.58,1),"ease-out":ta(0,0,.58,1)},Zf=/\((.*?)\)/;function Yl(i){if(kn(i))return i;if(Ud(i))return ta(...i);if($l[i])return $l[i];if(i.startsWith("steps")){const e=Zf.exec(i);if(e){const a=e[1].split(",");return Qf(parseFloat(a[0]),a[1].trim())}}return Gi}class Nd{constructor(e,a=[0,1],{easing:h,duration:m=Xr.duration,delay:T=Xr.delay,endDelay:k=Xr.endDelay,repeat:A=Xr.repeat,offset:w,direction:U="normal"}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=Gi,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise((P,g)=>{this.resolve=P,this.reject=g}),h=h||Xr.easing,Mo(h)){const P=h.createAnimation(a);h=P.easing,a=P.keyframes||a,m=P.duration||m}this.repeat=A,this.easing=Sn(h)?Gi:Yl(h),this.updateDuration(m);const x=Wf(a,w,Sn(h)?h.map(Yl):Gi);this.tick=P=>{var g;T=T;let I=0;this.pauseTime!==void 0?I=this.pauseTime:I=(P-this.startTime)*this.rate,this.t=I,I/=1e3,I=Math.max(I-T,0),this.playState==="finished"&&this.pauseTime===void 0&&(I=this.totalDuration);const O=I/this.duration;let X=Math.floor(O),N=O%1;!N&&O>=1&&(N=1),N===1&&X--;const ye=X%2;(U==="reverse"||U==="alternate"&&ye||U==="alternate-reverse"&&!ye)&&(N=1-N);const de=I>=this.totalDuration?1:Math.min(N,1),re=x(this.easing(de));e(re),this.pauseTime===void 0&&(this.playState==="finished"||I>=this.totalDuration+k)?(this.playState="finished",(g=this.resolve)===null||g===void 0||g.call(this,re)):this.playState!=="idle"&&(this.frameRequestId=requestAnimationFrame(this.tick))},this.play()}play(){const e=performance.now();this.playState="running",this.pauseTime!==void 0?this.startTime=e-this.pauseTime:this.startTime||(this.startTime=e),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var e;this.playState="idle",this.frameRequestId!==void 0&&cancelAnimationFrame(this.frameRequestId),(e=this.reject)===null||e===void 0||e.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(e){this.duration=e,this.totalDuration=e*(this.repeat+1)}get currentTime(){return this.t}set currentTime(e){this.pauseTime!==void 0||this.rate===0?this.pauseTime=e:this.startTime=performance.now()-e/this.rate}get playbackRate(){return this.rate}set playbackRate(e){this.rate=e}}const ki=new WeakMap,oo={},Pa={},Bi=()=>{},ri=Bi(),lo=Object,Kt=i=>i===ri,Ii=i=>typeof i=="function",qi=(i,e)=>({...i,...e}),fl="undefined",ks=typeof window!=fl,Po=typeof document!=fl,Jf=()=>ks&&typeof window.requestAnimationFrame!=fl,Bd=(i,e)=>{const a=ki.get(i);return[()=>i.get(e)||oo,h=>{if(!Kt(e)){const m=i.get(e);e in Pa||(Pa[e]=m),a[5](e,qi(m,h),m||oo)}},a[6],()=>!Kt(e)&&e in Pa?Pa[e]:i.get(e)||oo]},Ua=new WeakMap;let ep=0;const va=i=>{const e=typeof i,a=i&&i.constructor,h=a==Date;let m,T;if(lo(i)===i&&!h&&a!=RegExp){if(m=Ua.get(i),m)return m;if(m=++ep+"~",Ua.set(i,m),a==Array){for(m="@",T=0;T<i.length;T++)m+=va(i[T])+",";Ua.set(i,m)}if(a==lo){m="#";const k=lo.keys(i).sort();for(;!Kt(T=k.pop());)Kt(i[T])||(m+=T+":"+va(i[T])+",");Ua.set(i,m)}}else m=h?i.toJSON():e=="symbol"?i.toString():e=="string"?JSON.stringify(i):""+i;return m};let Uo=!0;const tp=()=>Uo,[Fo,No]=ks&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Bi,Bi],rp=()=>{const i=Po&&document.visibilityState;return Kt(i)||i!=="hidden"},ip=i=>(Po&&document.addEventListener("visibilitychange",i),Fo("focus",i),()=>{Po&&document.removeEventListener("visibilitychange",i),No("focus",i)}),np=i=>{const e=()=>{Uo=!0,i()},a=()=>{Uo=!1};return Fo("online",e),Fo("offline",a),()=>{No("online",e),No("offline",a)}},ap={isOnline:tp,isVisible:rp},sp={initFocus:ip,initReconnect:np},zl=!et.useId,ma=!ks||"Deno"in window,op=i=>Jf()?window.requestAnimationFrame(i):setTimeout(i,1),uo=ma?Ue.useEffect:Ue.useLayoutEffect,co=typeof navigator<"u"&&navigator.connection,Xl=!ma&&co&&(["slow-2g","2g"].includes(co.effectiveType)||co.saveData),pl=i=>{if(Ii(i))try{i=i()}catch{i=""}const e=i;return i=typeof i=="string"?i:(Array.isArray(i)?i.length:i)?va(i):"",[i,e]};let lp=0;const Bo=()=>++lp,Hd=0,jd=1,Gd=2,up=3;var Qn={__proto__:null,FOCUS_EVENT:Hd,RECONNECT_EVENT:jd,MUTATE_EVENT:Gd,ERROR_REVALIDATE_EVENT:up};async function Vd(...i){const[e,a,h,m]=i,T=qi({populateCache:!0,throwOnError:!0},typeof m=="boolean"?{revalidate:m}:m||{});let k=T.populateCache;const A=T.rollbackOnError;let w=T.optimisticData;const U=T.revalidate!==!1,x=I=>typeof A=="function"?A(I):A!==!1,P=T.throwOnError;if(Ii(a)){const I=a,O=[],X=e.keys();for(let N=X.next();!N.done;N=X.next()){const ye=N.value;!ye.startsWith("$inf$")&&I(e.get(ye)._k)&&O.push(ye)}return Promise.all(O.map(g))}return g(a);async function g(I){const[O]=pl(I);if(!O)return;const[X,N]=Bd(e,O),[ye,de,re]=ki.get(e),z=ye[O],he=()=>U&&(delete re[O],z&&z[0])?z[0](Gd).then(()=>X().data):X().data;if(i.length<3)return he();let G=h,Y;const me=Bo();de[O]=[me,0];const Ae=!Kt(w),ke=X(),Q=ke.data,L=ke._c,W=Kt(L)?Q:L;if(Ae&&(w=Ii(w)?w(W):w,N({data:w,_c:W})),Ii(G))try{G=G(W)}catch(se){Y=se}if(G&&Ii(G.then))if(G=await G.catch(se=>{Y=se}),me!==de[O][0]){if(Y)throw Y;return G}else Y&&Ae&&x(Y)&&(k=!0,G=W,N({data:G,_c:ri}));k&&(Y||(Ii(k)&&(G=k(G,W)),N({data:G,_c:ri}))),de[O][1]=Bo();const B=await he();if(N({_c:ri}),Y){if(P)throw Y;return}return k?B:G}}const Ql=(i,e)=>{for(const a in i)i[a][0]&&i[a][0](e)},dp=(i,e)=>{if(!ki.has(i)){const a=qi(sp,e),h={},m=Vd.bind(ri,i);let T=Bi;const k={},A=(x,P)=>{const g=k[x]||[];return k[x]=g,g.push(P),()=>g.splice(g.indexOf(P),1)},w=(x,P,g)=>{i.set(x,P);const I=k[x];if(I)for(const O of I)O(P,g)},U=()=>{if(!ki.has(i)&&(ki.set(i,[h,{},{},{},m,w,A]),!ma)){const x=a.initFocus(setTimeout.bind(ri,Ql.bind(ri,h,Hd))),P=a.initReconnect(setTimeout.bind(ri,Ql.bind(ri,h,jd)));T=()=>{x&&x(),P&&P(),ki.delete(i)}}};return U(),[i,m,U,T]}return[i,ki.get(i)[4]]},cp=(i,e,a,h,m)=>{const T=a.errorRetryCount,k=m.retryCount,A=~~((Math.random()+.5)*(1<<(k<8?k:8)))*a.errorRetryInterval;!Kt(T)&&k>T||setTimeout(h,A,m)},hp=(i,e)=>va(i)==va(e),[Kd,fp]=dp(new Map),pp=qi({onLoadingSlow:Bi,onSuccess:Bi,onError:Bi,onErrorRetry:cp,onDiscarded:Bi,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Xl?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Xl?5e3:3e3,compare:hp,isPaused:()=>!1,cache:Kd,mutate:fp,fallback:{}},ap),vp=(i,e)=>{const a=qi(i,e);if(e){const{use:h,fallback:m}=i,{use:T,fallback:k}=e;h&&T&&(a.use=h.concat(T)),m&&k&&(a.fallback=qi(m,k))}return a},mp=Ue.createContext({}),qd=ks&&window.__SWR_DEVTOOLS_USE__,gp=qd?window.__SWR_DEVTOOLS_USE__:[],yp=()=>{qd&&(window.__SWR_DEVTOOLS_REACT__=et)},Ep=i=>Ii(i[1])?[i[0],i[1],i[2]||{}]:[i[0],null,(i[1]===null?i[2]:i[1])||{}],bp=()=>qi(pp,Ue.useContext(mp)),_p=i=>(e,a,h)=>i(e,a&&((...T)=>{const k=pl(e)[0],[,,,A]=ki.get(Kd),w=A[k];return w?(delete A[k],w):a(...T)}),h),Tp=gp.concat(_p),Sp=i=>function(...a){const h=bp(),[m,T,k]=Ep(a),A=vp(h,k);let w=i;const{use:U}=A,x=(U||[]).concat(Tp);for(let P=x.length;P--;)w=x[P](w);return w(m,T||A.fetcher||null,A)},Ap=(i,e,a)=>{const h=e[i]||(e[i]=[]);return h.push(a),()=>{const m=h.indexOf(a);m>=0&&(h[m]=h[h.length-1],h.pop())}};yp();const ho={dedupe:!0},wp=(i,e,a)=>{const{cache:h,compare:m,suspense:T,fallbackData:k,revalidateOnMount:A,revalidateIfStale:w,refreshInterval:U,refreshWhenHidden:x,refreshWhenOffline:P,keepPreviousData:g}=a,[I,O,X]=ki.get(h),[N,ye]=pl(i),de=Ue.useRef(!1),re=Ue.useRef(!1),z=Ue.useRef(N),he=Ue.useRef(e),G=Ue.useRef(a),Y=()=>G.current,me=()=>Y().isVisible()&&Y().isOnline(),[Ae,ke,Q,L]=Bd(h,N),W=Ue.useRef({}).current,B=Kt(k)?a.fallback[N]:k,se=(Oe,Be)=>{let _e=!0;for(const Ne in W){const Xe=Ne;Xe==="data"?m(Be[Xe],Oe[Xe])||Kt(Oe[Xe])&&m(Be[Xe],We)||(_e=!1):Be[Xe]!==Oe[Xe]&&(_e=!1)}return _e},fe=Ue.useMemo(()=>{const Oe=(()=>!N||!e?!1:Kt(A)?Y().isPaused()||T?!1:Kt(w)?!0:w:A)(),Be=Xe=>{const at=qi(Xe);return delete at._k,Oe?{isValidating:!0,isLoading:!0,...at}:at};let _e=Be(Ae());const Ne=Be(L());return[()=>{const Xe=Be(Ae());return se(Xe,_e)?_e:_e=Xe},()=>Ne]},[h,N]),ne=sf.useSyncExternalStore(Ue.useCallback(Oe=>Q(N,(Be,_e)=>{se(_e,Be)||Oe()}),[h,N]),fe[0],fe[1]),Te=!de.current,He=I[N]&&I[N].length>0,le=ne.data,ae=Kt(le)?B:le,we=ne.error,Ke=Ue.useRef(ae),We=g?Kt(le)?Ke.current:le:ae,ie=(()=>He&&!Kt(we)?!1:Te&&!Kt(A)?A:Y().isPaused()?!1:T?Kt(ae)?!1:w:Kt(ae)||w)(),Ee=!!(N&&e&&Te&&ie),ue=Kt(ne.isValidating)?Ee:ne.isValidating,Re=Kt(ne.isLoading)?Ee:ne.isLoading,Le=Ue.useCallback(async Oe=>{const Be=he.current;if(!N||!Be||re.current||Y().isPaused())return!1;let _e,Ne,Xe=!0;const at=Oe||{},mt=!X[N]||!at.dedupe,gt=()=>zl?!re.current&&N===z.current&&de.current:N===z.current,Ft={isValidating:!1,isLoading:!1},Mt=()=>{ke(Ft)},xt=()=>{const ht=X[N];ht&&ht[1]===Ne&&delete X[N]},Ot={isValidating:!0};Kt(Ae().data)&&(Ot.isLoading=!0);try{if(mt&&(ke(Ot),a.loadingTimeout&&Kt(Ae().data)&&setTimeout(()=>{Xe&&gt()&&Y().onLoadingSlow(N,a)},a.loadingTimeout),X[N]=[Be(ye),Bo()]),[_e,Ne]=X[N],_e=await _e,mt&&setTimeout(xt,a.dedupingInterval),!X[N]||X[N][1]!==Ne)return mt&&gt()&&Y().onDiscarded(N),!1;Ft.error=ri;const ht=O[N];if(!Kt(ht)&&(Ne<=ht[0]||Ne<=ht[1]||ht[1]===0))return Mt(),mt&&gt()&&Y().onDiscarded(N),!1;const ct=Ae().data;Ft.data=m(ct,_e)?ct:_e,mt&&gt()&&Y().onSuccess(_e,N,a)}catch(ht){xt();const ct=Y(),{shouldRetryOnError:Pt}=ct;ct.isPaused()||(Ft.error=ht,mt&&gt()&&(ct.onError(ht,N,ct),(Pt===!0||Ii(Pt)&&Pt(ht))&&me()&&ct.onErrorRetry(ht,N,ct,Ht=>{const qt=I[N];qt&&qt[0]&&qt[0](Qn.ERROR_REVALIDATE_EVENT,Ht)},{retryCount:(at.retryCount||0)+1,dedupe:!0})))}return Xe=!1,Mt(),!0},[N,h]),Me=Ue.useCallback((...Oe)=>Vd(h,z.current,...Oe),[]);if(uo(()=>{he.current=e,G.current=a,Kt(le)||(Ke.current=le)}),uo(()=>{if(!N)return;const Oe=Le.bind(ri,ho);let Be=0;const Ne=Ap(N,I,(Xe,at={})=>{if(Xe==Qn.FOCUS_EVENT){const mt=Date.now();Y().revalidateOnFocus&&mt>Be&&me()&&(Be=mt+Y().focusThrottleInterval,Oe())}else if(Xe==Qn.RECONNECT_EVENT)Y().revalidateOnReconnect&&me()&&Oe();else{if(Xe==Qn.MUTATE_EVENT)return Le();if(Xe==Qn.ERROR_REVALIDATE_EVENT)return Le(at)}});return re.current=!1,z.current=N,de.current=!0,ke({_k:ye}),ie&&(Kt(ae)||ma?Oe():op(Oe)),()=>{re.current=!0,Ne()}},[N]),uo(()=>{let Oe;function Be(){const Ne=Ii(U)?U(ae):U;Ne&&Oe!==-1&&(Oe=setTimeout(_e,Ne))}function _e(){!Ae().error&&(x||Y().isVisible())&&(P||Y().isOnline())?Le(ho).then(Be):Be()}return Be(),()=>{Oe&&(clearTimeout(Oe),Oe=-1)}},[U,x,P,N]),Ue.useDebugValue(We),T&&Kt(ae)&&N)throw!zl&&ma?new Error("Fallback data is required when using suspense in SSR."):(he.current=e,G.current=a,re.current=!1,Kt(we)?Le(ho):we);return{mutate:Me,get data(){return W.data=!0,We},get error(){return W.error=!0,we},get isValidating(){return W.isValidating=!0,ue},get isLoading(){return W.isLoading=!0,Re}}};var kp=Sp(wp),Ip=Object.create,Wd=Object.defineProperty,Dp=Object.getOwnPropertyDescriptor,Lp=Object.getOwnPropertyNames,Rp=Object.getPrototypeOf,Cp=Object.prototype.hasOwnProperty,Ea=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),xp=(i,e,a,h)=>{if(e&&typeof e=="object"||typeof e=="function")for(let m of Lp(e))!Cp.call(i,m)&&m!==a&&Wd(i,m,{get:()=>e[m],enumerable:!(h=Dp(e,m))||h.enumerable});return i},Op=(i,e,a)=>(a=i!=null?Ip(Rp(i)):{},xp(e||!i||!i.__esModule?Wd(a,"default",{value:i,enumerable:!0}):a,i)),Mp=Ea((i,e)=>{var a;typeof window<"u"?a=window:typeof global<"u"?a=global:typeof self<"u"?a=self:a={},e.exports=a}),Pp=Ea((i,e)=>{e.exports=h;var a=Object.prototype.toString;function h(m){if(!m)return!1;var T=a.call(m);return T==="[object Function]"||typeof m=="function"&&T!=="[object RegExp]"||typeof window<"u"&&(m===window.setTimeout||m===window.alert||m===window.confirm||m===window.prompt)}}),Up=Ea((i,e)=>{var a=function(m){return m.replace(/^\s+|\s+$/g,"")},h=function(m){return Object.prototype.toString.call(m)==="[object Array]"};e.exports=function(m){if(!m)return{};for(var T={},k=a(m).split(`
`),A=0;A<k.length;A++){var w=k[A],U=w.indexOf(":"),x=a(w.slice(0,U)).toLowerCase(),P=a(w.slice(U+1));typeof T[x]>"u"?T[x]=P:h(T[x])?T[x].push(P):T[x]=[T[x],P]}return T}}),Fp=Ea((i,e)=>{e.exports=h;var a=Object.prototype.hasOwnProperty;function h(){for(var m={},T=0;T<arguments.length;T++){var k=arguments[T];for(var A in k)a.call(k,A)&&(m[A]=k[A])}return m}}),Np=Ea((i,e)=>{var a=Mp(),h=Pp(),m=Up(),T=Fp();e.exports=U,e.exports.default=U,U.XMLHttpRequest=a.XMLHttpRequest||g,U.XDomainRequest="withCredentials"in new U.XMLHttpRequest?U.XMLHttpRequest:a.XDomainRequest,k(["get","put","post","patch","head","delete"],function(I){U[I==="delete"?"del":I]=function(O,X,N){return X=w(O,X,N),X.method=I.toUpperCase(),x(X)}});function k(I,O){for(var X=0;X<I.length;X++)O(I[X])}function A(I){for(var O in I)if(I.hasOwnProperty(O))return!1;return!0}function w(I,O,X){var N=I;return h(O)?(X=O,typeof I=="string"&&(N={uri:I})):N=T(O,{uri:I}),N.callback=X,N}function U(I,O,X){return O=w(I,O,X),x(O)}function x(I){if(typeof I.callback>"u")throw new Error("callback argument missing");var O=!1,X=function(se,fe,ne){O||(O=!0,I.callback(se,fe,ne))};function N(){z.readyState===4&&setTimeout(re,0)}function ye(){var se=void 0;if(z.response?se=z.response:se=z.responseText||P(z),L)try{se=JSON.parse(se)}catch{}return se}function de(se){return clearTimeout(W),se instanceof Error||(se=new Error(""+(se||"Unknown XMLHttpRequest Error"))),se.statusCode=0,X(se,B)}function re(){if(!G){var se;clearTimeout(W),I.useXDR&&z.status===void 0?se=200:se=z.status===1223?204:z.status;var fe=B,ne=null;return se!==0?(fe={body:ye(),statusCode:se,method:me,headers:{},url:Y,rawRequest:z},z.getAllResponseHeaders&&(fe.headers=m(z.getAllResponseHeaders()))):ne=new Error("Internal XMLHttpRequest Error"),X(ne,fe,fe.body)}}var z=I.xhr||null;z||(I.cors||I.useXDR?z=new U.XDomainRequest:z=new U.XMLHttpRequest);var he,G,Y=z.url=I.uri||I.url,me=z.method=I.method||"GET",Ae=I.body||I.data,ke=z.headers=I.headers||{},Q=!!I.sync,L=!1,W,B={body:void 0,headers:{},statusCode:0,method:me,url:Y,rawRequest:z};if("json"in I&&I.json!==!1&&(L=!0,ke.accept||ke.Accept||(ke.Accept="application/json"),me!=="GET"&&me!=="HEAD"&&(ke["content-type"]||ke["Content-Type"]||(ke["Content-Type"]="application/json"),Ae=JSON.stringify(I.json===!0?Ae:I.json))),z.onreadystatechange=N,z.onload=re,z.onerror=de,z.onprogress=function(){},z.onabort=function(){G=!0},z.ontimeout=de,z.open(me,Y,!Q,I.username,I.password),Q||(z.withCredentials=!!I.withCredentials),!Q&&I.timeout>0&&(W=setTimeout(function(){if(!G){G=!0,z.abort("timeout");var se=new Error("XMLHttpRequest timeout");se.code="ETIMEDOUT",de(se)}},I.timeout)),z.setRequestHeader)for(he in ke)ke.hasOwnProperty(he)&&z.setRequestHeader(he,ke[he]);else if(I.headers&&!A(I.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in I&&(z.responseType=I.responseType),"beforeSend"in I&&typeof I.beforeSend=="function"&&I.beforeSend(z),z.send(Ae||null),z}function P(I){try{if(I.responseType==="document")return I.responseXML;var O=I.responseXML&&I.responseXML.documentElement.nodeName==="parsererror";if(I.responseType===""&&!O)return I.responseXML}catch{}return null}function g(){}});function vl(i,e,...a){if(!i)throw new TypeError($d(e,a))}function $d(i,e){let a=0;return i.replace(/%[os]/gu,()=>Yd(e[a++]))}function Yd(i){return typeof i!="object"||i===null?String(i):Object.prototype.toString.call(i)}var Bp;function Hp(i){try{let e=i instanceof Error?i:new Error(Yd(i));if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:e,message:e.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)}catch{}}var ii=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:typeof globalThis<"u"?globalThis:void 0,jp,$i=class{constructor(i,e){this.code=i,this.message=e}warn(...i){var e;try{let a=((e=new Error().stack)!==null&&e!==void 0?e:"").replace(/^(?:.+?\n){2}/gu,`
`);console.warn(this.message,...i,a)}catch{}}},Gp=new $i("W01","Unable to initialize event under dispatching."),Vp=new $i("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),Kp=new $i("W03","Assigning any truthy value to 'returnValue' property has no effect."),qp=new $i("W04","Unable to preventDefault on non-cancelable events."),Wp=new $i("W05","Unable to preventDefault inside passive event listener invocation."),$p=new $i("W06","An event listener wasn't added because it has been added already: %o, %o"),fo=new $i("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),Zl=new $i("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),Di=class{static get NONE(){return Jl}static get CAPTURING_PHASE(){return eu}static get AT_TARGET(){return tu}static get BUBBLING_PHASE(){return ru}constructor(e,a){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let h=a??{};Ho.set(this,{type:String(e),bubbles:Boolean(h.bubbles),cancelable:Boolean(h.cancelable),composed:Boolean(h.composed),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return pr(this).type}get target(){return pr(this).target}get srcElement(){return pr(this).target}get currentTarget(){return pr(this).currentTarget}composedPath(){let e=pr(this).currentTarget;return e?[e]:[]}get NONE(){return Jl}get CAPTURING_PHASE(){return eu}get AT_TARGET(){return tu}get BUBBLING_PHASE(){return ru}get eventPhase(){return pr(this).dispatchFlag?2:0}stopPropagation(){pr(this).stopPropagationFlag=!0}get cancelBubble(){return pr(this).stopPropagationFlag}set cancelBubble(e){e?pr(this).stopPropagationFlag=!0:Vp.warn()}stopImmediatePropagation(){let e=pr(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return pr(this).bubbles}get cancelable(){return pr(this).cancelable}get returnValue(){return!pr(this).canceledFlag}set returnValue(e){e?Kp.warn():iu(pr(this))}preventDefault(){iu(pr(this))}get defaultPrevented(){return pr(this).canceledFlag}get composed(){return pr(this).composed}get isTrusted(){return!1}get timeStamp(){return pr(this).timeStamp}initEvent(e,a=!1,h=!1){let m=pr(this);if(m.dispatchFlag){Gp.warn();return}Ho.set(this,{...m,type:String(e),bubbles:Boolean(a),cancelable:Boolean(h),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}},Jl=0,eu=1,tu=2,ru=3,Ho=new WeakMap;function pr(i,e="this"){let a=Ho.get(i);return vl(a!=null,"'%s' must be an object that Event constructor created, but got another one: %o",e,i),a}function iu(i){if(i.inPassiveListenerFlag){Wp.warn();return}if(!i.cancelable){qp.warn();return}i.canceledFlag=!0}Object.defineProperty(Di,"NONE",{enumerable:!0});Object.defineProperty(Di,"CAPTURING_PHASE",{enumerable:!0});Object.defineProperty(Di,"AT_TARGET",{enumerable:!0});Object.defineProperty(Di,"BUBBLING_PHASE",{enumerable:!0});var po=Object.getOwnPropertyNames(Di.prototype);for(let i=0;i<po.length;++i)po[i]!=="constructor"&&Object.defineProperty(Di.prototype,po[i],{enumerable:!0});typeof ii<"u"&&typeof ii.Event<"u"&&Object.setPrototypeOf(Di.prototype,ii.Event.prototype);function Yp(i){return ii.DOMException?new ii.DOMException(i,"InvalidStateError"):(vn==null&&(vn=class zd extends Error{constructor(a){super(a),Error.captureStackTrace&&Error.captureStackTrace(this,zd)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(vn.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),au(vn),au(vn.prototype)),new vn(i))}var vn,nu={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function au(i){let e=Object.keys(nu);for(let a=0;a<e.length;++a){let h=e[a],m=nu[h];Object.defineProperty(i,h,{get(){return m},configurable:!0,enumerable:!0})}}var Is=class extends Di{static wrap(e){return new(Qd(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),Xd.set(this,{original:e});let a=Object.keys(e);for(let h=0;h<a.length;++h){let m=a[h];m in this||Object.defineProperty(this,m,Zd(e,m))}}stopPropagation(){super.stopPropagation();let{original:e}=Ui(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;let{original:a}=Ui(this);"cancelBubble"in a&&(a.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();let{original:e}=Ui(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;let{original:a}=Ui(this);"returnValue"in a&&(a.returnValue=e)}preventDefault(){super.preventDefault();let{original:e}=Ui(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){let{original:e}=Ui(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}},Xd=new WeakMap;function Ui(i){let e=Xd.get(i);return vl(e!=null,"'this' is expected an Event object, but got",i),e}var ms=new WeakMap;ms.set(Object.prototype,Is);typeof ii<"u"&&typeof ii.Event<"u"&&ms.set(ii.Event.prototype,Is);function Qd(i){let e=Object.getPrototypeOf(i);if(e==null)return Is;let a=ms.get(e);return a==null&&(a=zp(Qd(e),e),ms.set(e,a)),a}function zp(i,e){class a extends i{}let h=Object.keys(e);for(let m=0;m<h.length;++m)Object.defineProperty(a.prototype,h[m],Zd(e,h[m]));return a}function Zd(i,e){let a=Object.getOwnPropertyDescriptor(i,e);return{get(){let h=Ui(this).original,m=h[e];return typeof m=="function"?m.bind(h):m},set(h){let m=Ui(this).original;m[e]=h},configurable:a.configurable,enumerable:a.enumerable}}function Xp(i,e,a,h,m,T){return{callback:i,flags:(e?1:0)|(a?2:0)|(h?4:0),signal:m,signalListener:T}}function Qp(i){i.flags|=8}function Jd(i){return(i.flags&1)===1}function ec(i){return(i.flags&2)===2}function tc(i){return(i.flags&4)===4}function Zp(i){return(i.flags&8)===8}function Jp({callback:i},e,a){try{typeof i=="function"?i.call(e,a):typeof i.handleEvent=="function"&&i.handleEvent(a)}catch(h){Hp(h)}}function rc({listeners:i},e,a){for(let h=0;h<i.length;++h)if(i[h].callback===e&&Jd(i[h])===a)return h;return-1}function ev(i,e,a,h,m,T){let k;T&&(k=ic.bind(null,i,e,a),T.addEventListener("abort",k));let A=Xp(e,a,h,m,T,k);return i.cow?(i.cow=!1,i.listeners=[...i.listeners,A]):i.listeners.push(A),A}function ic(i,e,a){let h=rc(i,e,a);return h!==-1?nc(i,h):!1}function nc(i,e,a=!1){let h=i.listeners[e];return Qp(h),h.signal&&h.signal.removeEventListener("abort",h.signalListener),i.cow&&!a?(i.cow=!1,i.listeners=i.listeners.filter((m,T)=>T!==e),!1):(i.listeners.splice(e,1),!0)}function tv(){return Object.create(null)}function rv(i,e){var a;return(a=i[e])!==null&&a!==void 0?a:i[e]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var Ds=class{constructor(){ac.set(this,tv())}addEventListener(e,a,h){let m=vo(this),{callback:T,capture:k,once:A,passive:w,signal:U,type:x}=iv(e,a,h);if(T==null||U!=null&&U.aborted)return;let P=rv(m,x),g=rc(P,T,k);if(g!==-1){av(P.listeners[g],w,A,U);return}ev(P,T,k,w,A,U)}removeEventListener(e,a,h){let m=vo(this),{callback:T,capture:k,type:A}=nv(e,a,h),w=m[A];T!=null&&w&&ic(w,T,k)}dispatchEvent(e){let a=vo(this)[String(e.type)];if(a==null)return!0;let h=e instanceof Di?e:Is.wrap(e),m=pr(h,"event");if(m.dispatchFlag)throw Yp("This event has been in dispatching.");if(m.dispatchFlag=!0,m.target=m.currentTarget=this,!m.stopPropagationFlag){let{cow:T,listeners:k}=a;a.cow=!0;for(let A=0;A<k.length;++A){let w=k[A];if(!Zp(w)&&(tc(w)&&nc(a,A,!T)&&(A-=1),m.inPassiveListenerFlag=ec(w),Jp(w,this,h),m.inPassiveListenerFlag=!1,m.stopImmediatePropagationFlag))break}T||(a.cow=!1)}return m.target=null,m.currentTarget=null,m.stopImmediatePropagationFlag=!1,m.stopPropagationFlag=!1,m.dispatchFlag=!1,!m.canceledFlag}},ac=new WeakMap;function vo(i,e="this"){let a=ac.get(i);return vl(a!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",e,i),a}function iv(i,e,a){var h;return sc(e),typeof a=="object"&&a!==null?{type:String(i),callback:e??void 0,capture:Boolean(a.capture),passive:Boolean(a.passive),once:Boolean(a.once),signal:(h=a.signal)!==null&&h!==void 0?h:void 0}:{type:String(i),callback:e??void 0,capture:Boolean(a),passive:!1,once:!1,signal:void 0}}function nv(i,e,a){return sc(e),typeof a=="object"&&a!==null?{type:String(i),callback:e??void 0,capture:Boolean(a.capture)}:{type:String(i),callback:e??void 0,capture:Boolean(a)}}function sc(i){if(!(typeof i=="function"||typeof i=="object"&&i!==null&&typeof i.handleEvent=="function")){if(i==null||typeof i=="object"){Zl.warn(i);return}throw new TypeError($d(Zl.message,[i]))}}function av(i,e,a,h){$p.warn(Jd(i)?"capture":"bubble",i.callback),ec(i)!==e&&fo.warn("passive"),tc(i)!==a&&fo.warn("once"),i.signal!==h&&fo.warn("signal")}var mo=Object.getOwnPropertyNames(Ds.prototype);for(let i=0;i<mo.length;++i)mo[i]!=="constructor"&&Object.defineProperty(Ds.prototype,mo[i],{enumerable:!0});typeof ii<"u"&&typeof ii.EventTarget<"u"&&Object.setPrototypeOf(Ds.prototype,ii.EventTarget.prototype);var sv=Op(Np()),oc=30720,Ls=512e3,Rs=256,jo=(i,{minChunkSize:e=Rs,maxChunkSize:a=Ls}={})=>i==null||typeof i=="number"&&i>=256&&i%256===0&&i>=e&&i<=a,Go=(i,{minChunkSize:e=Rs,maxChunkSize:a=Ls}={})=>new TypeError(`chunkSize ${i} must be a positive number in multiples of 256, between ${e} and ${a}`),ov=class{constructor(e,a={}){this.readableStream=e;var h,m,T;if(!jo(a.defaultChunkSize,a))throw Go(a.defaultChunkSize,a);this.defaultChunkSize=(h=a.defaultChunkSize)!=null?h:oc,this.minChunkSize=(m=a.minChunkSize)!=null?m:Rs,this.maxChunkSize=(T=a.maxChunkSize)!=null?T:Ls}get chunkSize(){var e;return(e=this._chunkSize)!=null?e:this.defaultChunkSize}set chunkSize(e){if(!jo(e,this))throw Go(e,this);this._chunkSize=e}get chunkByteSize(){return this.chunkSize*1024}async*[Symbol.asyncIterator](){let e,a=this.readableStream.getReader();try{for(;;){let{done:h,value:m}=await a.read();if(h){if(e){let k=e;e=void 0,yield k}break}let T=m instanceof Uint8Array?new Blob([m],{type:"application/octet-stream"}):m;for(e=e?new Blob([e,T]):T;e;)if(e.size===this.chunkByteSize){let k=e;e=void 0,yield k;break}else{if(e.size<this.chunkByteSize)break;{let k=e.slice(0,this.chunkByteSize);e=e.slice(this.chunkByteSize),yield k}}}}finally{if(e){let h=e;e=void 0,yield h}a.releaseLock();return}}},lv=[200,201,202,204,308],lc=[408,502,503,504],uc=(i,e)=>!!i&&lv.includes(i.statusCode),uv=(i,{retryCodes:e=lc})=>!i||e.includes(i.statusCode),dv=(i,e)=>e.attemptCount>=e.attempts||!(uc(i)||uv(i,e)),cv=class{constructor(e){this.endpoint=e.endpoint,this.file=e.file,this.headers=e.headers||{},this.method=e.method||"PUT",this.attempts=e.attempts||5,this.delayBeforeAttempt=e.delayBeforeAttempt||1,this.retryCodes=e.retryCodes||lc,this.dynamicChunkSize=e.dynamicChunkSize||!1,this.maxFileBytes=(e.maxFileSize||0)*1024,this.chunkCount=0,this.attemptCount=0,this.offline=!1,this._paused=!1,this.success=!1,this.nextChunkRangeStart=0,this.chunkedStreamIterable=new ov(this.file.stream(),{...e,defaultChunkSize:e.chunkSize}),this.chunkedStreamIterator=this.chunkedStreamIterable[Symbol.asyncIterator](),this.totalChunks=Math.ceil(this.file.size/this.chunkByteSize),this.eventTarget=new Ds,this.validateOptions(),this.getEndpoint().then(()=>this.sendChunks()),typeof window<"u"&&(window.addEventListener("online",()=>{!this.offline||(this.offline=!1,this.dispatch("online"),this.sendChunks())}),window.addEventListener("offline",()=>{this.offline=!0,this.dispatch("offline")}))}get maxChunkSize(){var e,a;return(a=(e=this.chunkedStreamIterable)==null?void 0:e.maxChunkSize)!=null?a:Ls}get minChunkSize(){var e,a;return(a=(e=this.chunkedStreamIterable)==null?void 0:e.minChunkSize)!=null?a:Rs}get chunkSize(){var e,a;return(a=(e=this.chunkedStreamIterable)==null?void 0:e.chunkSize)!=null?a:oc}set chunkSize(e){this.chunkedStreamIterable.chunkSize=e}get chunkByteSize(){return this.chunkedStreamIterable.chunkByteSize}get totalChunkSize(){return Math.ceil(this.file.size/this.chunkByteSize)}on(e,a){this.eventTarget.addEventListener(e,a)}once(e,a){this.eventTarget.addEventListener(e,a,{once:!0})}off(e,a){this.eventTarget.removeEventListener(e,a)}get paused(){return this._paused}abort(){var e;this.pause(),(e=this.currentXhr)==null||e.abort()}pause(){this._paused=!0}resume(){this._paused&&(this._paused=!1,this.sendChunks())}dispatch(e,a){let h=new CustomEvent(e,{detail:a});this.eventTarget.dispatchEvent(h)}validateOptions(){if(!this.endpoint||typeof this.endpoint!="function"&&typeof this.endpoint!="string")throw new TypeError("endpoint must be defined as a string or a function that returns a promise");if(!(this.file instanceof File))throw new TypeError("file must be a File object");if(this.headers&&typeof this.headers!="function"&&typeof this.headers!="object")throw new TypeError("headers must be null, an object, or a function that returns an object or a promise");if(!jo(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize}))throw Go(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize});if(this.maxChunkSize&&(typeof this.maxChunkSize!="number"||this.maxChunkSize<256||this.maxChunkSize%256!==0||this.maxChunkSize<this.chunkSize||this.maxChunkSize<this.minChunkSize))throw new TypeError(`maxChunkSize must be a positive number in multiples of 256, and larger than or equal to both ${this.minChunkSize} and ${this.chunkSize}`);if(this.minChunkSize&&(typeof this.minChunkSize!="number"||this.minChunkSize<256||this.minChunkSize%256!==0||this.minChunkSize>this.chunkSize||this.minChunkSize>this.maxChunkSize))throw new TypeError(`minChunkSize must be a positive number in multiples of 256, and smaller than ${this.chunkSize} and ${this.maxChunkSize}`);if(this.maxFileBytes>0&&this.maxFileBytes<this.file.size)throw new Error(`file size exceeds maximum (${this.file.size} > ${this.maxFileBytes})`);if(this.attempts&&(typeof this.attempts!="number"||this.attempts<=0))throw new TypeError("retries must be a positive number");if(this.delayBeforeAttempt&&(typeof this.delayBeforeAttempt!="number"||this.delayBeforeAttempt<0))throw new TypeError("delayBeforeAttempt must be a positive number")}getEndpoint(){return typeof this.endpoint=="string"?(this.endpointValue=this.endpoint,Promise.resolve(this.endpoint)):this.endpoint(this.file).then(e=>(this.endpointValue=e,this.endpointValue))}xhrPromise(e){let a=h=>{h.upload.onprogress=m=>{var T;let k=this.totalChunks-this.chunkCount,A=(this.file.size-this.nextChunkRangeStart)/this.file.size/k,w=this.nextChunkRangeStart/this.file.size,U=m.loaded/((T=m.total)!=null?T:this.chunkByteSize)*A;this.dispatch("progress",Math.min((w+U)*100,100))}};return new Promise((h,m)=>{this.currentXhr=(0,sv.default)({...e,beforeSend:a},(T,k)=>(this.currentXhr=void 0,T?m(T):h(k)))})}async sendChunk(e){let a=this.nextChunkRangeStart,h=a+e.size-1,m={...await(typeof this.headers=="function"?this.headers():this.headers),"Content-Type":this.file.type,"Content-Range":`bytes ${a}-${h}/${this.file.size}`};return this.dispatch("attempt",{chunkNumber:this.chunkCount,totalChunks:this.totalChunks,chunkSize:this.chunkSize}),this.xhrPromise({headers:m,url:this.endpointValue,method:this.method,body:e})}async sendChunkWithRetries(e){let a=async(A,w)=>{var U;let x=(new Date().getTime()-this.lastChunkStart.getTime())/1e3;if(this.dispatch("chunkSuccess",{chunk:this.chunkCount,chunkSize:this.chunkSize,attempts:this.attemptCount,timeInterval:x,response:A}),this.attemptCount=0,this.chunkCount=((U=this.chunkCount)!=null?U:0)+1,this.nextChunkRangeStart=this.nextChunkRangeStart+this.chunkByteSize,this.dynamicChunkSize){let P=this.chunkSize;x<10?P=Math.min(this.chunkSize*2,this.maxChunkSize):x>30&&(P=Math.max(this.chunkSize/2,this.minChunkSize)),this.chunkSize=Math.ceil(P/256)*256;let g=(this.file.size-this.nextChunkRangeStart)/this.chunkByteSize;this.totalChunks=Math.ceil(this.chunkCount+g)}return!0},h=async(A,w)=>(this.dispatch("error",{message:`Server responded with ${A.statusCode}. Stopping upload.`,chunk:this.chunkCount,attempts:this.attemptCount}),!1),m=async(A,w)=>(this.dispatch("attemptFailure",{message:`An error occured uploading chunk ${this.chunkCount}. ${this.attempts-this.attemptCount} retries left.`,chunkNumber:this.chunkCount,attemptsLeft:this.attempts-this.attemptCount}),new Promise(U=>{setTimeout(async()=>{if(this._paused||this.offline){this.pendingChunk=e,U(!1);return}let x=await this.sendChunkWithRetries(e);U(x)},this.delayBeforeAttempt*1e3)})),T;try{this.attemptCount=this.attemptCount+1,this.lastChunkStart=new Date,T=await this.sendChunk(e)}catch{}let k={retryCodes:this.retryCodes,attemptCount:this.attemptCount,attempts:this.attempts};return uc(T)?a(T):dv(T,k)?h(T):m()}async sendChunks(){if(this.pendingChunk&&!(this._paused||this.offline)){let e=this.pendingChunk;this.pendingChunk=void 0;let a=await this.sendChunkWithRetries(e);this.success&&a&&this.dispatch("success")}for(;!(this.success||this._paused||this.offline);){let{value:e,done:a}=await this.chunkedStreamIterator.next(),h=!e&&a;if(e&&(h=await this.sendChunkWithRetries(e)),this.success=!!a,this.success&&h&&this.dispatch("success"),!h)return}}},hv=i=>new cv(i);const go=new WeakMap;function dc(i){return go.has(i)||go.set(i,{transforms:[],values:new Map}),go.get(i)}function fv(i,e){return i.has(e)||i.set(e,new jf),i.get(e)}const pv=["","X","Y","Z"],vv=["translate","scale","rotate","skew"],gs={x:"translateX",y:"translateY",z:"translateZ"},su={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:i=>i+"deg"},mv={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:i=>i+"px"},rotate:su,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:Gi},skew:su},ga=new Map,ml=i=>`--motion-${i}`,ys=["x","y","z"];vv.forEach(i=>{pv.forEach(e=>{ys.push(i+e),ga.set(ml(i+e),mv[i])})});const gv=(i,e)=>ys.indexOf(i)-ys.indexOf(e),yv=new Set(ys),cc=i=>yv.has(i),Ev=(i,e)=>{gs[e]&&(e=gs[e]);const{transforms:a}=dc(i);Gf(a,e),i.style.transform=bv(a)},bv=i=>i.sort(gv).reduce(_v,"").trim(),_v=(i,e)=>`${i} ${e}(var(${ml(e)}))`,Vo=i=>i.startsWith("--"),ou=new Set;function Tv(i){if(!ou.has(i)){ou.add(i);try{const{syntax:e,initialValue:a}=ga.has(i)?ga.get(i):{};CSS.registerProperty({name:i,inherits:!1,syntax:e,initialValue:a})}catch{}}}const yo=(i,e)=>document.createElement("div").animate(i,e),lu={cssRegisterProperty:()=>typeof CSS<"u"&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{yo({opacity:[1]})}catch{return!1}return!0},finished:()=>Boolean(yo({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{yo({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0}},Eo={},En={};for(const i in lu)En[i]=()=>(Eo[i]===void 0&&(Eo[i]=lu[i]()),Eo[i]);const Sv=.015,Av=(i,e)=>{let a="";const h=Math.round(e/Sv);for(let m=0;m<h;m++)a+=i(hl(0,h-1,m))+", ";return a.substring(0,a.length-2)},uu=(i,e)=>kn(i)?En.linearEasing()?`linear(${Av(i,e)})`:Xr.easing:Ud(i)?wv(i):i,wv=([i,e,a,h])=>`cubic-bezier(${i}, ${e}, ${a}, ${h})`;function kv(i,e){for(let a=0;a<i.length;a++)i[a]===null&&(i[a]=a?i[a-1]:e());return i}const Iv=i=>Array.isArray(i)?i:[i];function Ko(i){return gs[i]&&(i=gs[i]),cc(i)?ml(i):i}const Fa={get:(i,e)=>{e=Ko(e);let a=Vo(e)?i.style.getPropertyValue(e):getComputedStyle(i)[e];if(!a&&a!==0){const h=ga.get(e);h&&(a=h.initialValue)}return a},set:(i,e,a)=>{e=Ko(e),Vo(e)?i.style.setProperty(e,a):i.style[e]=a}};function hc(i,e=!0){if(!(!i||i.playState==="finished"))try{i.stop?i.stop():(e&&i.commitStyles(),i.cancel())}catch{}}function Dv(i,e){var a;let h=(e==null?void 0:e.toDefaultUnit)||Gi;const m=i[i.length-1];if($f(m)){const T=((a=m.match(/(-?[\d.]+)([a-z%]*)/))===null||a===void 0?void 0:a[2])||"";T&&(h=k=>k+T)}return h}function Lv(){return window.__MOTION_DEV_TOOLS_RECORD}function Rv(i,e,a,h={},m){const T=Lv(),k=h.record!==!1&&T;let A,{duration:w=Xr.duration,delay:U=Xr.delay,endDelay:x=Xr.endDelay,repeat:P=Xr.repeat,easing:g=Xr.easing,persist:I=!1,direction:O,offset:X,allowWebkitAcceleration:N=!1}=h;const ye=dc(i),de=cc(e);let re=En.waapi();de&&Ev(i,e);const z=Ko(e),he=fv(ye.values,z),G=ga.get(z);return hc(he.animation,!(Mo(g)&&he.generator)&&h.record!==!1),()=>{const Y=()=>{var ke,Q;return(Q=(ke=Fa.get(i,z))!==null&&ke!==void 0?ke:G==null?void 0:G.initialValue)!==null&&Q!==void 0?Q:0};let me=kv(Iv(a),Y);const Ae=Dv(me,G);if(Mo(g)){const ke=g.createAnimation(me,e!=="opacity",Y,z,he);g=ke.easing,me=ke.keyframes||me,w=ke.duration||w}if(Vo(z)&&(En.cssRegisterProperty()?Tv(z):re=!1),de&&!En.linearEasing()&&(kn(g)||Sn(g)&&g.some(kn))&&(re=!1),re){G&&(me=me.map(L=>vs(L)?G.toDefaultUnit(L):L)),me.length===1&&(!En.partialKeyframes()||k)&&me.unshift(Y());const ke={delay:ua.ms(U),duration:ua.ms(w),endDelay:ua.ms(x),easing:Sn(g)?void 0:uu(g,w),direction:O,iterations:P+1,fill:"both"};A=i.animate({[z]:me,offset:X,easing:Sn(g)?g.map(L=>uu(L,w)):void 0},ke),A.finished||(A.finished=new Promise((L,W)=>{A.onfinish=L,A.oncancel=W}));const Q=me[me.length-1];A.finished.then(()=>{I||(Fa.set(i,z,Q),A.cancel())}).catch(Md),N||(A.playbackRate=1.000001)}else if(m&&de)me=me.map(ke=>typeof ke=="string"?parseFloat(ke):ke),me.length===1&&me.unshift(parseFloat(Y())),A=new m(ke=>{Fa.set(i,z,Ae?Ae(ke):ke)},me,Object.assign(Object.assign({},h),{duration:w,easing:g}));else{const ke=me[me.length-1];Fa.set(i,z,G&&vs(ke)?G.toDefaultUnit(ke):ke)}return k&&T(i,e,me,{duration:w,delay:U,easing:g,repeat:P,offset:X},"motion-one"),he.setAnimation(A),A}}const Cv=(i,e)=>i[e]?Object.assign(Object.assign({},i),i[e]):Object.assign({},i);function xv(i,e){var a;return typeof i=="string"?e?((a=e[i])!==null&&a!==void 0||(e[i]=document.querySelectorAll(i)),i=e[i]):i=document.querySelectorAll(i):i instanceof Element&&(i=[i]),Array.from(i||[])}const Ov=i=>i(),fc=(i,e,a=Xr.duration)=>new Proxy({animations:i.map(Ov).filter(Boolean),duration:a,options:e},Pv),Mv=i=>i.animations[0],Pv={get:(i,e)=>{const a=Mv(i);switch(e){case"duration":return i.duration;case"currentTime":return ua.s((a==null?void 0:a[e])||0);case"playbackRate":case"playState":return a==null?void 0:a[e];case"finished":return i.finished||(i.finished=Promise.all(i.animations.map(Uv)).catch(Md)),i.finished;case"stop":return()=>{i.animations.forEach(h=>hc(h))};case"forEachNative":return h=>{i.animations.forEach(m=>h(m,i))};default:return typeof(a==null?void 0:a[e])>"u"?void 0:()=>i.animations.forEach(h=>h[e]())}},set:(i,e,a)=>{switch(e){case"currentTime":a=ua.ms(a);case"currentTime":case"playbackRate":for(let h=0;h<i.animations.length;h++)i.animations[h][e]=a;return!0}return!1}},Uv=i=>i.finished;function Fv(i,e,a){return kn(i)?i(e,a):i}function Nv(i){return function(a,h,m={}){a=xv(a);const T=a.length;Wl(Boolean(T),"No valid element provided."),Wl(Boolean(h),"No keyframes defined.");const k=[];for(let A=0;A<T;A++){const w=a[A];for(const U in h){const x=Cv(m,U);x.delay=Fv(x.delay,A,T);const P=Rv(w,U,h[U],x,i);k.push(P)}}return fc(k,m,m.duration)}}const Bv=Nv(Nd);function Hv(i,e={}){return fc([()=>{const a=new Nd(i,[0,1],e);return a.finished.catch(()=>{}),a}],e,e.duration)}function du(i,e,a){return(kn(i)?Hv:Bv)(i,e,a)}const At={MEDIA_PLAY_REQUEST:"mediaplayrequest",MEDIA_PAUSE_REQUEST:"mediapauserequest",MEDIA_MUTE_REQUEST:"mediamuterequest",MEDIA_UNMUTE_REQUEST:"mediaunmuterequest",MEDIA_VOLUME_REQUEST:"mediavolumerequest",MEDIA_SEEK_REQUEST:"mediaseekrequest",MEDIA_AIRPLAY_REQUEST:"mediaairplayrequest",MEDIA_ENTER_FULLSCREEN_REQUEST:"mediaenterfullscreenrequest",MEDIA_EXIT_FULLSCREEN_REQUEST:"mediaexitfullscreenrequest",MEDIA_PREVIEW_REQUEST:"mediapreviewrequest",MEDIA_ENTER_PIP_REQUEST:"mediaenterpiprequest",MEDIA_EXIT_PIP_REQUEST:"mediaexitpiprequest",MEDIA_ENTER_CAST_REQUEST:"mediaentercastrequest",MEDIA_EXIT_CAST_REQUEST:"mediaexitcastrequest",MEDIA_SHOW_TEXT_TRACKS_REQUEST:"mediashowtexttracksrequest",MEDIA_HIDE_TEXT_TRACKS_REQUEST:"mediahidetexttracksrequest",MEDIA_SHOW_CAPTIONS_REQUEST:"mediashowcaptionsrequest",MEDIA_SHOW_SUBTITLES_REQUEST:"mediashowsubtitlesrequest",MEDIA_DISABLE_CAPTIONS_REQUEST:"mediadisablecaptionsrequest",MEDIA_DISABLE_SUBTITLES_REQUEST:"mediadisablesubtitlesrequest",MEDIA_PLAYBACK_RATE_REQUEST:"mediaplaybackraterequest",MEDIA_SEEK_TO_LIVE_REQUEST:"mediaseektoliverequest",REGISTER_MEDIA_STATE_RECEIVER:"registermediastatereceiver",UNREGISTER_MEDIA_STATE_RECEIVER:"unregistermediastatereceiver"},Es={MEDIA_AIRPLAY_UNAVAILABLE:"mediaairplayunavailablechange",MEDIA_PIP_UNAVAILABLE:"mediapipunavailablechange",MEDIA_PAUSED:"mediapausedchange",MEDIA_HAS_PLAYED:"mediahasplayedchange",MEDIA_MUTED:"mediamutedchange",MEDIA_VOLUME_LEVEL:"mediavolumelevelchange",MEDIA_VOLUME:"mediavolumechange",MEDIA_VOLUME_UNAVAILABLE:"mediavolumeunavailablechange",MEDIA_IS_PIP:"mediaispipchange",MEDIA_IS_CASTING:"mediaiscastingchange",MEDIA_CAPTIONS_LIST:"mediacaptionslistchange",MEDIA_SUBTITLES_LIST:"mediasubtitleslistchange",MEDIA_CAPTIONS_SHOWING:"mediacaptionsshowingchange",MEDIA_SUBTITLES_SHOWING:"mediasubtitlesshowingchange",MEDIA_IS_FULLSCREEN:"mediaisfullscreenchange",MEDIA_PLAYBACK_RATE:"mediaplaybackratechange",MEDIA_CURRENT_TIME:"mediacurrenttimechange",MEDIA_DURATION:"mediadurationchange",MEDIA_SEEKABLE:"mediaseekablechange",MEDIA_PREVIEW_IMAGE:"mediapreviewimagechange",MEDIA_PREVIEW_COORDS:"mediapreviewcoordschange",MEDIA_LOADING:"medialoadingchange",USER_INACTIVE:"userinactivechange"},Qt={MEDIA_CHROME_ATTRIBUTES:"media-chrome-attributes",MEDIA_CONTROLLER:"media-controller"},Z={MEDIA_AIRPLAY_UNAVAILABLE:"media-airplay-unavailable",MEDIA_FULLSCREEN_UNAVAILABLE:"media-fullscreen-unavailable",MEDIA_PIP_UNAVAILABLE:"media-pip-unavailable",MEDIA_CAST_UNAVAILABLE:"media-cast-unavailable",MEDIA_PAUSED:"media-paused",MEDIA_HAS_PLAYED:"media-has-played",MEDIA_MUTED:"media-muted",MEDIA_VOLUME_LEVEL:"media-volume-level",MEDIA_VOLUME:"media-volume",MEDIA_VOLUME_UNAVAILABLE:"media-volume-unavailable",MEDIA_IS_PIP:"media-is-pip",MEDIA_IS_CASTING:"media-is-casting",MEDIA_CAPTIONS_LIST:"media-captions-list",MEDIA_SUBTITLES_LIST:"media-subtitles-list",MEDIA_CAPTIONS_SHOWING:"media-captions-showing",MEDIA_SUBTITLES_SHOWING:"media-subtitles-showing",MEDIA_IS_FULLSCREEN:"media-is-fullscreen",MEDIA_PLAYBACK_RATE:"media-playback-rate",MEDIA_CURRENT_TIME:"media-current-time",MEDIA_DURATION:"media-duration",MEDIA_SEEKABLE:"media-seekable",MEDIA_PREVIEW_TIME:"media-preview-time",MEDIA_PREVIEW_IMAGE:"media-preview-image",MEDIA_PREVIEW_COORDS:"media-preview-coords",MEDIA_LOADING:"media-loading",MEDIA_BUFFERED:"media-buffered",MEDIA_STREAM_TYPE:"media-stream-type",MEDIA_TARGET_LIVE_WINDOW:"media-target-live-window",MEDIA_TIME_IS_LIVE:"media-time-is-live"};Object.entries(Es).reduce((i,[e,a])=>{const h=Z[e];return h&&(i[a]=h),i},{userinactivechange:"user-inactive"});const jv=Object.entries(Z).reduce((i,[e,a])=>{const h=Es[e];return h&&(i[a]=h),i},{"user-inactive":"userinactivechange"}),ba={SUBTITLES:"subtitles",CAPTIONS:"captions",DESCRIPTIONS:"descriptions",CHAPTERS:"chapters",METADATA:"metadata"},bn={DISABLED:"disabled",HIDDEN:"hidden",SHOWING:"showing"},cu={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"},ui={UNAVAILABLE:"unavailable",UNSUPPORTED:"unsupported"},bs={LIVE:"live",ON_DEMAND:"on-demand"},Wi={AUDIO_PLAYER:()=>"audio player",VIDEO_PLAYER:()=>"video player",VOLUME:()=>"volume",SEEK:()=>"seek",CLOSED_CAPTIONS:()=>"closed captions",PLAYBACK_RATE:({playbackRate:i=1}={})=>`current playback rate ${i}`,PLAYBACK_TIME:()=>"playback time",MEDIA_LOADING:()=>"media loading"},Wr={PLAY:()=>"play",PAUSE:()=>"pause",MUTE:()=>"mute",UNMUTE:()=>"unmute",AIRPLAY:()=>"air play",ENTER_CAST:()=>"start casting",EXIT_CAST:()=>"stop casting",ENTER_FULLSCREEN:()=>"enter fullscreen mode",EXIT_FULLSCREEN:()=>"exit fullscreen mode",ENTER_PIP:()=>"enter picture in picture mode",EXIT_PIP:()=>"exit picture in picture mode",SEEK_FORWARD_N_SECS:({seekOffset:i=30}={})=>`seek forward ${i} seconds`,SEEK_BACK_N_SECS:({seekOffset:i=30}={})=>`seek back ${i} seconds`};function bo(i,e=!1){return i.split("_").map(function(a,h){return(h||e?a[0].toUpperCase():a[0].toLowerCase())+a.slice(1).toLowerCase()}).join("")}function Gv(i){return typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i)}const hu=[{singular:"hour",plural:"hours"},{singular:"minute",plural:"minutes"},{singular:"second",plural:"seconds"}],Vv=(i,e)=>{const a=i===1?hu[e].singular:hu[e].plural;return`${i} ${a}`},da=i=>{if(!Gv(i))return"";const e=Math.abs(i),a=e!==i,h=new Date(0,0,0,0,0,e,0);return`${[h.getHours(),h.getMinutes(),h.getSeconds()].map((A,w)=>A&&Vv(A,w)).filter(A=>A).join(", ")}${a?" remaining":""}`};function Vi(i,e){let a=!1;i<0&&(a=!0,i=0-i),i=i<0?0:i;let h=Math.floor(i%60),m=Math.floor(i/60%60),T=Math.floor(i/3600);const k=Math.floor(e/60%60),A=Math.floor(e/3600);return(isNaN(i)||i===1/0)&&(T=m=h="-"),T=T>0||A>0?T+":":"",m=((T||k>=10)&&m<10?"0"+m:m)+":",h=h<10?"0"+h:h,(a?"-":"")+T+m+h}class fu{addEventListener(){}removeEventListener(){}dispatchEvent(){return!0}}let Kv=class{observe(){}};const pc={ResizeObserver:Kv,HTMLElement:class extends fu{},DocumentFragment:class extends fu{},customElements:{get:function(){},define:function(){},whenDefined:function(){}},CustomEvent:function(){}},qv={createElement:function(){return new pc.HTMLElement}},vc=typeof window>"u"||typeof window.customElements>"u",Ge=vc?pc:window,Dt=vc?qv:window.document;var mc=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},ti=(i,e,a)=>(mc(i,e,"read from private field"),a?a.call(i):e.get(i)),Na=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Ba=(i,e,a,h)=>(mc(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),di,ts,mn,qo;const gc=Dt.createElement("template");gc.innerHTML=`
<style>
  :host {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: middle;
    box-sizing: border-box;
    background: var(--media-control-background, rgba(20,20,30, 0.7));

    padding: var(--media-control-padding, 10px);

    
    font-size: 14px;
    line-height: var(--media-text-content-height, var(--media-control-height, 24px));
    font-weight: bold;
    color: #fff;

    transition: background 0.15s linear;

    pointer-events: auto;
    cursor: pointer;
    font-family: Arial, sans-serif;
  }

  
  :host(:focus-visible) {
    box-shadow: inset 0 0 0 2px rgba(27, 127, 204, 0.9);
    outline: 0;
  }
  
  :host(:where(:focus)) {
    box-shadow: none;
    outline: 0;
  }

  :host(:hover) {
    background: var(--media-control-hover-background, rgba(50,50,70, 0.7));
  }

  svg, img, ::slotted(svg), ::slotted(img) {
    width: var(--media-button-icon-width);
    height: var(--media-button-icon-height, var(--media-control-height, 24px));
    transform: var(--media-button-icon-transform);
    transition: var(--media-button-icon-transition);
    fill: var(--media-icon-color, #eee);
    vertical-align: middle;
    max-width: 100%;
    max-height: 100%;
    min-width: 100%;
  }
</style>
`;class yc extends Ge.HTMLElement{constructor(e={}){super(),Na(this,di,void 0),Na(this,ts,T=>{this.handleClick(T)}),Na(this,mn,T=>{const{key:k}=T;if(!this.keysUsed.includes(k)){this.removeEventListener("keyup",ti(this,mn));return}this.handleClick(T)}),Na(this,qo,T=>{const{metaKey:k,altKey:A,key:w}=T;if(k||A||!this.keysUsed.includes(w)){this.removeEventListener("keyup",ti(this,mn));return}this.addEventListener("keyup",ti(this,mn),{once:!0})});const a=this.attachShadow({mode:"open"}),h=gc.content.cloneNode(!0);this.nativeEl=h;let m=e.slotTemplate;m||(m=Dt.createElement("template"),m.innerHTML=`<slot>${e.defaultContent||""}</slot>`),this.nativeEl.appendChild(m.content.cloneNode(!0)),a.appendChild(h)}static get observedAttributes(){return["disabled",Qt.MEDIA_CONTROLLER]}enable(){this.addEventListener("click",ti(this,ts)),this.addEventListener("keydown",ti(this,qo)),this.setAttribute("tabindex","0")}disable(){this.removeEventListener("click",ti(this,ts)),this.removeEventListener("keyup",ti(this,mn)),this.removeAttribute("tabindex")}attributeChangedCallback(e,a,h){var m,T,k,A,w;e===Qt.MEDIA_CONTROLLER?(a&&((T=(m=ti(this,di))==null?void 0:m.unassociateElement)==null||T.call(m,this),Ba(this,di,null)),h&&(Ba(this,di,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=ti(this,di))==null?void 0:A.associateElement)==null||w.call(A,this))):e==="disabled"&&h!==a&&(h==null?this.enable():this.disable())}connectedCallback(){var e,a,h;this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","button");const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Ba(this,di,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=ti(this,di))==null?void 0:a.associateElement)==null||h.call(a,this))}disconnectedCallback(){var e,a;this.disable(),(a=(e=ti(this,di))==null?void 0:e.unassociateElement)==null||a.call(e,this),Ba(this,di,null)}get keysUsed(){return["Enter"," "]}handleClick(e){}}di=new WeakMap;ts=new WeakMap;mn=new WeakMap;qo=new WeakMap;Ge.customElements.get("media-chrome-button")||Ge.customElements.define("media-chrome-button",yc);var ai=yc;const Wv=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.13 3H3.87a.87.87 0 0 0-.87.87v13.26a.87.87 0 0 0 .87.87h3.4L9 16H5V5h16v11h-4l1.72 2h3.4a.87.87 0 0 0 .87-.87V3.87a.87.87 0 0 0-.86-.87Zm-8.75 11.44a.5.5 0 0 0-.76 0l-4.91 5.73a.5.5 0 0 0 .38.83h9.82a.501.501 0 0 0 .38-.83l-4.91-5.73Z"/>
</svg>
`,Ec=Dt.createElement("template");Ec.innerHTML=`
  <slot name="airplay">${Wv}</slot>
`;class $v extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_AIRPLAY_UNAVAILABLE]}constructor(e={}){super({slotTemplate:Ec,...e})}connectedCallback(){this.setAttribute("aria-label",Wr.AIRPLAY()),super.connectedCallback()}handleClick(){const e=new Ge.CustomEvent(At.MEDIA_AIRPLAY_REQUEST,{composed:!0,bubbles:!0});this.dispatchEvent(e)}}Ge.customElements.get("media-airplay-button")||Ge.customElements.define("media-airplay-button",$v);const Yv='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/></g></svg>',zv='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/><path class="cast_caf_icon_boxfill" d="M5,7 L5,8.63 C8,8.6 13.37,14 13.37,17 L19,17 L19,7 Z"/></g></svg>',bc=Dt.createElement("template");bc.innerHTML=`
  <style>
  :host([${Z.MEDIA_IS_CASTING}]) slot:not([name=exit]) > *,
  :host([${Z.MEDIA_IS_CASTING}]) ::slotted(:not([slot=exit])) {
    display: none !important;
  }

  
  :host(:not([${Z.MEDIA_IS_CASTING}])) slot:not([name=enter]) > *,
  :host(:not([${Z.MEDIA_IS_CASTING}])) ::slotted(:not([slot=enter])) {
    display: none !important;
  }
  </style>

  <slot name="enter">${Yv}</slot>
  <slot name="exit">${zv}</slot>
`;const pu=i=>{const a=i.getAttribute(Z.MEDIA_IS_CASTING)!=null?Wr.EXIT_CAST():Wr.ENTER_CAST();i.setAttribute("aria-label",a)};class Xv extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_IS_CASTING,Z.MEDIA_CAST_UNAVAILABLE]}constructor(e={}){super({slotTemplate:bc,...e})}connectedCallback(){pu(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e===Z.MEDIA_IS_CASTING&&pu(this),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_IS_CASTING)!=null?At.MEDIA_EXIT_CAST_REQUEST:At.MEDIA_ENTER_CAST_REQUEST;this.dispatchEvent(new Ge.CustomEvent(e,{composed:!0,bubbles:!0}))}}Ge.customElements.get("media-cast-button")||Ge.customElements.define("media-cast-button",Xv);const _c=(i,e,a=".value")=>{const h=i.querySelector(a);h&&(h.textContent=e)},Qv=(i,e)=>{const a=`slot[name="${e}"]`,h=i.shadowRoot.querySelector(a);return h?h.children:[]},Tc=(i,e)=>Qv(i,e)[0],rs=(i,e)=>!i||!e?!1:i.contains(e)?!0:rs(i,e.getRootNode().host),gl=(i,e)=>{if(!i)return null;const a=i.closest(e);return a||gl(i.getRootNode().host,e)};function Hi(i,e){var a;let h;for(h of i.querySelectorAll("style")){let m;try{m=(a=h.sheet)==null?void 0:a.cssRules}catch{continue}for(let T of m??[])if(T.selectorText===e)return T}return h!=null&&h.sheet?(h.sheet.insertRule(`${e}{}`,h.sheet.cssRules.length),h.sheet.cssRules[h.sheet.cssRules.length-1]):{style:{setProperty:()=>{},removeProperty:()=>{}}}}var Sc=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},Mi=(i,e,a)=>(Sc(i,e,"read from private field"),a?a.call(i):e.get(i)),Zv=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Ha=(i,e,a,h)=>(Sc(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),Mr;const Ac=Dt.createElement("template");Ac.innerHTML=`
<style>
  :host {
    display: inline-block;
    box-sizing: border-box;
  }
</style>
`;class Jv extends Ge.HTMLElement{constructor(e={}){super(),Zv(this,Mr,void 0);const a=this.attachShadow({mode:"open"}),h=Ac.content.cloneNode(!0);this.nativeEl=h;let m=e.slotTemplate;m||(m=Dt.createElement("template"),m.innerHTML=`<slot>${e.defaultContent||""}</slot>`),this.nativeEl.appendChild(m.content.cloneNode(!0)),a.appendChild(h)}static get observedAttributes(){return[Qt.MEDIA_CONTROLLER,Z.MEDIA_PAUSED]}attributeChangedCallback(e,a,h){var m,T,k,A,w;e===Qt.MEDIA_CONTROLLER&&(a&&((T=(m=Mi(this,Mr))==null?void 0:m.unassociateElement)==null||T.call(m,this),Ha(this,Mr,null)),h&&(Ha(this,Mr,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=Mi(this,Mr))==null?void 0:A.associateElement)==null||w.call(A,this)))}connectedCallback(){var e,a,h,m;this.setAttribute("tabindex",-1),this.setAttribute("aria-hidden",!0),Ha(this,Mr,em(this)),this.getAttribute(Qt.MEDIA_CONTROLLER)&&((a=(e=Mi(this,Mr))==null?void 0:e.associateElement)==null||a.call(e,this)),(h=Mi(this,Mr))==null||h.addEventListener("pointerdown",this),(m=Mi(this,Mr))==null||m.addEventListener("click",this)}disconnectedCallback(){var e,a,h,m;this.getAttribute(Qt.MEDIA_CONTROLLER)&&((a=(e=Mi(this,Mr))==null?void 0:e.unassociateElement)==null||a.call(e,this)),(h=Mi(this,Mr))==null||h.removeEventListener("pointerdown",this),(m=Mi(this,Mr))==null||m.removeEventListener("click",this),Ha(this,Mr,null)}handleEvent(e){var a;const h=(a=e.composedPath())==null?void 0:a[0];if(["video","media-controller"].includes(h==null?void 0:h.localName)){if(e.type==="pointerdown")this._pointerType=e.pointerType;else if(e.type==="click"){const{clientX:T,clientY:k}=e,{left:A,top:w,width:U,height:x}=this.getBoundingClientRect(),P=T-A,g=k-w;if(P<0||g<0||P>U||g>x||U===0&&x===0)return;const{pointerType:I=this._pointerType}=e;if(this._pointerType=void 0,I===cu.TOUCH){this.handleTap(e);return}else if(I===cu.MOUSE){this.handleMouseClick(e);return}}}}handleTap(e){}handleMouseClick(e){const a=this.getAttribute(Z.MEDIA_PAUSED)!=null?At.MEDIA_PLAY_REQUEST:At.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Ge.CustomEvent(a,{composed:!0,bubbles:!0}))}}Mr=new WeakMap;function em(i){var e;const a=i.getAttribute(Qt.MEDIA_CONTROLLER);return a?(e=i.getRootNode())==null?void 0:e.getElementById(a):gl(i,"media-controller")}Ge.customElements.get("media-gesture-receiver")||Ge.customElements.define("media-gesture-receiver",Jv);const wc=Dt.createElement("template");wc.innerHTML=`
  <style>
    
    :host([media-is-fullscreen])  ::slotted([slot=media]) {
      outline: none;
    }

    :host {
      box-sizing: border-box;
      position: relative;
      display: inline-block;
      line-height: 0;
      background-color: var(--media-background-color, #000);
    }

    :host(:not([audio])) [part~=layer]:not([part~=media-layer]) {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      display: flex;
      flex-flow: column nowrap;
      align-items: start;
      pointer-events: none;
      background: none;
    }

    
    :host([audio]) [part~=layer][part~=gesture-layer] {
      height: 0;
      display: block;
    }

    
    :host(:not([audio])[gestures-disabled]) ::slotted([slot=gestures-chrome]),
    :host(:not([audio])[gestures-disabled]) media-gesture-receiver[slot=gestures-chrome] {
      display: none;
    }

    
    ::slotted(:not([slot=media]):not([slot=poster]):not(media-loading-indicator)) {
      pointer-events: auto;
    }

    :host(:not([audio])) *[part~=layer][part~=centered-layer] {
      align-items: center;
      justify-content: center;
    }

    :host(:not([audio])) ::slotted(media-gesture-receiver[slot=gestures-chrome]),
    :host(:not([audio])) media-gesture-receiver[slot=gestures-chrome] {
      align-self: stretch;
      flex-grow: 1;
    }

    slot[name=middle-chrome] {
      display: inline;
      flex-grow: 1;
      pointer-events: none;
      background: none;
    }

    
    ::slotted([slot=media]),
    ::slotted([slot=poster]) {
      width: 100%;
      height: 100%;
    }

    
    :host(:not([audio])) .spacer {
      flex-grow: 1;
    }

    
    :host(:-webkit-full-screen) {
      
      width: 100% !important;
      height: 100% !important;
    }

    
    ::slotted(:not([slot=media]):not([no-auto-hide])) {
      opacity: 1;
      transition: opacity 0.25s;
    }

    
    :host([user-inactive]:not([${Z.MEDIA_PAUSED}]):not([${Z.MEDIA_IS_CASTING}]):not([audio])) ::slotted(:not([slot=media]):not([no-auto-hide])) {
      opacity: 0;
      transition: opacity 1s;
    }

    ::slotted(media-control-bar)  {
      align-self: stretch;
    }

    :host([${Z.MEDIA_HAS_PLAYED}]) ::slotted([slot=poster]) {
      display: none;
    }
  </style>

  <slot name="media" part="layer media-layer"></slot>
  <slot name="poster" part="layer poster-layer"></slot>
  <slot name="gestures-chrome" part="layer gesture-layer">
    <media-gesture-receiver slot="gestures-chrome"></media-gesture-receiver>
  </slot>
  <span part="layer vertical-layer">
    <slot name="top-chrome" part="top chrome"></slot>
    <slot name="middle-chrome" part="middle chrome"></slot>
    <slot name="centered-chrome" part="layer centered-layer center centered chrome"></slot>
    
    <slot part="bottom chrome"></slot>
  </span>
`;const tm=Object.values(Z),rm="sm:384 md:576 lg:768 xl:960",im=i=>{var e;for(const a of i){const h=a.target;if(!h.isConnected)continue;const m=(e=h.getAttribute("breakpoints"))!=null?e:rm,T=nm(m),k=am(T,a.contentRect);Object.keys(T).forEach(A=>{if(k.includes(A)){h.hasAttribute(`breakpoint-${A}`)||h.setAttribute(`breakpoint-${A}`,"");return}h.removeAttribute(`breakpoint-${A}`)})}};function nm(i){const e=i.split(/\s+/);return Object.fromEntries(e.map(a=>a.split(":")))}function am(i,e){return Object.keys(i).filter(a=>e.width>=i[a])}let kc=class extends Ge.HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(wc.content.cloneNode(!0));const e=k=>{const A=this.media;for(let w of k)w.type==="childList"&&(w.removedNodes.forEach(U=>{if(U.slot=="media"&&w.target==this){let x=w.previousSibling&&w.previousSibling.previousElementSibling;if(!x||!A)this.mediaUnsetCallback(U);else{let P=x.slot!=="media";for(;(x=x.previousSibling)!==null;)x.slot=="media"&&(P=!1);P&&this.mediaUnsetCallback(U)}}}),A&&w.addedNodes.forEach(U=>{U==A&&this.handleMediaUpdated(A).then(x=>this.mediaSetCallback(x))}))};new MutationObserver(e).observe(this,{childList:!0,subtree:!0}),new ResizeObserver(im).observe(this);let m=this.media,T=this.querySelector(":scope > slot[slot=media]");T&&T.addEventListener("slotchange",()=>{if(!T.assignedElements({flatten:!0}).length){this.mediaUnsetCallback(m);return}this.media&&(m=this.media,this.handleMediaUpdated(this.media).then(A=>this.mediaSetCallback(A)))})}static get observedAttributes(){return["autohide","gestures-disabled"].concat(tm)}attributeChangedCallback(e,a,h){e.toLowerCase()=="autohide"&&(this.autohide=h)}get media(){let e=this.querySelector(":scope > [slot=media]");return(e==null?void 0:e.nodeName)=="SLOT"&&(e=e.assignedElements({flatten:!0})[0]),e}mediaSetCallback(e){this._mediaClickPlayToggle=()=>{const a=e.paused?At.MEDIA_PLAY_REQUEST:At.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Ge.CustomEvent(a,{composed:!0,bubbles:!0}))}}handleMediaUpdated(e){const a=T=>Promise.resolve(T),h=T=>(console.error('<media-chrome>: Media element set with slot="media" does not appear to be compatible.',T),Promise.reject(T));if(!e)return h(e);const m=e.nodeName.toLowerCase();return m.includes("-")?Ge.customElements.whenDefined(m).then(()=>a(e)):a(e)}mediaUnsetCallback(e){}connectedCallback(){const a=this.getAttribute("audio")!=null?Wi.AUDIO_PLAYER():Wi.VIDEO_PLAYER();this.setAttribute("role","region"),this.setAttribute("aria-label",a),this.media&&this.handleMediaUpdated(this.media).then(k=>this.mediaSetCallback(k)),this.setAttribute("user-inactive","user-inactive");const h=()=>{if(this.autohide<0)return;this.setAttribute("user-inactive","user-inactive");const k=new Ge.CustomEvent(Es.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!0});this.dispatchEvent(k)},m=()=>{this.removeAttribute("user-inactive");const k=new Ge.CustomEvent(Es.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!1});this.dispatchEvent(k)},T=()=>{m(),Ge.clearTimeout(this._inactiveTimeout),!(this.autohide<0)&&(this._inactiveTimeout=Ge.setTimeout(()=>{h()},this.autohide*1e3))};this.addEventListener("keyup",()=>{T()}),this.addEventListener("pointerup",k=>{k.pointerType==="touch"?[this,this.media].includes(k.target)&&!this.hasAttribute("user-inactive")?h():T():k.composedPath().some(A=>{var w;return["media-play-button","media-fullscreen-button"].includes((w=A==null?void 0:A.nodeName)==null?void 0:w.toLowerCase())})&&T()}),this.addEventListener("pointermove",k=>{k.pointerType==="mouse"&&k.target!==this&&(m(),Ge.clearTimeout(this._inactiveTimeout),[this,this.media].includes(k.target)&&T())}),this.addEventListener("mouseleave",()=>{h()}),this.addEventListener("keyup",()=>{this.setAttribute("media-keyboard-control","")}),Ge.addEventListener("mouseup",()=>{this.removeAttribute("media-keyboard-control")})}set autohide(e){e=Number(e),this._autohide=isNaN(e)?0:e}get autohide(){return this._autohide===void 0?2:this._autohide}};Ge.customElements.get("media-container-temp")||Ge.customElements.define("media-container-temp",kc);var sm=kc,Ic=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},Ir=(i,e,a)=>(Ic(i,e,"read from private field"),a?a.call(i):e.get(i)),_o=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},To=(i,e,a,h)=>(Ic(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),gn,yn,jr;class om{constructor(e,a){_o(this,gn,void 0),_o(this,yn,void 0),_o(this,jr,new Set),To(this,gn,e),To(this,yn,a)}[Symbol.iterator](){return Ir(this,jr).values()}get length(){return Ir(this,jr).size}get value(){var e;return(e=[...Ir(this,jr)].join(" "))!=null?e:""}set value(e){var a;e!==this.value&&(To(this,jr,new Set),this.add(...(a=e==null?void 0:e.split(" "))!=null?a:[]))}toString(){return this.value}item(e){return[...Ir(this,jr)][e]}values(){return Ir(this,jr).values()}keys(){return Ir(this,jr).keys()}forEach(e){Ir(this,jr).forEach(e)}add(...e){var a,h;e.forEach(m=>Ir(this,jr).add(m)),!(this.value===""&&!((a=Ir(this,gn))!=null&&a.hasAttribute(`${Ir(this,yn)}`)))&&((h=Ir(this,gn))==null||h.setAttribute(`${Ir(this,yn)}`,`${this.value}`))}remove(...e){var a;e.forEach(h=>Ir(this,jr).delete(h)),(a=Ir(this,gn))==null||a.setAttribute(`${Ir(this,yn)}`,`${this.value}`)}contains(e){return Ir(this,jr).has(e)}toggle(e,a){return typeof a<"u"?a?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}replace(e,a){this.remove(e),this.add(a)}}gn=new WeakMap;yn=new WeakMap;jr=new WeakMap;const _r={enter:"requestFullscreen",exit:"exitFullscreen",event:"fullscreenchange",element:"fullscreenElement",error:"fullscreenerror",enabled:"fullscreenEnabled"};Dt.fullscreenElement===void 0&&(_r.enter="webkitRequestFullScreen",_r.exit=Dt.webkitExitFullscreen!=null?"webkitExitFullscreen":"webkitCancelFullScreen",_r.event="webkitfullscreenchange",_r.element="webkitFullscreenElement",_r.error="webkitfullscreenerror",_r.enabled="webkitFullscreenEnabled");const Wo=(i="")=>i.split(/\s+/),Dc=(i="")=>{const[e,a]=i.split(":"),h=a?decodeURIComponent(a):void 0;return{language:e,label:h}},lm=(i="",e={})=>Wo(i).map(a=>{const h=Dc(a);return{...e,...h}}),um=i=>Array.isArray(i)?i.map(e=>typeof e=="string"?Dc(e):e):typeof i=="string"?lm(i):[i],dm=({label:i,language:e}={})=>i?`${e}:${encodeURIComponent(i)}`:e,mi=(i=[])=>Array.prototype.map.call(i,dm).join(" "),cm=(i,e)=>a=>a[i]===e,Lc=i=>{const e=Object.entries(i).map(([a,h])=>cm(a,h));return a=>e.every(h=>h(a))},ja=(i,e=[],a=[])=>{const h=um(a).map(Lc),m=T=>h.some(k=>k(T));Array.from(e).filter(m).forEach(T=>{T.mode=i})},_a=(i,e=()=>!0)=>{if(!(i!=null&&i.textTracks))return[];const a=typeof e=="function"?e:Lc(e);return Array.from(i.textTracks).filter(a)},Rc=i=>{const e=!!i.getAttribute(Z.MEDIA_CAPTIONS_SHOWING),a=!i.hasAttribute("no-subtitles-fallback")&&!!i.getAttribute(Z.MEDIA_SUBTITLES_SHOWING);return e||a},Cc=i=>{var e,a,h,m;if(Rc(i)){const k=i.getAttribute(Z.MEDIA_CAPTIONS_SHOWING);if(k){const w=new window.CustomEvent(At.MEDIA_DISABLE_CAPTIONS_REQUEST,{composed:!0,bubbles:!0,detail:k});i.dispatchEvent(w)}const A=i.getAttribute(Z.MEDIA_SUBTITLES_SHOWING);if(A&&!i.hasAttribute("no-subtitles-fallback")){const w=new window.CustomEvent(At.MEDIA_DISABLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:A});i.dispatchEvent(w)}}else{const[k]=(a=Wo((e=i.getAttribute(Z.MEDIA_CAPTIONS_LIST))!=null?e:""))!=null?a:[];if(k){const A=new window.CustomEvent(At.MEDIA_SHOW_CAPTIONS_REQUEST,{composed:!0,bubbles:!0,detail:k});i.dispatchEvent(A)}else if(i.hasAttribute("no-subtitles-fallback"))console.error("Attempting to enable closed captions but none are available! Please verify your media content if this is unexpected.");else{const[A]=(m=Wo((h=i.getAttribute(Z.MEDIA_SUBTITLES_LIST))!=null?h:""))!=null?m:[];if(A){const w=new window.CustomEvent(At.MEDIA_SHOW_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:A});i.dispatchEvent(w)}}}};var yl=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},an=(i,e,a)=>(yl(i,e,"read from private field"),a?a.call(i):e.get(i)),Ga=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},vu=(i,e,a,h)=>(yl(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),An=(i,e,a)=>(yl(i,e,"access private method"),a),Fi,ra,In,ya,is,$o;const mu=Object.values(bs),xc=["ArrowLeft","ArrowRight","Enter"," ","f","m","k","c"],hm=10,gu=0;let Oc=class extends sm{constructor(){super(),Ga(this,In),Ga(this,is),Ga(this,Fi,new om(this,"hotkeys")),Ga(this,ra,void 0),Tm||(this._airplayUnavailable=ui.UNSUPPORTED),bu||(this._fullscreenUnavailable=ui.UNAVAILABLE),Sm||(this._castUnavailable=ui.UNSUPPORTED),bm||(this._pipUnavailable=ui.UNSUPPORTED),ha!==void 0?ha||(this._volumeUnavailable=ui.UNSUPPORTED):_m.then(()=>{ha||(this._volumeUnavailable=ui.UNSUPPORTED,this.propagateMediaState(Z.MEDIA_VOLUME_UNAVAILABLE,this._volumeUnavailable))}),this.mediaStateReceivers=[],this.associatedElementSubscriptions=new Map,this.associateElement(this);const e={MEDIA_PLAY_REQUEST:(a,h)=>{const m=Zn[Z.MEDIA_STREAM_TYPE](this),T=this.getAttribute("noautoseektolive")===null;m==bs.LIVE&&T&&e.MEDIA_SEEK_TO_LIVE_REQUEST(a,h),this.media.play().catch(()=>{})},MEDIA_PAUSE_REQUEST:()=>this.media.pause(),MEDIA_MUTE_REQUEST:()=>this.media.muted=!0,MEDIA_UNMUTE_REQUEST:()=>{const a=this.media;a.muted=!1,a.volume===0&&(a.volume=.25)},MEDIA_VOLUME_REQUEST:a=>{const h=this.media,m=a.detail;h.volume=m,m>0&&h.muted&&(h.muted=!1);try{Ge.localStorage.setItem("media-chrome-pref-volume",m.toString())}catch{}},MEDIA_ENTER_FULLSCREEN_REQUEST:()=>{if(!bu){console.warn("Fullscreen support is unavailable; not entering fullscreen");return}const a=this.media;Dt.pictureInPictureElement&&Dt.exitPictureInPicture(),super[_r.enter]?this.fullscreenElement[_r.enter]():a.webkitEnterFullscreen?a.webkitEnterFullscreen():a.requestFullscreen?a.requestFullscreen():console.warn("MediaChrome: Fullscreen not supported")},MEDIA_EXIT_FULLSCREEN_REQUEST:()=>{Dt[_r.exit]()},MEDIA_ENTER_PIP_REQUEST:()=>{const a=this.media;if(!Dt.pictureInPictureEnabled){console.warn("MediaChrome: Picture-in-picture is not enabled");return}if(!a.requestPictureInPicture){console.warn("MediaChrome: The current media does not support picture-in-picture");return}Dt[_r.element]&&Dt[_r.exit]();const h=()=>{console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a readyState > 0.")};a.requestPictureInPicture().catch(m=>{if(m.code===11)if(a.readyState===0&&a.preload==="none"){const T=()=>{a.removeEventListener("loadedmetadata",k),a.preload="none"},k=()=>{a.requestPictureInPicture().catch(h),T()};a.addEventListener("loadedmetadata",k),a.preload="metadata",setTimeout(()=>{a.readyState===0&&h(),T()},1e3)}else throw m;else throw m})},MEDIA_EXIT_PIP_REQUEST:()=>{Dt.pictureInPictureElement&&Dt.exitPictureInPicture()},MEDIA_ENTER_CAST_REQUEST:()=>{var a;const h=this.media;(a=globalThis.CastableVideoElement)!=null&&a.castEnabled&&(Dt[_r.element]&&Dt[_r.exit](),h.requestCast())},MEDIA_EXIT_CAST_REQUEST:async()=>{var a;(a=globalThis.CastableVideoElement)!=null&&a.castElement&&globalThis.CastableVideoElement.exitCast()},MEDIA_SEEK_REQUEST:a=>{const h=this.media,m=a.detail;(h.readyState>0||h.readyState===void 0)&&(h.currentTime=m)},MEDIA_PLAYBACK_RATE_REQUEST:a=>{this.media.playbackRate=a.detail},MEDIA_PREVIEW_REQUEST:a=>{var h;const m=this.media;if(!m)return;const T=a.detail;T===null&&this.propagateMediaState(Z.MEDIA_PREVIEW_TIME,void 0),this.propagateMediaState(Z.MEDIA_PREVIEW_TIME,T);const[k]=_a(m,{kind:ba.METADATA,label:"thumbnails"});if(!(k&&k.cues))return;if(T===null){this.propagateMediaState(Z.MEDIA_PREVIEW_IMAGE,void 0),this.propagateMediaState(Z.MEDIA_PREVIEW_COORDS,void 0);return}const A=Array.prototype.find.call(k.cues,P=>P.startTime>=T);if(!A)return;const w=/'^(?:[a-z]+:)?\/\//i.test(A.text)||(h=m.querySelector('track[label="thumbnails"]'))==null?void 0:h.src,U=new URL(A.text,w),x=new URLSearchParams(U.hash).get("#xywh");this.propagateMediaState(Z.MEDIA_PREVIEW_IMAGE,U.href),this.propagateMediaState(Z.MEDIA_PREVIEW_COORDS,x.split(",").join(" "))},MEDIA_SHOW_CAPTIONS_REQUEST:a=>{const h=ns(this),{detail:m=[]}=a;ja(bn.SHOWING,h,m)},MEDIA_DISABLE_CAPTIONS_REQUEST:a=>{const h=ns(this),{detail:m=[]}=a;ja(bn.DISABLED,h,m)},MEDIA_SHOW_SUBTITLES_REQUEST:a=>{const h=ca(this),{detail:m=[]}=a;ja(bn.SHOWING,h,m)},MEDIA_DISABLE_SUBTITLES_REQUEST:a=>{const h=ca(this),{detail:m=[]}=a;ja(bn.DISABLED,h,m)},MEDIA_AIRPLAY_REQUEST:()=>{const{media:a}=this;if(a){if(!(a.webkitShowPlaybackTargetPicker&&Ge.WebKitPlaybackTargetAvailabilityEvent)){console.warn("received a request to select AirPlay but AirPlay is not supported in this environment");return}a.webkitShowPlaybackTargetPicker()}},MEDIA_SEEK_TO_LIVE_REQUEST:(a,h)=>{const m=h.seekable;if(!m){console.warn("MediaController: Media element does not support seeking to live.");return}if(!m.length){console.warn("MediaController: Media is unable to seek to live.");return}h.currentTime=m.end(m.length-1)}};if(Object.keys(e).forEach(a=>{const h=`_handle${bo(a,!0)}`;this[h]=m=>{if(m.stopPropagation(),!this.media){console.warn("MediaController: No media available.");return}e[a](m,this.media)},this.addEventListener(At[a],this[h])}),this._mediaStatePropagators={"play,pause,emptied":()=>{this.propagateMediaState(Z.MEDIA_PAUSED,Mc(this))},"playing,emptied":()=>{var a;this.propagateMediaState(Z.MEDIA_HAS_PLAYED,!((a=this.media)!=null&&a.paused))},volumechange:()=>{this.propagateMediaState(Z.MEDIA_MUTED,Pc(this)),this.propagateMediaState(Z.MEDIA_VOLUME,Uc(this)),this.propagateMediaState(Z.MEDIA_VOLUME_LEVEL,Fc(this))},[_r.event]:a=>{const m=!!Dt[_r.element]&&(a==null?void 0:a.target),T=rs(this.fullscreenElement,m);this.propagateMediaState(Z.MEDIA_IS_FULLSCREEN,T)},"enterpictureinpicture,leavepictureinpicture":a=>{var h;let m;if(a)m=a.type=="enterpictureinpicture";else{const T=(h=this.getRootNode().pictureInPictureElement)!=null?h:Dt.pictureInPictureElement;m=this.media&&rs(this.media,T)}this.propagateMediaState(Z.MEDIA_IS_PIP,m)},"entercast,leavecast,castchange":a=>{var h;const m=(h=globalThis.CastableVideoElement)==null?void 0:h.castElement;let T=this.media&&rs(this.media,m);(a==null?void 0:a.type)==="castchange"&&(a==null?void 0:a.detail)==="CONNECTING"&&(T="connecting"),this.propagateMediaState(Z.MEDIA_IS_CASTING,T)},"timeupdate,loadedmetadata":()=>{this.propagateMediaState(Z.MEDIA_CURRENT_TIME,Nc(this))},"durationchange,loadedmetadata,emptied":()=>{this.propagateMediaState(Z.MEDIA_DURATION,Bc(this))},"emptied,durationchange,loadedmetadata,streamtypechange":()=>{this.propagateMediaState(Z.MEDIA_STREAM_TYPE)},"emptied,durationchange,loadedmetadata,targetlivewindowchange":()=>{this.propagateMediaState(Z.MEDIA_TARGET_LIVE_WINDOW)},"loadedmetadata,emptied,progress":()=>{var a;this.propagateMediaState(Z.MEDIA_SEEKABLE,(a=Hc(this))==null?void 0:a.join(":"))},"progress,emptied":()=>{var a;this.propagateMediaState(Z.MEDIA_BUFFERED,km((a=this.media)==null?void 0:a.buffered))},"ratechange,loadstart":()=>{this.propagateMediaState(Z.MEDIA_PLAYBACK_RATE,jc(this))},"waiting,playing,emptied":()=>{var a;const h=((a=this.media)==null?void 0:a.readyState)<3;this.propagateMediaState(Z.MEDIA_LOADING,h)},"playing,timeupdate,progress,waiting,emptied":()=>{this.propagateMediaState(Z.MEDIA_TIME_IS_LIVE)}},this._airplayUnavailable!==ui.UNSUPPORTED){const a=h=>{(h==null?void 0:h.availability)==="available"?this._airplayUnavailable=void 0:(h==null?void 0:h.availability)==="not-available"&&(this._airplayUnavailable=ui.UNAVAILABLE),this.propagateMediaState(Z.MEDIA_AIRPLAY_UNAVAILABLE,this._airplayUnavailable)};this._mediaStatePropagators.webkitplaybacktargetavailabilitychanged=a}if(this._castUnavailable!==ui.UNSUPPORTED){const a=()=>{var h;const m=(h=globalThis.CastableVideoElement)==null?void 0:h.castState;m!=null&&m.includes("CONNECT")?this._castUnavailable=void 0:this._castUnavailable=ui.UNAVAILABLE,this.propagateMediaState(Z.MEDIA_CAST_UNAVAILABLE,this._castUnavailable)};this._mediaStatePropagators.castchange=a}this._textTrackMediaStatePropagators={"addtrack,removetrack,loadstart":()=>{this.propagateMediaState(Z.MEDIA_CAPTIONS_LIST,mi(ns(this))||void 0),this.propagateMediaState(Z.MEDIA_SUBTITLES_LIST,mi(ca(this))||void 0),this.propagateMediaState(Z.MEDIA_CAPTIONS_SHOWING,mi(Yo(this))||void 0),this.propagateMediaState(Z.MEDIA_SUBTITLES_SHOWING,mi(yu(this))||void 0)},change:()=>{this.propagateMediaState(Z.MEDIA_CAPTIONS_SHOWING,mi(Yo(this))||void 0),this.propagateMediaState(Z.MEDIA_SUBTITLES_SHOWING,mi(yu(this))||void 0)}},this.enableHotkeys()}static get observedAttributes(){return super.observedAttributes.concat("nohotkeys","hotkeys","default-stream-type")}get fullscreenElement(){var e;return(e=an(this,ra))!=null?e:this}set fullscreenElement(e){this.hasAttribute("fullscreen-element")&&this.removeAttribute("fullscreen-element"),vu(this,ra,e)}attributeChangedCallback(e,a,h){var m;if(e==="nohotkeys")h!==a&&h===""?(this.hasAttribute("hotkeys")&&console.warn("Both `hotkeys` and `nohotkeys` have been set. All hotkeys will be disabled."),this.disableHotkeys()):h!==a&&h===null&&this.enableHotkeys();else if(e==="hotkeys")an(this,Fi).value=h;else if(e==="default-stream-type")this.propagateMediaState(Z.MEDIA_STREAM_TYPE);else if(e==="fullscreen-element"){const T=h?(m=this.getRootNode())==null?void 0:m.getElementById(h):void 0;vu(this,ra,T)}super.attributeChangedCallback(e,a,h)}mediaSetCallback(e){super.mediaSetCallback(e),e.hasAttribute("tabindex")||e.setAttribute("tabindex",-1),Object.keys(this._mediaStatePropagators).forEach(a=>{const h=a.split(","),m=this._mediaStatePropagators[a];h.forEach(T=>{(T==_r.event?this.getRootNode():e).addEventListener(T,m)}),m()}),Object.entries(this._textTrackMediaStatePropagators).forEach(([a,h])=>{a.split(",").forEach(T=>{e.textTracks&&e.textTracks.addEventListener(T,h)}),h()});try{const a=Ge.localStorage.getItem("media-chrome-pref-volume");a!==null&&(e.volume=a)}catch(a){console.debug("Error getting volume pref",a)}}mediaUnsetCallback(e){super.mediaUnsetCallback(e),Object.keys(this._mediaStatePropagators).forEach(a=>{const h=a.split(","),m=this._mediaStatePropagators[a];h.forEach(T=>{(T==_r.event?this.getRootNode():e).removeEventListener(T,m)})}),Object.entries(this._textTrackMediaStatePropagators).forEach(([a,h])=>{a.split(",").forEach(T=>{e.textTracks&&e.textTracks.removeEventListener(T,h)}),h()}),this.propagateMediaState(Z.MEDIA_PAUSED,!0)}propagateMediaState(e,a){arguments.length===1&&(a=Zn[e](this)),nn(this.mediaStateReceivers,e,a);const h=new Ge.CustomEvent(jv[e],{composed:!0,bubbles:!0,detail:a});this.dispatchEvent(h)}associateElement(e){if(!e)return;const{associatedElementSubscriptions:a}=this;if(a.has(e))return;const h=this.registerMediaStateReceiver.bind(this),m=this.unregisterMediaStateReceiver.bind(this),T=gm(e,h,m);Object.keys(At).forEach(k=>{e.addEventListener(At[k],this[`_handle${bo(k,!0)}`])}),a.set(e,T)}unassociateElement(e){if(!e)return;const{associatedElementSubscriptions:a}=this;if(!a.has(e))return;a.get(e)(),a.delete(e),Object.keys(At).forEach(m=>{e.removeEventListener(At[m],this[`_handle${bo(m,!0)}`])})}registerMediaStateReceiver(e){if(!e)return;const a=this.mediaStateReceivers;a.indexOf(e)>-1||(a.push(e),nn([e],Z.MEDIA_VOLUME_UNAVAILABLE,this._volumeUnavailable),nn([e],Z.MEDIA_AIRPLAY_UNAVAILABLE,this._airplayUnavailable),nn([e],Z.MEDIA_FULLSCREEN_UNAVAILABLE,this._fullscreenUnavailable),nn([e],Z.MEDIA_CAST_UNAVAILABLE,this._castUnavailable),nn([e],Z.MEDIA_PIP_UNAVAILABLE,this._pipUnavailable),this.media&&Object.keys(Z).forEach(m=>{m.includes("UNAVAILABLE")||nn([e],Z[m],Zn[Z[m]]?Zn[Z[m]](this):Zn.default(this,Z[m]))}))}unregisterMediaStateReceiver(e){const a=this.mediaStateReceivers,h=a.indexOf(e);h<0||a.splice(h,1)}enableHotkeys(){this.addEventListener("keydown",An(this,is,$o))}disableHotkeys(){this.removeEventListener("keydown",An(this,is,$o)),this.removeEventListener("keyup",An(this,In,ya))}get hotkeys(){return an(this,Fi)}keyboardShortcutHandler(e){var a,h,m,T;if(((T=(m=(a=e.target.getAttribute("keysused"))==null?void 0:a.split(" "))!=null?m:(h=e.target)==null?void 0:h.keysUsed)!=null?T:[]).map(I=>I==="Space"?" ":I).filter(Boolean).includes(e.key))return;let A,w,U,x,P;const g=hm;if(!an(this,Fi).contains(`no${e.key.toLowerCase()}`)&&!(e.key===" "&&an(this,Fi).contains("nospace")))switch(e.key){case" ":case"k":A=this.getAttribute(Z.MEDIA_PAUSED)!=null?At.MEDIA_PLAY_REQUEST:At.MEDIA_PAUSE_REQUEST,this.dispatchEvent(new Ge.CustomEvent(A,{composed:!0,bubbles:!0}));break;case"m":A=this.getAttribute(Z.MEDIA_VOLUME_LEVEL)==="off"?At.MEDIA_UNMUTE_REQUEST:At.MEDIA_MUTE_REQUEST,this.dispatchEvent(new Ge.CustomEvent(A,{composed:!0,bubbles:!0}));break;case"f":A=this.getAttribute(Z.MEDIA_IS_FULLSCREEN)!=null?At.MEDIA_EXIT_FULLSCREEN_REQUEST:At.MEDIA_ENTER_FULLSCREEN_REQUEST,this.dispatchEvent(new Ge.CustomEvent(A,{composed:!0,bubbles:!0}));break;case"c":Cc(this);break;case"ArrowLeft":w=this.getAttribute(Z.MEDIA_CURRENT_TIME),U=w&&!Number.isNaN(+w)?+w:gu,x=Math.max(U-g,0),P=new Ge.CustomEvent(At.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:x}),this.dispatchEvent(P);break;case"ArrowRight":w=this.getAttribute(Z.MEDIA_CURRENT_TIME),U=w&&!Number.isNaN(+w)?+w:gu,x=Math.max(U+g,0),P=new Ge.CustomEvent(At.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:x}),this.dispatchEvent(P);break}}};Fi=new WeakMap;ra=new WeakMap;In=new WeakSet;ya=function(i){const{key:e}=i;if(!xc.includes(e)){this.removeEventListener("keyup",An(this,In,ya));return}this.keyboardShortcutHandler(i)};is=new WeakSet;$o=function(i){const{metaKey:e,altKey:a,key:h}=i;if(e||a||!xc.includes(h)){this.removeEventListener("keyup",An(this,In,ya));return}[" ","ArrowLeft","ArrowRight"].includes(h)&&!(an(this,Fi).contains(`no${h.toLowerCase()}`)||h===" "&&an(this,Fi).contains("nospace"))&&i.preventDefault(),this.addEventListener("keyup",An(this,In,ya),{once:!0})};const Zn={default(i,e){return i.getAttribute(e)},[Z.MEDIA_CAPTIONS_LIST](i){return mi(ns(i))||void 0},[Z.MEDIA_SUBTITLES_LIST](i){return mi(ca(i))||void 0},[Z.MEDIA_SUBTITLES_LIST](i){return mi(ca(i))||void 0},[Z.MEDIA_CAPTIONS_SHOWING](i){return mi(Yo(i))||void 0},[Z.MEDIA_PAUSED](i){return Mc(i)},[Z.MEDIA_MUTED](i){return Pc(i)},[Z.MEDIA_VOLUME](i){return Uc(i)},[Z.MEDIA_VOLUME_LEVEL](i){return Fc(i)},[Z.MEDIA_CURRENT_TIME](i){return Nc(i)},[Z.MEDIA_DURATION](i){return Bc(i)},[Z.MEDIA_SEEKABLE](i){var e;return(e=Hc(i))==null?void 0:e.join(":")},[Z.MEDIA_PLAYBACK_RATE](i){return jc(i)},[Z.MEDIA_STREAM_TYPE](i){return Eu(i)},[Z.MEDIA_TARGET_LIVE_WINDOW](i){return fm(i)},[Z.MEDIA_TIME_IS_LIVE](i){const e=i.media;if(!e)return!1;if(typeof e.liveEdgeStart=="number")return Number.isNaN(e.liveEdgeStart)?!1:e.currentTime>=e.liveEdgeStart;if(!(Eu(i)==="live"))return!1;const h=e.seekable;if(!h)return!0;if(!h.length)return!1;const m=i.hasAttribute("liveedgeoffset")?Number(i.getAttribute("liveedgeoffset")):10,T=h.end(h.length-1)-m;return e.currentTime>=T}},Mc=i=>i.media?i.media.paused:!0,Pc=i=>!!(i.media&&i.media.muted),Uc=i=>{const e=i.media;return e?e.volume:1},Fc=i=>{let e="high";if(!i.media)return e;const{muted:a,volume:h}=i.media;return h===0||a?e="off":h<.5?e="low":h<.75&&(e="medium"),e},Nc=i=>{const e=i.media;return e?e.currentTime:0},Bc=i=>{const e=i==null?void 0:i.media;return Number.isFinite(e==null?void 0:e.duration)?e.duration:NaN},Hc=i=>{var e;const a=i==null?void 0:i.media;if(!((e=a==null?void 0:a.seekable)!=null&&e.length))return;const h=a.seekable.start(0),m=a.seekable.end(a.seekable.length-1);if(!(!h&&!m))return[Number(h.toFixed(3)),Number(m.toFixed(3))]},jc=i=>{const e=i.media;return e?e.playbackRate:1},ca=i=>_a(i.media,{kind:ba.SUBTITLES}),ns=i=>_a(i.media,{kind:ba.CAPTIONS}),yu=i=>_a(i.media,{kind:ba.SUBTITLES,mode:bn.SHOWING}),Yo=i=>_a(i.media,{kind:ba.CAPTIONS,mode:bn.SHOWING}),Eu=i=>{const{media:e}=i;if(!e)return;if(e.streamType){if(e.streamType==="unknown"&&i.hasAttribute("default-stream-type")){const h=i.getAttribute("default-stream-type");if(mu.includes(h))return h}return e.streamType}const a=e.duration;if(a===1/0)return bs.LIVE;if(Number.isFinite(a))return bs.ON_DEMAND;{const h=i.getAttribute("default-stream-type");if(mu.includes(h))return h}},fm=i=>{var e;return(e=i==null?void 0:i.media)==null?void 0:e.targetLiveWindow},pm=Object.values(Z),Gc=i=>{var e,a,h,m;let{observedAttributes:T}=i.constructor;!T&&((e=i.nodeName)!=null&&e.includes("-"))&&(Ge.customElements.upgrade(i),{observedAttributes:T}=i.constructor);const k=(m=(h=(a=i==null?void 0:i.getAttribute)==null?void 0:a.call(i,Qt.MEDIA_CHROME_ATTRIBUTES))==null?void 0:h.split)==null?void 0:m.call(h,/\s+/);return Array.isArray(T||k)?(T||k).filter(A=>pm.includes(A)):[]},zo=i=>!!Gc(i).length,vm=async(i,e,a)=>(i.isConnected||await Vc(0),a==null?i.removeAttribute(e):typeof a=="boolean"?a?i.setAttribute(e,""):i.removeAttribute(e):Number.isNaN(a)?i.removeAttribute(e):i.setAttribute(e,a)),mm=i=>{var e;return!!((e=i.closest)!=null&&e.call(i,'*[slot="media"]'))},ia=(i,e)=>{if(mm(i))return;const a=(m,T)=>{var k,A;zo(m)&&T(m);const{children:w=[]}=m??{},U=(A=(k=m==null?void 0:m.shadowRoot)==null?void 0:k.children)!=null?A:[];[...w,...U].forEach(P=>ia(P,T))},h=i==null?void 0:i.nodeName.toLowerCase();if(h.includes("-")&&!zo(i)){Ge.customElements.whenDefined(h).then(()=>{a(i,e)});return}a(i,e)},nn=(i,e,a)=>{i.forEach(h=>{Gc(h).includes(e)&&vm(h,e,a)})},gm=(i,e,a)=>{ia(i,e);const h=w=>{var U;const x=(U=w==null?void 0:w.composedPath()[0])!=null?U:w.target;e(x)},m=w=>{var U;const x=(U=w==null?void 0:w.composedPath()[0])!=null?U:w.target;a(x)};i.addEventListener(At.REGISTER_MEDIA_STATE_RECEIVER,h),i.addEventListener(At.UNREGISTER_MEDIA_STATE_RECEIVER,m);const T=w=>{w.forEach(U=>{const{addedNodes:x=[],removedNodes:P=[],type:g,target:I,attributeName:O}=U;g==="childList"?(Array.prototype.forEach.call(x,X=>ia(X,e)),Array.prototype.forEach.call(P,X=>ia(X,a))):g==="attributes"&&O===Qt.MEDIA_CHROME_ATTRIBUTES&&(zo(I)?e(I):a(I))})},k=new MutationObserver(T);return k.observe(i,{childList:!0,attributes:!0,subtree:!0}),()=>{ia(i,a),k.disconnect(),i.removeEventListener(At.REGISTER_MEDIA_STATE_RECEIVER,h),i.removeEventListener(At.UNREGISTER_MEDIA_STATE_RECEIVER,m)}};let Va;const El=()=>{var i,e;return Va||(Va=(e=(i=Dt)==null?void 0:i.createElement)==null?void 0:e.call(i,"video"),Va)},ym=async(i=El())=>{if(!i)return!1;const e=i.volume;return i.volume=e/2+.1,await Vc(0),i.volume!==e},Vc=i=>new Promise(e=>setTimeout(e,i)),Em=(i=El())=>typeof(i==null?void 0:i.requestPictureInPicture)=="function",bm=Em();let ha;const _m=ym().then(i=>(ha=i,ha)),Tm=!!Ge.WebKitPlaybackTargetAvailabilityEvent,Sm=!!Ge.chrome,Am=(i=El())=>{let e=Dt[_r.enabled];return!e&&i&&(e="webkitSupportsFullscreen"in i),e},bu=Am(),wm=Object.freeze({length:0,start(i){const e=i>>>0;if(e>=this.length)throw new DOMException(`Failed to execute 'start' on 'TimeRanges': The index provided (${e}) is greater than or equal to the maximum bound (${this.length}).`);return 0},end(i){const e=i>>>0;if(e>=this.length)throw new DOMException(`Failed to execute 'end' on 'TimeRanges': The index provided (${e}) is greater than or equal to the maximum bound (${this.length}).`);return 0}});function km(i=wm){return Array.from(i).map((e,a)=>[Number(i.start(a).toFixed(3)),Number(i.end(a).toFixed(3))].join(":")).join(" ")}Ge.customElements.get("media-controller")||Ge.customElements.define("media-controller",Oc);var Kc=Oc,qc=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},wi=(i,e,a)=>(qc(i,e,"read from private field"),a?a.call(i):e.get(i)),Ka=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Jn=(i,e,a,h)=>(qc(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),as,ci,ss,os;const Wc=Dt.createElement("template"),_u=`
  height: var(--thumb-height);
  width: var(--media-range-thumb-width, 10px);
  border: var(--media-range-thumb-border, none);
  border-radius: var(--media-range-thumb-border-radius, 10px);
  background: var(--media-range-thumb-background, #fff);
  box-shadow: var(--media-range-thumb-box-shadow, 1px 1px 1px transparent);
  cursor: pointer;
  transition: var(--media-range-thumb-transition, none);
  transform: var(--media-range-thumb-transform, none);
  opacity: var(--media-range-thumb-opacity, 1);
`,So=`
  min-width: 40px;
  height: var(--track-height);
  border: var(--media-range-track-border, none);
  outline: var(--media-range-track-outline);
  outline-offset: var(--media-range-track-outline-offset);
  border-radius: var(--media-range-track-border-radius, 0);
  background: var(--media-range-track-progress-internal, var(--media-range-track-background, #eee));
  box-shadow: var(--media-range-track-box-shadow, none);
  transition: var(--media-range-track-transition, none);
  transform: translate(var(--media-range-track-translate-x, 0), var(--media-range-track-translate-y, 0));
  cursor: pointer;
`;Wc.innerHTML=`
  <style>
    :host {
      --thumb-height: var(--media-range-thumb-height, 10px);
      --track-height: var(--media-range-track-height, 4px);
      --_focus-box-shadow: var(--media-focus-box-shadow, inset 0 0 0 2px rgba(27, 127, 204, 0.9));
      --_media-range-padding: var(--media-range-padding, var(--media-control-padding, 10px));

      vertical-align: middle;
      box-sizing: border-box;
      display: inline-block;
      position: relative;
      background: var(--media-control-background, rgba(20,20,30, 0.7));
      transition: background 0.15s linear;
      width: 100px;
      height: calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding));
      padding-left: var(--media-range-padding-left, var(--_media-range-padding));
      padding-right: var(--media-range-padding-right, var(--_media-range-padding));
      pointer-events: auto;
      
      font-size: 0;
      box-shadow: var(--_focus-visible-box-shadow, none);
    }

    
    input[type=range]:focus {
      outline: 0;
    }
    input[type=range]:focus::-webkit-slider-runnable-track {
      outline: 0;
    }

    :host(:hover) {
      background: var(--media-control-hover-background, rgba(50,50,60, 0.7));
    }

    #container {
      position: relative;
      height: 100%;
    }

    input[type=range] {
      
      -webkit-appearance: none; 
      background: transparent; 

      
      min-height: 100%;
      width: var(--media-range-track-width, 100%); 

      box-sizing: border-box;
      padding: 0;
      margin: 0;
    }

    
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      ${_u}
      
      margin-top: calc(calc(0px - var(--thumb-height) + var(--track-height)) / 2);
    }

    
    input[type=range]::-moz-range-thumb {
      ${_u}
      translate: var(--media-range-track-translate-x, 0) var(--media-range-track-translate-y, 0);
    }

    input[type=range]::-webkit-slider-runnable-track { ${So} }
    input[type=range]::-moz-range-track { ${So} }
    input[type=range]::-ms-track {
      
      width: 100%;
      cursor: pointer;
      
      background: transparent;
      border-color: transparent;
      color: transparent;

      ${So}
    }

    #background,
    #pointer {
      min-width: 40px;
      width: var(--media-range-track-width, 100%);
      height: var(--track-height);
      border-radius: var(--media-range-track-border-radius, 0);
      position: absolute;
      top: 50%;
      transform: translate(var(--media-range-track-translate-x, 0px), calc(var(--media-range-track-translate-y, 0px) - 50%));
      background: var(--media-range-track-background, #333);
    }

    #pointer {
      min-width: auto;
      background: var(--media-range-track-pointer-background);
      border-right: var(--media-range-track-pointer-border-right);
      transition: visibility .25s, opacity .25s;
      visibility: hidden;
      opacity: 0;
    }

    :host(:hover) #pointer {
      transition: visibility .5s, opacity .5s;
      visibility: visible;
      opacity: 1;
    }

    #hoverzone {
      
      z-index: 1;
      display: var(--media-time-range-hover-display, none);
      position: absolute;
      width: 100%;
      bottom: var(--media-time-range-hover-bottom, -5px);
      height: var(--media-time-range-hover-height, max(calc(100% + 5px), 20px));
    }

    #range {
      z-index: 2;
      position: relative;
      height: var(--media-range-track-height, 4px);
    }

    input[type=range]:disabled::-webkit-slider-thumb {
      background-color: #777;
    }

    input[type=range]:disabled::-webkit-slider-runnable-track {
      background-color: #777;
    }
  </style>
  <div id="container">
    <div id="background"></div>
    <div id="pointer"></div>
    <div id="hoverzone"></div>
    <input id="range" type="range" min="0" max="1000" step="any" value="0">
  </div>
`;class $c extends Ge.HTMLElement{constructor(){super(),Ka(this,as,void 0),Ka(this,ci,void 0),Ka(this,ss,()=>{if(this.range.matches(":focus-visible")){const{style:e}=Hi(this.shadowRoot,":host");e.setProperty("--_focus-visible-box-shadow","var(--_focus-box-shadow)")}}),Ka(this,os,()=>{const{style:e}=Hi(this.shadowRoot,":host");e.removeProperty("--_focus-visible-box-shadow")}),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Wc.content.cloneNode(!0)),this.container=this.shadowRoot.querySelector("#container"),this.range=this.shadowRoot.querySelector("#range"),this.range.addEventListener("input",this.updateBar.bind(this)),Jn(this,as,parseInt(getComputedStyle(this).getPropertyValue("--media-range-thumb-width")||"10",10))}static get observedAttributes(){return["disabled","aria-disabled",Qt.MEDIA_CONTROLLER]}attributeChangedCallback(e,a,h){var m,T,k,A,w;e===Qt.MEDIA_CONTROLLER?(a&&((T=(m=wi(this,ci))==null?void 0:m.unassociateElement)==null||T.call(m,this),Jn(this,ci,null)),h&&(Jn(this,ci,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=wi(this,ci))==null?void 0:A.associateElement)==null||w.call(A,this))):(e==="disabled"||e==="aria-disabled"&&a!==h)&&(h==null?this.range.removeAttribute(e):this.range.setAttribute(e,h))}connectedCallback(){var e,a,h;const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Jn(this,ci,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=wi(this,ci))==null?void 0:a.associateElement)==null||h.call(a,this)),this.updateBar(),this.shadowRoot.addEventListener("focusin",wi(this,ss)),this.shadowRoot.addEventListener("focusout",wi(this,os))}disconnectedCallback(){var e,a;(a=(e=wi(this,ci))==null?void 0:e.unassociateElement)==null||a.call(e,this),Jn(this,ci,null),this.shadowRoot.removeEventListener("focusin",wi(this,ss)),this.shadowRoot.removeEventListener("focusout",wi(this,os))}updatePointerBar(e){const a=this.range.getBoundingClientRect();let h=(e.clientX-a.left)/a.width;h=Math.max(0,Math.min(1,h));const{style:m}=Hi(this.shadowRoot,"#pointer");m.setProperty("width",`${h*a.width}px`)}updateBar(){const e=this.getBarColors();let a="linear-gradient(to right, ",h=0;e.forEach(T=>{T[1]<h||(a=a+`${T[0]} ${h}%, ${T[0]} ${T[1]}%,`,h=T[1])}),a=a.slice(0,a.length-1)+")";const{style:m}=Hi(this.shadowRoot,"#range");m.setProperty("--media-range-track-progress-internal",a)}getBarColors(){const e=this.range,a=e.value-e.min,h=e.max-e.min,m=a/h*100;let T=0;return e.value>e.min&&e.value<e.max&&(T=wi(this,as)*(.5-m/100)/e.offsetWidth*100),[["var(--media-range-bar-color, #fff)",m+T],["var(--media-range-track-color, transparent)",100]]}get keysUsed(){return["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]}}as=new WeakMap;ci=new WeakMap;ss=new WeakMap;os=new WeakMap;Ge.customElements.get("media-chrome-range")||Ge.customElements.define("media-chrome-range",$c);var Yc=$c,zc=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},qa=(i,e,a)=>(zc(i,e,"read from private field"),a?a.call(i):e.get(i)),Im=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Wa=(i,e,a,h)=>(zc(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),hi;const Xc=Dt.createElement("template");Xc.innerHTML=`
  <style>
    :host {
      
      box-sizing: border-box;
      display: inline-flex;
      color: var(--media-icon-color, #eee);
      --media-loading-icon-width: 44px;
    }

    media-time-range,
    ::slotted(media-time-range),
    ::slotted(media-progress-range),
    ::slotted(media-clip-selector) {
      flex-grow: 1;
    }
  </style>

  <slot></slot>
`;let Dm=class extends Ge.HTMLElement{constructor(){super(),Im(this,hi,void 0),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Xc.content.cloneNode(!0))}static get observedAttributes(){return[Qt.MEDIA_CONTROLLER]}attributeChangedCallback(e,a,h){var m,T,k,A,w;e===Qt.MEDIA_CONTROLLER&&(a&&((T=(m=qa(this,hi))==null?void 0:m.unassociateElement)==null||T.call(m,this),Wa(this,hi,null)),h&&(Wa(this,hi,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=qa(this,hi))==null?void 0:A.associateElement)==null||w.call(A,this)))}connectedCallback(){var e,a,h;const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Wa(this,hi,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=qa(this,hi))==null?void 0:a.associateElement)==null||h.call(a,this))}disconnectedCallback(){var e,a;(a=(e=qa(this,hi))==null?void 0:e.unassociateElement)==null||a.call(e,this),Wa(this,hi,null)}};hi=new WeakMap;Ge.customElements.get("media-control-bar")||Ge.customElements.define("media-control-bar",Dm);var Qc=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},$a=(i,e,a)=>(Qc(i,e,"read from private field"),a?a.call(i):e.get(i)),Lm=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Ya=(i,e,a,h)=>(Qc(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),fi;const Zc=Dt.createElement("template");Zc.innerHTML=`
  <style>
    :host {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      vertical-align: middle;
      box-sizing: border-box;
      background: var(--media-control-background, rgba(20,20,30, 0.7));
  
      padding: var(--media-control-padding, 10px);

      font-size: 14px;
      line-height: var(--media-text-content-height, var(--media-control-height, 24px));
      font-family: Arial, sans-serif;
      text-align: center;
      color: #ffffff;
      pointer-events: auto;
    }

    
    :host(:focus-visible) {
      box-shadow: inset 0 0 0 2px rgba(27, 127, 204, 0.9);
      outline: 0;
    }

    
    :host(:where(:focus)) {
      box-shadow: none;
      outline: 0;
    }
  </style>
  <span id="container">
  <slot></slot>
  </span>
`;class Jc extends Ge.HTMLElement{constructor(){super(),Lm(this,fi,void 0),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Zc.content.cloneNode(!0)),this.container=this.shadowRoot.querySelector("#container")}static get observedAttributes(){return[Qt.MEDIA_CONTROLLER]}attributeChangedCallback(e,a,h){var m,T,k,A,w;e===Qt.MEDIA_CONTROLLER&&(a&&((T=(m=$a(this,fi))==null?void 0:m.unassociateElement)==null||T.call(m,this),Ya(this,fi,null)),h&&(Ya(this,fi,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=$a(this,fi))==null?void 0:A.associateElement)==null||w.call(A,this)))}connectedCallback(){var e,a,h;const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Ya(this,fi,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=$a(this,fi))==null?void 0:a.associateElement)==null||h.call(a,this))}disconnectedCallback(){var e,a;(a=(e=$a(this,fi))==null?void 0:e.unassociateElement)==null||a.call(e,this),Ya(this,fi,null)}}fi=new WeakMap;Ge.customElements.get("media-text-display")||Ge.customElements.define("media-text-display",Jc);var Cs=Jc;class Rm extends Cs{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_CURRENT_TIME]}constructor(){super(),this.container.innerHTML=Vi(0)}attributeChangedCallback(e,a,h){e===Z.MEDIA_CURRENT_TIME&&(this.container.innerHTML=Vi(h)),super.attributeChangedCallback(e,a,h)}}Ge.customElements.get("media-current-time-display")||Ge.customElements.define("media-current-time-display",Rm);let Cm=class extends Cs{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_DURATION]}constructor(){super(),this.container.innerHTML=Vi(0)}attributeChangedCallback(e,a,h){e===Z.MEDIA_DURATION&&(this.container.innerHTML=Vi(h)),super.attributeChangedCallback(e,a,h)}};Ge.customElements.get("media-duration-display")||Ge.customElements.define("media-duration-display",Cm);const xm="&nbsp;/&nbsp;",Tu=(i,{timesSep:e=xm}={})=>{var a,h,m;const T=i.getAttribute("remaining")!=null,k=i.getAttribute("show-duration")!=null,A=(a=i.mediaCurrentTime)!=null?a:0,w=(m=(h=i.mediaDuration)!=null?h:i.mediaSeekableEnd)!=null?m:0,U=Vi(T?0-(w-A):A);return k?`${U}${e}${Vi(w)}`:U},Om="video not loaded, unknown time.",Mm=i=>{const e=i.mediaCurrentTime,a=i.mediaDuration||i.mediaSeekableEnd;if(e==null||a==null){i.setAttribute("aria-valuetext",Om);return}const h=i.hasAttribute("remaining"),m=i.hasAttribute("show-duration"),T=da(h?0-(a-e):e);if(!m){i.setAttribute("aria-valuetext",T);return}const k=da(a),A=`${T} of ${k}`;i.setAttribute("aria-valuetext",A)};let Pm=class extends Cs{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_CURRENT_TIME,Z.MEDIA_DURATION,Z.MEDIA_SEEKABLE,"remaining","show-duration","disabled"]}constructor(){super(),this.container.innerHTML=Tu(this)}connectedCallback(){this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","progressbar"),this.setAttribute("aria-label",Wi.PLAYBACK_TIME()),super.connectedCallback()}disconnectedCallback(){this.disable(),super.disconnectedCallback()}attributeChangedCallback(e,a,h){if([Z.MEDIA_CURRENT_TIME,Z.MEDIA_DURATION,Z.MEDIA_SEEKABLE,"remaining","show-duration"].includes(e)){const m=Tu(this);Mm(this),this.container.innerHTML=m}else e==="disabled"&&h!==a&&(h==null?this.enable():this.disable());super.attributeChangedCallback(e,a,h)}enable(){this.setAttribute("tabindex",0)}disable(){this.removeAttribute("tabindex")}get mediaDuration(){const e=this.getAttribute(Z.MEDIA_DURATION);return e!=null?+e:void 0}get mediaCurrentTime(){const e=this.getAttribute(Z.MEDIA_CURRENT_TIME);return e!=null?+e:void 0}get mediaSeekable(){const e=this.getAttribute(Z.MEDIA_SEEKABLE);if(e)return e.split(":").map(a=>+a)}get mediaSeekableEnd(){var e;const[,a]=(e=this.mediaSeekable)!=null?e:[];return a}get mediaSeekableStart(){var e;const[a]=(e=this.mediaSeekable)!=null?e:[];return a}};Ge.customElements.get("media-time-display")||Ge.customElements.define("media-time-display",Pm);const Um=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>
</svg>`,Fm=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>
</svg>`,eh=Dt.createElement("template");eh.innerHTML=`
  <style>
  :host([aria-checked="true"]) slot:not([name=on]) > *,
  :host([aria-checked="true"]) ::slotted(:not([slot=on])) {
    display: none !important;
  }

  
  :host(:not([aria-checked="true"])) slot:not([name=off]) > *, 
  :host(:not([aria-checked="true"])) ::slotted(:not([slot=off])) {
    display: none !important;
  }
  </style>

  <slot name="on">${Um}</slot>
  <slot name="off">${Fm}</slot>
`;const Su=i=>{i.setAttribute("aria-checked",Rc(i))};class Nm extends ai{static get observedAttributes(){return[...super.observedAttributes,"no-subtitles-fallback","default-showing",Z.MEDIA_CAPTIONS_LIST,Z.MEDIA_CAPTIONS_SHOWING,Z.MEDIA_SUBTITLES_LIST,Z.MEDIA_SUBTITLES_SHOWING]}constructor(e={}){super({slotTemplate:eh,...e}),this._captionsReady=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","switch"),this.setAttribute("aria-label",Wi.CLOSED_CAPTIONS()),Su(this)}attributeChangedCallback(e,a,h){if([Z.MEDIA_CAPTIONS_SHOWING,Z.MEDIA_SUBTITLES_SHOWING].includes(e)&&Su(this),this.hasAttribute("default-showing")&&this.getAttribute("aria-checked")!=="true"){const m=!this.hasAttribute("no-subtitles-fallback");if((m?[Z.MEDIA_CAPTIONS_LIST,Z.MEDIA_SUBTITLES_LIST]:[Z.MEDIA_CAPTIONS_LIST]).includes(e)){const k=!!this.getAttribute(Z.MEDIA_CAPTIONS_LIST)||!!(m&&this.getAttribute(Z.MEDIA_SUBTITLES_LIST));this._captionsReady!==k&&(this._captionsReady=k,this._captionsReady&&this.handleClick())}}super.attributeChangedCallback(e,a,h)}handleClick(){Cc(this)}}Ge.customElements.get("media-captions-button")||Ge.customElements.define("media-captions-button",Nm);const Xo="30",Bm=`<svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(8.9 19.87)">${Xo}</text><path d="M10 6V3l5.61 4L10 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 10 6Z"/></svg>`,th=Dt.createElement("template");th.innerHTML=`  
  <slot name="forward">${Bm}</slot>
`;const Hm=0,Au=i=>{const e=Math.abs(+i.getAttribute("seek-offset")),a=Wr.SEEK_FORWARD_N_SECS({seekOffset:e});i.setAttribute("aria-label",a)},wu=i=>{const e=Tc(i,"forward"),a=i.getAttribute("seek-offset");_c(e,a)};class jm extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_CURRENT_TIME,"seek-offset"]}constructor(e={}){super({slotTemplate:th,...e})}connectedCallback(){this.hasAttribute("seek-offset")||this.setAttribute("seek-offset",Xo),Au(this),wu(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e==="seek-offset"&&(h==null&&this.setAttribute("seek-offset",Xo),wu(this),Au(this)),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_CURRENT_TIME),a=+this.getAttribute("seek-offset"),m=(e&&!Number.isNaN(+e)?+e:Hm)+a,T=new Ge.CustomEvent(At.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:m});this.dispatchEvent(T)}}Ge.customElements.get("media-seek-forward-button")||Ge.customElements.define("media-seek-forward-button",jm);const Gm=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M16 3v2.5h3.5V9H22V3h-6ZM4 9h2.5V5.5H10V3H4v6Zm15.5 9.5H16V21h6v-6h-2.5v3.5ZM6.5 15H4v6h6v-2.5H6.5V15Z"/>
</svg>`,Vm=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M18.5 6.5V3H16v6h6V6.5h-3.5ZM16 21h2.5v-3.5H22V15h-6v6ZM4 17.5h3.5V21H10v-6H4v2.5Zm3.5-11H4V9h6V3H7.5v3.5Z"/>
</svg>`,rh=Dt.createElement("template");rh.innerHTML=`
  <style>
  :host([${Z.MEDIA_IS_FULLSCREEN}]) slot:not([name=exit]) > *,
  :host([${Z.MEDIA_IS_FULLSCREEN}]) ::slotted(:not([slot=exit])) {
    display: none !important;
  }

  
  :host(:not([${Z.MEDIA_IS_FULLSCREEN}])) slot:not([name=enter]) > *,
  :host(:not([${Z.MEDIA_IS_FULLSCREEN}])) ::slotted(:not([slot=enter])) {
    display: none !important;
  }
  </style>

  <slot name="enter">${Gm}</slot>
  <slot name="exit">${Vm}</slot>
`;const ku=i=>{const a=i.getAttribute(Z.MEDIA_IS_FULLSCREEN)!=null?Wr.EXIT_FULLSCREEN():Wr.ENTER_FULLSCREEN();i.setAttribute("aria-label",a)};let Km=class extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_IS_FULLSCREEN,Z.MEDIA_FULLSCREEN_UNAVAILABLE]}constructor(e={}){super({slotTemplate:rh,...e})}connectedCallback(){ku(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e===Z.MEDIA_IS_FULLSCREEN&&ku(this),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_IS_FULLSCREEN)!=null?At.MEDIA_EXIT_FULLSCREEN_REQUEST:At.MEDIA_ENTER_FULLSCREEN_REQUEST;this.dispatchEvent(new Ge.CustomEvent(e,{composed:!0,bubbles:!0}))}};Ge.customElements.get("media-fullscreen-button")||Ge.customElements.define("media-fullscreen-button",Km);const{MEDIA_TIME_IS_LIVE:fa,MEDIA_PAUSED:wn}=Z,{MEDIA_SEEK_TO_LIVE_REQUEST:qm,MEDIA_PLAY_REQUEST:Wm}=At,$m='<svg viewBox="0 0 6 12"><circle cx="3" cy="6" r="2"></circle></svg>',ih=Dt.createElement("template");ih.innerHTML=`
  <style>

  slot[name=indicator] > *,
  :host ::slotted([slot=indicator]) {
    
    min-width: auto;
    fill: var(--media-live-button-icon-color, rgb(140, 140, 140));
    color: var(--media-live-button-icon-color, rgb(140, 140, 140));
  }

  :host([${fa}]:not([${wn}])) slot[name=indicator] > *,
  :host([${fa}]:not([${wn}])) ::slotted([slot=indicator]) {
    fill: var(--media-live-indicator-color, rgb(255, 0, 0));
    color: var(--media-live-indicator-color, rgb(255, 0, 0));
  }

  :host([${fa}]:not([${wn}])) {
    cursor: not-allowed;
  }

  </style>

  <slot name="indicator">${$m}</slot>
  
  <slot name="spacer">&nbsp;</slot><slot name="text">LIVE</slot>
`;class Ym extends ai{static get observedAttributes(){return[...super.observedAttributes,wn,fa]}constructor(e={}){super({slotTemplate:ih,...e}),this.setAttribute("aria-label","Seek to Live")}attributeChangedCallback(e,a,h){super.attributeChangedCallback(e,a,h)}handleClick(){!this.hasAttribute(wn)&&this.hasAttribute(fa)||(this.dispatchEvent(new Ge.CustomEvent(qm,{composed:!0,bubbles:!0})),this.hasAttribute(wn)&&this.dispatchEvent(new Ge.CustomEvent(Wm,{composed:!0,bubbles:!0})))}}Ge.customElements.get("media-live-button")||Ge.customElements.define("media-live-button",Ym);const zm=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M16.5 12A4.5 4.5 0 0 0 14 8v2.18l2.45 2.45a4.22 4.22 0 0 0 .05-.63Zm2.5 0a6.84 6.84 0 0 1-.54 2.64L20 16.15A8.8 8.8 0 0 0 21 12a9 9 0 0 0-7-8.77v2.06A7 7 0 0 1 19 12ZM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25A6.92 6.92 0 0 1 14 18.7v2.06A9 9 0 0 0 17.69 19l2 2.05L21 19.73l-9-9L4.27 3ZM12 4 9.91 6.09 12 8.18V4Z"/>
</svg>`,Iu=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4Z"/>
</svg>`,Xm=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4ZM14 3.23v2.06a7 7 0 0 1 0 13.42v2.06a9 9 0 0 0 0-17.54Z"/>
</svg>`,nh=Dt.createElement("template");nh.innerHTML=`
  <style>
  
  :host(:not([${Z.MEDIA_VOLUME_LEVEL}])) slot:not([name=high]) > *, 
  :host(:not([${Z.MEDIA_VOLUME_LEVEL}])) ::slotted(:not([slot=high])),
  :host([${Z.MEDIA_VOLUME_LEVEL}=high]) slot:not([name=high]) > *, 
  :host([${Z.MEDIA_VOLUME_LEVEL}=high]) ::slotted(:not([slot=high])) {
    display: none !important;
  }

  :host([${Z.MEDIA_VOLUME_LEVEL}=off]) slot:not([name=off]) > *, 
  :host([${Z.MEDIA_VOLUME_LEVEL}=off]) ::slotted(:not([slot=off])) {
    display: none !important;
  }

  :host([${Z.MEDIA_VOLUME_LEVEL}=low]) slot:not([name=low]) > *, 
  :host([${Z.MEDIA_VOLUME_LEVEL}=low]) ::slotted(:not([slot=low])) {
    display: none !important;
  }

  :host([${Z.MEDIA_VOLUME_LEVEL}=medium]) slot:not([name=medium]) > *, 
  :host([${Z.MEDIA_VOLUME_LEVEL}=medium]) ::slotted(:not([slot=medium])) {
    display: none !important;
  }
  </style>

  <slot name="off">${zm}</slot>
  <slot name="low">${Iu}</slot>
  <slot name="medium">${Iu}</slot>
  <slot name="high">${Xm}</slot>
`;const Du=i=>{const a=i.getAttribute(Z.MEDIA_VOLUME_LEVEL)==="off"?Wr.UNMUTE():Wr.MUTE();i.setAttribute("aria-label",a)};let Qm=class extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_VOLUME_LEVEL]}constructor(e={}){super({slotTemplate:nh,...e})}connectedCallback(){Du(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e===Z.MEDIA_VOLUME_LEVEL&&Du(this),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_VOLUME_LEVEL)==="off"?At.MEDIA_UNMUTE_REQUEST:At.MEDIA_MUTE_REQUEST;this.dispatchEvent(new Ge.CustomEvent(e,{composed:!0,bubbles:!0}))}};Ge.customElements.get("media-mute-button")||Ge.customElements.define("media-mute-button",Qm);const Lu=`<svg aria-hidden="true" viewBox="0 0 28 24">
  <path d="M24 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Zm-1 16H5V5h18v14Zm-3-8h-7v5h7v-5Z"/>
</svg>`,ah=Dt.createElement("template");ah.innerHTML=`
  <style>
  :host([${Z.MEDIA_IS_PIP}]) slot:not([name=exit]) > *, 
  :host([${Z.MEDIA_IS_PIP}]) ::slotted(:not([slot=exit])) {
    display: none !important;
  }

  
  :host(:not([${Z.MEDIA_IS_PIP}])) slot:not([name=enter]) > *, 
  :host(:not([${Z.MEDIA_IS_PIP}])) ::slotted(:not([slot=enter])) {
    display: none !important;
  }
  </style>

  <slot name="enter">${Lu}</slot>
  <slot name="exit">${Lu}</slot>
`;const Ru=i=>{const a=i.getAttribute(Z.MEDIA_IS_PIP)!=null?Wr.EXIT_PIP():Wr.ENTER_PIP();i.setAttribute("aria-label",a)};class Zm extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_IS_PIP,Z.MEDIA_PIP_UNAVAILABLE]}constructor(e={}){super({slotTemplate:ah,...e})}connectedCallback(){Ru(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e===Z.MEDIA_IS_PIP&&Ru(this),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_IS_PIP)!=null?At.MEDIA_EXIT_PIP_REQUEST:At.MEDIA_ENTER_PIP_REQUEST;this.dispatchEvent(new Ge.CustomEvent(e,{composed:!0,bubbles:!0}))}}Ge.customElements.get("media-pip-button")||Ge.customElements.define("media-pip-button",Zm);const Jm=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="m6 21 15-9L6 3v18Z"/>
</svg>`,eg=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M6 20h4V4H6v16Zm8-16v16h4V4h-4Z"/>
</svg>`,sh=Dt.createElement("template");sh.innerHTML=`
  <style>
  :host([${Z.MEDIA_PAUSED}]) slot[name=pause] > *, 
  :host([${Z.MEDIA_PAUSED}]) ::slotted([slot=pause]) {
    display: none !important;
  }

  :host(:not([${Z.MEDIA_PAUSED}])) slot[name=play] > *, 
  :host(:not([${Z.MEDIA_PAUSED}])) ::slotted([slot=play]) {
    display: none !important;
  }
  </style>

  <slot name="play">${Jm}</slot>
  <slot name="pause">${eg}</slot>
`;const Cu=i=>{const a=i.getAttribute(Z.MEDIA_PAUSED)!=null?Wr.PLAY():Wr.PAUSE();i.setAttribute("aria-label",a)};let tg=class extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_PAUSED]}constructor(e={}){super({slotTemplate:sh,...e})}connectedCallback(){Cu(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e===Z.MEDIA_PAUSED&&Cu(this),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_PAUSED)!=null?At.MEDIA_PLAY_REQUEST:At.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Ge.CustomEvent(e,{composed:!0,bubbles:!0}))}};Ge.customElements.get("media-play-button")||Ge.customElements.define("media-play-button",tg);const xu=[1,1.25,1.5,1.75,2],za=1,oh=Dt.createElement("template");oh.innerHTML=`
  <span id="container"></span>
`;class rg extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_PLAYBACK_RATE,"rates"]}constructor(e={}){super({slotTemplate:oh,...e}),this._rates=xu,this.container=this.shadowRoot.querySelector("#container"),this.container.innerHTML=`${za}x`}attributeChangedCallback(e,a,h){if(e==="rates"){const m=(h??"").trim().split(/\s*,?\s+/).map(T=>Number(T)).filter(T=>!Number.isNaN(T)).sort((T,k)=>T-k);this._rates=m.length?m:xu;return}if(e===Z.MEDIA_PLAYBACK_RATE){const m=h?+h:Number.NaN,T=Number.isNaN(m)?za:m;this.container.innerHTML=`${T}x`,this.setAttribute("aria-label",Wi.PLAYBACK_RATE({playbackRate:T}));return}super.attributeChangedCallback(e,a,h)}handleClick(){var e,a;const h=+this.getAttribute(Z.MEDIA_PLAYBACK_RATE)||za,m=(a=(e=this._rates.find(k=>k>h))!=null?e:this._rates[0])!=null?a:za,T=new Ge.CustomEvent(At.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:m});this.dispatchEvent(T)}}Ge.customElements.get("media-playback-rate-button")||Ge.customElements.define("media-playback-rate-button",rg);const lh=Dt.createElement("template");lh.innerHTML=`
  <style>
    :host {
      pointer-events: none;
      display: inline-block;
      box-sizing: border-box;
    }

    img {
      max-width: 100%;
      max-height: 100%;
      min-width: 100%;
      min-height: 100%;
      background-repeat: no-repeat;
      background-position: var(--media-background-position, var(--media-object-position, center));
      background-size: var(--media-background-size, var(--media-object-fit, contain));
      object-fit: var(--media-object-fit, contain);
      object-position: var(--media-object-position, center);
    }
  </style>

  <img aria-hidden="true" id="image"/>
`;const ig=i=>{i.style.removeProperty("background-image")},ng=(i,e)=>{i.style["background-image"]=`url('${e}')`};let ag=class extends Ge.HTMLElement{static get observedAttributes(){return["placeholder-src","src"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(lh.content.cloneNode(!0)),this.image=this.shadowRoot.querySelector("#image")}attributeChangedCallback(e,a,h){e==="src"&&(h==null?this.image.removeAttribute("src"):this.image.setAttribute("src",h)),e==="placeholder-src"&&(h==null?ig(this.image):ng(this.image,h))}};Ge.customElements.get("media-poster-image")||Ge.customElements.define("media-poster-image",ag);var bl=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},br=(i,e,a)=>(bl(i,e,"read from private field"),a?a.call(i):e.get(i)),Or=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Pi=(i,e,a,h)=>(bl(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),ea=(i,e,a)=>(bl(i,e,"access private method"),a),na,ls,aa,_s,Ts,us,Qo,ds,_n,pa,Zo,Ss,xs,cs,Jo,el,uh;const sg="video not loaded, unknown time.",Ao=i=>{const e=i.range,a=da(+e.value),h=da(+e.max),m=a&&h?`${a} of ${h}`:sg;e.setAttribute("aria-valuetext",m)},dh=Dt.createElement("template");dh.innerHTML=`
  <style>
    :host {
      --media-preview-background-color: rgba(20,20,30, .5);
      --media-preview-background: var(--media-control-background,
        var(--media-preview-background-color));
      --media-preview-border-radius: 3px;
      --media-box-padding-left: 10px;
      --media-box-padding-right: 10px;
      color: #fff;
    }

    #preview-rail,
    #current-rail {
      
      width: 1%;
      position: absolute;
      left: 0;
      bottom: 100%;
      pointer-events: none;
    }

    [part~="box"] {
      
      position: absolute;
      bottom: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      transform: translateX(-50%);
    }

    [part~="preview-box"] {
      transition-property: var(--media-preview-transition-property, visibility, opacity);
      transition-duration: var(--media-preview-transition-duration-out, .25s);
      transition-delay: var(--media-preview-transition-delay-out, 0s);
      visibility: hidden;
      opacity: 0;
    }

    :host([${Z.MEDIA_PREVIEW_IMAGE}]:hover) [part~="preview-box"],
    :host([${Z.MEDIA_PREVIEW_TIME}]:hover) [part~="preview-box"] {
      transition-duration: var(--media-preview-transition-duration-in, .5s);
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
      opacity: 1;
    }

    media-preview-thumbnail,
    ::slotted(media-preview-thumbnail) {
      visibility: hidden;
      
      transition: visibility 0s .25s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-time-background, var(--media-preview-background));
      box-shadow: var(--media-preview-thumbnail-box-shadow, 0 0 4px rgba(0,0,0, .2));
      max-width: var(--media-preview-thumbnail-max-width, 180px);
      max-height: var(--media-preview-thumbnail-max-height, 160px);
      min-width: var(--media-preview-thumbnail-min-width, 120px);
      min-height: var(--media-preview-thumbnail-min-height, 80px);
      border: var(--media-preview-thumbnail-border);
      border-radius: var(--media-preview-thumbnail-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius) 0 0);
    }

    :host([${Z.MEDIA_PREVIEW_IMAGE}]:hover) media-preview-thumbnail,
    :host([${Z.MEDIA_PREVIEW_IMAGE}]:hover) ::slotted(media-preview-thumbnail) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
    }

    media-preview-time-display,
    ::slotted(media-preview-time-display) {
      color: unset;
      min-width: 0;
      
      transition: min-width 0s, border-radius 0s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-time-background, var(--media-preview-background));
      border-radius: var(--media-preview-time-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius)
        var(--media-preview-border-radius) var(--media-preview-border-radius));
      padding: var(--media-preview-time-padding, 1px 10px 0);
      margin: var(--media-preview-time-margin, 0 0 10px);
      text-shadow: var(--media-preview-time-text-shadow, 0 0 4px rgba(0,0,0, .75));
    }

    :host([${Z.MEDIA_PREVIEW_IMAGE}]) media-preview-time-display,
    :host([${Z.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-time-display) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      min-width: 100%;
      border-radius: var(--media-preview-time-border-radius,
        0 0 var(--media-preview-border-radius) var(--media-preview-border-radius));
    }

    :host([${Z.MEDIA_PREVIEW_TIME}]:hover) {
      --media-time-range-hover-display: block;
    }
  </style>
  <div id="preview-rail">
    <slot name="preview" part="box preview-box">
      <media-preview-thumbnail></media-preview-thumbnail>
      <media-preview-time-display></media-preview-time-display>
    </slot>
  </div>
  <div id="current-rail">
    <slot name="current" part="box current-box">
      
    </slot>
  </div>
`;let ch=class extends Yc{constructor(){super(),Or(this,us),Or(this,cs),Or(this,el),Or(this,na,void 0),Or(this,ls,void 0),Or(this,aa,void 0),Or(this,_s,void 0),Or(this,Ts,void 0),Or(this,ds,a=>{if([...br(this,na)].some(x=>a.composedPath().includes(x)))return;this.updatePointerBar(a);const h=+this.getAttribute(Z.MEDIA_DURATION);if(!h)return;const m=this.range.getBoundingClientRect();let T=(a.clientX-m.left)/m.width;T=Math.max(0,Math.min(1,T));const k=ea(this,us,Qo).call(this,br(this,ls),T),{style:A}=Hi(this.shadowRoot,"#preview-rail");A.transform=`translateX(${k})`;const w=T*h,U=new Ge.CustomEvent(At.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:w});this.dispatchEvent(U)}),Or(this,_n,!1),Or(this,pa,a=>{(!a.composedPath().includes(this)||[...br(this,na)].some(h=>a.composedPath().includes(h)))&&(Ge.removeEventListener("pointermove",br(this,pa)),Pi(this,_n,!1),br(this,Ss).call(this))}),Or(this,Zo,()=>{Ge.addEventListener("pointermove",br(this,ds),!1)}),Or(this,Ss,()=>{Ge.removeEventListener("pointermove",br(this,ds));const a=new Ge.CustomEvent(At.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:null});this.dispatchEvent(a)}),Or(this,xs,()=>{const a=this.getAttribute(Z.MEDIA_DURATION);!br(this,_n)&&a&&(Pi(this,_n,!0),br(this,Zo).call(this),Ge.addEventListener("pointermove",br(this,pa),!1))}),this.container.appendChild(dh.content.cloneNode(!0)),this.range.addEventListener("input",()=>{cancelAnimationFrame(this._refreshId);const h=this.range.value,m=new Ge.CustomEvent(At.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:h});this.dispatchEvent(m)}),this._refreshBar=()=>{const a=(performance.now()-this._updateTimestamp)/1e3;this.range.value=this.mediaCurrentTime+a*this.mediaPlaybackRate,this.updateBar(),this.updateCurrentBox(),this._refreshId=requestAnimationFrame(this._refreshBar)},Pi(this,na,this.shadowRoot.querySelectorAll('[part~="box"]')),Pi(this,ls,this.shadowRoot.querySelector('[part~="preview-box"]')),Pi(this,aa,this.shadowRoot.querySelector('[part~="current-box"]'));const e=getComputedStyle(this);Pi(this,_s,parseInt(e.getPropertyValue("--media-box-padding-left"))),Pi(this,Ts,parseInt(e.getPropertyValue("--media-box-padding-right"))),ea(this,cs,Jo).call(this)}static get observedAttributes(){return[...super.observedAttributes,"thumbnails","disabled",Z.MEDIA_PAUSED,Z.MEDIA_DURATION,Z.MEDIA_SEEKABLE,Z.MEDIA_CURRENT_TIME,Z.MEDIA_PREVIEW_IMAGE,Z.MEDIA_PREVIEW_TIME,Z.MEDIA_BUFFERED,Z.MEDIA_PLAYBACK_RATE,Z.MEDIA_LOADING]}connectedCallback(){this.range.setAttribute("aria-label",Wi.SEEK()),super.connectedCallback()}disconnectedCallback(){cancelAnimationFrame(this._refreshId),super.disconnectedCallback()}attributeChangedCallback(e,a,h){var m,T,k,A,w;(e===Z.MEDIA_CURRENT_TIME||e===Z.MEDIA_PAUSED||e===Z.MEDIA_LOADING)&&(this._updateTimestamp=performance.now(),this.range.value=this.mediaCurrentTime,Ao(this),this.updateBar(),this.updateCurrentBox(),cancelAnimationFrame(this._refreshId),!this.mediaPaused&&!this.mediaLoading&&(this._refreshId=requestAnimationFrame(this._refreshBar))),e===Z.MEDIA_DURATION&&(this.range.max=(T=(m=this.mediaSeekableEnd)!=null?m:this.mediaDuration)!=null?T:1e3,Ao(this),this.updateBar(),this.updateCurrentBox()),e===Z.MEDIA_SEEKABLE&&(this.range.min=(k=this.mediaSeekableStart)!=null?k:0,this.range.max=(w=(A=this.mediaSeekableEnd)!=null?A:this.mediaDuration)!=null?w:1e3,Ao(this),this.updateBar()),e===Z.MEDIA_BUFFERED&&this.updateBar(),e==="disabled"&&(h==null?ea(this,cs,Jo).call(this):ea(this,el,uh).call(this)),super.attributeChangedCallback(e,a,h)}get mediaPaused(){return this.hasAttribute(Z.MEDIA_PAUSED)}get mediaLoading(){return this.hasAttribute(Z.MEDIA_LOADING)}get mediaDuration(){const e=this.getAttribute(Z.MEDIA_DURATION);return e!=null?+e:void 0}get mediaCurrentTime(){const e=this.getAttribute(Z.MEDIA_CURRENT_TIME);return e!=null?+e:void 0}get mediaPlaybackRate(){const e=this.getAttribute(Z.MEDIA_PLAYBACK_RATE);return e!=null?+e:1}get mediaBuffered(){const e=this.getAttribute(Z.MEDIA_BUFFERED);return e?e.split(" ").map(a=>a.split(":").map(h=>+h)):[]}get mediaSeekable(){const e=this.getAttribute(Z.MEDIA_SEEKABLE);if(e)return e.split(":").map(a=>+a)}get mediaSeekableEnd(){var e;const[,a]=(e=this.mediaSeekable)!=null?e:[];return a}get mediaSeekableStart(){var e;const[a]=(e=this.mediaSeekable)!=null?e:[];return a}getBarColors(){var e;let a=super.getBarColors();const{range:h}=this,m=h.max-h.min,T=this.mediaBuffered;if(!T.length||!Number.isFinite(m)||m<=0)return a;const k=this.mediaCurrentTime,[,A=h.min]=(e=T.find(([x,P])=>x<=k&&k<=P))!=null?e:[],U=(A-h.min)/m*100;return a.splice(1,0,["var(--media-time-buffered-color, rgba(255,255,255, .4))",U]),a}updateCurrentBox(){if(!br(this,aa).assignedElements().length)return;const e=this.range.value/(this.range.max-this.range.min),a=ea(this,us,Qo).call(this,br(this,aa),e),{style:h}=Hi(this.shadowRoot,"#current-rail");h.transform=`translateX(${a})`}};na=new WeakMap;ls=new WeakMap;aa=new WeakMap;_s=new WeakMap;Ts=new WeakMap;us=new WeakSet;Qo=function(i,e){var a;let h=`${e*100*100}%`;const m=i.offsetWidth;if(!m)return h;const T=(a=this.getAttribute("bounds")?gl(this,`#${this.getAttribute("bounds")}`):this.parentElement)!=null?a:this,k=this.range.getBoundingClientRect(),A=T.getBoundingClientRect(),w=(br(this,_s)-(k.left-A.left-m/2))/k.width*100,U=(A.right-k.left-m/2-br(this,Ts))/k.width*100;return Number.isNaN(w)||(h=`max(${w*100}%, ${h})`),Number.isNaN(U)||(h=`min(${h}, ${U*100}%)`),h};ds=new WeakMap;_n=new WeakMap;pa=new WeakMap;Zo=new WeakMap;Ss=new WeakMap;xs=new WeakMap;cs=new WeakSet;Jo=function(){this.addEventListener("pointermove",br(this,xs),!1)};el=new WeakSet;uh=function(){Ge.removeEventListener("pointermove",br(this,pa)),this.removeEventListener("pointermove",br(this,xs)),Pi(this,_n,!1),br(this,Ss).call(this)};Ge.customElements.get("media-time-range")||Ge.customElements.define("media-time-range",ch);var og=ch;class lg extends og{constructor(){super(),console.warn("MediaChrome: <media-progress-range> is deprecated. Use <media-time-range> instead.")}}Ge.customElements.get("media-progress-range")||Ge.customElements.define("media-progress-range",lg);const tl="30",ug=`<svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(2.18 19.87)">${tl}</text><path d="M10 6V3L4.37 7 10 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 10 6Z"/></svg>`,hh=Dt.createElement("template");hh.innerHTML=`  
  <slot name="backward">${ug}</slot>
`;const dg=0,Ou=i=>{const e=Math.abs(+i.getAttribute("seek-offset")),a=Wr.SEEK_BACK_N_SECS({seekOffset:e});i.setAttribute("aria-label",a)},Mu=i=>{const e=Tc(i,"backward"),a=i.getAttribute("seek-offset");_c(e,a)};class cg extends ai{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_CURRENT_TIME]}constructor(e={}){super({slotTemplate:hh,...e})}connectedCallback(){this.hasAttribute("seek-offset")||this.setAttribute("seek-offset",tl),Ou(this),Mu(this),super.connectedCallback()}attributeChangedCallback(e,a,h){e==="seek-offset"&&(h==null&&this.setAttribute("seek-offset",tl),Mu(this),Ou(this)),super.attributeChangedCallback(e,a,h)}handleClick(){const e=this.getAttribute(Z.MEDIA_CURRENT_TIME),a=+this.getAttribute("seek-offset"),h=e&&!Number.isNaN(+e)?+e:dg,m=Math.max(h-a,0),T=new Ge.CustomEvent(At.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:m});this.dispatchEvent(T)}}Ge.customElements.get("media-seek-backward-button")||Ge.customElements.define("media-seek-backward-button",cg);class hg extends Cs{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_PREVIEW_TIME]}attributeChangedCallback(e,a,h){e===Z.MEDIA_PREVIEW_TIME&&h!=null&&(this.container.textContent=Vi(h)),super.attributeChangedCallback(e,a,h)}}Ge.customElements.get("media-preview-time-display")||Ge.customElements.define("media-preview-time-display",hg);var fh=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},Xa=(i,e,a)=>(fh(i,e,"read from private field"),a?a.call(i):e.get(i)),fg=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Qa=(i,e,a,h)=>(fh(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),pi;const ph=Dt.createElement("template");ph.innerHTML=`
  <style>
    :host {
      box-sizing: border-box;
      display: inline-block;
      overflow: hidden;
    }

    img {
      display: none;
      position: relative;
    }
  </style>
  <img crossorigin loading="eager" decoding="async" />
`;class pg extends Ge.HTMLElement{constructor(){super(),fg(this,pi,void 0),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(ph.content.cloneNode(!0))}static get observedAttributes(){return[Qt.MEDIA_CONTROLLER,"time",Z.MEDIA_PREVIEW_IMAGE,Z.MEDIA_PREVIEW_COORDS]}connectedCallback(){var e,a,h;const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Qa(this,pi,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=Xa(this,pi))==null?void 0:a.associateElement)==null||h.call(a,this))}disconnectedCallback(){var e,a;(a=(e=Xa(this,pi))==null?void 0:e.unassociateElement)==null||a.call(e,this),Qa(this,pi,null)}attributeChangedCallback(e,a,h){var m,T,k,A,w;["time",Z.MEDIA_PREVIEW_IMAGE,Z.MEDIA_PREVIEW_COORDS].includes(e)&&this.update(),e===Qt.MEDIA_CONTROLLER&&(a&&((T=(m=Xa(this,pi))==null?void 0:m.unassociateElement)==null||T.call(m,this),Qa(this,pi,null)),h&&(Qa(this,pi,(k=this.getRootNode())==null?void 0:k.getElementById(h)),(w=(A=Xa(this,pi))==null?void 0:A.associateElement)==null||w.call(A,this)))}update(){const e=this.getAttribute(Z.MEDIA_PREVIEW_COORDS),a=this.getAttribute(Z.MEDIA_PREVIEW_IMAGE);if(!(e&&a))return;const[h,m,T,k]=e.split(/\s+/).map(G=>+G),A=a.split("#")[0],w=getComputedStyle(this),{maxWidth:U,maxHeight:x,minWidth:P,minHeight:g}=w,I=Math.min(parseInt(U)/T,parseInt(x)/k),O=Math.max(parseInt(P)/T,parseInt(g)/k),X=I<1,N=X?I:O>1?O:1,{style:ye}=Hi(this.shadowRoot,":host"),de=Hi(this.shadowRoot,"img").style,re=this.shadowRoot.querySelector("img"),z=X?"min":"max";ye.setProperty(`${z}-width`,"initial","important"),ye.setProperty(`${z}-height`,"initial","important"),ye.width=`${T*N}px`,ye.height=`${k*N}px`;const he=()=>{de.width=`${this.imgWidth*N}px`,de.height=`${this.imgHeight*N}px`,de.display="block"};re.src!==A&&(re.onload=()=>{this.imgWidth=re.naturalWidth,this.imgHeight=re.naturalHeight,he()},re.src=A,he()),he(),de.transform=`translate(-${h*N}px, -${m*N}px)`}}pi=new WeakMap;Ge.customElements.get("media-preview-thumbnail")||Ge.customElements.define("media-preview-thumbnail",pg);var vh=(i,e,a)=>{if(!e.has(i))throw TypeError("Cannot "+a)},Za=(i,e,a)=>(vh(i,e,"read from private field"),a?a.call(i):e.get(i)),vg=(i,e,a)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,a)},Ja=(i,e,a,h)=>(vh(i,e,"write to private field"),h?h.call(i,a):e.set(i,a),a),vi;const mh=Dt.createElement("template"),mg=`
<svg aria-hidden="true" viewBox="0 0 100 100">
  <path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">
    <animateTransform
       attributeName="transform"
       attributeType="XML"
       type="rotate"
       dur="1s"
       from="0 50 50"
       to="360 50 50"
       repeatCount="indefinite" />
  </path>
</svg>
`;mh.innerHTML=`
<style>
:host {
  display: inline-block;
  vertical-align: middle;
  box-sizing: border-box;
}

#status {
  color: rgba(0,0,0,0);
  width: 0px;
  height: 0px;
}

:host slot[name=loading] > *,
:host ::slotted([slot=loading]) {
  opacity: 1;
  transition: opacity 0.15s;
}

:host(:not([is-loading])) slot[name=loading] > *, 
:host(:not([is-loading])) ::slotted([slot=loading]) {
  opacity: 0;
}

:host(:not([is-loading])) #status {
  display: none;
}

svg, img, ::slotted(svg), ::slotted(img) {
  width: var(--media-loading-icon-width, 100px);
  height: var(--media-loading-icon-height);
  fill: var(--media-icon-color, #fff);
  vertical-align: middle;
}
</style>

<slot name="loading">${mg}</slot>
<div id="status" role="status" aria-live="polite">${Wi.MEDIA_LOADING()}</div>
`;const gg=500;let yg=class extends Ge.HTMLElement{constructor(){super(),vg(this,vi,void 0);const e=this.attachShadow({mode:"open"}),a=mh.content.cloneNode(!0);e.appendChild(a)}static get observedAttributes(){return[Qt.MEDIA_CONTROLLER,Z.MEDIA_PAUSED,Z.MEDIA_LOADING,"loading-delay"]}attributeChangedCallback(e,a,h){var m,T,k,A,w,U;if(e===Z.MEDIA_LOADING||e===Z.MEDIA_PAUSED){const x=this.getAttribute(Z.MEDIA_PAUSED)!=null,P=this.getAttribute(Z.MEDIA_LOADING)!=null,g=!x&&P;if(!g)this.loadingDelayHandle&&(clearTimeout(this.loadingDelayHandle),this.loadingDelayHandle=void 0),this.removeAttribute("is-loading");else if(!this.loadingDelayHandle&&g){const I=+((m=this.getAttribute("loading-delay"))!=null?m:gg);this.loadingDelayHandle=setTimeout(()=>{this.setAttribute("is-loading",""),this.loadingDelayHandle=void 0},I)}}else e===Qt.MEDIA_CONTROLLER&&(a&&((k=(T=Za(this,vi))==null?void 0:T.unassociateElement)==null||k.call(T,this),Ja(this,vi,null)),h&&(Ja(this,vi,(A=this.getRootNode())==null?void 0:A.getElementById(h)),(U=(w=Za(this,vi))==null?void 0:w.associateElement)==null||U.call(w,this)))}connectedCallback(){var e,a,h;const m=this.getAttribute(Qt.MEDIA_CONTROLLER);m&&(Ja(this,vi,(e=this.getRootNode())==null?void 0:e.getElementById(m)),(h=(a=Za(this,vi))==null?void 0:a.associateElement)==null||h.call(a,this))}disconnectedCallback(){var e,a;this.loadingDelayHandle&&(clearTimeout(this.loadingDelayHandle),this.loadingDelayHandle=void 0),(a=(e=Za(this,vi))==null?void 0:e.unassociateElement)==null||a.call(e,this),Ja(this,vi,null)}};vi=new WeakMap;Ge.customElements.get("media-loading-indicator")||Ge.customElements.define("media-loading-indicator",yg);const gh=Dt.createElement("template");gh.innerHTML=`
  <style>
    :host {
    }
  </style>
  <slot></slot>
`;class Eg extends Ge.HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(gh.content.cloneNode(!0))}}Ge.customElements.get("media-title-bar")||Ge.customElements.define("media-title-bar",Eg);const bg=100,_g=i=>{var e;if(i.getAttribute(Z.MEDIA_MUTED)!=null)return 0;const h=+((e=i.getAttribute(Z.MEDIA_VOLUME))!=null?e:1);return Math.round(h*i.range.max)},Tg=({value:i,max:e})=>`${Math.round(i/e*100)}%`;class Sg extends Yc{static get observedAttributes(){return[...super.observedAttributes,Z.MEDIA_VOLUME,Z.MEDIA_MUTED,Z.MEDIA_VOLUME_UNAVAILABLE]}constructor(){super(),this.range.max=bg,this.range.addEventListener("input",()=>{const a=this.range.value/this.range.max,h=new Ge.CustomEvent(At.MEDIA_VOLUME_REQUEST,{composed:!0,bubbles:!0,detail:a});this.dispatchEvent(h)})}connectedCallback(){this.range.setAttribute("aria-label",Wi.VOLUME()),super.connectedCallback()}attributeChangedCallback(e,a,h){if(e===Z.MEDIA_VOLUME||e===Z.MEDIA_MUTED){const m=_g(this);this.range.value=m,this.range.setAttribute("aria-valuetext",Tg(this.range)),this.updateBar()}super.attributeChangedCallback(e,a,h)}}Ge.customElements.get("media-volume-range")||Ge.customElements.define("media-volume-range",Sg);class Ag extends Kc{}Ge.customElements.get("media-chrome")||Ge.customElements.define("media-chrome",Ag);class wg extends Kc{constructor(){super(),console.warn("MediaChrome: <media-container> is deprecated. Use <media-controller>.")}}Ge.customElements.get("media-container")||Ge.customElements.define("media-container",wg);const Pu={className:"class",classname:"class",htmlFor:"for",crossOrigin:"crossorigin",viewBox:"viewBox"},kg=i=>i.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`),Ig=(i,e)=>{if(Pu[i])return Pu[i];if(typeof e!=null&&!(typeof e=="boolean"&&!e))return/[A-Z]/.test(i)?kg(i):i},Dg=(i,e)=>typeof i=="boolean"?"":i,jt=(i={})=>Object.entries(i).reduce((e,[a,h])=>{const m=Ig(a,h);if(!m)return e;const T=Dg(h);return e[m]=T,e},{});et.forwardRef(({children:i,...e},a)=>et.createElement("media-chrome-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-airplay-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-cast-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-gesture-receiver",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-container-temp",jt({...e,ref:a}),i));const Lg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-controller",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-chrome-range",jt({...e,ref:a}),i));const yh=et.forwardRef(({children:i,...e},a)=>et.createElement("media-control-bar",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-text-display",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-current-time-display",jt({...e,ref:a}),i));const Rg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-duration-display",jt({...e,ref:a}),i)),Cg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-time-display",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-captions-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-seek-forward-button",jt({...e,ref:a}),i));const xg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-fullscreen-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-live-button",jt({...e,ref:a}),i));const Og=et.forwardRef(({children:i,...e},a)=>et.createElement("media-mute-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-pip-button",jt({...e,ref:a}),i));const Mg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-play-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-playback-rate-button",jt({...e,ref:a}),i));const Pg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-poster-image",jt({...e,ref:a}),i)),Ug=et.forwardRef(({children:i,...e},a)=>et.createElement("media-time-range",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-progress-range",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-seek-backward-button",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-preview-time-display",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-preview-thumbnail",jt({...e,ref:a}),i));const Fg=et.forwardRef(({children:i,...e},a)=>et.createElement("media-loading-indicator",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-title-bar",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-volume-range",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-chrome",jt({...e,ref:a}),i));et.forwardRef(({children:i,...e},a)=>et.createElement("media-container",jt({...e,ref:a}),i));var Uu,Fu,Nu,Bu,Hu,ju,Gu,Vu,Ku,qu,Wu,$u,Yu,zu,Xu,Qu,Zu,Ju,ed;function yr(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function Ng(){return Ue.useState(!1)}const Bg=i=>{var e,a;const h=gi(),m=yf(),T=Ef(),k=Ue.useMemo(()=>{var A,w;return!!(i!=null&&i.assetId)&&((i==null?void 0:i.status)==="preparing"||((w=(A=i==null?void 0:i.data)==null?void 0:A.static_renditions)==null?void 0:w.status)==="preparing")},[i==null?void 0:i.assetId,(a=(e=i==null?void 0:i.data)==null?void 0:e.static_renditions)==null?void 0:a.status,i==null?void 0:i.status]);return kp(k?"/".concat(m,"/addons/mux/assets/").concat(T,"/data/").concat(i==null?void 0:i.assetId):null,async()=>{const{data:A}=await h.request({url:"/addons/mux/assets/".concat(T,"/data/").concat(i.assetId),withCredentials:!0,method:"GET"});h.patch(i._id).set({status:A.status,data:A}).commit({returnDocuments:!1})},{refreshInterval:2e3,refreshWhenHidden:!0,dedupingInterval:1e3})},Hg=["token","secretKey","enableSignedUrls","signingKeyId","signingKeyPrivate"],jg=()=>{const{error:i,isLoading:e,value:a}=bf(_f,Hg),h=Ue.useMemo(()=>{const m=Boolean(a),T={token:(a==null?void 0:a.token)||null,secretKey:(a==null?void 0:a.secretKey)||null,enableSignedUrls:(a==null?void 0:a.enableSignedUrls)||!1,signingKeyId:(a==null?void 0:a.signingKeyId)||null,signingKeyPrivate:(a==null?void 0:a.signingKeyPrivate)||null};return{isInitialSetup:!m,needsSetup:!(T!=null&&T.token)||!(T!=null&&T.secretKey),secrets:T}},[a]);return{error:i,isLoading:e,value:h}};function Gg(i,e,a){return new Of(h=>{const m=hv({endpoint:e,file:a,dynamicChunkSize:!0}),T=()=>{h.next({type:"success",id:i}),h.complete()},k=x=>h.error(new Error(x.detail.message)),A=x=>h.next({type:"progress",percent:x.detail}),w=()=>{m.pause(),h.next({type:"pause",id:i})},U=()=>{m.resume(),h.next({type:"resume",id:i})};return m.on("success",T),m.on("error",k),m.on("progress",A),m.on("offline",w),m.on("online",U),()=>m.abort()})}function Eh(i,e){const{dataset:a}=i.config();return i.request({url:"/addons/mux/assets/".concat(a,"/").concat(e),withCredentials:!0,method:"DELETE"})}function Vg(i,e){const{dataset:a}=i.config();return i.request({url:"/addons/mux/assets/".concat(a,"/data/").concat(e),withCredentials:!0,method:"GET"})}function td(i,e,a,h,m,T){const k={_id:"secrets.mux",_type:"mux.apiKey",token:e,secretKey:a,enableSignedUrls:h,signingKeyId:m,signingKeyPrivate:T};return i.createOrReplace(k)}function Kg(i){const{dataset:e}=i.config();return i.request({url:"/addons/mux/signing-keys/".concat(e),withCredentials:!0,method:"POST"})}function qg(i){const{dataset:e}=i.config();return i.request({url:"/addons/mux/secrets/".concat(e,"/test"),withCredentials:!0,method:"GET"})}async function Wg(i,e,a){if(!(e&&a))return!1;const{dataset:h}=i.config();try{const m=await i.request({url:"/addons/mux/signing-keys/".concat(h,"/").concat(e),withCredentials:!0,method:"GET"});return!!(m.data&&m.data.id)}catch{return console.error("Error fetching signingKeyId",e,"assuming it is not valid"),!1}}function bh(i){const{dataset:e}=i.config();return ul(()=>i.observable.request({url:"/addons/mux/secrets/".concat(e,"/test"),withCredentials:!0,method:"GET"}))}function $g(i,e){return i.observable.request({url:"/addons/mux/uploads/".concat(i.clientConfig.dataset,"/").concat(e),withCredentials:!0,method:"DELETE"})}function Yg(i,e,a){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return ey(a).pipe(fs(m=>Oo(Ni({type:"url",url:m}),bh(e).pipe(fs(T=>{if(!T||!T.status)return ji(new Error("Invalid credentials"));const k=Ld(),{enableSignedUrls:A}=h,w={input:m,playback_policy:[A?"signed":"public"],mp4_support:i.mp4_support},U={muxBody:JSON.stringify(w),filename:m.split("/").slice(-1)[0]},x=e.clientConfig.dataset;return ul(()=>e.observable.request({url:"/addons/mux/assets/".concat(x),withCredentials:!0,method:"POST",headers:{"MUX-Proxy-UUID":k,"Content-Type":"application/json"},query:U})).pipe(es(P=>{const g=P&&P.results&&P.results[0]&&P.results[0].document||null;return g?Ni({type:"success",id:k,asset:g}):ji(new Error("No asset document returned"))}))})))))}function zg(i,e,a){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Jg(a).pipe(fs(m=>Oo(Ni({type:"file",file:m}),bh(e).pipe(fs(T=>{if(!T||!T.status)return ji(new Error("Invalid credentials"));const k=Ld(),{enableSignedUrls:A}=h,w={mp4_support:i.mp4_support,playback_policy:[A?"signed":"public"]};return Oo(Ni({type:"uuid",uuid:k}),ul(()=>e.observable.request({url:"/addons/mux/uploads/".concat(e.clientConfig.dataset),withCredentials:!0,method:"POST",headers:{"MUX-Proxy-UUID":k,"Content-Type":"application/json"},body:w})).pipe(es(U=>Gg(k,U.upload.url,a).pipe(es(x=>x.type!=="success"?Ni(x):Df(Zg(e,k)).pipe(es(P=>Ni({...x,asset:P})))),Lf(x=>$g(e,k).pipe(Rf(ji(x))))))))})))))}function Xg(i,e){const{dataset:a}=i.config();return i.request({url:"/addons/mux/uploads/".concat(a,"/").concat(e),withCredentials:!0,method:"GET"})}function Qg(i,e){let h,m=0,T,k;return new Promise((A,w)=>{h=setInterval(async()=>{try{k=await Xg(i,e)}catch(U){w(U);return}T=k&&k.data&&k.data.asset_id,T&&(clearInterval(h),A(k)),m>10&&(clearInterval(h),w(new Error("Upload did not finish"))),m++},2e3)})}async function Zg(i,e){let a,h;try{a=await Qg(i,e)}catch(T){return Promise.reject(T)}try{h=await Vg(i,a.data.asset_id)}catch(T){return Promise.reject(T)}const m={_id:e,_type:"mux.videoAsset",status:h.data.status,data:h.data,assetId:h.data.id,playbackId:h.data.playback_ids[0].id,uploadId:a.data.id};return i.createOrReplace(m).then(()=>m)}function Jg(i){if(typeof window<"u"&&i instanceof window.File){const e=ty({},i);return Ni(e)}return ji(new Error("Invalid file"))}function ey(i){const e=new Error("Invalid URL");if(typeof i!="string")return ji(e);let a;try{a=new URL(i)}catch{return ji(e)}return a&&!a.protocol.match(/http:|https:/)?ji(e):Ni(i)}function ty(i,e){return typeof window>"u"||!(e instanceof window.File)?i:{name:i.preserveFilename===!1?void 0:e.name,type:e.type}}function ry(i){const e=Array.from(i.files||[]),a=Array.from(i.items||[]);return e&&e.length>0?Promise.resolve(e):iy(a).then(h=>h.flat())}function iy(i){return Promise.all(i.map(e=>{if(e.kind==="file"&&e.webkitGetAsEntry){let a;try{a=e.webkitGetAsEntry()}catch{return[e.getAsFile()]}return a?a.isDirectory?_h(a):[e.getAsFile()]:[]}if(e.kind==="file"){const a=e.getAsFile();return Promise.resolve(a?[a]:[])}return new Promise(a=>e.getAsString(a)).then(a=>a?[new File([a],"unknown.txt",{type:e.type})]:[])}))}function ny(i){return i.isFile}function ay(i){return i.isDirectory}function _h(i){if(ny(i))return new Promise(e=>i.file(e)).then(e=>[e]);if(ay(i)){const e=i.createReader();return new Promise(a=>e.readEntries(a)).then(a=>a.filter(h=>!h.name.startsWith("."))).then(a=>Promise.all(a.map(_h)).then(h=>h.flat()))}return Promise.resolve([])}function sy(i){const{asset:e}=i,a=Ue.useId(),[h,m]=Ue.useState(),[T,k]=Ue.useState(!1),[A,w]=Ue.useState(null),U=Ue.useCallback(()=>m("confirm-delete"),[]),x=Ue.useCallback(()=>{m(!1),k(!0)},[m]),P=Ue.useCallback(()=>{m(!1),k(!1)},[m]);return Ue.useEffect(()=>{T&&h&&k(!1)},[h,T]),_d(Ue.useCallback(()=>k(!1),[]),[A]),lt(Ki,{children:[te(Tf,{id:"".concat(a,"-asset-menu"),button:te(Rr,{icon:wd,mode:"ghost",onClick:x,padding:2}),menu:te(Td,{ref:w,children:te(la,{tone:"critical",icon:kd,text:"Delete",onClick:U})}),portal:!0,placement:"right"}),h==="confirm-delete"&&te(oy,{asset:e,onClose:P})]})}function oy(i){const{asset:e,onClose:a}=i,h=gi(),{push:m}=Sf(),[T,k]=Ue.useState(!1),[A,w]=Ue.useState(!1),U=Ue.useId(),x=200*dl({maxDpr:2}),P=Ue.useCallback(async()=>{var g,I,O;k(!0);try{e!=null&&e._id&&await h.delete(e._id),A&&(e!=null&&e.assetId)&&await Eh(h,e.assetId),(O=(I=(g=document.querySelector('[data-id="'.concat(e._id,'"]')))==null?void 0:g.parentElement)==null?void 0:I.setAttribute)==null||O.call(I,"hidden","true")}catch(X){console.error("Failed during delete",X),m({closable:!0,description:X==null?void 0:X.message,duration:5e3,title:"Uncaught error",status:"error"})}finally{k(!1),a()}},[e._id,e.assetId,h,A,a,m]);return te(ws,{onClose:a,id:"".concat(U,"-confirm-delete"),header:"Delete video",footer:lt(xo,{padding:2,gap:2,columns:2,children:[te(Rr,{mode:"bleed",text:"Cancel",onClick:a}),te(Rr,{text:"Delete",tone:"critical",icon:kd,onClick:P,loading:T})]}),width:1,children:te(qr,{paddingX:0,paddingY:0,space:1,children:te(Pr,{paddingX:[2,3,4],paddingY:[3,3,3,4],children:lt(xo,{columns:3,gap:3,children:[te(Dr,{style:{gridColumn:"span 2"},align:"center",children:te(ni,{padding:4,children:lt(qr,{space:4,children:[lt(Dr,{align:"center",as:"label",children:[te(Co,{checked:A,onChange:()=>w(g=>!g)}),te(vr,{style:{margin:"0 10px"},children:"Delete asset on Mux"})]}),lt(Dr,{align:"center",as:"label",children:[te(Co,{disabled:!0,checked:!0}),te(vr,{style:{margin:"0 10px"},children:"Delete video from dataset"})]})]})})}),te(ps,{asset:e,width:x,showTip:!0})]})})})})}function ly(i){let{assets:e,isLoading:a,isLastPage:h,onSelect:m,onLoadMore:T}=i;const k=Ue.useCallback(U=>m(U.currentTarget.dataset.id),[m]),A=Ue.useCallback(U=>{U.key==="Enter"&&m(U.currentTarget.dataset.id)},[m]),w=200*dl({maxDpr:2});return lt(Ki,{children:[lt(ni,{padding:4,children:[te(Bf,{gap:2,children:e.map(U=>te(dy,{asset:U,onClick:k,onKeyPress:A,width:w},U._id))}),a&&e.length===0&&te(Dr,{justify:"center",children:te(Mf,{muted:!0})}),!a&&e.length===0&&te(vr,{align:"center",muted:!0,children:"No videos"})]}),e.length>0&&!h&&te(Hf,{tone:"default",padding:4,children:te(Dr,{direction:"column",children:te(Rr,{type:"button",icon:Pf,loading:a,onClick:T,text:"Load more",tone:"primary"})})})]})}const uy=i=>{let{asset:e,onClick:a,onKeyPress:h,width:m}=i;const[T,k]=Ue.useState(null),A=Ue.useRef(null);return Ue.useLayoutEffect(()=>{!A.current||T===null||(T?du(A.current,{opacity:1}):du(A.current,{opacity:0}))},[T]),lt(ni,{height:"fill",style:{position:"relative"},children:[lt(Pr,{as:"button","data-id":e._id,onClick:a,onKeyPress:h,tabIndex:0,radius:2,padding:1,style:{lineHeight:0,position:"relative"},__unstable_focusRing:!0,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:[te(ps,{asset:e,width:m,showTip:!0}),(e==null?void 0:e.playbackId)&&te(cy,{tone:"transparent",ref:A,margin:1,radius:1,children:T!==null&&te(Uf,{asset:e,width:m})})]}),te(hy,{children:te(sy,{asset:e})})]})},dy=Ue.memo(uy),cy=gr(Pr)(Uu||(Uu=yr([`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  will-change: opacity;
  background: transparent;
  background-color: hsl(0deg 0% 0% / 33%);
  opacity: 0;
  pointer-events: none;
`]))),hy=gr.div(Fu||(Fu=yr([`
  box-sizing: border-box;
  position: absolute;
  z-index: 300;
  opacity: 0;
  top: 7px;
  right: 7px;

  button:hover + &,
  button:focus-visible + &,
  &:hover,
  &:focus-visible {
    opacity: 1;
  }
`]))),hs=200;function fy(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hs;return'*[_type == "mux.videoAsset"] | order(_updatedAt desc) ['.concat(i,"...").concat(e,"]")}function py(i){let{asset:e,onChange:a,setDialogState:h}=i;const m=gi(),T=Ue.useRef(0),[k,A]=Ue.useState(!1),[w,U]=Ue.useState(!1),[x,P]=Ue.useState([]),g=Ue.useCallback(X=>{const N=X*hs,ye=N+hs;return U(!0),m.fetch(fy(N,ye)).then(de=>{A(de.length<hs),P(re=>re.concat(de))}).finally(()=>U(!1))},[m]),I=Ue.useCallback(X=>{const N=x.find(ye=>ye._id===X);if(!N)throw new TypeError("Failed to find video asset with id: ".concat(X));a(As.from([Id({asset:{}}),Dd({_type:"reference",_weak:!0,_ref:N._id},["asset"])])),h(!1)},[x,a,h]),O=Ue.useCallback(()=>{g(++T.current)},[g]);return Ue.useEffect(()=>void g(T.current),[g]),te(ly,{onSelect:I,assets:x,isLastPage:k,isLoading:w,onLoadMore:O})}function vy(i){let{setDialogState:e,asset:a,onChange:h}=i;const m="InputBrowser".concat(Ue.useId()),T=Ue.useCallback(()=>e(!1),[e]);return te(ws,{scheme:"dark",__unstable_autoFocus:!0,header:"Select video",id:m,onClose:T,width:2,children:te(py,{asset:a,onChange:h,setDialogState:e})})}var my=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Th(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Gr={},gy={get exports(){return Gr},set exports(i){Gr=i}};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var wo,rd;function yy(){if(rd)return wo;rd=1;var i=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function h(T){if(T==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(T)}function m(){try{if(!Object.assign)return!1;var T=new String("abc");if(T[5]="de",Object.getOwnPropertyNames(T)[0]==="5")return!1;for(var k={},A=0;A<10;A++)k["_"+String.fromCharCode(A)]=A;var w=Object.getOwnPropertyNames(k).map(function(x){return k[x]});if(w.join("")!=="0123456789")return!1;var U={};return"abcdefghijklmnopqrst".split("").forEach(function(x){U[x]=x}),Object.keys(Object.assign({},U)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return wo=m()?Object.assign:function(T,k){for(var A,w=h(T),U,x=1;x<arguments.length;x++){A=Object(arguments[x]);for(var P in A)e.call(A,P)&&(w[P]=A[P]);if(i){U=i(A);for(var g=0;g<U.length;g++)a.call(A,U[g])&&(w[U[g]]=A[U[g]])}}return w},wo}var ko,id;function Sh(){if(id)return ko;id=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ko=i,ko}var Io,nd;function Ah(){return nd||(nd=1,Io=Function.call.bind(Object.prototype.hasOwnProperty)),Io}var Do,ad;function Ey(){if(ad)return Do;ad=1;var i=function(){};{var e=Sh(),a={},h=Ah();i=function(T){var k="Warning: "+T;typeof console<"u"&&console.error(k);try{throw new Error(k)}catch{}}}function m(T,k,A,w,U){for(var x in T)if(h(T,x)){var P;try{if(typeof T[x]!="function"){var g=Error((w||"React class")+": "+A+" type `"+x+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof T[x]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw g.name="Invariant Violation",g}P=T[x](k,x,w,A,null,e)}catch(O){P=O}if(P&&!(P instanceof Error)&&i((w||"React class")+": type specification of "+A+" `"+x+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof P+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),P instanceof Error&&!(P.message in a)){a[P.message]=!0;var I=U?U():"";i("Failed "+A+" type: "+P.message+(I??""))}}}return m.resetWarningCache=function(){a={}},Do=m,Do}var Lo,sd;function by(){if(sd)return Lo;sd=1;var i=Ed,e=yy(),a=Sh(),h=Ah(),m=Ey(),T=function(){};T=function(A){var w="Warning: "+A;typeof console<"u"&&console.error(w);try{throw new Error(w)}catch{}};function k(){return null}return Lo=function(A,w){var U=typeof Symbol=="function"&&Symbol.iterator,x="@@iterator";function P(le){var ae=le&&(U&&le[U]||le[x]);if(typeof ae=="function")return ae}var g="<<anonymous>>",I={array:ye("array"),bigint:ye("bigint"),bool:ye("boolean"),func:ye("function"),number:ye("number"),object:ye("object"),string:ye("string"),symbol:ye("symbol"),any:de(),arrayOf:re,element:z(),elementType:he(),instanceOf:G,node:ke(),objectOf:me,oneOf:Y,oneOfType:Ae,shape:L,exact:W};function O(le,ae){return le===ae?le!==0||1/le===1/ae:le!==le&&ae!==ae}function X(le,ae){this.message=le,this.data=ae&&typeof ae=="object"?ae:{},this.stack=""}X.prototype=Error.prototype;function N(le){var ae={},we=0;function Ke(ie,Ee,ue,Re,Le,Me,Oe){if(Re=Re||g,Me=Me||ue,Oe!==a){if(w){var Be=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw Be.name="Invariant Violation",Be}else if(typeof console<"u"){var _e=Re+":"+ue;!ae[_e]&&we<3&&(T("You are manually calling a React.PropTypes validation function for the `"+Me+"` prop on `"+Re+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),ae[_e]=!0,we++)}}return Ee[ue]==null?ie?Ee[ue]===null?new X("The "+Le+" `"+Me+"` is marked as required "+("in `"+Re+"`, but its value is `null`.")):new X("The "+Le+" `"+Me+"` is marked as required in "+("`"+Re+"`, but its value is `undefined`.")):null:le(Ee,ue,Re,Le,Me)}var We=Ke.bind(null,!1);return We.isRequired=Ke.bind(null,!0),We}function ye(le){function ae(we,Ke,We,ie,Ee,ue){var Re=we[Ke],Le=fe(Re);if(Le!==le){var Me=ne(Re);return new X("Invalid "+ie+" `"+Ee+"` of type "+("`"+Me+"` supplied to `"+We+"`, expected ")+("`"+le+"`."),{expectedType:le})}return null}return N(ae)}function de(){return N(k)}function re(le){function ae(we,Ke,We,ie,Ee){if(typeof le!="function")return new X("Property `"+Ee+"` of component `"+We+"` has invalid PropType notation inside arrayOf.");var ue=we[Ke];if(!Array.isArray(ue)){var Re=fe(ue);return new X("Invalid "+ie+" `"+Ee+"` of type "+("`"+Re+"` supplied to `"+We+"`, expected an array."))}for(var Le=0;Le<ue.length;Le++){var Me=le(ue,Le,We,ie,Ee+"["+Le+"]",a);if(Me instanceof Error)return Me}return null}return N(ae)}function z(){function le(ae,we,Ke,We,ie){var Ee=ae[we];if(!A(Ee)){var ue=fe(Ee);return new X("Invalid "+We+" `"+ie+"` of type "+("`"+ue+"` supplied to `"+Ke+"`, expected a single ReactElement."))}return null}return N(le)}function he(){function le(ae,we,Ke,We,ie){var Ee=ae[we];if(!i.isValidElementType(Ee)){var ue=fe(Ee);return new X("Invalid "+We+" `"+ie+"` of type "+("`"+ue+"` supplied to `"+Ke+"`, expected a single ReactElement type."))}return null}return N(le)}function G(le){function ae(we,Ke,We,ie,Ee){if(!(we[Ke]instanceof le)){var ue=le.name||g,Re=He(we[Ke]);return new X("Invalid "+ie+" `"+Ee+"` of type "+("`"+Re+"` supplied to `"+We+"`, expected ")+("instance of `"+ue+"`."))}return null}return N(ae)}function Y(le){if(!Array.isArray(le))return arguments.length>1?T("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):T("Invalid argument supplied to oneOf, expected an array."),k;function ae(we,Ke,We,ie,Ee){for(var ue=we[Ke],Re=0;Re<le.length;Re++)if(O(ue,le[Re]))return null;var Le=JSON.stringify(le,function(Oe,Be){var _e=ne(Be);return _e==="symbol"?String(Be):Be});return new X("Invalid "+ie+" `"+Ee+"` of value `"+String(ue)+"` "+("supplied to `"+We+"`, expected one of "+Le+"."))}return N(ae)}function me(le){function ae(we,Ke,We,ie,Ee){if(typeof le!="function")return new X("Property `"+Ee+"` of component `"+We+"` has invalid PropType notation inside objectOf.");var ue=we[Ke],Re=fe(ue);if(Re!=="object")return new X("Invalid "+ie+" `"+Ee+"` of type "+("`"+Re+"` supplied to `"+We+"`, expected an object."));for(var Le in ue)if(h(ue,Le)){var Me=le(ue,Le,We,ie,Ee+"."+Le,a);if(Me instanceof Error)return Me}return null}return N(ae)}function Ae(le){if(!Array.isArray(le))return T("Invalid argument supplied to oneOfType, expected an instance of array."),k;for(var ae=0;ae<le.length;ae++){var we=le[ae];if(typeof we!="function")return T("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+Te(we)+" at index "+ae+"."),k}function Ke(We,ie,Ee,ue,Re){for(var Le=[],Me=0;Me<le.length;Me++){var Oe=le[Me],Be=Oe(We,ie,Ee,ue,Re,a);if(Be==null)return null;Be.data&&h(Be.data,"expectedType")&&Le.push(Be.data.expectedType)}var _e=Le.length>0?", expected one of type ["+Le.join(", ")+"]":"";return new X("Invalid "+ue+" `"+Re+"` supplied to "+("`"+Ee+"`"+_e+"."))}return N(Ke)}function ke(){function le(ae,we,Ke,We,ie){return B(ae[we])?null:new X("Invalid "+We+" `"+ie+"` supplied to "+("`"+Ke+"`, expected a ReactNode."))}return N(le)}function Q(le,ae,we,Ke,We){return new X((le||"React class")+": "+ae+" type `"+we+"."+Ke+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+We+"`.")}function L(le){function ae(we,Ke,We,ie,Ee){var ue=we[Ke],Re=fe(ue);if(Re!=="object")return new X("Invalid "+ie+" `"+Ee+"` of type `"+Re+"` "+("supplied to `"+We+"`, expected `object`."));for(var Le in le){var Me=le[Le];if(typeof Me!="function")return Q(We,ie,Ee,Le,ne(Me));var Oe=Me(ue,Le,We,ie,Ee+"."+Le,a);if(Oe)return Oe}return null}return N(ae)}function W(le){function ae(we,Ke,We,ie,Ee){var ue=we[Ke],Re=fe(ue);if(Re!=="object")return new X("Invalid "+ie+" `"+Ee+"` of type `"+Re+"` "+("supplied to `"+We+"`, expected `object`."));var Le=e({},we[Ke],le);for(var Me in Le){var Oe=le[Me];if(h(le,Me)&&typeof Oe!="function")return Q(We,ie,Ee,Me,ne(Oe));if(!Oe)return new X("Invalid "+ie+" `"+Ee+"` key `"+Me+"` supplied to `"+We+"`.\nBad object: "+JSON.stringify(we[Ke],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(le),null,"  "));var Be=Oe(ue,Me,We,ie,Ee+"."+Me,a);if(Be)return Be}return null}return N(ae)}function B(le){switch(typeof le){case"number":case"string":case"undefined":return!0;case"boolean":return!le;case"object":if(Array.isArray(le))return le.every(B);if(le===null||A(le))return!0;var ae=P(le);if(ae){var we=ae.call(le),Ke;if(ae!==le.entries){for(;!(Ke=we.next()).done;)if(!B(Ke.value))return!1}else for(;!(Ke=we.next()).done;){var We=Ke.value;if(We&&!B(We[1]))return!1}}else return!1;return!0;default:return!1}}function se(le,ae){return le==="symbol"?!0:ae?ae["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&ae instanceof Symbol:!1}function fe(le){var ae=typeof le;return Array.isArray(le)?"array":le instanceof RegExp?"object":se(ae,le)?"symbol":ae}function ne(le){if(typeof le>"u"||le===null)return""+le;var ae=fe(le);if(ae==="object"){if(le instanceof Date)return"date";if(le instanceof RegExp)return"regexp"}return ae}function Te(le){var ae=ne(le);switch(ae){case"array":case"object":return"an "+ae;case"boolean":case"date":case"regexp":return"a "+ae;default:return ae}}function He(le){return!le.constructor||!le.constructor.name?g:le.constructor.name}return I.checkPropTypes=m,I.resetWarningCache=m.resetWarningCache,I.PropTypes=I,I},Lo}{var _y=Ed,Ty=!0;gy.exports=by()(_y.isElement,Ty)}var rl={},Sy={get exports(){return rl},set exports(i){rl=i}};/*!
* mux-embed
* @version 4.18.0
* @copyright 2023 Mux, Inc
*/(function(i,e){(function(){var a;a=function(){return function(){var h={80:function(k,A,w){k.exports=w(728).default},728:function(k,A,w){w.d(A,{default:function(){return Ca}});var U=w(48),x=w.n(U),P=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(S){var y=16*Math.random()|0;return(S==="x"?y:3&y|8).toString(16)})},g=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},I=function(S){return S&&S.nodeName!==void 0?(S.muxId||(S.muxId=S.id||g()),S.muxId):S},O=function(S){var y;S&&S.nodeName!==void 0?S=I(y=S):y=document.querySelector(S);var _=y&&y.nodeName?y.nodeName.toLowerCase():"";return[y,S,_]},X=w(640),N=w.n(X),ye=N().methodFactory;N().methodFactory=function(S,y,_){var E=ye(S,y,_);return function(){for(var M=["[mux]"],ee=0;ee<arguments.length;ee++)M.push(arguments[ee]);E.apply(void 0,M)}},N().setLevel(N().getLevel());var de=N();function re(){return(x().doNotTrack||x().navigator&&x().navigator.doNotTrack)==="1"}var z={now:function(){var S=x().performance,y=S&&S.timing,_=y&&y.navigationStart,E=typeof _=="number"&&typeof S.now=="function"?_+S.now():Date.now();return Math.round(E)}},he=w(678),G=w.n(he),Y=function(S){return me(S)[0]},me=function(S){if(typeof S!="string"||S==="")return["localhost"];var y,_=(S.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return _&&(y=(_.match(/[^\.]+\.[^\.]+$/)||[])[0]),[_,y]},Ae={exists:function(){var S=x().performance;return(S&&S.timing)!==void 0},domContentLoadedEventEnd:function(){var S=x().performance,y=S&&S.timing;return y&&y.domContentLoadedEventEnd},navigationStart:function(){var S=x().performance,y=S&&S.timing;return y&&y.navigationStart}};function ke(S,y,_){_=_===void 0?1:_,S[y]=S[y]||0,S[y]+=_}var Q=["x-cdn","content-type","x-request-id"];function L(S){var y={};return(S=S||"").trim().split(/[\r\n]+/).forEach(function(_){if(_){var E=_.split(": "),M=E.shift();M&&(Q.indexOf(M.toLowerCase())>=0||M.toLowerCase().indexOf("x-litix-")===0)&&(y[M]=E.join(": "))}}),y}var W=function(S){var y={};for(var _ in S){var E=S[_];E["DATA-ID"].search("io.litix.data.")!==-1&&(y[E["DATA-ID"].replace("io.litix.data.","")]=E.VALUE)}return y};function B(S,y){var _=Object.keys(S);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(S);y&&(E=E.filter(function(M){return Object.getOwnPropertyDescriptor(S,M).enumerable})),_.push.apply(_,E)}return _}function se(S){for(var y=1;y<arguments.length;y++){var _=arguments[y]!=null?arguments[y]:{};y%2?B(Object(_),!0).forEach(function(E){fe(S,E,_[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(_)):B(Object(_)).forEach(function(E){Object.defineProperty(S,E,Object.getOwnPropertyDescriptor(_,E))})}return S}function fe(S,y,_){return y in S?Object.defineProperty(S,y,{value:_,enumerable:!0,configurable:!0,writable:!0}):S[y]=_,S}var ne=function(S){if(!S)return{};var y=Ae.navigationStart(),_=S.loading,E=_?_.start:S.trequest,M=_?_.first:S.tfirst,ee=_?_.end:S.tload;return{bytesLoaded:S.total,requestStart:Math.round(y+E),responseStart:Math.round(y+M),responseEnd:Math.round(y+ee)}},Te=function(S){if(S&&typeof S.getAllResponseHeaders=="function")return L(S.getAllResponseHeaders())};function He(S,y){var _=Object.keys(S);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(S);y&&(E=E.filter(function(M){return Object.getOwnPropertyDescriptor(S,M).enumerable})),_.push.apply(_,E)}return _}function le(S){for(var y=1;y<arguments.length;y++){var _=arguments[y]!=null?arguments[y]:{};y%2?He(Object(_),!0).forEach(function(E){ae(S,E,_[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(_)):He(Object(_)).forEach(function(E){Object.defineProperty(S,E,Object.getOwnPropertyDescriptor(_,E))})}return S}function ae(S,y,_){return y in S?Object.defineProperty(S,y,{value:_,enumerable:!0,configurable:!0,writable:!0}):S[y]=_,S}var we=function(S,y){if(!S||typeof S.getRequests!="function")return{};var _=S.getRequests({state:"executed"});if(_.length===0)return{};var E,M=_[_.length-1],ee=Y(M.url),H=M.url,be=M.bytesLoaded,oe=new Date(M.requestStartDate).getTime(),Ve=new Date(M.firstByteDate).getTime(),nt=new Date(M.requestEndDate).getTime(),ut=isNaN(M.duration)?0:M.duration,bt=typeof y.getMetricsFor=="function"?y.getMetricsFor(M.mediaType).HttpList:y.getDashMetrics().getHttpRequests(M.mediaType);return bt.length>0&&(E=L(bt[bt.length-1]._responseHeaders||"")),{requestStart:oe,requestResponseStart:Ve,requestResponseEnd:nt,requestBytesLoaded:be,requestResponseHeaders:E,requestMediaDuration:ut,requestHostname:ee,requestUrl:H}},Ke=function(S,y){var _=y.getQualityFor(S),E=y.getCurrentTrackFor(S).bitrateList;return E?{currentLevel:_,renditionWidth:E[_].width||null,renditionHeight:E[_].height||null,renditionBitrate:E[_].bandwidth}:{}},We=function(S){var y;return(y=S.match(/.*codecs\*?="(.*)"/))===null||y===void 0?void 0:y[1]};function ie(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var Ee=0,ue=function(){function S(){(function(E,M){if(!(E instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S)}var y,_;return y=S,_=[{key:"on",value:function(E,M,ee){return M._eventEmitterGuid=M._eventEmitterGuid||++Ee,this._listeners=this._listeners||{},this._listeners[E]=this._listeners[E]||[],ee&&(M=M.bind(ee)),this._listeners[E].push(M),M}},{key:"off",value:function(E,M){var ee=this._listeners&&this._listeners[E];ee&&ee.forEach(function(H,be){H._eventEmitterGuid===M._eventEmitterGuid&&ee.splice(be,1)})}},{key:"one",value:function(E,M,ee){var H=this;M._eventEmitterGuid=M._eventEmitterGuid||++Ee;var be=function oe(){H.off(E,oe),M.apply(ee||this,arguments)};be._eventEmitterGuid=M._eventEmitterGuid,this.on(E,be)}},{key:"emit",value:function(E,M){var ee=this;if(this._listeners){M=M||{};var H=this._listeners["before*"]||[],be=this._listeners[E]||[],oe=this._listeners["after"+E]||[],Ve=function(nt,ut){(nt=nt.slice()).forEach(function(bt){bt.call(ee,{type:E},ut)})};Ve(H,M),Ve(be,M),Ve(oe,M)}}}],_&&ie(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}(),Re=ue;function Le(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var Me=function(){function S(E){var M=this;(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,E.on("playing",function(){M._playheadShouldBeProgressing=!0}),E.on("play",this._startPlaybackHeartbeatInterval.bind(this)),E.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),E.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),E.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),E.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),E.on("seeking",this._startPlaybackHeartbeatInterval.bind(this)),E.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),E.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),E.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),E.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),E.on("seeked",function(){E.data.player_is_paused?M._stopPlaybackHeartbeatInterval():M._startPlaybackHeartbeatInterval()}),E.on("timeupdate",function(){M._playbackHeartbeatInterval!==null&&E.emit("playbackheartbeat")}),E.on("devicesleep",function(ee,H){M._playbackHeartbeatInterval!==null&&(x().clearInterval(M._playbackHeartbeatInterval),E.emit("playbackheartbeatend",{viewer_time:H.viewer_time}),M._playbackHeartbeatInterval=null)})}var y,_;return y=S,(_=[{key:"_startPlaybackHeartbeatInterval",value:function(){var E=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=x().setInterval(function(){E.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(x().clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}])&&Le(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function Oe(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function Be(S,y,_){return y&&Oe(S.prototype,y),_&&Oe(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var _e=Be(function S(y){var _=this;(function(E,M){if(!(E instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S),y.on("viewinit",function(){_.viewErrored=!1}),y.on("error",function(E,M){try{var ee=y.errorTranslator({player_error_code:M.player_error_code,player_error_message:M.player_error_message,player_error_context:M.player_error_context});ee?(y.data.player_error_code=ee.player_error_code||M.player_error_code,y.data.player_error_message=ee.player_error_message||M.player_error_message,y.data.player_error_context=ee.player_error_context||M.player_error_context,_.viewErrored=!0):(delete y.data.player_error_code,delete y.data.player_error_message,delete y.data.player_error_context)}catch(H){y.mux.log.warn("Exception in error translator callback.",H),_.viewErrored=!0}})});function Ne(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var Xe=function(){function S(E){(function(M,ee){if(!(M instanceof ee))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,this._watchTimeTrackerLastCheckedTime=null,E.on("playbackheartbeat",this._updateWatchTime.bind(this)),E.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}var y,_;return y=S,(_=[{key:"_updateWatchTime",value:function(E,M){var ee=M.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=ee),ke(this.pm.data,"view_watch_time",ee-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=ee}},{key:"_clearWatchTimeState",value:function(E,M){this._updateWatchTime(E,M),this._watchTimeTrackerLastCheckedTime=null}}])&&Ne(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function at(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var mt=function(){function S(E){(function(M,ee){if(!(M instanceof ee))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,this._playbackTimeTrackerLastPlayheadPosition=-1,E.on("playbackheartbeat",this._updatePlaybackTime.bind(this)),E.on("playbackheartbeatend",this._clearPlaybackTimeState.bind(this)),E.on("seeking",this._clearPlaybackTimeState.bind(this))}var y,_;return y=S,(_=[{key:"_updatePlaybackTime",value:function(){var E=this.pm.data.player_playhead_time;if(this._playbackTimeTrackerLastPlayheadPosition>=0&&E>this._playbackTimeTrackerLastPlayheadPosition){var M=E-this._playbackTimeTrackerLastPlayheadPosition;M<=1e3&&ke(this.pm.data,"view_content_playback_time",M)}this._playbackTimeTrackerLastPlayheadPosition=E}},{key:"_clearPlaybackTimeState",value:function(){this._updatePlaybackTime(),this._playbackTimeTrackerLastPlayheadPosition=-1}}])&&at(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function gt(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var Ft=function(){function S(E){(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E;var M=this._updatePlayheadTime.bind(this);E.on("playbackheartbeat",M),E.on("playbackheartbeatend",M),E.on("timeupdate",M),E.on("destroy",function(){E.off("timeupdate",M)})}var y,_;return y=S,(_=[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=this.pm.data.view_max_playhead_position===void 0?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(E,M){var ee=this,H=function(){ee.pm.currentFragmentPDT&&ee.pm.currentFragmentStart&&(ee.pm.data.player_program_time=ee.pm.currentFragmentPDT+ee.pm.data.player_playhead_time-ee.pm.currentFragmentStart)};if(M&&M.player_playhead_time)this.pm.data.player_playhead_time=M.player_playhead_time,H(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var be=this.pm.getPlayheadTime();be!==void 0&&(this.pm.data.player_playhead_time=be,H(),this._updateMaxPlayheadPosition())}}}])&&gt(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function Mt(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function xt(S,y,_){return y&&Mt(S.prototype,y),_&&Mt(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var Ot=xt(function S(y){if(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")}(this,S),!y.disableRebufferTracking){var _,E=function(ee,H){M(H),_=void 0},M=function(ee){if(_){var H=ee.viewer_time-_;ke(y.data,"view_rebuffer_duration",H),_=ee.viewer_time}y.data.view_watch_time>=0&&y.data.view_rebuffer_count>0&&(y.data.view_rebuffer_frequency=y.data.view_rebuffer_count/y.data.view_watch_time,y.data.view_rebuffer_percentage=y.data.view_rebuffer_duration/y.data.view_watch_time)};y.on("playbackheartbeat",function(ee,H){return M(H)}),y.on("rebufferstart",function(ee,H){_||(ke(y.data,"view_rebuffer_count",1),_=H.viewer_time,y.one("rebufferend",E))}),y.on("viewinit",function(){_=void 0,y.off("rebufferend",E)})}});function ht(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var ct=function(){function S(E){var M=this;(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,E.disableRebufferTracking||E.disablePlayheadRebufferTracking||(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,E.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),E.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),E.on("seeking",function(){M._cleanupRebufferTracker(null,{viewer_time:z.now()})}))}var y,_;return y=S,_=[{key:"_checkIfRebuffering",value:function(E,M){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing)this._cleanupRebufferTracker(E,M);else if(this._lastCheckedTime!==null)if(this._lastPlayheadTime===this.pm.data.player_playhead_time){var ee=M.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&ee>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=M.viewer_time}else this._cleanupRebufferTracker(E,M,!0);else this._prepareRebufferTrackerState(M.viewer_time)}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(E){this._lastCheckedTime=E,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=E}},{key:"_cleanupRebufferTracker",value:function(E,M){var ee=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:M.viewer_time});else{if(this._lastCheckedTime===null)return;var H=this.pm.data.player_playhead_time-this._lastPlayheadTime,be=M.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&H>0&&be-H>this.pm.minimumRebufferDuration&&(this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+be-H}))}ee?this._prepareRebufferTrackerState(M.viewer_time):this._clearRebufferTrackerState()}}],_&&ht(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}(),Pt=ct;function Ht(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var qt=function(){function S(E){var M=this;(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,E.on("viewinit",function(){var ee=E.data,H=ee.view_id;if(!ee.view_program_changed){var be=function(oe,Ve){var nt=Ve.viewer_time;oe.type==="playing"&&E.data.view_time_to_first_frame===void 0?M.calculateTimeToFirstFrame(nt||z.now(),H):oe.type!=="adplaying"||E.data.view_time_to_first_frame!==void 0&&!M._inPrerollPosition()||M.calculateTimeToFirstFrame(nt||z.now(),H)};E.one("playing",be),E.one("adplaying",be),E.one("viewend",function(){E.off("playing",be),E.off("adplaying",be)})}})}var y,_;return y=S,(_=[{key:"_inPrerollPosition",value:function(){return this.pm.data.view_content_playback_time===void 0||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(E,M){M===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:E}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}])&&Ht(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function nr(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function tr(S,y,_){return y&&nr(S.prototype,y),_&&nr(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var Lr=tr(function S(y){var _=this;(function(E,M){if(!(E instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S),y.on("viewinit",function(){_._lastPlayheadPosition=-1}),["pause","rebufferstart","seeking","error","adbreakstart","hb"].forEach(function(E){y.on(E,function(){if(_._lastPlayheadPosition>=0&&y.data.player_playhead_time>=0&&_._lastPlayerWidth>=0&&_._lastSourceWidth>0&&_._lastPlayerHeight>=0&&_._lastSourceHeight>0){var M=y.data.player_playhead_time-_._lastPlayheadPosition;if(M<0)return void(_._lastPlayheadPosition=-1);var ee=Math.min(_._lastPlayerWidth/_._lastSourceWidth,_._lastPlayerHeight/_._lastSourceHeight),H=Math.max(0,ee-1),be=Math.max(0,1-ee);y.data.view_max_upscale_percentage=Math.max(y.data.view_max_upscale_percentage||0,H),y.data.view_max_downscale_percentage=Math.max(y.data.view_max_downscale_percentage||0,be),ke(y.data,"view_total_content_playback_time",M),ke(y.data,"view_total_upscaling",H*M),ke(y.data,"view_total_downscaling",be*M)}_._lastPlayheadPosition=-1})}),["playing","hb"].forEach(function(E){y.on(E,function(){_._lastPlayheadPosition=y.data.player_playhead_time,_._lastPlayerWidth=y.data.player_width,_._lastPlayerHeight=y.data.player_height,_._lastSourceWidth=y.data.video_source_width,_._lastSourceHeight=y.data.video_source_height})})});function ge(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function $(S,y,_){return y&&ge(S.prototype,y),_&&ge(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var R=$(function S(y){var _=this;(function(E,M){if(!(E instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S),this.isSeeking=!1,y.on("seeking",function(E,M){G()(y.data,M),_._lastSeekingTime=z.now(),_.isSeeking===!1&&(_.isSeeking=!0,y.send("seeking"))}),y.on("seeked",function(){_.isSeeking=!1;var E=_._lastSeekingTime||z.now(),M=z.now()-E;ke(y.data,"view_seek_count",1),ke(y.data,"view_seek_duration",M);var ee=y.data.view_max_seek_time||0;y.data.view_max_seek_time=Math.max(ee,M)}),y.on("viewend",function(){_.isSeeking=!1})});function V(S,y){return function(_){if(Array.isArray(_))return _}(S)||function(_,E){var M=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(M!=null){var ee,H,be=[],oe=!0,Ve=!1;try{for(M=M.call(_);!(oe=(ee=M.next()).done)&&(be.push(ee.value),!E||be.length!==E);oe=!0);}catch(nt){Ve=!0,H=nt}finally{try{oe||M.return==null||M.return()}finally{if(Ve)throw H}}return be}}(S,y)||function(_,E){if(_){if(typeof _=="string")return j(_,E);var M=Object.prototype.toString.call(_).slice(8,-1);return M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set"?Array.from(_):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?j(_,E):void 0}}(S,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function j(S,y){(y==null||y>S.length)&&(y=S.length);for(var _=0,E=new Array(y);_<y;_++)E[_]=S[_];return E}function J(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}var pe=function(S,y){S.push(y),S.sort(function(_,E){return _.viewer_time-E.viewer_time})},ve=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror"],De=function(){function S(E){var M=this;(function(H,be){if(!(H instanceof be))throw new TypeError("Cannot call a class as a function")})(this,S),this.pm=E,E.on("viewinit",function(){M.isAdBreak=!1,M._currentAdRequestNumber=0,M._currentAdResponseNumber=0,M._adRequests=[],M._adResponses=[],M._adHasPlayed=!1,M._wouldBeNewAdPlay=!0,M._prerollPlayTime=void 0}),ve.forEach(function(H){return E.on(H,M._updateAdData.bind(M))});var ee=function(){M.isAdBreak=!1};E.on("adbreakstart",function(){M.isAdBreak=!0}),E.on("play",ee),E.on("playing",ee),E.on("viewend",ee),E.on("adrequest",function(H,be){be=G()({ad_request_id:"generatedAdRequestId"+M._currentAdRequestNumber++},be),pe(M._adRequests,be),ke(E.data,"view_ad_request_count"),M.inPrerollPosition()&&(E.data.view_preroll_requested=!0,M._adHasPlayed||ke(E.data,"view_preroll_request_count"))}),E.on("adresponse",function(H,be){be=G()({ad_request_id:"generatedAdRequestId"+M._currentAdResponseNumber++},be),pe(M._adResponses,be);var oe=M.findAdRequest(be.ad_request_id);oe&&ke(E.data,"view_ad_request_time",Math.max(0,be.viewer_time-oe.viewer_time))}),E.on("adplay",function(H,be){M._adHasPlayed=!0,M._wouldBeNewAdPlay&&(M._wouldBeNewAdPlay=!1,ke(E.data,"view_ad_played_count")),M.inPrerollPosition()&&!E.data.view_preroll_played&&(E.data.view_preroll_played=!0,M._adRequests.length>0&&(E.data.view_preroll_request_time=Math.max(0,be.viewer_time-M._adRequests[0].viewer_time)),E.data.view_start&&(E.data.view_startup_preroll_request_time=Math.max(0,be.viewer_time-E.data.view_start)),M._prerollPlayTime=be.viewer_time)}),E.on("adplaying",function(H,be){M.inPrerollPosition()&&E.data.view_preroll_load_time===void 0&&M._prerollPlayTime!==void 0&&(E.data.view_preroll_load_time=be.viewer_time-M._prerollPlayTime,E.data.view_startup_preroll_load_time=be.viewer_time-M._prerollPlayTime)}),E.on("adended",function(){M._wouldBeNewAdPlay=!0}),E.on("aderror",function(){M._wouldBeNewAdPlay=!0})}var y,_;return y=S,(_=[{key:"inPrerollPosition",value:function(){return this.pm.data.view_content_playback_time===void 0||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(E){for(var M=0;M<this._adRequests.length;M++)if(this._adRequests[M].ad_request_id===E)return this._adRequests[M]}},{key:"_updateAdData",value:function(E,M){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&M.ad_tag_url){var ee=V(me(M.ad_tag_url),2),H=ee[0],be=ee[1];this.pm.data.view_preroll_ad_tag_domain=be,this.pm.data.view_preroll_ad_tag_hostname=H}if(!this.pm.data.view_preroll_ad_asset_hostname&&M.ad_asset_url){var oe=V(me(M.ad_asset_url),2),Ve=oe[0],nt=oe[1];this.pm.data.view_preroll_ad_asset_domain=nt,this.pm.data.view_preroll_ad_asset_hostname=Ve}}}}])&&J(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function Fe(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function je(S,y,_){return y&&Fe(S.prototype,y),_&&Fe(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var qe=je(function S(y){var _,E;(function(be,oe){if(!(be instanceof oe))throw new TypeError("Cannot call a class as a function")})(this,S);var M=function(){y.disableRebufferTracking||_&&(ke(y.data,"view_waiting_rebuffer_duration",z.now()-_),_=!1,x().clearInterval(E))},ee=!1,H=function(){ee=!1,M()};y.on("waiting",function(){ee&&(y.disableRebufferTracking||(ke(y.data,"view_waiting_rebuffer_count",1),_=z.now(),E=x().setInterval(function(){if(_){var be=z.now();ke(y.data,"view_waiting_rebuffer_duration",be-_),_=be}},250)))}),y.on("playing",function(){M(),ee=!0}),y.on("pause",H),y.on("seeking",H)});function Je(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function Ye(S,y,_){return y&&Je(S.prototype,y),_&&Je(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var ot=Ye(function S(y){var _=this;(function(ee,H){if(!(ee instanceof H))throw new TypeError("Cannot call a class as a function")})(this,S);var E=function(){_.lastWallClockTime=z.now(),y.on("before*",M)},M=function(ee){var H=z.now(),be=_.lastWallClockTime;_.lastWallClockTime=H,H-be>3e4&&(y.emit("devicesleep",{viewer_time:be}),G()(y.data,{viewer_time:be}),y.send("devicesleep"),y.emit("devicewake",{viewer_time:H}),G()(y.data,{viewer_time:H}),y.send("devicewake"))};y.one("playbackheartbeat",E),y.on("playbackheartbeatend",function(){y.off("before*",M),y.one("playbackheartbeat",E)})}),Et=w(375),Ut=w(655),rt=w.n(Ut),Nt="muxData",lr=function(){var S;try{S=Et.parse(rt().get(Nt)||"")}catch{S={}}return S},Wt=function(S){try{rt().set(Nt,Et.stringify(S),{expires:7300})}catch{}},Vt=function(){var S=lr();return S.mux_viewer_id=S.mux_viewer_id||P(),S.msn=S.msn||Math.random(),Wt(S),{mux_viewer_id:S.mux_viewer_id,mux_sample_number:S.msn}};function Zt(S,y){var _=y.beaconCollectionDomain,E=y.beaconDomain;if(_)return"https://"+_;var M=E||"litix.io";return(S=S||"inferred").match(/^[a-z0-9]+$/)?"https://"+S+"."+M:"https://img.litix.io/a.gif"}var dt=function(){var S;switch(Tr()){case"cellular":S="cellular";break;case"ethernet":S="wired";break;case"wifi":S="wifi";break;case void 0:break;default:S="other"}return S},Tr=function(){var S=x().navigator,y=S&&(S.connection||S.mozConnection||S.webkitConnection);return y&&y.type};dt.getConnectionFromAPI=Tr;var Qr=dt,zt=Cr({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),ir=Cr({ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ep:"experiments",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function Cr(S){var y={};for(var _ in S)S.hasOwnProperty(_)&&(y[S[_]]=_);return y}function Zr(S){var y={},_={};return Object.keys(S).forEach(function(E){var M=!1;if(S.hasOwnProperty(E)&&S[E]!==void 0){var ee=E.split("_"),H=ee[0],be=zt[H];be||(de.info("Data key word `"+ee[0]+"` not expected in "+E),be=H+"_"),ee.splice(1).forEach(function(oe){oe==="url"&&(M=!0),ir[oe]?be+=ir[oe]:Number(oe)&&Math.floor(Number(oe))===Number(oe)?be+=oe:(de.info("Data key word `"+oe+"` not expected in "+E),be+="_"+oe+"_")}),M?_[be]=S[E]:y[be]=S[E]}}),G()(y,_)}var Ur={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},$t=["hb","requestcompleted","requestfailed","requestcanceled"],Ln="https://img.litix.io",$r=function(S){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=S||Ln,this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=G()({},Ur,y)};$r.prototype.queueEvent=function(S,y){var _=G()({},y);return(this._eventQueue.length<=this._options.maxQueueLength||S==="eventrateexceeded")&&(this._eventQueue.push(_),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},$r.prototype.flushEvents=function(){var S=arguments.length>0&&arguments[0]!==void 0&&arguments[0];S&&this._eventQueue.length===1?this._eventQueue.pop():(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},$r.prototype.destroy=function(){var S=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.destroyed=!0,S?this._clearBeaconQueue():this.flushEvents(),x().clearTimeout(this._sendTimeout)},$r.prototype._clearBeaconQueue=function(){var S=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,y=this._eventQueue.slice(S);S>0&&G()(y[y.length-1],Zr({mux_view_message:"event queue truncated"}));var _=this._createPayload(y);Rn(this._beaconUrl,_,!0,function(){})},$r.prototype._sendBeaconQueue=function(){var S=this;if(!this._postInFlight){var y=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var _=this._createPayload(y),E=z.now();Rn(this._beaconUrl,_,!1,function(M,ee){ee?(S._eventQueue=y.concat(S._eventQueue),S._failureCount+=1,de.info("Error sending beacon: "+ee)):S._failureCount=0,S._roundTripTime=z.now()-E,S._postInFlight=!1})}},$r.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var S=Math.pow(2,this._failureCount-1);return(1+(S*=Math.random()))*this._options.baseTimeBetweenBeacons},$r.prototype._startBeaconSending=function(){var S=this;x().clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=x().setTimeout(function(){S._eventQueue.length&&S._sendBeaconQueue(),S._startBeaconSending()},this._getNextBeaconTime()))},$r.prototype._createPayload=function(S){var y,_,E,M=this,ee={transmission_timestamp:Math.round(z.now())};this._roundTripTime&&(ee.rtt_ms=Math.round(this._roundTripTime));var H=function(){y=JSON.stringify({metadata:ee,events:_||S}),E=y.length/1024},be=function(){return E<=M._options.maxPayloadKBSize};return H(),be()||(de.info("Payload size is too big ("+E+" kb). Removing unnecessary events."),_=S.filter(function(oe){return $t.indexOf(oe.e)===-1}),H()),be()||(de.info("Payload size still too big ("+E+" kb). Cropping fields.."),_.forEach(function(oe){for(var Ve in oe){var nt=oe[Ve];typeof nt=="string"&&nt.length>51200&&(oe[Ve]=nt.substring(0,51200))}}),H()),y};var Rn=function(S,y,_,E){if(_&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(S,y))E();else if(x().fetch)x().fetch(S,{method:"POST",body:y,headers:{"Content-Type":"text/plain"},keepalive:!0}).then(function(ee){return E(null,ee.ok?null:"Error")}).catch(function(ee){return E(null,ee)});else{if(x().XMLHttpRequest){var M=new(x()).XMLHttpRequest;return M.onreadystatechange=function(){if(M.readyState===4)return E(null,M.status!==200?"error":void 0)},M.open("POST",S),M.setRequestHeader("Content-Type","text/plain"),void M.send(y)}E()}},Cn=$r;function Sa(S,y){return function(_){if(Array.isArray(_))return _}(S)||function(_,E){var M=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(M!=null){var ee,H,be=[],oe=!0,Ve=!1;try{for(M=M.call(_);!(oe=(ee=M.next()).done)&&(be.push(ee.value),!E||be.length!==E);oe=!0);}catch(nt){Ve=!0,H=nt}finally{try{oe||M.return==null||M.return()}finally{if(Ve)throw H}}return be}}(S,y)||function(_,E){if(_){if(typeof _=="string")return xn(_,E);var M=Object.prototype.toString.call(_).slice(8,-1);return M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set"?Array.from(_):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?xn(_,E):void 0}}(S,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function xn(S,y){(y==null||y>S.length)&&(y=S.length);for(var _=0,E=new Array(y);_<y;_++)E[_]=S[_];return E}function on(S,y){var _=Object.keys(S);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(S);y&&(E=E.filter(function(M){return Object.getOwnPropertyDescriptor(S,M).enumerable})),_.push.apply(_,E)}return _}function si(S){for(var y=1;y<arguments.length;y++){var _=arguments[y]!=null?arguments[y]:{};y%2?on(Object(_),!0).forEach(function(E){ln(S,E,_[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(_)):on(Object(_)).forEach(function(E){Object.defineProperty(S,E,Object.getOwnPropertyDescriptor(_,E))})}return S}function Yi(S){return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},Yi(S)}function Ms(S,y){if(!(S instanceof y))throw new TypeError("Cannot call a class as a function")}function Ps(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function ln(S,y,_){return y in S?Object.defineProperty(S,y,{value:_,enumerable:!0,configurable:!0,writable:!0}):S[y]=_,S}var On=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],Fr=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse"],Lt=["viewstart","error","ended","viewend"],Aa=function(){function S(E,M){var ee,H,be,oe,Ve,nt,ut,bt,Ze,pt,_t,ur,dr,Jt,It,sr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ms(this,S),ln(this,"previousBeaconData",null),ln(this,"lastEventTime",0),ln(this,"rateLimited",!1),this.mux=E,this.envKey=M,this.options=sr,this.eventQueue=new Cn(Zt(this.envKey,this.options)),this.sampleRate=(ee=this.options.sampleRate)!==null&&ee!==void 0?ee:1,this.disableCookies=(H=this.options.disableCookies)!==null&&H!==void 0&&H,this.respectDoNotTrack=(be=this.options.respectDoNotTrack)!==null&&be!==void 0&&be,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(oe=this.options.platform)===null||oe===void 0?void 0:oe.name,viewer_application_version:(Ve=this.options.platform)===null||Ve===void 0?void 0:Ve.version,viewer_application_engine:(nt=this.options.platform)===null||nt===void 0?void 0:nt.layout,viewer_device_name:(ut=this.options.platform)===null||ut===void 0?void 0:ut.product,viewer_device_category:"",viewer_device_manufacturer:(bt=this.options.platform)===null||bt===void 0?void 0:bt.manufacturer,viewer_os_family:(Ze=this.options.platform)===null||Ze===void 0||(pt=Ze.os)===null||pt===void 0?void 0:pt.family,viewer_os_architecture:(_t=this.options.platform)===null||_t===void 0||(ur=_t.os)===null||ur===void 0?void 0:ur.architecture,viewer_os_version:(dr=this.options.platform)===null||dr===void 0||(Jt=dr.os)===null||Jt===void 0?void 0:Jt.version,viewer_connection_type:Qr(),page_url:x()===null||x()===void 0||(It=x().location)===null||It===void 0?void 0:It.href},this.viewerData=this.disableCookies?{}:Vt()}var y,_;return y=S,(_=[{key:"send",value:function(E,M){var ee;if(E){if(this.respectDoNotTrack&&re())return de.info("Not sending `"+E+"` because Do Not Track is enabled");if(!M||Yi(M)!=="object")return de.error("A data object was expected in send() but was not provided");var H,be,oe=this.disableCookies?{}:(H=lr(),be=z.now(),H.session_start&&(H.sst=H.session_start,delete H.session_start),H.session_id&&(H.sid=H.session_id,delete H.session_id),H.session_expires&&(H.sex=H.session_expires,delete H.session_expires),(!H.sex||H.sex<be)&&(H.sid=P(),H.sst=be),H.sex=be+15e5,Wt(H),{session_id:H.sid,session_start:H.sst,session_expires:H.sex}),Ve=si(si(si(si(si({},this.pageLevelData),M),oe),this.viewerData),{},{event:E,env_key:this.envKey});Ve.user_id&&(Ve.viewer_user_id=Ve.user_id,delete Ve.user_id);var nt=((ee=Ve.mux_sample_number)!==null&&ee!==void 0?ee:0)>=this.sampleRate,ut=Zr(this._deduplicateBeaconData(E,Ve));if(this.lastEventTime=this.mux.utils.now(),nt)return de.info("Not sending event due to sample rate restriction",E,Ve,ut);if(this.envKey||de.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",E,Ve,ut),!this.rateLimited){if(de.info("Sending event",E,Ve,ut),this.rateLimited=!this.eventQueue.queueEvent(E,ut),this.mux.WINDOW_UNLOADING&&E==="viewend")this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&E==="hb"?this.eventQueue.flushEvents(!0):Lt.indexOf(E)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return Ve.event="eventrateexceeded",ut=Zr(Ve),this.eventQueue.queueEvent(Ve.event,ut),de.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(E,M){var ee=this,H={},be=M.view_id;if(!be||E==="viewstart"||E==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)H=si({},M),be&&(this.previousBeaconData=H),be&&E==="viewend"&&(this.previousBeaconData=null);else{var oe=E.indexOf("request")===0;Object.entries(M).forEach(function(Ve){var nt=Sa(Ve,2),ut=nt[0],bt=nt[1];ee.previousBeaconData&&(bt!==ee.previousBeaconData[ut]||On.indexOf(ut)>-1||ee.objectHasChanged(oe,ut,bt,ee.previousBeaconData[ut])||ee.eventRequiresKey(E,ut))&&(H[ut]=bt,ee.previousBeaconData[ut]=bt)})}return H}},{key:"objectHasChanged",value:function(E,M,ee,H){return!(!E||M.indexOf("request_")!==0||M!=="request_response_headers"&&Yi(ee)==="object"&&Yi(H)==="object"&&Object.keys(ee||{}).length===Object.keys(H||{}).length)}},{key:"eventRequiresKey",value:function(E,M){return E==="renditionchange"&&M.indexOf("video_source_")===0||!(M.indexOf("ad_id")!==0||!Fr.includes(E))}}])&&Ps(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),S}();function yi(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function Li(S,y,_){return y&&yi(S.prototype,y),_&&yi(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var un=Li(function S(y){(function(Ve,nt){if(!(Ve instanceof nt))throw new TypeError("Cannot call a class as a function")})(this,S);var _=0,E=0,M=0,ee=0,H=0,be=0,oe=0;y.on("requestcompleted",function(Ve,nt){var ut,bt,Ze=nt.request_start,pt=nt.request_response_start,_t=nt.request_response_end,ur=nt.request_bytes_loaded;if(ee++,pt?(ut=pt-Ze,bt=_t-pt):bt=_t-Ze,bt>0&&ur>0){var dr=ur/bt*8e3;H++,E+=ur,M+=bt,y.data.view_min_request_throughput=Math.min(y.data.view_min_request_throughput||1/0,dr),y.data.view_average_request_throughput=E/M*8e3,y.data.view_request_count=ee,ut>0&&(_+=ut,y.data.view_max_request_latency=Math.max(y.data.view_max_request_latency||0,ut),y.data.view_average_request_latency=_/H)}}),y.on("requestfailed",function(Ve,nt){ee++,be++,y.data.view_request_count=ee,y.data.view_request_failed_count=be}),y.on("requestcanceled",function(Ve,nt){ee++,oe++,y.data.view_request_count=ee,y.data.view_request_canceled_count=oe})});function Nr(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function zi(S,y,_){return y&&Nr(S.prototype,y),_&&Nr(S,_),Object.defineProperty(S,"prototype",{writable:!1}),S}var Xi=zi(function S(y){var _=this;(function(E,M){if(!(E instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S),y.on("before*",function(E,M){var ee=M.viewer_time,H=z.now(),be=_._lastEventTime;if(_._lastEventTime=H,be&&H-be>36e5){var oe=Object.keys(y.data).reduce(function(Ve,nt){return nt.indexOf("video_")===0?G()(Ve,function(ut,bt,Ze){return bt in ut?Object.defineProperty(ut,bt,{value:Ze,enumerable:!0,configurable:!0,writable:!0}):ut[bt]=Ze,ut}({},nt,y.data[nt])):Ve},{});y.mux.log.info("Received event after at least an hour inactivity, creating a new view"),y.emit("viewinit",G()({viewer_time:ee},oe)),y.playbackHeartbeat._playheadShouldBeProgressing&&E.type!=="play"&&E.type!=="adbreakstart"&&(y.emit("play",{viewer_time:ee}),E.type!=="playing"&&y.emit("playing",{viewer_time:ee}))}})});function Br(S){return Br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},Br(S)}function Qi(S,y){return function(_){if(Array.isArray(_))return _}(S)||function(_,E){var M=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(M!=null){var ee,H,be=[],oe=!0,Ve=!1;try{for(M=M.call(_);!(oe=(ee=M.next()).done)&&(be.push(ee.value),!E||be.length!==E);oe=!0);}catch(nt){Ve=!0,H=nt}finally{try{oe||M.return==null||M.return()}finally{if(Ve)throw H}}return be}}(S,y)||function(_,E){if(_){if(typeof _=="string")return Ei(_,E);var M=Object.prototype.toString.call(_).slice(8,-1);return M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set"?Array.from(_):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?Ei(_,E):void 0}}(S,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ei(S,y){(y==null||y>S.length)&&(y=S.length);for(var _=0,E=new Array(y);_<y;_++)E[_]=S[_];return E}function Mn(S,y){for(var _=0;_<y.length;_++){var E=y[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function Zi(S,y){return Zi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,E){return _.__proto__=E,_},Zi(S,y)}function wa(S){var y=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var _,E=Ji(S);if(y){var M=Ji(this).constructor;_=Reflect.construct(E,arguments,M)}else _=E.apply(this,arguments);return Pn(this,_)}}function Pn(S,y){if(y&&(Br(y)==="object"||typeof y=="function"))return y;if(y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ar(S)}function ar(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function Ji(S){return Ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},Ji(S)}var Us=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],Fs=function(S){(function(ee,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(H&&H.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),Object.defineProperty(ee,"prototype",{writable:!1}),H&&Zi(ee,H)})(M,S);var y,_,E=wa(M);function M(ee,H,be){var oe;(function(Ze,pt){if(!(Ze instanceof pt))throw new TypeError("Cannot call a class as a function")})(this,M),(oe=E.call(this)).DOM_CONTENT_LOADED_EVENT_END=Ae.domContentLoadedEventEnd(),oe.NAVIGATION_START=Ae.navigationStart(),oe.mux=ee,oe.id=H,(be=G()({debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(Ze){return Ze}},be)).data=be.data||{},be.data.property_key&&(be.data.env_key=be.data.property_key,delete be.data.property_key),de.setLevel(be.debug?"debug":"warn"),oe.getPlayheadTime=be.getPlayheadTime,oe.getStateData=be.getStateData||function(){return{}},oe.getAdData=be.getAdData||function(){},oe.minimumRebufferDuration=be.minimumRebufferDuration,oe.sustainedRebufferThreshold=be.sustainedRebufferThreshold,oe.playbackHeartbeatTime=be.playbackHeartbeatTime,oe.disableRebufferTracking=be.disableRebufferTracking,oe.disableRebufferTracking&&oe.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),oe.disablePlayheadRebufferTracking=be.disablePlayheadRebufferTracking,oe.errorTranslator=be.errorTranslator,oe.playbackEventDispatcher=new Aa(ee,be.data.env_key,be),oe.data={player_instance_id:P(),mux_sample_rate:be.sampleRate,beacon_domain:be.beaconCollectionDomain?be.beaconCollectionDomain:be.beaconDomain},oe.data.view_sequence_number=1,oe.data.player_sequence_number=1,oe.oldEmit=oe.emit,oe.emit=function(Ze,pt){pt=G()({viewer_time:this.mux.utils.now()},pt),this.oldEmit(Ze,pt)};var Ve=function(){this.data.view_start===void 0&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(ar(oe));oe.on("viewinit",function(Ze,pt){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),G()(this.data,pt),this._initializeViewData(),this.one("play",Ve),this.one("adbreakstart",Ve)});var nt=function(Ze){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",Ze)}.bind(ar(oe));if(oe.on("videochange",function(Ze,pt){nt(pt)}),oe.on("programchange",function(Ze,pt){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),nt(G()(pt,{view_program_changed:!0})),Ve(),this.emit("play"),this.emit("playing")}),oe.on("fragmentchange",function(Ze,pt){this.currentFragmentPDT=pt.currentFragmentPDT,this.currentFragmentStart=pt.currentFragmentStart}),oe.on("destroy",oe.destroy),typeof window<"u"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var ut=function(){var Ze=oe.data.view_start!==void 0;oe.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",Ze&&oe.mux.WINDOW_HIDDEN&&(oe.data.player_is_paused||oe.emit("hb"))};window.addEventListener("visibilitychange",ut,!1);var bt=function(Ze){Ze.persisted||oe.destroy()};window.addEventListener("pagehide",bt,!1),oe.on("destroy",function(){window.removeEventListener("visibilitychange",ut),window.removeEventListener("pagehide",bt)})}return oe.on("playerready",function(Ze,pt){G()(this.data,pt)}),Us.forEach(function(Ze){oe.on(Ze,function(pt,_t){Ze.indexOf("ad")!==0&&this._updateStateData(),G()(this.data,_t),this._sanitizeData()}),oe.on("after"+Ze,function(){(Ze!=="error"||this.errorTracker.viewErrored)&&this.send(Ze)})}),oe.on("viewend",function(Ze,pt){G()(oe.data,pt)}),oe.one("playerready",function(Ze){var pt=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=pt-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time}),oe.longResumeTracker=new Xi(ar(oe)),oe.errorTracker=new _e(ar(oe)),new ot(ar(oe)),oe.seekingTracker=new R(ar(oe)),oe.playheadTime=new Ft(ar(oe)),oe.playbackHeartbeat=new Me(ar(oe)),new Lr(ar(oe)),oe.watchTimeTracker=new Xe(ar(oe)),new mt(ar(oe)),oe.adTracker=new De(ar(oe)),new Pt(ar(oe)),new Ot(ar(oe)),new qt(ar(oe)),new qe(ar(oe)),new un(ar(oe)),be.hlsjs&&oe.addHLSJS(be),be.dashjs&&oe.addDashJS(be),oe.emit("viewinit",be.data),oe}return y=M,_=[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.data.view_start!==void 0&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(ee){var H=G()({},this.data);if(H.video_source_is_live===void 0&&(H.player_source_duration===1/0||H.video_source_duration===1/0?H.video_source_is_live=!0:(H.player_source_duration>0||H.video_source_duration>0)&&(H.video_source_is_live=!1)),H.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach(function(nt){H[nt]=void 0}),H.video_source_url=H.video_source_url||H.player_source_url,H.video_source_url){var be=Qi(me(H.video_source_url),2),oe=be[0],Ve=be[1];H.video_source_domain=Ve,H.video_source_hostname=oe}delete H.ad_request_id,this.playbackEventDispatcher.send(ee,H),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat()}},{key:"_updateStateData",value:function(){G()(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var ee=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach(function(H){var be=parseInt(ee.data[H],10);ee.data[H]=isNaN(be)?void 0:be}),["player_source_url","video_source_url"].forEach(function(H){if(ee.data[H]){var be=ee.data[H].toLowerCase();be.indexOf("data:")!==0&&be.indexOf("blob:")!==0||(ee.data[H]="MSE style URL")}})}},{key:"_resetVideoData",value:function(ee,H){var be=this;Object.keys(this.data).forEach(function(oe){oe.indexOf("video_")===0&&delete be.data[oe]})}},{key:"_resetViewData",value:function(){var ee=this;Object.keys(this.data).forEach(function(H){H.indexOf("view_")===0&&delete ee.data[H]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(ee,H){delete this.data.player_error_code,delete this.data.player_error_message}},{key:"_initializeViewData",value:function(){var ee=this,H=this.data.view_id=P(),be=function(){H===ee.data.view_id&&ke(ee.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",be):be()}},{key:"_restartHeartBeat",value:function(){var ee=this;window.clearTimeout(this._heartBeatTimeout),this.errorTracker.viewErrored||(this._heartBeatTimeout=window.setTimeout(function(){ee.data.player_is_paused||ee.emit("hb")},1e4))}},{key:"addHLSJS",value:function(ee){ee.hlsjs?this.hlsjs?this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=ee.hlsjs,function(H,be,oe){var Ve=arguments.length>4?arguments[4]:void 0,nt=H.log,ut=H.utils.secondsToMs,bt=function(Rt){var tt,Tt=parseInt(Ve.version);return Tt===1&&Rt.programDateTime!==null&&(tt=Rt.programDateTime),Tt===0&&Rt.pdt!==null&&(tt=Rt.pdt),tt};if(Ae.exists()){var Ze=function(Rt,tt){return H.emit(be,Rt,tt)},pt=function(Rt,tt){var Tt=tt.levels,it=tt.audioTracks,vt=tt.url,Yt=tt.stats,Xt=tt.networkDetails,Er=tt.sessionData,mr={},Ar={};Tt.forEach(function(xr,Ti){mr[Ti]={width:xr.width,height:xr.height,bitrate:xr.bitrate,attrs:xr.attrs}}),it.forEach(function(xr,Ti){Ar[Ti]={name:xr.name,language:xr.lang,bitrate:xr.bitrate}});var Sr=ne(Yt),Yr=Sr.bytesLoaded,cr=Sr.requestStart,wr=Sr.responseStart,tn=Sr.responseEnd;Ze("requestcompleted",se(se({},W(Er)),{},{request_event_type:Rt,request_bytes_loaded:Yr,request_start:cr,request_response_start:wr,request_response_end:tn,request_type:"manifest",request_hostname:Y(vt),request_response_headers:Te(Xt),request_rendition_lists:{media:mr,audio:Ar,video:{}}}))};oe.on(Ve.Events.MANIFEST_LOADED,pt);var _t=function(Rt,tt){var Tt=tt.details,it=tt.level,vt=tt.networkDetails,Yt=tt.stats,Xt=ne(Yt),Er=Xt.bytesLoaded,mr=Xt.requestStart,Ar=Xt.responseStart,Sr=Xt.responseEnd,Yr=Tt.fragments[Tt.fragments.length-1],cr=bt(Yr)+ut(Yr.duration);Ze("requestcompleted",{request_event_type:Rt,request_bytes_loaded:Er,request_start:mr,request_response_start:Ar,request_response_end:Sr,request_current_level:it,request_type:"manifest",request_hostname:Y(Tt.url),request_response_headers:Te(vt),video_holdback:Tt.holdBack&&ut(Tt.holdBack),video_part_holdback:Tt.partHoldBack&&ut(Tt.partHoldBack),video_part_target_duration:Tt.partTarget&&ut(Tt.partTarget),video_target_duration:Tt.targetduration&&ut(Tt.targetduration),video_source_is_live:Tt.live,player_manifest_newest_program_time:isNaN(cr)?void 0:cr})};oe.on(Ve.Events.LEVEL_LOADED,_t);var ur=function(Rt,tt){var Tt=tt.details,it=tt.networkDetails,vt=tt.stats,Yt=ne(vt),Xt=Yt.bytesLoaded,Er=Yt.requestStart,mr=Yt.responseStart,Ar=Yt.responseEnd;Ze("requestcompleted",{request_event_type:Rt,request_bytes_loaded:Xt,request_start:Er,request_response_start:mr,request_response_end:Ar,request_type:"manifest",request_hostname:Y(Tt.url),request_response_headers:Te(it)})};oe.on(Ve.Events.AUDIO_TRACK_LOADED,ur);var dr=function(Rt,tt){var Tt=tt.stats,it=tt.networkDetails,vt=tt.frag;Tt=Tt||vt.stats;var Yt=ne(Tt),Xt=Yt.bytesLoaded,Er=Yt.requestStart,mr=Yt.responseStart,Ar=Yt.responseEnd,Sr=Te(it),Yr=Sr==null?void 0:Sr["x-request-id"],cr={request_event_type:Rt,request_bytes_loaded:Xt,request_start:Er,request_response_start:mr,request_response_end:Ar,request_hostname:it?Y(it.responseURL):void 0,request_id:Yr,request_response_headers:Sr,request_media_duration:vt.duration,request_url:it==null?void 0:it.responseURL};vt.type==="main"?(cr.request_type="media",cr.request_current_level=vt.level,cr.request_video_width=(oe.levels[vt.level]||{}).width,cr.request_video_height=(oe.levels[vt.level]||{}).height,cr.request_labeled_bitrate=(oe.levels[vt.level]||{}).bitrate):cr.request_type=vt.type,Ze("requestcompleted",cr)};oe.on(Ve.Events.FRAG_LOADED,dr);var Jt=function(Rt,tt){var Tt=tt.frag,it=Tt.start,vt={currentFragmentPDT:bt(Tt),currentFragmentStart:ut(it)};Ze("fragmentchange",vt)};oe.on(Ve.Events.FRAG_CHANGED,Jt);var It=function(Rt,tt){var Tt=tt.type,it=tt.details,vt=tt.response,Yt=tt.fatal,Xt=tt.frag,Er=(Xt==null?void 0:Xt.url)||tt.url||"";if(it!==Ve.ErrorDetails.MANIFEST_LOAD_ERROR&&it!==Ve.ErrorDetails.MANIFEST_LOAD_TIMEOUT&&it!==Ve.ErrorDetails.FRAG_LOAD_ERROR&&it!==Ve.ErrorDetails.FRAG_LOAD_TIMEOUT&&it!==Ve.ErrorDetails.LEVEL_LOAD_ERROR&&it!==Ve.ErrorDetails.LEVEL_LOAD_TIMEOUT&&it!==Ve.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&it!==Ve.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT&&it!==Ve.ErrorDetails.SUBTITLE_LOAD_ERROR&&it!==Ve.ErrorDetails.SUBTITLE_LOAD_TIMEOUT&&it!==Ve.ErrorDetails.KEY_LOAD_ERROR&&it!==Ve.ErrorDetails.KEY_LOAD_TIMEOUT||Ze("requestfailed",{request_error:it,request_url:Er,request_hostname:Y(Er),request_type:it===Ve.ErrorDetails.FRAG_LOAD_ERROR||it===Ve.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":it===Ve.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||it===Ve.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":it===Ve.ErrorDetails.SUBTITLE_LOAD_ERROR||it===Ve.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":it===Ve.ErrorDetails.KEY_LOAD_ERROR||it===Ve.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:vt==null?void 0:vt.code,request_error_text:vt==null?void 0:vt.text}),Yt){var mr,Ar="".concat(Er?"url: ".concat(Er,`
`):"")+"".concat(vt&&(vt.code||vt.text)?"response: ".concat(vt.code,", ").concat(vt.text,`
`):"")+"".concat(tt.reason?"failure reason: ".concat(tt.reason,`
`):"")+"".concat(tt.level?"level: ".concat(tt.level,`
`):"")+"".concat(tt.parent?"parent stream controller: ".concat(tt.parent,`
`):"")+"".concat(tt.buffer?"buffer length: ".concat(tt.buffer,`
`):"")+"".concat(tt.error?"error: ".concat(tt.error,`
`):"")+"".concat(tt.event?"event: ".concat(tt.event,`
`):"")+"".concat(tt.err?"error message: ".concat((mr=tt.err)===null||mr===void 0?void 0:mr.message,`
`):"");Ze("error",{player_error_code:Tt,player_error_message:it,player_error_context:Ar})}};oe.on(Ve.Events.ERROR,It);var sr=function(Rt,tt){var Tt=tt.frag,it=Tt&&Tt._url||"";Ze("requestcanceled",{request_event_type:Rt,request_url:it,request_type:"media",request_hostname:Y(it)})};oe.on(Ve.Events.FRAG_LOAD_EMERGENCY_ABORTED,sr);var rr=function(Rt,tt){var Tt=tt.level,it=oe.levels[Tt];if(it&&it.attrs&&it.attrs.BANDWIDTH){var vt,Yt=it.attrs.BANDWIDTH,Xt=parseFloat(it.attrs["FRAME-RATE"]);isNaN(Xt)||(vt=Xt),Yt?Ze("renditionchange",{video_source_fps:vt,video_source_bitrate:Yt,video_source_width:it.width,video_source_height:it.height,video_source_rendition_name:it.name,video_source_codec:it==null?void 0:it.videoCodec}):nt.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};oe.on(Ve.Events.LEVEL_SWITCHED,rr),oe._stopMuxMonitor=function(){oe.off(Ve.Events.MANIFEST_LOADED,pt),oe.off(Ve.Events.LEVEL_LOADED,_t),oe.off(Ve.Events.AUDIO_TRACK_LOADED,ur),oe.off(Ve.Events.FRAG_LOADED,dr),oe.off(Ve.Events.FRAG_CHANGED,Jt),oe.off(Ve.Events.ERROR,It),oe.off(Ve.Events.FRAG_LOAD_EMERGENCY_ABORTED,sr),oe.off(Ve.Events.LEVEL_SWITCHED,rr),oe.off(Ve.Events.DESTROYING,oe._stopMuxMonitor),delete oe._stopMuxMonitor},oe.on(Ve.Events.DESTROYING,oe._stopMuxMonitor)}else nt.warn("performance timing not supported. Not tracking HLS.js.")}(this.mux,this.id,ee.hlsjs,{},ee.Hls||window.Hls)):this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")}},{key:"removeHLSJS",value:function(){var ee;this.hlsjs&&((ee=this.hlsjs)&&typeof ee._stopMuxMonitor=="function"&&ee._stopMuxMonitor(),this.hlsjs=void 0)}},{key:"addDashJS",value:function(ee){ee.dashjs?this.dashjs?this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=ee.dashjs,function(H,be,oe){var Ve=H.log;if(oe&&oe.on){var nt=function(It,sr){return H.emit(be,It,sr)},ut=function(It){var sr=It.type,rr=(It.data||{}).url;nt("requestcompleted",{request_event_type:sr,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:Y(rr),request_url:rr})};oe.on("manifestLoaded",ut);var bt={},Ze=function(It){var sr=It.type,rr=It.fragmentModel,Rt=(It.chunk||{}).mediaInfo||{},tt=Rt.type,Tt=Rt.bitrateList,it={};(Tt=Tt||[]).forEach(function(cr,wr){it[wr]={},it[wr].width=cr.width,it[wr].height=cr.height,it[wr].bitrate=cr.bandwidth,it[wr].attrs={}}),tt==="video"?bt.video=it:tt==="audio"?bt.audio=it:bt.media=it;var vt=we(rr,oe),Yt=vt.requestStart,Xt=vt.requestResponseStart,Er=vt.requestResponseEnd,mr=vt.requestResponseHeaders,Ar=vt.requestMediaDuration,Sr=vt.requestHostname,Yr=vt.requestUrl;nt("requestcompleted",{request_event_type:sr,request_start:Yt,request_response_start:Xt,request_response_end:Er,request_bytes_loaded:-1,request_type:tt+"_init",request_response_headers:mr,request_hostname:Sr,request_url:Yr,request_media_duration:Ar,request_rendition_lists:bt})};oe.on("initFragmentLoaded",Ze);var pt=function(It){var sr=It.type,rr=It.fragmentModel,Rt=It.chunk||{},tt=Rt.mediaInfo,Tt=Rt.start,it=(tt||{}).type,vt=we(rr,oe),Yt=vt.requestStart,Xt=vt.requestResponseStart,Er=vt.requestResponseEnd,mr=vt.requestBytesLoaded,Ar=vt.requestResponseHeaders,Sr=vt.requestMediaDuration,Yr=vt.requestHostname,cr=vt.requestUrl,wr=Ke(it,oe),tn=wr.currentLevel,xr=wr.renditionWidth,Ti=wr.renditionHeight,qn=wr.renditionBitrate;nt("requestcompleted",{request_event_type:sr,request_start:Yt,request_response_start:Xt,request_response_end:Er,request_bytes_loaded:mr,request_type:it,request_response_headers:Ar,request_hostname:Yr,request_url:cr,request_media_start_time:Tt,request_media_duration:Sr,request_current_level:tn,request_labeled_bitrate:qn,request_video_width:xr,request_video_height:Ti})};oe.on("mediaFragmentLoaded",pt);var _t={video:void 0,audio:void 0,totalBitrate:void 0},ur=function(){if(_t.video&&typeof _t.video.bitrate=="number"){if(_t.video.width&&_t.video.height){var It=_t.video.bitrate;return _t.audio&&typeof _t.audio.bitrate=="number"&&(It+=_t.audio.bitrate),It!==_t.totalBitrate?(_t.totalBitrate=It,{video_source_bitrate:It,video_source_height:_t.video.height,video_source_width:_t.video.width,video_source_codec:We(_t.video.codec)}):void 0}Ve.warn("have bitrate info for video but missing width/height")}},dr=function(It,sr,rr){if(typeof It.newQuality=="number"){var Rt=It.mediaType;if(Rt==="audio"||Rt==="video"){var tt=oe.getBitrateInfoListFor(Rt).find(function(it){return it.qualityIndex===It.newQuality});if(tt&&typeof tt.bitrate=="number"){_t[Rt]=le(le({},tt),{},{codec:oe.getCurrentTrackFor(Rt).codec});var Tt=ur();Tt&&nt("renditionchange",Tt)}else Ve.warn("missing bitrate info for ".concat(Rt))}}else Ve.warn("missing evt.newQuality in qualityChangeRendered event",It)};oe.on("qualityChangeRendered",dr);var Jt=function(It){var sr=It.error,rr=It.event,Rt=(rr=rr||{}).request||{},tt=x().event&&x().event.currentTarget||{};nt("requestfailed",{request_error:sr+"_"+rr.id+"_"+Rt.type,request_url:rr.url,request_hostname:Y(rr.url),request_type:Rt.mediaType,request_error_code:tt.status,request_error_type:tt.statusText})};oe.on("error",Jt),oe._stopMuxMonitor=function(){oe.off("manifestLoaded",ut),oe.off("initFragmentLoaded",Ze),oe.off("mediaFragmentLoaded",pt),oe.off("qualityChangeRendered",dr),oe.off("error",Jt),delete oe._stopMuxMonitor}}else Ve.warn("Invalid dash.js player reference. Monitoring blocked.")}(this.mux,this.id,ee.dashjs)):this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")}},{key:"removeDashJS",value:function(){var ee;this.dashjs&&((ee=this.dashjs)&&typeof ee._stopMuxMonitor=="function"&&ee._stopMuxMonitor(),this.dashjs=void 0)}}],_&&Mn(y.prototype,_),Object.defineProperty(y,"prototype",{writable:!1}),M}(Re),ka=Fs,bi=w(153),_i=w.n(bi);function Un(S){return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},Un(S)}function dn(S,y){return function(_){if(Array.isArray(_))return _}(S)||function(_,E){var M=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(M!=null){var ee,H,be=[],oe=!0,Ve=!1;try{for(M=M.call(_);!(oe=(ee=M.next()).done)&&(be.push(ee.value),!E||be.length!==E);oe=!0);}catch(nt){Ve=!0,H=nt}finally{try{oe||M.return==null||M.return()}finally{if(Ve)throw H}}return be}}(S,y)||function(_,E){if(_){if(typeof _=="string")return Fn(_,E);var M=Object.prototype.toString.call(_).slice(8,-1);return M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set"?Array.from(_):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?Fn(_,E):void 0}}(S,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Fn(S,y){(y==null||y>S.length)&&(y=S.length);for(var _=0,E=new Array(y);_<y;_++)E[_]=S[_];return E}var Ri,Ns=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],Nn={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};x()&&x().WeakMap&&(Ri=new WeakMap);var Bs="#EXT-X-TARGETDURATION",cn="#EXT-X-PART-INF",Hs="#EXT-X-SERVER-CONTROL",js="#EXTINF",Gs="#EXT-X-PROGRAM-DATE-TIME",Ia="#EXT-X-VERSION",hn="#EXT-X-SESSION-DATA",Ci=function(S){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(S),this.manifest};Ci.prototype.process=function(S){var y;for(this.buffer+=S,y=this.buffer.indexOf(`
`);y>-1;y=this.buffer.indexOf(`
`))this.processLine(this.buffer.substring(0,y)),this.buffer=this.buffer.substring(y+1)},Ci.prototype.processLine=function(S){var y=S.indexOf(":"),_=Gn(S,y),E=_[0],M=_.length===2?Hn(_[1]):void 0;if(E[0]!=="#")this.currentUri.uri=E,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(E){case Bs:if(!isFinite(M)||M<0)return;this.manifest.targetDuration=M,this.setHoldBack();break;case cn:Bn(this.manifest,_),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case Hs:Bn(this.manifest,_),this.setHoldBack();break;case js:M===0?this.currentUri.duration=.01:M>0&&(this.currentUri.duration=M);break;case Gs:var ee=M,H=new Date(ee);this.manifest.dateTimeString||(this.manifest.dateTimeString=ee,this.manifest.dateTimeObject=H),this.currentUri.dateTimeString=ee,this.currentUri.dateTimeObject=H;break;case Ia:Bn(this.manifest,_);break;case hn:var be=qs(_[1]),oe=W(be);G()(this.manifest.sessionData,oe)}},Ci.prototype.setHoldBack=function(){var S=this.manifest,y=S.serverControl,_=S.targetDuration,E=S.partTargetDuration;if(y){var M="holdBack",ee="partHoldBack",H=_&&3*_,be=E&&2*E;_&&!y.hasOwnProperty(M)&&(y[M]=H),H&&y[M]<H&&(y[M]=H),E&&!y.hasOwnProperty(ee)&&(y[ee]=3*E),E&&y[ee]<be&&(y[ee]=be)}};var Bn=function(S,y){var _,E=Da(y[0].replace("#EXT-X-",""));Ks(y[1])?(_={},_=G()(Vs(y[1]),_)):_=Hn(y[1]),S[E]=_},Da=function(S){return S.toLowerCase().replace(/-(\w)/g,function(y){return y[1].toUpperCase()})},Hn=function(S){if(S.toLowerCase()==="yes"||S.toLowerCase()==="no")return S.toLowerCase()==="yes";var y=S.indexOf(":")!==-1?S:parseFloat(S);return isNaN(y)?S:y},jn=function(S){var y={},_=S.split("=");return _.length>1&&(y[Da(_[0])]=Hn(_[1])),y},Vs=function(S){for(var y=S.split(","),_={},E=0;y.length>E;E++){var M=y[E],ee=jn(M);_=G()(ee,_)}return _},Ks=function(S){return S.indexOf("=")>-1},Gn=function(S,y){return y===-1?[S]:[S.substring(0,y),S.substring(y+1)]},qs=function(S){var y={};if(S){var _=S.search(",");return[S.slice(0,_),S.slice(_+1)].forEach(function(E,M){for(var ee=E.replace(/['"]+/g,"").split("="),H=0;H<ee.length;H++)ee[H]==="DATA-ID"&&(y["DATA-ID"]=ee[1-H]),ee[H]==="VALUE"&&(y.VALUE=ee[1-H])}),{data:y}}},Ws=Ci,$s={safeCall:function(S,y,_,E){var M=E;if(S&&typeof S[y]=="function")try{M=S[y].apply(S,_)}catch(ee){de.info("safeCall error",ee)}return M},safeIncrement:ke,getComputedStyle:function(S,y){var _;if(S&&y&&x()&&typeof x().getComputedStyle=="function")return Ri&&Ri.has(S)&&(_=Ri.get(S)),_||(_=x().getComputedStyle(S,null),Ri&&Ri.set(S,_)),_.getPropertyValue(y)},secondsToMs:function(S){return Math.floor(1e3*S)},assign:G(),headersStringToObject:L,extractHostnameAndDomain:me,extractHostname:Y,manifestParser:Ws,generateShortID:g,generateUUID:P,now:z.now},Vn={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"};function Kn(S,y){return function(_){if(Array.isArray(_))return _}(S)||function(_,E){var M=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(M!=null){var ee,H,be=[],oe=!0,Ve=!1;try{for(M=M.call(_);!(oe=(ee=M.next()).done)&&(be.push(ee.value),!E||be.length!==E);oe=!0);}catch(nt){Ve=!0,H=nt}finally{try{oe||M.return==null||M.return()}finally{if(Ve)throw H}}return be}}(S,y)||function(_,E){if(_){if(typeof _=="string")return La(_,E);var M=Object.prototype.toString.call(_).slice(8,-1);return M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set"?Array.from(_):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?La(_,E):void 0}}(S,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function La(S,y){(y==null||y>S.length)&&(y=S.length);for(var _=0,E=new Array(y);_<y;_++)E[_]=S[_];return E}var ft={},en=function S(y){var _=arguments;typeof y=="string"?S.hasOwnProperty(y)?x().setTimeout(function(){_=Array.prototype.splice.call(_,1),S[y].apply(null,_)},0):de.warn("`"+y+"` is an unknown task"):typeof y=="function"?x().setTimeout(function(){y(S)},0):de.warn("`"+y+"` is invalid.")},Ra={loaded:z.now(),NAME:"mux-embed",VERSION:"4.18.0",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(S,y){return function(_,E,M){var ee=dn(O(E),3),H=ee[0],be=ee[1],oe=ee[2],Ve=_.log,nt=_.utils.getComputedStyle,ut=_.utils.secondsToMs;if(!H)return Ve.error("No element was found with the `"+be+"` query selector.");if(oe!=="video"&&oe!=="audio")return Ve.error("The element of `"+be+"` was not a media element.");H.mux&&(H.mux.destroy(),delete H.mux,Ve.warn("Already monitoring this video element, replacing existing event listeners")),(M=G()({automaticErrorTracking:!0},M)).data=G()({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:_.VERSION},M.data),M.getPlayheadTime=function(){return ut(H.currentTime)},M.getStateData=function(){var Ze,pt,_t=this.hlsjs&&this.hlsjs.url,ur=this.dashjs&&Un(this.dashjs.getSource==="function")&&this.dashjs.getSource(),dr={player_is_paused:H.paused,player_playhead_time:ut(H.currentTime),player_width:parseInt(nt(H,"width")),player_height:parseInt(nt(H,"height")),player_autoplay_on:H.autoplay,player_preload_on:H.preload,player_language_code:H.lang,player_is_fullscreen:_i()&&!!(_i().fullscreenElement||_i().webkitFullscreenElement||_i().mozFullScreenElement||_i().msFullscreenElement),video_poster_url:H.poster,video_source_url:_t||ur||H.currentSrc,video_source_duration:ut(H.duration),video_source_height:H.videoHeight,video_source_width:H.videoWidth,view_dropped_frame_count:(Ze=H)===null||Ze===void 0||(pt=Ze.getVideoPlaybackQuality)===null||pt===void 0?void 0:pt.call(Ze).droppedVideoFrames},Jt=M.getPlayheadTime();if(H.getStartDate&&Jt>0){var It=H.getStartDate();if(It&&typeof It.getTime=="function"&&It.getTime()){var sr=It.getTime();if(dr.player_program_time=sr+Jt,H.seekable.length>0){var rr=sr+H.seekable.end(H.seekable.length-1);dr.player_live_edge_program_time=rr}}}return dr},H.mux=H.mux||{},H.mux.deleted=!1,H.mux.emit=function(Ze,pt){_.emit(be,Ze,pt)};var bt=function(){Ve.error("The monitor for this video element has already been destroyed.")};H.mux.destroy=function(){Object.keys(H.mux.listeners).forEach(function(Ze){H.removeEventListener(Ze,H.mux.listeners[Ze],!1)}),delete H.mux.listeners,H.mux.destroy=bt,H.mux.swapElement=bt,H.mux.emit=bt,H.mux.addHLSJS=bt,H.mux.addDashJS=bt,H.mux.removeHLSJS=bt,H.mux.removeDashJS=bt,H.mux.deleted=!0,_.emit(be,"destroy")},H.mux.swapElement=function(Ze){var pt=dn(O(Ze),3),_t=pt[0],ur=pt[1],dr=pt[2];return _t?dr!=="video"&&dr!=="audio"?_.log.error("The element of `"+ur+"` was not a media element."):(_t.muxId=H.muxId,delete H.muxId,_t.mux=_t.mux||{},_t.mux.listeners=G()({},H.mux.listeners),delete H.mux.listeners,Object.keys(_t.mux.listeners).forEach(function(Jt){H.removeEventListener(Jt,_t.mux.listeners[Jt],!1),_t.addEventListener(Jt,_t.mux.listeners[Jt],!1)}),_t.mux.swapElement=H.mux.swapElement,_t.mux.destroy=H.mux.destroy,delete H.mux,void(H=_t)):_.log.error("No element was found with the `"+ur+"` query selector.")},H.mux.addHLSJS=function(Ze){_.addHLSJS(be,Ze)},H.mux.addDashJS=function(Ze){_.addDashJS(be,Ze)},H.mux.removeHLSJS=function(){_.removeHLSJS(be)},H.mux.removeDashJS=function(){_.removeDashJS(be)},_.init(be,M),_.emit(be,"playerready"),H.paused||(_.emit(be,"play"),H.readyState>2&&_.emit(be,"playing")),H.mux.listeners={},Ns.forEach(function(Ze){(Ze!=="error"||M.automaticErrorTracking)&&(H.mux.listeners[Ze]=function(){var pt={};if(Ze==="error"){if(!H.error||H.error.code===1)return;pt.player_error_code=H.error.code,pt.player_error_message=Nn[H.error.code]||H.error.message}_.emit(be,Ze,pt)},H.addEventListener(Ze,H.mux.listeners[Ze],!1))})}(en,S,y)},destroyMonitor:function(S){var y=Kn(O(S),1)[0];y&&y.mux&&typeof y.mux.destroy=="function"?y.mux.destroy():de.error("A video element monitor for `"+S+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(S,y){var _=I(S);ft[_]?ft[_].addHLSJS(y):de.error("A monitor for `"+_+"` has not been initialized.")},addDashJS:function(S,y){var _=I(S);ft[_]?ft[_].addDashJS(y):de.error("A monitor for `"+_+"` has not been initialized.")},removeHLSJS:function(S){var y=I(S);ft[y]?ft[y].removeHLSJS():de.error("A monitor for `"+y+"` has not been initialized.")},removeDashJS:function(S){var y=I(S);ft[y]?ft[y].removeDashJS():de.error("A monitor for `"+y+"` has not been initialized.")},init:function(S,y){re()&&y&&y.respectDoNotTrack&&de.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var _=I(S);ft[_]=new ka(en,_,y)},emit:function(S,y,_){var E=I(S);ft[E]?(ft[E].emit(y,_),y==="destroy"&&delete ft[E]):de.error("A monitor for `"+E+"` has not been initialized.")},checkDoNotTrack:re,log:de,utils:$s,events:Vn,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(en,Ra),x()!==void 0&&typeof x().addEventListener=="function"&&x().addEventListener("pagehide",function(S){S.persisted||(en.WINDOW_UNLOADING=!0)},!1);var Ca=en},655:function(k,A,w){var U,x;function P(g){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},P(g);/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/}(function(g){var I=!1;if((x=typeof(U=g)=="function"?U.call(A,w,A,k):U)===void 0||(k.exports=x),I=!0,P(A)==="object"&&(k.exports=g(),I=!0),!I){var O=window.Cookies,X=window.Cookies=g();X.noConflict=function(){return window.Cookies=O,X}}})(function(){var g=function(){for(var I=0,O={};I<arguments.length;I++){var X=arguments[I];for(var N in X)O[N]=X[N]}return O};return function I(O){function X(N,ye,de){var re;if(typeof document<"u"){if(arguments.length>1){if(typeof(de=g({path:"/"},X.defaults,de)).expires=="number"){var z=new Date;z.setMilliseconds(z.getMilliseconds()+864e5*de.expires),de.expires=z}try{re=JSON.stringify(ye),/^[\{\[]/.test(re)&&(ye=re)}catch{}return ye=O.write?O.write(ye,N):encodeURIComponent(String(ye)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),N=(N=(N=encodeURIComponent(String(N))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[N,"=",ye,de.expires?"; expires="+de.expires.toUTCString():"",de.path?"; path="+de.path:"",de.domain?"; domain="+de.domain:"",de.secure?"; secure":""].join("")}N||(re={});for(var he=document.cookie?document.cookie.split("; "):[],G=/(%[0-9A-Z]{2})+/g,Y=0;Y<he.length;Y++){var me=he[Y].split("="),Ae=me.slice(1).join("=");Ae.charAt(0)==='"'&&(Ae=Ae.slice(1,-1));try{var ke=me[0].replace(G,decodeURIComponent);if(Ae=O.read?O.read(Ae,ke):O(Ae,ke)||Ae.replace(G,decodeURIComponent),this.json)try{Ae=JSON.parse(Ae)}catch{}if(N===ke){re=Ae;break}N||(re[ke]=Ae)}catch{}}return re}}return X.set=X,X.get=function(N){return X.call(X,N)},X.getJSON=function(){return X.apply({json:!0},[].slice.call(arguments))},X.defaults={},X.remove=function(N,ye){X(N,"",g(ye,{expires:-1}))},X.withConverter=I,X}(function(){})})},153:function(k,A,w){var U,x=w.g!==void 0?w.g:typeof window<"u"?window:{},P=w(558);typeof document<"u"?U=document:(U=x["__GLOBAL_DOCUMENT_CACHE@4"])||(U=x["__GLOBAL_DOCUMENT_CACHE@4"]=P),k.exports=U},48:function(k,A,w){var U;U=typeof window<"u"?window:w.g!==void 0?w.g:typeof self<"u"?self:{},k.exports=U},678:function(k){var A=9007199254740991,w="[object Arguments]",U="[object Function]",x="[object GeneratorFunction]",P=/^(?:0|[1-9]\d*)$/;function g(fe,ne,Te){switch(Te.length){case 0:return fe.call(ne);case 1:return fe.call(ne,Te[0]);case 2:return fe.call(ne,Te[0],Te[1]);case 3:return fe.call(ne,Te[0],Te[1],Te[2])}return fe.apply(ne,Te)}var I,O,X=Object.prototype,N=X.hasOwnProperty,ye=X.toString,de=X.propertyIsEnumerable,re=(I=Object.keys,O=Object,function(fe){return I(O(fe))}),z=Math.max,he=!de.call({valueOf:1},"valueOf");function G(fe,ne){var Te=Q(fe)||function(we){return function(Ke){return function(We){return!!We&&typeof We=="object"}(Ke)&&L(Ke)}(we)&&N.call(we,"callee")&&(!de.call(we,"callee")||ye.call(we)==w)}(fe)?function(we,Ke){for(var We=-1,ie=Array(we);++We<we;)ie[We]=Ke(We);return ie}(fe.length,String):[],He=Te.length,le=!!He;for(var ae in fe)!ne&&!N.call(fe,ae)||le&&(ae=="length"||me(ae,He))||Te.push(ae);return Te}function Y(fe,ne,Te){var He=fe[ne];N.call(fe,ne)&&ke(He,Te)&&(Te!==void 0||ne in fe)||(fe[ne]=Te)}function me(fe,ne){return!!(ne=ne??A)&&(typeof fe=="number"||P.test(fe))&&fe>-1&&fe%1==0&&fe<ne}function Ae(fe){var ne=fe&&fe.constructor;return fe===(typeof ne=="function"&&ne.prototype||X)}function ke(fe,ne){return fe===ne||fe!=fe&&ne!=ne}var Q=Array.isArray;function L(fe){return fe!=null&&function(ne){return typeof ne=="number"&&ne>-1&&ne%1==0&&ne<=A}(fe.length)&&!function(ne){var Te=W(ne)?ye.call(ne):"";return Te==U||Te==x}(fe)}function W(fe){var ne=typeof fe;return!!fe&&(ne=="object"||ne=="function")}var B,se=(B=function(fe,ne){if(he||Ae(ne)||L(ne))(function(He,le,ae,we){ae||(ae={});for(var Ke=-1,We=le.length;++Ke<We;){var ie=le[Ke],Ee=we?we(ae[ie],He[ie],ie,ae,He):void 0;Y(ae,ie,Ee===void 0?He[ie]:Ee)}})(ne,function(He){return L(He)?G(He):function(le){if(!Ae(le))return re(le);var ae=[];for(var we in Object(le))N.call(le,we)&&we!="constructor"&&ae.push(we);return ae}(He)}(ne),fe);else for(var Te in ne)N.call(ne,Te)&&Y(fe,Te,ne[Te])},function(fe,ne){return ne=z(ne===void 0?fe.length-1:ne,0),function(){for(var Te=arguments,He=-1,le=z(Te.length-ne,0),ae=Array(le);++He<le;)ae[He]=Te[ne+He];He=-1;for(var we=Array(ne+1);++He<ne;)we[He]=Te[He];return we[ne]=ae,g(fe,this,we)}}(function(fe,ne){var Te=-1,He=ne.length,le=He>1?ne[He-1]:void 0,ae=He>2?ne[2]:void 0;for(le=B.length>3&&typeof le=="function"?(He--,le):void 0,ae&&function(Ke,We,ie){if(!W(ie))return!1;var Ee=typeof We;return!!(Ee=="number"?L(ie)&&me(We,ie.length):Ee=="string"&&We in ie)&&ke(ie[We],Ke)}(ne[0],ne[1],ae)&&(le=He<3?void 0:le,He=1),fe=Object(fe);++Te<He;){var we=ne[Te];we&&B(fe,we,Te,le)}return fe}));k.exports=se},640:function(k,A,w){var U,x;(function(P,g){U=function(){var I=function(){},O="undefined",X=typeof window!==O&&typeof window.navigator!==O&&/Trident\/|MSIE /.test(window.navigator.userAgent),N=["trace","debug","info","warn","error"];function ye(Q,L){var W=Q[L];if(typeof W.bind=="function")return W.bind(Q);try{return Function.prototype.bind.call(W,Q)}catch{return function(){return Function.prototype.apply.apply(W,[Q,arguments])}}}function de(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function re(Q){return Q==="debug"&&(Q="log"),typeof console!==O&&(Q==="trace"&&X?de:console[Q]!==void 0?ye(console,Q):console.log!==void 0?ye(console,"log"):I)}function z(Q,L){for(var W=0;W<N.length;W++){var B=N[W];this[B]=W<Q?I:this.methodFactory(B,Q,L)}this.log=this.debug}function he(Q,L,W){return function(){typeof console!==O&&(z.call(this,L,W),this[Q].apply(this,arguments))}}function G(Q,L,W){return re(Q)||he.apply(this,arguments)}function Y(Q,L,W){var B,se=this;L=L??"WARN";var fe="loglevel";function ne(ae){var we=(N[ae]||"silent").toUpperCase();if(typeof window!==O&&fe){try{return void(window.localStorage[fe]=we)}catch{}try{window.document.cookie=encodeURIComponent(fe)+"="+we+";"}catch{}}}function Te(){var ae;if(typeof window!==O&&fe){try{ae=window.localStorage[fe]}catch{}if(typeof ae===O)try{var we=window.document.cookie,Ke=we.indexOf(encodeURIComponent(fe)+"=");Ke!==-1&&(ae=/^([^;]+)/.exec(we.slice(Ke))[1])}catch{}return se.levels[ae]===void 0&&(ae=void 0),ae}}function He(){if(typeof window!==O&&fe){try{return void window.localStorage.removeItem(fe)}catch{}try{window.document.cookie=encodeURIComponent(fe)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}typeof Q=="string"?fe+=":"+Q:typeof Q=="symbol"&&(fe=void 0),se.name=Q,se.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},se.methodFactory=W||G,se.getLevel=function(){return B},se.setLevel=function(ae,we){if(typeof ae=="string"&&se.levels[ae.toUpperCase()]!==void 0&&(ae=se.levels[ae.toUpperCase()]),!(typeof ae=="number"&&ae>=0&&ae<=se.levels.SILENT))throw"log.setLevel() called with invalid level: "+ae;if(B=ae,we!==!1&&ne(ae),z.call(se,ae,Q),typeof console===O&&ae<se.levels.SILENT)return"No console available for logging"},se.setDefaultLevel=function(ae){L=ae,Te()||se.setLevel(ae,!1)},se.resetLevel=function(){se.setLevel(L,!1),He()},se.enableAll=function(ae){se.setLevel(se.levels.TRACE,ae)},se.disableAll=function(ae){se.setLevel(se.levels.SILENT,ae)};var le=Te();le==null&&(le=L),se.setLevel(le,!1)}var me=new Y,Ae={};me.getLogger=function(Q){if(typeof Q!="symbol"&&typeof Q!="string"||Q==="")throw new TypeError("You must supply a name when creating a logger.");var L=Ae[Q];return L||(L=Ae[Q]=new Y(Q,me.getLevel(),me.methodFactory)),L};var ke=typeof window!==O?window.log:void 0;return me.noConflict=function(){return typeof window!==O&&window.log===me&&(window.log=ke),me},me.getLoggers=function(){return Ae},me.default=me,me},(x=typeof U=="function"?U.call(A,w,A,k):U)===void 0||(k.exports=x)})()},375:function(k,A){var w=Object.prototype.hasOwnProperty;function U(P){try{return decodeURIComponent(P.replace(/\+/g," "))}catch{return null}}function x(P){try{return encodeURIComponent(P)}catch{return null}}A.stringify=function(P,g){g=g||"";var I,O,X=[];for(O in typeof g!="string"&&(g="?"),P)if(w.call(P,O)){if((I=P[O])||I!=null&&!isNaN(I)||(I=""),O=x(O),I=x(I),O===null||I===null)continue;X.push(O+"="+I)}return X.length?g+X.join("&"):""},A.parse=function(P){for(var g,I=/([^=?#&]+)=?([^&]*)/g,O={};g=I.exec(P);){var X=U(g[1]),N=U(g[2]);X===null||N===null||X in O||(O[X]=N)}return O}},558:function(){}},m={};function T(k){var A=m[k];if(A!==void 0)return A.exports;var w=m[k]={exports:{}};return h[k].call(w.exports,w,w.exports,T),w.exports}return T.n=function(k){var A=k&&k.__esModule?function(){return k.default}:function(){return k};return T.d(A,{a:A}),A},T.d=function(k,A){for(var w in A)T.o(A,w)&&!T.o(k,w)&&Object.defineProperty(k,w,{enumerable:!0,get:A[w]})},T.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),T.o=function(k,A){return Object.prototype.hasOwnProperty.call(k,A)},T(80)}()},i.exports=a()})()})(Sy);var _l=Th(rl),il={},Ay={get exports(){return il},set exports(i){il=i}};(function(i,e){typeof window<"u"&&function(a,h){i.exports=h()}(my,()=>(()=>{var a={21:(k,A,w)=>{w.r(A),w.d(A,{default:()=>X});var U=function(){function N(ye,de){this.subtle=void 0,this.aesIV=void 0,this.subtle=ye,this.aesIV=de}return N.prototype.decrypt=function(ye,de){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},de,ye)},N}(),x=function(){function N(ye,de){this.subtle=void 0,this.key=void 0,this.subtle=ye,this.key=de}return N.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},N}(),P=w(145),g=function(){function N(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var ye=N.prototype;return ye.uint8ArrayToUint32Array_=function(de){for(var re=new DataView(de),z=new Uint32Array(4),he=0;he<4;he++)z[he]=re.getUint32(4*he);return z},ye.initTable=function(){var de=this.sBox,re=this.invSBox,z=this.subMix,he=z[0],G=z[1],Y=z[2],me=z[3],Ae=this.invSubMix,ke=Ae[0],Q=Ae[1],L=Ae[2],W=Ae[3],B=new Uint32Array(256),se=0,fe=0,ne=0;for(ne=0;ne<256;ne++)B[ne]=ne<128?ne<<1:ne<<1^283;for(ne=0;ne<256;ne++){var Te=fe^fe<<1^fe<<2^fe<<3^fe<<4;Te=Te>>>8^255&Te^99,de[se]=Te,re[Te]=se;var He=B[se],le=B[He],ae=B[le],we=257*B[Te]^16843008*Te;he[se]=we<<24|we>>>8,G[se]=we<<16|we>>>16,Y[se]=we<<8|we>>>24,me[se]=we,we=16843009*ae^65537*le^257*He^16843008*se,ke[Te]=we<<24|we>>>8,Q[Te]=we<<16|we>>>16,L[Te]=we<<8|we>>>24,W[Te]=we,se?(se=He^B[B[B[ae^He]]],fe^=B[B[fe]]):se=fe=1}},ye.expandKey=function(de){for(var re=this.uint8ArrayToUint32Array_(de),z=!0,he=0;he<re.length&&z;)z=re[he]===this.key[he],he++;if(!z){this.key=re;var G=this.keySize=re.length;if(G!==4&&G!==6&&G!==8)throw new Error("Invalid aes key size="+G);var Y,me,Ae,ke,Q=this.ksRows=4*(G+6+1),L=this.keySchedule=new Uint32Array(Q),W=this.invKeySchedule=new Uint32Array(Q),B=this.sBox,se=this.rcon,fe=this.invSubMix,ne=fe[0],Te=fe[1],He=fe[2],le=fe[3];for(Y=0;Y<Q;Y++)Y<G?Ae=L[Y]=re[Y]:(ke=Ae,Y%G==0?(ke=B[(ke=ke<<8|ke>>>24)>>>24]<<24|B[ke>>>16&255]<<16|B[ke>>>8&255]<<8|B[255&ke],ke^=se[Y/G|0]<<24):G>6&&Y%G==4&&(ke=B[ke>>>24]<<24|B[ke>>>16&255]<<16|B[ke>>>8&255]<<8|B[255&ke]),L[Y]=Ae=(L[Y-G]^ke)>>>0);for(me=0;me<Q;me++)Y=Q-me,ke=3&me?L[Y]:L[Y-4],W[me]=me<4||Y<=4?ke:ne[B[ke>>>24]]^Te[B[ke>>>16&255]]^He[B[ke>>>8&255]]^le[B[255&ke]],W[me]=W[me]>>>0}},ye.networkToHostOrderSwap=function(de){return de<<24|(65280&de)<<8|(16711680&de)>>8|de>>>24},ye.decrypt=function(de,re,z){for(var he,G,Y,me,Ae,ke,Q,L,W,B,se,fe,ne,Te,He=this.keySize+6,le=this.invKeySchedule,ae=this.invSBox,we=this.invSubMix,Ke=we[0],We=we[1],ie=we[2],Ee=we[3],ue=this.uint8ArrayToUint32Array_(z),Re=ue[0],Le=ue[1],Me=ue[2],Oe=ue[3],Be=new Int32Array(de),_e=new Int32Array(Be.length),Ne=this.networkToHostOrderSwap;re<Be.length;){for(W=Ne(Be[re]),B=Ne(Be[re+1]),se=Ne(Be[re+2]),fe=Ne(Be[re+3]),Ae=W^le[0],ke=fe^le[1],Q=se^le[2],L=B^le[3],ne=4,Te=1;Te<He;Te++)he=Ke[Ae>>>24]^We[ke>>16&255]^ie[Q>>8&255]^Ee[255&L]^le[ne],G=Ke[ke>>>24]^We[Q>>16&255]^ie[L>>8&255]^Ee[255&Ae]^le[ne+1],Y=Ke[Q>>>24]^We[L>>16&255]^ie[Ae>>8&255]^Ee[255&ke]^le[ne+2],me=Ke[L>>>24]^We[Ae>>16&255]^ie[ke>>8&255]^Ee[255&Q]^le[ne+3],Ae=he,ke=G,Q=Y,L=me,ne+=4;he=ae[Ae>>>24]<<24^ae[ke>>16&255]<<16^ae[Q>>8&255]<<8^ae[255&L]^le[ne],G=ae[ke>>>24]<<24^ae[Q>>16&255]<<16^ae[L>>8&255]<<8^ae[255&Ae]^le[ne+1],Y=ae[Q>>>24]<<24^ae[L>>16&255]<<16^ae[Ae>>8&255]<<8^ae[255&ke]^le[ne+2],me=ae[L>>>24]<<24^ae[Ae>>16&255]<<16^ae[ke>>8&255]<<8^ae[255&Q]^le[ne+3],_e[re]=Ne(he^Re),_e[re+1]=Ne(me^Le),_e[re+2]=Ne(Y^Me),_e[re+3]=Ne(G^Oe),Re=W,Le=B,Me=se,Oe=fe,re+=4}return _e.buffer},N}(),I=w(93),O=w(63),X=function(){function N(de,re){var z=(re===void 0?{}:re).removePKCS7Padding,he=z===void 0||z;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=de.enableSoftwareAES,this.removePKCS7Padding=he,he)try{var G=self.crypto;G&&(this.subtle=G.subtle||G.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var ye=N.prototype;return ye.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},ye.isSync=function(){return this.useSoftware},ye.flush=function(){var de=this.currentResult,re=this.remainderData;if(!de||re)return I.logger.error("[softwareDecrypt] "+(re?"overflow bytes: "+re.byteLength:"no result")),this.reset(),null;var z,he,G,Y=new Uint8Array(de);return this.reset(),this.removePKCS7Padding?(G=(he=(z=Y).byteLength)&&new DataView(z.buffer).getUint8(he-1))?(0,P.sliceUint8)(z,0,he-G):z:Y},ye.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},ye.decrypt=function(de,re,z){var he=this;return this.useSoftware?new Promise(function(G,Y){he.softwareDecrypt(new Uint8Array(de),re,z);var me=he.flush();me?G(me.buffer):Y(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(de),re,z)},ye.softwareDecrypt=function(de,re,z){var he=this.currentIV,G=this.currentResult,Y=this.remainderData;this.logOnce("JS AES decrypt"),Y&&(de=(0,O.appendUint8Array)(Y,de),this.remainderData=null);var me=this.getValidChunk(de);if(!me.length)return null;he&&(z=he);var Ae=this.softwareDecrypter;Ae||(Ae=this.softwareDecrypter=new g),Ae.expandKey(re);var ke=G;return this.currentResult=Ae.decrypt(me.buffer,0,z),this.currentIV=(0,P.sliceUint8)(me,-16).buffer,ke||null},ye.webCryptoDecrypt=function(de,re,z){var he=this,G=this.subtle;return this.key===re&&this.fastAesKey||(this.key=re,this.fastAesKey=new x(G,re)),this.fastAesKey.expandKey().then(function(Y){return G?(he.logOnce("WebCrypto AES decrypt"),new U(G,new Uint8Array(z)).decrypt(de.buffer,Y)):Promise.reject(new Error("web crypto not initialized"))}).catch(function(Y){return I.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+Y.name+": "+Y.message),he.onWebCryptoError(de,re,z)})},ye.onWebCryptoError=function(de,re,z){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(de,re,z);var he=this.flush();if(he)return he.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},ye.getValidChunk=function(de){var re=de,z=de.length-de.length%16;return z!==de.length&&(re=(0,P.sliceUint8)(de,0,z),this.remainderData=(0,P.sliceUint8)(de,z)),re},ye.logOnce=function(de){this.logEnabled&&(I.logger.log("[decrypter]: "+de),this.logEnabled=!1)},N}()},181:(k,A,w)=>{w.r(A),w.d(A,{canParse:()=>O,decodeFrame:()=>re,getID3Data:()=>g,getID3Frames:()=>de,getTimeStamp:()=>X,isFooter:()=>P,isHeader:()=>x,isTimeStampFrame:()=>N,testables:()=>Ae,utf8ArrayToStr:()=>me});var U,x=function(Q,L){return L+10<=Q.length&&Q[L]===73&&Q[L+1]===68&&Q[L+2]===51&&Q[L+3]<255&&Q[L+4]<255&&Q[L+6]<128&&Q[L+7]<128&&Q[L+8]<128&&Q[L+9]<128},P=function(Q,L){return L+10<=Q.length&&Q[L]===51&&Q[L+1]===68&&Q[L+2]===73&&Q[L+3]<255&&Q[L+4]<255&&Q[L+6]<128&&Q[L+7]<128&&Q[L+8]<128&&Q[L+9]<128},g=function(Q,L){for(var W=L,B=0;x(Q,L);)B+=10,B+=I(Q,L+6),P(Q,L+10)&&(B+=10),L+=B;if(B>0)return Q.subarray(W,W+B)},I=function(Q,L){var W=0;return W=(127&Q[L])<<21,W|=(127&Q[L+1])<<14,(W|=(127&Q[L+2])<<7)|127&Q[L+3]},O=function(Q,L){return x(Q,L)&&I(Q,L+6)+10<=Q.length-L},X=function(Q){for(var L=de(Q),W=0;W<L.length;W++){var B=L[W];if(N(B))return Y(B)}},N=function(Q){return Q&&Q.key==="PRIV"&&Q.info==="com.apple.streaming.transportStreamTimestamp"},ye=function(Q){var L=String.fromCharCode(Q[0],Q[1],Q[2],Q[3]),W=I(Q,4);return{type:L,size:W,data:Q.subarray(10,10+W)}},de=function(Q){for(var L=0,W=[];x(Q,L);){for(var B=I(Q,L+6),se=(L+=10)+B;L+8<se;){var fe=ye(Q.subarray(L)),ne=re(fe);ne&&W.push(ne),L+=fe.size+10}P(Q,L)&&(L+=10)}return W},re=function(Q){return Q.type==="PRIV"?z(Q):Q.type[0]==="W"?G(Q):he(Q)},z=function(Q){if(!(Q.size<2)){var L=me(Q.data,!0),W=new Uint8Array(Q.data.subarray(L.length+1));return{key:Q.type,info:L,data:W.buffer}}},he=function(Q){if(!(Q.size<2)){if(Q.type==="TXXX"){var L=1,W=me(Q.data.subarray(L),!0);L+=W.length+1;var B=me(Q.data.subarray(L));return{key:Q.type,info:W,data:B}}var se=me(Q.data.subarray(1));return{key:Q.type,data:se}}},G=function(Q){if(Q.type==="WXXX"){if(Q.size<2)return;var L=1,W=me(Q.data.subarray(L),!0);L+=W.length+1;var B=me(Q.data.subarray(L));return{key:Q.type,info:W,data:B}}var se=me(Q.data);return{key:Q.type,data:se}},Y=function(Q){if(Q.data.byteLength===8){var L=new Uint8Array(Q.data),W=1&L[3],B=(L[4]<<23)+(L[5]<<15)+(L[6]<<7)+L[7];return B/=45,W&&(B+=4772185884e-2),Math.round(B)}},me=function(Q,L){L===void 0&&(L=!1);var W=ke();if(W){var B=W.decode(Q);if(L){var se=B.indexOf("\0");return se!==-1?B.substring(0,se):B}return B.replace(/\0/g,"")}for(var fe,ne,Te,He=Q.length,le="",ae=0;ae<He;){if((fe=Q[ae++])===0&&L)return le;if(fe!==0&&fe!==3)switch(fe>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:le+=String.fromCharCode(fe);break;case 12:case 13:ne=Q[ae++],le+=String.fromCharCode((31&fe)<<6|63&ne);break;case 14:ne=Q[ae++],Te=Q[ae++],le+=String.fromCharCode((15&fe)<<12|(63&ne)<<6|(63&Te)<<0)}}return le},Ae={decodeTextFrame:he};function ke(){return U||self.TextDecoder===void 0||(U=new self.TextDecoder("utf-8")),U}},182:(k,A,w)=>{w.r(A),w.d(A,{default:()=>O});var U=w(544),x=w(851),P=w(93),g=w(729),I=w(973);function O(de){var re=new g.EventEmitter,z=function(he,G){de.postMessage({event:he,data:G})};re.on(x.Events.FRAG_DECRYPTED,z),re.on(x.Events.ERROR,z),de.addEventListener("message",function(he){var G=he.data;switch(G.cmd){case"init":var Y=JSON.parse(G.config);de.transmuxer=new U.default(re,G.typeSupported,Y,G.vendor,G.id),(0,P.enableLogs)(Y.debug,G.id),function(){var Q=function(W){P.logger[W]=function(B){z("workerLog",{logType:W,message:B})}};for(var L in P.logger)Q(L)}(),z("init",null);break;case"configure":de.transmuxer.configure(G.config);break;case"demux":var me=de.transmuxer.push(G.data,G.decryptdata,G.chunkMeta,G.state);(0,U.isPromise)(me)?(de.transmuxer.async=!0,me.then(function(Q){X(de,Q)}).catch(function(Q){z(x.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:G.chunkMeta,fatal:!1,error:Q,err:Q,reason:"transmuxer-worker push error"})})):(de.transmuxer.async=!1,X(de,me));break;case"flush":var Ae=G.chunkMeta,ke=de.transmuxer.flush(Ae);(0,U.isPromise)(ke)||de.transmuxer.async?((0,U.isPromise)(ke)||(ke=Promise.resolve(ke)),ke.then(function(Q){ye(de,Q,Ae)}).catch(function(Q){z(x.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:G.chunkMeta,fatal:!1,error:Q,err:Q,reason:"transmuxer-worker flush error"})})):ye(de,ke,Ae)}})}function X(de,re){if(!((z=re.remuxResult).audio||z.video||z.text||z.id3||z.initSegment))return!1;var z,he=[],G=re.remuxResult,Y=G.audio,me=G.video;return Y&&N(he,Y),me&&N(he,me),de.postMessage({event:"transmuxComplete",data:re},he),!0}function N(de,re){re.data1&&de.push(re.data1.buffer),re.data2&&de.push(re.data2.buffer)}function ye(de,re,z){re.reduce(function(he,G){return X(de,G)||he},!1)||de.postMessage({event:"transmuxComplete",data:re[0]}),de.postMessage({event:"flush",data:z})}},544:(k,A,w)=>{w.r(A),w.d(A,{TransmuxConfig:()=>tr,TransmuxState:()=>Lr,default:()=>Ht,isPromise:()=>nr});var U=w(851),x=w(973),P=w(21),g=w(965),I=w(181),O=w(856);function X(ge,$){return ge===void 0&&(ge=""),$===void 0&&($=9e4),{type:ge,id:-1,pid:-1,inputTimeScale:$,sequenceNumber:-1,samples:[],dropped:0}}var N=w(63),ye=w(145),de=function(){function ge(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var $=ge.prototype;return $.resetInitSegment=function(R,V,j,J){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},$.resetTimeStamp=function(R){this.initPTS=R,this.resetContiguity()},$.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},$.canParse=function(R,V){return!1},$.appendFrame=function(R,V,j){},$.demux=function(R,V){this.cachedData&&(R=(0,N.appendUint8Array)(this.cachedData,R),this.cachedData=null);var j,J=I.getID3Data(R,0),pe=J?J.length:0,ve=this._audioTrack,De=this._id3Track,Fe=J?I.getTimeStamp(J):void 0,je=R.length;for((this.basePTS===null||this.frameIndex===0&&(0,g.isFiniteNumber)(Fe))&&(this.basePTS=re(Fe,V,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),J&&J.length>0&&De.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:J,type:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});pe<je;){if(this.canParse(R,pe)){var qe=this.appendFrame(ve,R,pe);qe?(this.frameIndex++,this.lastPTS=qe.sample.pts,j=pe+=qe.length):pe=je}else I.canParse(R,pe)?(J=I.getID3Data(R,pe),De.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:J,type:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),j=pe+=J.length):pe++;if(pe===je&&j!==je){var Je=(0,ye.sliceUint8)(R,j);this.cachedData?this.cachedData=(0,N.appendUint8Array)(this.cachedData,Je):this.cachedData=Je}}return{audioTrack:ve,videoTrack:X(),id3Track:De,textTrack:X()}},$.demuxSampleAes=function(R,V,j){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},$.flush=function(R){var V=this.cachedData;return V&&(this.cachedData=null,this.demux(V,0)),{audioTrack:this._audioTrack,videoTrack:X(),id3Track:this._id3Track,textTrack:X()}},$.destroy=function(){},ge}(),re=function(ge,$,R){return(0,g.isFiniteNumber)(ge)?90*ge:9e4*$+(R||0)};const z=de;var he=w(93);function G(ge,$){return ge[$]===255&&(246&ge[$+1])==240}function Y(ge,$){return 1&ge[$+1]?7:9}function me(ge,$){return(3&ge[$+3])<<11|ge[$+4]<<3|(224&ge[$+5])>>>5}function Ae(ge,$){return $+1<ge.length&&G(ge,$)}function ke(ge,$){if(Ae(ge,$)){var R=Y(ge,$);if($+R>=ge.length)return!1;var V=me(ge,$);if(V<=R)return!1;var j=$+V;return j===ge.length||Ae(ge,j)}return!1}function Q(ge,$,R,V,j){if(!ge.samplerate){var J=function(pe,ve,De,Fe){var je,qe,Je,Ye,ot=navigator.userAgent.toLowerCase(),Et=Fe,Ut=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];je=1+((192&ve[De+2])>>>6);var rt=(60&ve[De+2])>>>2;if(!(rt>Ut.length-1))return Je=(1&ve[De+2])<<2,Je|=(192&ve[De+3])>>>6,he.logger.log("manifest codec:"+Fe+", ADTS type:"+je+", samplingIndex:"+rt),/firefox/i.test(ot)?rt>=6?(je=5,Ye=new Array(4),qe=rt-3):(je=2,Ye=new Array(2),qe=rt):ot.indexOf("android")!==-1?(je=2,Ye=new Array(2),qe=rt):(je=5,Ye=new Array(4),Fe&&(Fe.indexOf("mp4a.40.29")!==-1||Fe.indexOf("mp4a.40.5")!==-1)||!Fe&&rt>=6?qe=rt-3:((Fe&&Fe.indexOf("mp4a.40.2")!==-1&&(rt>=6&&Je===1||/vivaldi/i.test(ot))||!Fe&&Je===1)&&(je=2,Ye=new Array(2)),qe=rt)),Ye[0]=je<<3,Ye[0]|=(14&rt)>>1,Ye[1]|=(1&rt)<<7,Ye[1]|=Je<<3,je===5&&(Ye[1]|=(14&qe)>>1,Ye[2]=(1&qe)<<7,Ye[2]|=8,Ye[3]=0),{config:Ye,samplerate:Ut[rt],channelCount:Je,codec:"mp4a.40."+je,manifestCodec:Et};pe.trigger(U.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+rt})}($,R,V,j);if(!J)return;ge.config=J.config,ge.samplerate=J.samplerate,ge.channelCount=J.channelCount,ge.codec=J.codec,ge.manifestCodec=J.manifestCodec,he.logger.log("parsed codec:"+ge.codec+", rate:"+J.samplerate+", channels:"+J.channelCount)}}function L(ge){return 9216e4/ge}function W(ge,$,R,V,j){var J,pe=V+j*L(ge.samplerate),ve=function(ot,Et){var Ut=Y(ot,Et);if(Et+Ut<=ot.length){var rt=me(ot,Et)-Ut;if(rt>0)return{headerLength:Ut,frameLength:rt}}}($,R);if(ve){var De=ve.frameLength,Fe=ve.headerLength,je=Fe+De,qe=Math.max(0,R+je-$.length);qe?(J=new Uint8Array(je-Fe)).set($.subarray(R+Fe,$.length),0):J=$.subarray(R+Fe,R+je);var Je={unit:J,pts:pe};return qe||ge.samples.push(Je),{sample:Je,length:je,missing:qe}}var Ye=$.length-R;return(J=new Uint8Array(Ye)).set($.subarray(R,$.length),0),{sample:{unit:J,pts:pe},length:Ye,missing:-1}}function B(ge,$){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,V){return R.__proto__=V,R},B(ge,$)}const se=function(ge){var $,R;function V(J,pe){var ve;return(ve=ge.call(this)||this).observer=void 0,ve.config=void 0,ve.observer=J,ve.config=pe,ve}R=ge,($=V).prototype=Object.create(R.prototype),$.prototype.constructor=$,B($,R);var j=V.prototype;return j.resetInitSegment=function(J,pe,ve,De){ge.prototype.resetInitSegment.call(this,J,pe,ve,De),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:pe,duration:De,inputTimeScale:9e4,dropped:0}},V.probe=function(J){if(!J)return!1;for(var pe=(I.getID3Data(J,0)||[]).length,ve=J.length;pe<ve;pe++)if(ke(J,pe))return he.logger.log("ADTS sync word found !"),!0;return!1},j.canParse=function(J,pe){return function(ve,De){return function(Fe,je){return je+5<Fe.length}(ve,De)&&G(ve,De)&&me(ve,De)<=ve.length-De}(J,pe)},j.appendFrame=function(J,pe,ve){Q(J,this.observer,pe,ve,J.manifestCodec);var De=W(J,pe,ve,this.basePTS,this.frameIndex);if(De&&De.missing===0)return De},V}(z);var fe=/\/emsg[-/]ID3/i;const ne=function(){function ge(R,V){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=V}var $=ge.prototype;return $.resetTimeStamp=function(){},$.resetInitSegment=function(R,V,j,J){var pe=this.videoTrack=X("video",1),ve=this.audioTrack=X("audio",1),De=this.txtTrack=X("text",1);if(this.id3Track=X("id3",1),this.timeOffset=0,R&&R.byteLength){var Fe=(0,N.parseInitSegment)(R);if(Fe.video){var je=Fe.video,qe=je.id,Je=je.timescale,Ye=je.codec;pe.id=qe,pe.timescale=De.timescale=Je,pe.codec=Ye}if(Fe.audio){var ot=Fe.audio,Et=ot.id,Ut=ot.timescale,rt=ot.codec;ve.id=Et,ve.timescale=Ut,ve.codec=rt}De.id=N.RemuxerTrackIdConfig.text,pe.sampleDuration=0,pe.duration=ve.duration=J}},$.resetContiguity=function(){},ge.probe=function(R){return R=R.length>16384?R.subarray(0,16384):R,(0,N.findBox)(R,["moof"]).length>0},$.demux=function(R,V){this.timeOffset=V;var j=R,J=this.videoTrack,pe=this.txtTrack;if(this.config.progressive){this.remainderData&&(j=(0,N.appendUint8Array)(this.remainderData,R));var ve=(0,N.segmentValidRange)(j);this.remainderData=ve.remainder,J.samples=ve.valid||new Uint8Array}else J.samples=j;var De=this.extractID3Track(J,V);return pe.samples=(0,N.parseSamples)(V,J),{videoTrack:J,audioTrack:this.audioTrack,id3Track:De,textTrack:this.txtTrack}},$.flush=function(){var R=this.timeOffset,V=this.videoTrack,j=this.txtTrack;V.samples=this.remainderData||new Uint8Array,this.remainderData=null;var J=this.extractID3Track(V,this.timeOffset);return j.samples=(0,N.parseSamples)(R,V),{videoTrack:V,audioTrack:X(),id3Track:J,textTrack:X()}},$.extractID3Track=function(R,V){var j=this.id3Track;if(R.samples.length){var J=(0,N.findBox)(R.samples,["emsg"]);J&&J.forEach(function(pe){var ve=(0,N.parseEmsg)(pe);if(fe.test(ve.schemeIdUri)){var De=(0,g.isFiniteNumber)(ve.presentationTime)?ve.presentationTime/ve.timeScale:V+ve.presentationTimeDelta/ve.timeScale,Fe=ve.eventDuration===4294967295?Number.POSITIVE_INFINITY:ve.eventDuration/ve.timeScale;Fe<=.001&&(Fe=Number.POSITIVE_INFINITY);var je=ve.payload;j.samples.push({data:je,len:je.byteLength,dts:De,pts:De,type:O.MetadataSchema.emsg,duration:Fe})}})}return j},$.demuxSampleAes=function(R,V,j){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},$.destroy=function(){},ge}();var Te=null,He=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],le=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ae=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],we=[0,1,1,4];function Ke(ge,$,R,V,j){if(!(R+24>$.length)){var J=We($,R);if(J&&R+J.frameLength<=$.length){var pe=V+j*(9e4*J.samplesPerFrame/J.sampleRate),ve={unit:$.subarray(R,R+J.frameLength),pts:pe,dts:pe};return ge.config=[],ge.channelCount=J.channelCount,ge.samplerate=J.sampleRate,ge.samples.push(ve),{sample:ve,length:J.frameLength,missing:0}}}}function We(ge,$){var R=ge[$+1]>>3&3,V=ge[$+1]>>1&3,j=ge[$+2]>>4&15,J=ge[$+2]>>2&3;if(R!==1&&j!==0&&j!==15&&J!==3){var pe=ge[$+2]>>1&1,ve=ge[$+3]>>6,De=1e3*He[14*(R===3?3-V:V===3?3:4)+j-1],Fe=le[3*(R===3?0:R===2?1:2)+J],je=ve===3?1:2,qe=ae[R][V],Je=we[V],Ye=8*qe*Je,ot=Math.floor(qe*De/Fe+pe)*Je;if(Te===null){var Et=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Te=Et?parseInt(Et[1]):0}return Te&&Te<=87&&V===2&&De>=224e3&&ve===0&&(ge[$+3]=128|ge[$+3]),{sampleRate:Fe,channelCount:je,frameLength:ot,samplesPerFrame:Ye}}}function ie(ge,$){return ge[$]===255&&(224&ge[$+1])==224&&(6&ge[$+1])!=0}function Ee(ge,$){return $+1<ge.length&&ie(ge,$)}function ue(ge,$){if($+1<ge.length&&ie(ge,$)){var R=We(ge,$),V=4;R!=null&&R.frameLength&&(V=R.frameLength);var j=$+V;return j===ge.length||Ee(ge,j)}return!1}const Re=function(){function ge(R){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=R,this.bytesAvailable=R.byteLength,this.word=0,this.bitsAvailable=0}var $=ge.prototype;return $.loadWord=function(){var R=this.data,V=this.bytesAvailable,j=R.byteLength-V,J=new Uint8Array(4),pe=Math.min(4,V);if(pe===0)throw new Error("no bytes available");J.set(R.subarray(j,j+pe)),this.word=new DataView(J.buffer).getUint32(0),this.bitsAvailable=8*pe,this.bytesAvailable-=pe},$.skipBits=function(R){var V;R=Math.min(R,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>R?(this.word<<=R,this.bitsAvailable-=R):(R-=this.bitsAvailable,R-=(V=R>>3)<<3,this.bytesAvailable-=V,this.loadWord(),this.word<<=R,this.bitsAvailable-=R)},$.readBits=function(R){var V=Math.min(this.bitsAvailable,R),j=this.word>>>32-V;if(R>32&&he.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=V,this.bitsAvailable>0)this.word<<=V;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(V=R-V)>0&&this.bitsAvailable?j<<V|this.readBits(V):j},$.skipLZ=function(){var R;for(R=0;R<this.bitsAvailable;++R)if(this.word&2147483648>>>R)return this.word<<=R,this.bitsAvailable-=R,R;return this.loadWord(),R+this.skipLZ()},$.skipUEG=function(){this.skipBits(1+this.skipLZ())},$.skipEG=function(){this.skipBits(1+this.skipLZ())},$.readUEG=function(){var R=this.skipLZ();return this.readBits(R+1)-1},$.readEG=function(){var R=this.readUEG();return 1&R?1+R>>>1:-1*(R>>>1)},$.readBoolean=function(){return this.readBits(1)===1},$.readUByte=function(){return this.readBits(8)},$.readUShort=function(){return this.readBits(16)},$.readUInt=function(){return this.readBits(32)},$.skipScalingList=function(R){for(var V=8,j=8,J=0;J<R;J++)j!==0&&(j=(V+this.readEG()+256)%256),V=j===0?V:j},$.readSPS=function(){var R,V,j,J=0,pe=0,ve=0,De=0,Fe=this.readUByte.bind(this),je=this.readBits.bind(this),qe=this.readUEG.bind(this),Je=this.readBoolean.bind(this),Ye=this.skipBits.bind(this),ot=this.skipEG.bind(this),Et=this.skipUEG.bind(this),Ut=this.skipScalingList.bind(this);Fe();var rt=Fe();if(je(5),Ye(3),Fe(),Et(),rt===100||rt===110||rt===122||rt===244||rt===44||rt===83||rt===86||rt===118||rt===128){var Nt=qe();if(Nt===3&&Ye(1),Et(),Et(),Ye(1),Je())for(V=Nt!==3?8:12,j=0;j<V;j++)Je()&&Ut(j<6?16:64)}Et();var lr=qe();if(lr===0)qe();else if(lr===1)for(Ye(1),ot(),ot(),R=qe(),j=0;j<R;j++)ot();Et(),Ye(1);var Wt=qe(),Vt=qe(),Zt=je(1);Zt===0&&Ye(1),Ye(1),Je()&&(J=qe(),pe=qe(),ve=qe(),De=qe());var dt=[1,1];if(Je()&&Je())switch(Fe()){case 1:dt=[1,1];break;case 2:dt=[12,11];break;case 3:dt=[10,11];break;case 4:dt=[16,11];break;case 5:dt=[40,33];break;case 6:dt=[24,11];break;case 7:dt=[20,11];break;case 8:dt=[32,11];break;case 9:dt=[80,33];break;case 10:dt=[18,11];break;case 11:dt=[15,11];break;case 12:dt=[64,33];break;case 13:dt=[160,99];break;case 14:dt=[4,3];break;case 15:dt=[3,2];break;case 16:dt=[2,1];break;case 255:dt=[Fe()<<8|Fe(),Fe()<<8|Fe()]}return{width:Math.ceil(16*(Wt+1)-2*J-2*pe),height:(2-Zt)*(Vt+1)*16-(Zt?2:4)*(ve+De),pixelRatio:dt}},$.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},ge}(),Le=function(){function ge(R,V,j){this.keyData=void 0,this.decrypter=void 0,this.keyData=j,this.decrypter=new P.default(V,{removePKCS7Padding:!1})}var $=ge.prototype;return $.decryptBuffer=function(R){return this.decrypter.decrypt(R,this.keyData.key.buffer,this.keyData.iv.buffer)},$.decryptAacSample=function(R,V,j){var J=this,pe=R[V].unit;if(!(pe.length<=16)){var ve=pe.subarray(16,pe.length-pe.length%16),De=ve.buffer.slice(ve.byteOffset,ve.byteOffset+ve.length);this.decryptBuffer(De).then(function(Fe){var je=new Uint8Array(Fe);pe.set(je,16),J.decrypter.isSync()||J.decryptAacSamples(R,V+1,j)})}},$.decryptAacSamples=function(R,V,j){for(;;V++){if(V>=R.length)return void j();if(!(R[V].unit.length<32||(this.decryptAacSample(R,V,j),this.decrypter.isSync())))return}},$.getAvcEncryptedData=function(R){for(var V=16*Math.floor((R.length-48)/160)+16,j=new Int8Array(V),J=0,pe=32;pe<R.length-16;pe+=160,J+=16)j.set(R.subarray(pe,pe+16),J);return j},$.getAvcDecryptedUnit=function(R,V){for(var j=new Uint8Array(V),J=0,pe=32;pe<R.length-16;pe+=160,J+=16)R.set(j.subarray(J,J+16),pe);return R},$.decryptAvcSample=function(R,V,j,J,pe){var ve=this,De=(0,N.discardEPB)(pe.data),Fe=this.getAvcEncryptedData(De);this.decryptBuffer(Fe.buffer).then(function(je){pe.data=ve.getAvcDecryptedUnit(De,je),ve.decrypter.isSync()||ve.decryptAvcSamples(R,V,j+1,J)})},$.decryptAvcSamples=function(R,V,j,J){if(R instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;V++,j=0){if(V>=R.length)return void J();for(var pe=R[V].units;!(j>=pe.length);j++){var ve=pe[j];if(!(ve.data.length<=48||ve.type!==1&&ve.type!==5||(this.decryptAvcSample(R,V,j,J,ve),this.decrypter.isSync())))return}}},ge}();function Me(){return Me=Object.assign?Object.assign.bind():function(ge){for(var $=1;$<arguments.length;$++){var R=arguments[$];for(var V in R)Object.prototype.hasOwnProperty.call(R,V)&&(ge[V]=R[V])}return ge},Me.apply(this,arguments)}var Oe=188;function Be(ge,$,R,V){return{key:ge,frame:!1,pts:$,dts:R,units:[],debug:V,length:0}}function _e(ge,$){return(31&ge[$+10])<<8|ge[$+11]}function Ne(ge,$,R,V){var j={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},J=$+3+((15&ge[$+1])<<8|ge[$+2])-4;for($+=12+((15&ge[$+10])<<8|ge[$+11]);$<J;){var pe=(31&ge[$+1])<<8|ge[$+2];switch(ge[$]){case 207:if(!V){he.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:j.audio===-1&&(j.audio=pe);break;case 21:j.id3===-1&&(j.id3=pe);break;case 219:if(!V){he.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:j.avc===-1&&(j.avc=pe);break;case 3:case 4:R.mpeg!==!0&&R.mp3!==!0?he.logger.log("MPEG audio found, not supported in this browser"):j.audio===-1&&(j.audio=pe,j.segmentCodec="mp3");break;case 36:he.logger.warn("Unsupported HEVC stream type found")}$+=5+((15&ge[$+3])<<8|ge[$+4])}return j}function Xe(ge){var $,R,V,j,J,pe=0,ve=ge.data;if(!ge||ge.size===0)return null;for(;ve[0].length<19&&ve.length>1;){var De=new Uint8Array(ve[0].length+ve[1].length);De.set(ve[0]),De.set(ve[1],ve[0].length),ve[0]=De,ve.splice(1,1)}if((($=ve[0])[0]<<16)+($[1]<<8)+$[2]===1){if((R=($[4]<<8)+$[5])&&R>ge.size-6)return null;var Fe=$[7];192&Fe&&(j=536870912*(14&$[9])+4194304*(255&$[10])+16384*(254&$[11])+128*(255&$[12])+(254&$[13])/2,64&Fe?j-(J=536870912*(14&$[14])+4194304*(255&$[15])+16384*(254&$[16])+128*(255&$[17])+(254&$[18])/2)>54e5&&(he.logger.warn(Math.round((j-J)/9e4)+"s delta between PTS and DTS, align them"),j=J):J=j);var je=(V=$[8])+9;if(ge.size<=je)return null;ge.size-=je;for(var qe=new Uint8Array(ge.size),Je=0,Ye=ve.length;Je<Ye;Je++){var ot=($=ve[Je]).byteLength;if(je){if(je>ot){je-=ot;continue}$=$.subarray(je),ot-=je,je=0}qe.set($,pe),pe+=ot}return R&&(R-=V+3),{data:qe,pts:j,dts:J,len:R}}return null}function at(ge,$){if(ge.units.length&&ge.frame){if(ge.pts===void 0){var R=$.samples,V=R.length;if(!V)return void $.dropped++;var j=R[V-1];ge.pts=j.pts,ge.dts=j.dts}$.samples.push(ge)}ge.debug.length&&he.logger.log(ge.pts+"/"+ge.dts+":"+ge.debug)}const mt=function(){function ge(R,V,j){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=R,this.config=V,this.typeSupported=j}ge.probe=function(R){var V=ge.syncOffset(R);return V>0&&he.logger.warn("MPEG2-TS detected but first sync word found @ offset "+V),V!==-1},ge.syncOffset=function(R){for(var V=Math.min(940,R.length-376)+1,j=0;j<V;){if(R[j]===71&&R[j+Oe]===71)return j;j++}return-1},ge.createTrack=function(R,V){return{container:R==="video"||R==="audio"?"video/mp2t":void 0,type:R,id:N.RemuxerTrackIdConfig[R],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:R==="audio"?V:void 0}};var $=ge.prototype;return $.resetInitSegment=function(R,V,j,J){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ge.createTrack("video"),this._audioTrack=ge.createTrack("audio",J),this._id3Track=ge.createTrack("id3"),this._txtTrack=ge.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=V,this.videoCodec=j,this._duration=J},$.resetTimeStamp=function(){},$.resetContiguity=function(){var R=this._audioTrack,V=this._avcTrack,j=this._id3Track;R&&(R.pesData=null),V&&(V.pesData=null),j&&(j.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},$.demux=function(R,V,j,J){var pe;j===void 0&&(j=!1),J===void 0&&(J=!1),j||(this.sampleAes=null);var ve=this._avcTrack,De=this._audioTrack,Fe=this._id3Track,je=this._txtTrack,qe=ve.pid,Je=ve.pesData,Ye=De.pid,ot=Fe.pid,Et=De.pesData,Ut=Fe.pesData,rt=null,Nt=this.pmtParsed,lr=this._pmtId,Wt=R.length;if(this.remainderData&&(Wt=(R=(0,N.appendUint8Array)(this.remainderData,R)).length,this.remainderData=null),Wt<Oe&&!J)return this.remainderData=R,{audioTrack:De,videoTrack:ve,id3Track:Fe,textTrack:je};var Vt=Math.max(0,ge.syncOffset(R));(Wt-=(Wt-Vt)%Oe)<R.byteLength&&!J&&(this.remainderData=new Uint8Array(R.buffer,Wt,R.buffer.byteLength-Wt));for(var Zt=0,dt=Vt;dt<Wt;dt+=Oe)if(R[dt]===71){var Tr=!!(64&R[dt+1]),Qr=((31&R[dt+1])<<8)+R[dt+2],zt=void 0;if((48&R[dt+3])>>4>1){if((zt=dt+5+R[dt+4])===dt+Oe)continue}else zt=dt+4;switch(Qr){case qe:Tr&&(Je&&(pe=Xe(Je))&&this.parseAVCPES(ve,je,pe,!1),Je={data:[],size:0}),Je&&(Je.data.push(R.subarray(zt,dt+Oe)),Je.size+=dt+Oe-zt);break;case Ye:if(Tr){if(Et&&(pe=Xe(Et)))switch(De.segmentCodec){case"aac":this.parseAACPES(De,pe);break;case"mp3":this.parseMPEGPES(De,pe)}Et={data:[],size:0}}Et&&(Et.data.push(R.subarray(zt,dt+Oe)),Et.size+=dt+Oe-zt);break;case ot:Tr&&(Ut&&(pe=Xe(Ut))&&this.parseID3PES(Fe,pe),Ut={data:[],size:0}),Ut&&(Ut.data.push(R.subarray(zt,dt+Oe)),Ut.size+=dt+Oe-zt);break;case 0:Tr&&(zt+=R[zt]+1),lr=this._pmtId=_e(R,zt);break;case lr:Tr&&(zt+=R[zt]+1);var ir=Ne(R,zt,this.typeSupported,j);(qe=ir.avc)>0&&(ve.pid=qe),(Ye=ir.audio)>0&&(De.pid=Ye,De.segmentCodec=ir.segmentCodec),(ot=ir.id3)>0&&(Fe.pid=ot),rt===null||Nt||(he.logger.log("unknown PID '"+rt+"' in TS found"),rt=null,dt=Vt-188),Nt=this.pmtParsed=!0;break;case 17:case 8191:break;default:rt=Qr}}else Zt++;Zt>0&&this.observer.emit(U.Events.ERROR,U.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+Zt+" TS packet/s that do not start with 0x47"}),ve.pesData=Je,De.pesData=Et,Fe.pesData=Ut;var Cr={audioTrack:De,videoTrack:ve,id3Track:Fe,textTrack:je};return J&&this.extractRemainingSamples(Cr),Cr},$.flush=function(){var R,V=this.remainderData;return this.remainderData=null,R=V?this.demux(V,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(R),this.sampleAes?this.decrypt(R,this.sampleAes):R},$.extractRemainingSamples=function(R){var V,j=R.audioTrack,J=R.videoTrack,pe=R.id3Track,ve=R.textTrack,De=J.pesData,Fe=j.pesData,je=pe.pesData;if(De&&(V=Xe(De))?(this.parseAVCPES(J,ve,V,!0),J.pesData=null):J.pesData=De,Fe&&(V=Xe(Fe))){switch(j.segmentCodec){case"aac":this.parseAACPES(j,V);break;case"mp3":this.parseMPEGPES(j,V)}j.pesData=null}else Fe!=null&&Fe.size&&he.logger.log("last AAC PES packet truncated,might overlap between fragments"),j.pesData=Fe;je&&(V=Xe(je))?(this.parseID3PES(pe,V),pe.pesData=null):pe.pesData=je},$.demuxSampleAes=function(R,V,j){var J=this.demux(R,j,!0,!this.config.progressive),pe=this.sampleAes=new Le(this.observer,this.config,V);return this.decrypt(J,pe)},$.decrypt=function(R,V){return new Promise(function(j){var J=R.audioTrack,pe=R.videoTrack;J.samples&&J.segmentCodec==="aac"?V.decryptAacSamples(J.samples,0,function(){pe.samples?V.decryptAvcSamples(pe.samples,0,0,function(){j(R)}):j(R)}):pe.samples&&V.decryptAvcSamples(pe.samples,0,0,function(){j(R)})})},$.destroy=function(){this._duration=0},$.parseAVCPES=function(R,V,j,J){var pe,ve=this,De=this.parseAVCNALu(R,j.data),Fe=this.avcSample,je=!1;j.data=null,Fe&&De.length&&!R.audFound&&(at(Fe,R),Fe=this.avcSample=Be(!1,j.pts,j.dts,"")),De.forEach(function(qe){switch(qe.type){case 1:pe=!0,Fe||(Fe=ve.avcSample=Be(!0,j.pts,j.dts,"")),Fe.frame=!0;var Je=qe.data;if(je&&Je.length>4){var Ye=new Re(Je).readSliceType();Ye!==2&&Ye!==4&&Ye!==7&&Ye!==9||(Fe.key=!0)}break;case 5:pe=!0,Fe||(Fe=ve.avcSample=Be(!0,j.pts,j.dts,"")),Fe.key=!0,Fe.frame=!0;break;case 6:pe=!0,(0,N.parseSEIMessageFromNALu)(qe.data,1,j.pts,V.samples);break;case 7:if(pe=!0,je=!0,!R.sps){var ot=new Re(qe.data).readSPS();R.width=ot.width,R.height=ot.height,R.pixelRatio=ot.pixelRatio,R.sps=[qe.data],R.duration=ve._duration;for(var Et=qe.data.subarray(1,4),Ut="avc1.",rt=0;rt<3;rt++){var Nt=Et[rt].toString(16);Nt.length<2&&(Nt="0"+Nt),Ut+=Nt}R.codec=Ut}break;case 8:pe=!0,R.pps||(R.pps=[qe.data]);break;case 9:pe=!1,R.audFound=!0,Fe&&at(Fe,R),Fe=ve.avcSample=Be(!1,j.pts,j.dts,"");break;case 12:pe=!0;break;default:pe=!1,Fe&&(Fe.debug+="unknown NAL "+qe.type+" ")}Fe&&pe&&Fe.units.push(qe)}),J&&Fe&&(at(Fe,R),this.avcSample=null)},$.getLastNalUnit=function(R){var V,j,J=this.avcSample;if(J&&J.units.length!==0||(J=R[R.length-1]),(V=J)!==null&&V!==void 0&&V.units){var pe=J.units;j=pe[pe.length-1]}return j},$.parseAVCNALu=function(R,V){var j,J,pe=V.byteLength,ve=R.naluState||0,De=ve,Fe=[],je=0,qe=-1,Je=0;for(ve===-1&&(qe=0,Je=31&V[0],ve=0,je=1);je<pe;)if(j=V[je++],ve)if(ve!==1)if(j)if(j===1){if(qe>=0){var Ye={data:V.subarray(qe,je-ve-1),type:Je};Fe.push(Ye)}else{var ot=this.getLastNalUnit(R.samples);if(ot&&(De&&je<=4-De&&ot.state&&(ot.data=ot.data.subarray(0,ot.data.byteLength-De)),(J=je-ve-1)>0)){var Et=new Uint8Array(ot.data.byteLength+J);Et.set(ot.data,0),Et.set(V.subarray(0,J),ot.data.byteLength),ot.data=Et,ot.state=0}}je<pe?(qe=je,Je=31&V[je],ve=0):ve=-1}else ve=0;else ve=3;else ve=j?0:2;else ve=j?0:1;if(qe>=0&&ve>=0){var Ut={data:V.subarray(qe,pe),type:Je,state:ve};Fe.push(Ut)}if(Fe.length===0){var rt=this.getLastNalUnit(R.samples);if(rt){var Nt=new Uint8Array(rt.data.byteLength+V.byteLength);Nt.set(rt.data,0),Nt.set(V,rt.data.byteLength),rt.data=Nt}}return R.naluState=ve,Fe},$.parseAACPES=function(R,V){var j,J,pe,ve,De,Fe=0,je=this.aacOverFlow,qe=V.data;if(je){this.aacOverFlow=null;var Je=je.missing,Ye=je.sample.unit.byteLength;if(Je===-1){var ot=new Uint8Array(Ye+qe.byteLength);ot.set(je.sample.unit,0),ot.set(qe,Ye),qe=ot}else{var Et=Ye-Je;je.sample.unit.set(qe.subarray(0,Je),Et),R.samples.push(je.sample),Fe=je.missing}}for(j=Fe,J=qe.length;j<J-1&&!Ae(qe,j);j++);if(j===Fe||(j<J-1?(pe="AAC PES did not start with ADTS header,offset:"+j,ve=!1):(pe="no ADTS header found in AAC PES",ve=!0),he.logger.warn("parsing error:"+pe),this.observer.emit(U.Events.ERROR,U.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:ve,reason:pe}),!ve)){if(Q(R,this.observer,qe,j,this.audioCodec),V.pts!==void 0)De=V.pts;else{if(!je)return void he.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var Ut=L(R.samplerate);De=je.sample.pts+Ut}for(var rt,Nt=0;j<J;){if(j+=(rt=W(R,qe,j,De,Nt)).length,rt.missing){this.aacOverFlow=rt;break}for(Nt++;j<J-1&&!Ae(qe,j);j++);}}},$.parseMPEGPES=function(R,V){var j=V.data,J=j.length,pe=0,ve=0,De=V.pts;if(De!==void 0)for(;ve<J;)if(Ee(j,ve)){var Fe=Ke(R,j,ve,De,pe);if(!Fe)break;ve+=Fe.length,pe++}else ve++;else he.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},$.parseID3PES=function(R,V){if(V.pts!==void 0){var j=Me({},V,{type:this._avcTrack?O.MetadataSchema.emsg:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});R.samples.push(j)}else he.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},ge}();function gt(ge,$){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,V){return R.__proto__=V,R},gt(ge,$)}const Ft=function(ge){var $,R;function V(){return ge.apply(this,arguments)||this}R=ge,($=V).prototype=Object.create(R.prototype),$.prototype.constructor=$,gt($,R);var j=V.prototype;return j.resetInitSegment=function(J,pe,ve,De){ge.prototype.resetInitSegment.call(this,J,pe,ve,De),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:pe,duration:De,inputTimeScale:9e4,dropped:0}},V.probe=function(J){if(!J)return!1;for(var pe=(I.getID3Data(J,0)||[]).length,ve=J.length;pe<ve;pe++)if(ue(J,pe))return he.logger.log("MPEG Audio sync word found !"),!0;return!1},j.canParse=function(J,pe){return function(ve,De){return ie(ve,De)&&4<=ve.length-De}(J,pe)},j.appendFrame=function(J,pe,ve){if(this.basePTS!==null)return Ke(J,pe,ve,this.basePTS,this.frameIndex)},V}(z);var Mt=w(524),xt=w(923);function Ot(ge,$){var R=ge==null?void 0:ge.codec;return R&&R.length>4?R:R==="hvc1"||R==="hev1"?"hvc1.1.c.L120.90":R==="av01"?"av01.0.04M.08":R==="avc1"||$===xt.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const ht=function(){function ge(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var $=ge.prototype;return $.destroy=function(){},$.resetTimeStamp=function(R){this.initPTS=R,this.lastEndTime=null},$.resetNextTimestamp=function(){this.lastEndTime=null},$.resetInitSegment=function(R,V,j,J){this.audioCodec=V,this.videoCodec=j,this.generateInitSegment((0,N.patchEncyptionData)(R,J)),this.emitInitSegment=!0},$.generateInitSegment=function(R){var V=this.audioCodec,j=this.videoCodec;if(!R||!R.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var J=this.initData=(0,N.parseInitSegment)(R);V||(V=Ot(J.audio,xt.ElementaryStreamTypes.AUDIO)),j||(j=Ot(J.video,xt.ElementaryStreamTypes.VIDEO));var pe={};J.audio&&J.video?pe.audiovideo={container:"video/mp4",codec:V+","+j,initSegment:R,id:"main"}:J.audio?pe.audio={container:"audio/mp4",codec:V,initSegment:R,id:"audio"}:J.video?pe.video={container:"video/mp4",codec:j,initSegment:R,id:"main"}:he.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=pe},$.remux=function(R,V,j,J,pe){var ve,De=this.initPTS,Fe=this.lastEndTime,je={audio:void 0,video:void 0,text:J,id3:j,initSegment:void 0};(0,g.isFiniteNumber)(Fe)||(Fe=this.lastEndTime=pe||0);var qe=V.samples;if(!qe||!qe.length)return je;var Je={initPTS:void 0,timescale:1},Ye=this.initData;if(Ye&&Ye.length||(this.generateInitSegment(qe),Ye=this.initData),!Ye||!Ye.length)return he.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),je;this.emitInitSegment&&(Je.tracks=this.initTracks,this.emitInitSegment=!1);var ot=(0,N.getStartDTS)(Ye,qe);(0,g.isFiniteNumber)(De)||(this.initPTS=Je.initPTS=De=ot-pe);var Et=(0,N.getDuration)(qe,Ye),Ut=R?ot-De:Fe,rt=Ut+Et;(0,N.offsetStartDTS)(Ye,qe,De),Et>0?this.lastEndTime=rt:(he.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var Nt=!!Ye.audio,lr=!!Ye.video,Wt="";Nt&&(Wt+="audio"),lr&&(Wt+="video");var Vt={data1:qe,startPTS:Ut,startDTS:Ut,endPTS:rt,endDTS:rt,type:Wt,hasAudio:Nt,hasVideo:lr,nb:1,dropped:0};je.audio=Vt.type==="audio"?Vt:void 0,je.video=Vt.type!=="audio"?Vt:void 0,je.initSegment=Je;var Zt=(ve=this.initPTS)!=null?ve:0;return je.id3=(0,Mt.flushTextTrackMetadataCueSamples)(j,pe,Zt,Zt),J.samples.length&&(je.text=(0,Mt.flushTextTrackUserdataCueSamples)(J,pe,Zt)),je},ge}();var ct;try{ct=self.performance.now.bind(self.performance)}catch{he.logger.debug("Unable to use Performance API on this environment"),ct=self.Date.now}var Pt=[{demux:ne,remux:ht},{demux:mt,remux:Mt.default},{demux:se,remux:Mt.default},{demux:Ft,remux:Mt.default}],Ht=function(){function ge(R,V,j,J,pe){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=R,this.typeSupported=V,this.config=j,this.vendor=J,this.id=pe}var $=ge.prototype;return $.configure=function(R){this.transmuxConfig=R,this.decrypter&&this.decrypter.reset()},$.push=function(R,V,j,J){var pe=this,ve=j.transmuxing;ve.executeStart=ct();var De=new Uint8Array(R),Fe=this.currentTransmuxState,je=this.transmuxConfig;J&&(this.currentTransmuxState=J);var qe=J||Fe,Je=qe.contiguous,Ye=qe.discontinuity,ot=qe.trackSwitch,Et=qe.accurateTimeOffset,Ut=qe.timeOffset,rt=qe.initSegmentChange,Nt=je.audioCodec,lr=je.videoCodec,Wt=je.defaultInitPts,Vt=je.duration,Zt=je.initSegmentData,dt=function(Zr,Ur){var $t=null;return Zr.byteLength>0&&Ur!=null&&Ur.key!=null&&Ur.iv!==null&&Ur.method!=null&&($t=Ur),$t}(De,V);if(dt&&dt.method==="AES-128"){var Tr=this.getDecrypter();if(!Tr.isSync())return this.decryptionPromise=Tr.webCryptoDecrypt(De,dt.key.buffer,dt.iv.buffer).then(function(Zr){var Ur=pe.push(Zr,null,j);return pe.decryptionPromise=null,Ur}),this.decryptionPromise;var Qr=Tr.softwareDecrypt(De,dt.key.buffer,dt.iv.buffer);if(!Qr)return ve.executeEnd=ct(),qt(j);De=new Uint8Array(Qr)}var zt=this.needsProbing(Ye,ot);zt&&this.configureTransmuxer(De),(Ye||ot||rt||zt)&&this.resetInitSegment(Zt,Nt,lr,Vt,V),(Ye||rt||zt)&&this.resetInitialTimestamp(Wt),Je||this.resetContiguity();var ir=this.transmux(De,dt,Ut,Et,j),Cr=this.currentTransmuxState;return Cr.contiguous=!0,Cr.discontinuity=!1,Cr.trackSwitch=!1,ve.executeEnd=ct(),ir},$.flush=function(R){var V=this,j=R.transmuxing;j.executeStart=ct();var J=this.decrypter,pe=this.currentTransmuxState,ve=this.decryptionPromise;if(ve)return ve.then(function(){return V.flush(R)});var De=[],Fe=pe.timeOffset;if(J){var je=J.flush();je&&De.push(this.push(je,null,R))}var qe=this.demuxer,Je=this.remuxer;if(!qe||!Je)return this.observer.emit(U.Events.ERROR,U.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),j.executeEnd=ct(),[qt(R)];var Ye=qe.flush(Fe);return nr(Ye)?Ye.then(function(ot){return V.flushRemux(De,ot,R),De}):(this.flushRemux(De,Ye,R),De)},$.flushRemux=function(R,V,j){var J=V.audioTrack,pe=V.videoTrack,ve=V.id3Track,De=V.textTrack,Fe=this.currentTransmuxState,je=Fe.accurateTimeOffset,qe=Fe.timeOffset;he.logger.log("[transmuxer.ts]: Flushed fragment "+j.sn+(j.part>-1?" p: "+j.part:"")+" of level "+j.level);var Je=this.remuxer.remux(J,pe,ve,De,qe,je,!0,this.id);R.push({remuxResult:Je,chunkMeta:j}),j.transmuxing.executeEnd=ct()},$.resetInitialTimestamp=function(R){var V=this.demuxer,j=this.remuxer;V&&j&&(V.resetTimeStamp(R),j.resetTimeStamp(R))},$.resetContiguity=function(){var R=this.demuxer,V=this.remuxer;R&&V&&(R.resetContiguity(),V.resetNextTimestamp())},$.resetInitSegment=function(R,V,j,J,pe){var ve=this.demuxer,De=this.remuxer;ve&&De&&(ve.resetInitSegment(R,V,j,J),De.resetInitSegment(R,V,j,pe))},$.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},$.transmux=function(R,V,j,J,pe){return V&&V.method==="SAMPLE-AES"?this.transmuxSampleAes(R,V,j,J,pe):this.transmuxUnencrypted(R,j,J,pe)},$.transmuxUnencrypted=function(R,V,j,J){var pe=this.demuxer.demux(R,V,!1,!this.config.progressive),ve=pe.audioTrack,De=pe.videoTrack,Fe=pe.id3Track,je=pe.textTrack;return{remuxResult:this.remuxer.remux(ve,De,Fe,je,V,j,!1,this.id),chunkMeta:J}},$.transmuxSampleAes=function(R,V,j,J,pe){var ve=this;return this.demuxer.demuxSampleAes(R,V,j).then(function(De){return{remuxResult:ve.remuxer.remux(De.audioTrack,De.videoTrack,De.id3Track,De.textTrack,j,J,!1,ve.id),chunkMeta:pe}})},$.configureTransmuxer=function(R){for(var V,j=this.config,J=this.observer,pe=this.typeSupported,ve=this.vendor,De=0,Fe=Pt.length;De<Fe;De++)if(Pt[De].demux.probe(R)){V=Pt[De];break}V||(he.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),V={demux:ne,remux:ht});var je=this.demuxer,qe=this.remuxer,Je=V.remux,Ye=V.demux;qe&&qe instanceof Je||(this.remuxer=new Je(J,j,pe,ve)),je&&je instanceof Ye||(this.demuxer=new Ye(J,j,pe),this.probe=Ye.probe)},$.needsProbing=function(R,V){return!this.demuxer||!this.remuxer||R||V},$.getDecrypter=function(){var R=this.decrypter;return R||(R=this.decrypter=new P.default(this.config)),R},ge}(),qt=function(ge){return{remuxResult:{},chunkMeta:ge}};function nr(ge){return"then"in ge&&ge.then instanceof Function}var tr=function(ge,$,R,V,j){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=ge,this.videoCodec=$,this.initSegmentData=R,this.duration=V,this.defaultInitPts=j},Lr=function(ge,$,R,V,j,J){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=ge,this.contiguous=$,this.accurateTimeOffset=R,this.trackSwitch=V,this.timeOffset=j,this.initSegmentChange=J}},973:(k,A,w)=>{var U,x;w.r(A),w.d(A,{ErrorDetails:()=>x,ErrorTypes:()=>U}),function(P){P.NETWORK_ERROR="networkError",P.MEDIA_ERROR="mediaError",P.KEY_SYSTEM_ERROR="keySystemError",P.MUX_ERROR="muxError",P.OTHER_ERROR="otherError"}(U||(U={})),function(P){P.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",P.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",P.KEY_SYSTEM_NO_SESSION="keySystemNoSession",P.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",P.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",P.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",P.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",P.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",P.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",P.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",P.MANIFEST_LOAD_ERROR="manifestLoadError",P.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",P.MANIFEST_PARSING_ERROR="manifestParsingError",P.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",P.LEVEL_EMPTY_ERROR="levelEmptyError",P.LEVEL_LOAD_ERROR="levelLoadError",P.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",P.LEVEL_SWITCH_ERROR="levelSwitchError",P.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",P.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",P.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",P.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",P.FRAG_LOAD_ERROR="fragLoadError",P.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",P.FRAG_DECRYPT_ERROR="fragDecryptError",P.FRAG_PARSING_ERROR="fragParsingError",P.REMUX_ALLOC_ERROR="remuxAllocError",P.KEY_LOAD_ERROR="keyLoadError",P.KEY_LOAD_TIMEOUT="keyLoadTimeOut",P.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",P.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",P.BUFFER_APPEND_ERROR="bufferAppendError",P.BUFFER_APPENDING_ERROR="bufferAppendingError",P.BUFFER_STALLED_ERROR="bufferStalledError",P.BUFFER_FULL_ERROR="bufferFullError",P.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",P.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",P.INTERNAL_EXCEPTION="internalException",P.INTERNAL_ABORTED="aborted",P.UNKNOWN="unknown"}(x||(x={}))},851:(k,A,w)=>{var U;w.r(A),w.d(A,{Events:()=>U}),function(x){x.MEDIA_ATTACHING="hlsMediaAttaching",x.MEDIA_ATTACHED="hlsMediaAttached",x.MEDIA_DETACHING="hlsMediaDetaching",x.MEDIA_DETACHED="hlsMediaDetached",x.BUFFER_RESET="hlsBufferReset",x.BUFFER_CODECS="hlsBufferCodecs",x.BUFFER_CREATED="hlsBufferCreated",x.BUFFER_APPENDING="hlsBufferAppending",x.BUFFER_APPENDED="hlsBufferAppended",x.BUFFER_EOS="hlsBufferEos",x.BUFFER_FLUSHING="hlsBufferFlushing",x.BUFFER_FLUSHED="hlsBufferFlushed",x.MANIFEST_LOADING="hlsManifestLoading",x.MANIFEST_LOADED="hlsManifestLoaded",x.MANIFEST_PARSED="hlsManifestParsed",x.LEVEL_SWITCHING="hlsLevelSwitching",x.LEVEL_SWITCHED="hlsLevelSwitched",x.LEVEL_LOADING="hlsLevelLoading",x.LEVEL_LOADED="hlsLevelLoaded",x.LEVEL_UPDATED="hlsLevelUpdated",x.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",x.LEVELS_UPDATED="hlsLevelsUpdated",x.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",x.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",x.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",x.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",x.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",x.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",x.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",x.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",x.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",x.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",x.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",x.CUES_PARSED="hlsCuesParsed",x.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",x.INIT_PTS_FOUND="hlsInitPtsFound",x.FRAG_LOADING="hlsFragLoading",x.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",x.FRAG_LOADED="hlsFragLoaded",x.FRAG_DECRYPTED="hlsFragDecrypted",x.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",x.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",x.FRAG_PARSING_METADATA="hlsFragParsingMetadata",x.FRAG_PARSED="hlsFragParsed",x.FRAG_BUFFERED="hlsFragBuffered",x.FRAG_CHANGED="hlsFragChanged",x.FPS_DROP="hlsFpsDrop",x.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",x.ERROR="hlsError",x.DESTROYING="hlsDestroying",x.KEY_LOADING="hlsKeyLoading",x.KEY_LOADED="hlsKeyLoaded",x.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",x.BACK_BUFFER_REACHED="hlsBackBufferReached"}(U||(U={}))},76:(k,A,w)=>{w.r(A),w.d(A,{default:()=>jl});var U,x=w(945),P=w(965),g=w(851),I=w(973),O=w(93),X=/^(\d+)x(\d+)$/,N=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,ye=function(){function p(t){for(var r in typeof t=="string"&&(t=p.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var d=p.prototype;return d.decimalInteger=function(t){var r=parseInt(this[t],10);return r>Number.MAX_SAFE_INTEGER?1/0:r},d.hexadecimalInteger=function(t){if(this[t]){var r=(this[t]||"0x").slice(2);r=(1&r.length?"0":"")+r;for(var s=new Uint8Array(r.length/2),o=0;o<r.length/2;o++)s[o]=parseInt(r.slice(2*o,2*o+2),16);return s}return null},d.hexadecimalIntegerAsNumber=function(t){var r=parseInt(this[t],16);return r>Number.MAX_SAFE_INTEGER?1/0:r},d.decimalFloatingPoint=function(t){return parseFloat(this[t])},d.optionalFloat=function(t,r){var s=this[t];return s?parseFloat(s):r},d.enumeratedString=function(t){return this[t]},d.bool=function(t){return this[t]==="YES"},d.decimalResolution=function(t){var r=X.exec(this[t]);if(r!==null)return{width:parseInt(r[1],10),height:parseInt(r[2],10)}},p.parseAttrList=function(t){var r,s={};for(N.lastIndex=0;(r=N.exec(t))!==null;){var o=r[2];o.indexOf('"')===0&&o.lastIndexOf('"')===o.length-1&&(o=o.slice(1,-1)),s[r[1]]=o}return s},p}();function de(){return de=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},de.apply(this,arguments)}function re(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}(function(p){p.ID="ID",p.CLASS="CLASS",p.START_DATE="START-DATE",p.DURATION="DURATION",p.END_DATE="END-DATE",p.END_ON_NEXT="END-ON-NEXT",p.PLANNED_DURATION="PLANNED-DURATION",p.SCTE35_OUT="SCTE35-OUT",p.SCTE35_IN="SCTE35-IN"})(U||(U={}));var z=function(){function p(r,s){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,s){var o=s.attr;for(var l in o)if(Object.prototype.hasOwnProperty.call(r,l)&&r[l]!==o[l]){O.logger.warn('DATERANGE tag attribute: "'+l+'" does not match for tags with ID: "'+r.ID+'"'),this._badValueForSameId=l;break}r=de(new ye({}),o,r)}if(this.attr=r,this._startDate=new Date(r[U.START_DATE]),U.END_DATE in this.attr){var n=new Date(this.attr[U.END_DATE]);(0,P.isFiniteNumber)(n.getTime())&&(this._endDate=n)}}var d,t;return d=p,(t=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var r=this.duration;return r!==null?new Date(this._startDate.getTime()+1e3*r):null}},{key:"duration",get:function(){if(U.DURATION in this.attr){var r=this.attr.decimalFloatingPoint(U.DURATION);if((0,P.isFiniteNumber)(r))return r}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return U.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(U.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(U.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,P.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&re(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}(),he=w(923);function G(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}var Y,me,Ae,ke=function(){function p(r){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=r}var d,t;return p.prototype.reloaded=function(r){if(!r)return this.advanced=!0,void(this.updated=!0);var s=this.lastPartSn-r.lastPartSn,o=this.lastPartIndex-r.lastPartIndex;this.updated=this.endSN!==r.endSN||!!o||!!s,this.advanced=this.endSN>r.endSN||s>0||s===0&&o>0,this.updated||this.advanced?this.misses=Math.floor(.6*r.misses):this.misses=r.misses+1,this.availabilityDelay=r.availabilityDelay},d=p,(t=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&(0,P.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var r=this.driftEndTime-this.driftStartTime;return r>0?1e3*(this.driftEnd-this.driftStart)/r:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var r;return(r=this.partList)!==null&&r!==void 0&&r.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var r;return(r=this.fragments)!==null&&r!==void 0&&r.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var r;return(r=this.partList)!==null&&r!==void 0&&r.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var r;return(r=this.partList)!==null&&r!==void 0&&r.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&G(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}();function Q(p){return Uint8Array.from(atob(p),function(d){return d.charCodeAt(0)})}function L(p){return Uint8Array.from(unescape(encodeURIComponent(p)),function(d){return d.charCodeAt(0)})}function W(p){switch(p){case me.FAIRPLAY:return Y.FAIRPLAY;case me.PLAYREADY:return Y.PLAYREADY;case me.WIDEVINE:return Y.WIDEVINE;case me.CLEARKEY:return Y.CLEARKEY}}function B(p){switch(p){case Y.FAIRPLAY:return me.FAIRPLAY;case Y.PLAYREADY:return me.PLAYREADY;case Y.WIDEVINE:return me.WIDEVINE;case Y.CLEARKEY:return me.CLEARKEY}}function se(p){var d=p.drmSystems,t=p.widevineLicenseUrl,r=d?[Y.FAIRPLAY,Y.WIDEVINE,Y.PLAYREADY,Y.CLEARKEY].filter(function(s){return!!d[s]}):[];return!r[Y.WIDEVINE]&&t&&r.push(Y.WIDEVINE),r}(function(p){p.CLEARKEY="org.w3.clearkey",p.FAIRPLAY="com.apple.fps",p.PLAYREADY="com.microsoft.playready",p.WIDEVINE="com.widevine.alpha"})(Y||(Y={})),function(p){p.CLEARKEY="org.w3.clearkey",p.FAIRPLAY="com.apple.streamingkeydelivery",p.PLAYREADY="com.microsoft.playready",p.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"}(me||(me={})),function(p){p.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"}(Ae||(Ae={}));var fe=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,ne=w(63),Te={},He=function(){function p(t,r,s,o,l){o===void 0&&(o=[1]),l===void 0&&(l=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=r,this.keyFormat=s,this.keyFormatVersions=o,this.iv=l,this.encrypted=!!t&&t!=="NONE",this.isCommonEncryption=this.encrypted&&t!=="AES-128"}p.clearKeyUriToKeyIdMap=function(){Te={}};var d=p.prototype;return d.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case me.FAIRPLAY:case me.WIDEVINE:case me.PLAYREADY:case me.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},d.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method!=="AES-128"||this.iv||O.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var r=function(q){for(var K=new Uint8Array(16),ce=12;ce<16;ce++)K[ce]=q>>8*(15-ce)&255;return K}(t);return new p(this.method,this.uri,"identity",this.keyFormatVersions,r)}var s=function(q){var K,ce,Se=q.split(":"),Ce=null;if(Se[0]==="data"&&Se.length===2){var Ie=Se[1].split(";"),Pe=Ie[Ie.length-1].split(",");if(Pe.length===2){var Qe=Pe[0]==="base64",st=Pe[1];Qe?(Ie.splice(-1,1),Ce=Q(st)):(K=L(st).subarray(0,16),(ce=new Uint8Array(16)).set(K,16-K.length),Ce=ce)}}return Ce}(this.uri);if(s)switch(this.keyFormat){case me.WIDEVINE:this.pssh=s,s.length>=22&&(this.keyId=s.subarray(s.length-22,s.length-6));break;case me.PLAYREADY:var o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,ne.mp4pssh)(o,null,s);var l=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),n=String.fromCharCode.apply(null,Array.from(l)),u=n.substring(n.indexOf("<"),n.length),c=new DOMParser().parseFromString(u,"text/xml").getElementsByTagName("KID")[0];if(c){var f=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(f){var v=Q(f).subarray(0,16);(function(q){var K=function(ce,Se,Ce){var Ie=ce[Se];ce[Se]=ce[Ce],ce[Ce]=Ie};K(q,0,3),K(q,1,2),K(q,4,5),K(q,6,7)})(v),this.keyId=v}}break;default:var b=s.subarray(0,16);if(b.length!==16){var D=new Uint8Array(16);D.set(b,16-b.length),b=D}this.keyId=b}if(!this.keyId||this.keyId.byteLength!==16){var C=Te[this.uri];if(!C){var F=Object.keys(Te).length%Number.MAX_SAFE_INTEGER;C=new Uint8Array(16),new DataView(C.buffer,12,4).setUint32(0,F),Te[this.uri]=C}this.keyId=C}return this},p}(),le={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function ae(p,d){return MediaSource.isTypeSupported((d||"video")+'/mp4;codecs="'+p+'"')}function we(){return we=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},we.apply(this,arguments)}var Ke=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,We=/#EXT-X-MEDIA:(.*)/g,ie=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Ee=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),ue=function(){function p(){}return p.findGroup=function(d,t){for(var r=0;r<d.length;r++){var s=d[r];if(s.id===t)return s}},p.convertAVC1ToAVCOTI=function(d){var t=d.split(".");if(t.length>2){var r=t.shift()+".";return(r+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).slice(-4)}return d},p.resolve=function(d,t){return(0,x.buildAbsoluteURL)(t,d,{alwaysNormalize:!0})},p.parseMasterPlaylist=function(d,t){var r,s=[],o=[],l={},n=[],u=!1;for(Ke.lastIndex=0;(r=Ke.exec(d))!=null;)if(r[1]){var c,f=new ye(r[1]),v={attrs:f,bitrate:f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),name:f.NAME,url:p.resolve(r[2],t)},b=f.decimalResolution("RESOLUTION");b&&(v.width=b.width,v.height=b.height),Le((f.CODECS||"").split(/[ ,]+/).filter(function(q){return q}),v),v.videoCodec&&v.videoCodec.indexOf("avc1")!==-1&&(v.videoCodec=p.convertAVC1ToAVCOTI(v.videoCodec)),(c=v.unknownCodecs)!==null&&c!==void 0&&c.length||o.push(v),s.push(v)}else if(r[3]){var D=new ye(r[3]);D["DATA-ID"]&&(u=!0,l[D["DATA-ID"]]=D)}else if(r[4]){var C=r[4],F=Re(C,t);F.encrypted&&F.isSupported()?n.push(F):O.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+C+'"')}return{levels:o.length>0&&o.length<s.length?o:s,sessionData:u?l:null,sessionKeys:n.length?n:null}},p.parseMasterPlaylistMedia=function(d,t,r,s){var o;s===void 0&&(s=[]);var l=[],n=0;for(We.lastIndex=0;(o=We.exec(d))!==null;){var u=new ye(o[1]);if(u.TYPE===r){var c={attrs:u,bitrate:0,id:n++,groupId:u["GROUP-ID"],instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:r,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?p.resolve(u.URI,t):""};if(s.length){var f=p.findGroup(s,c.groupId)||s[0];Me(c,f,"audioCodec"),Me(c,f,"textCodec")}l.push(c)}}return l},p.parseLevelPlaylist=function(d,t,r,s,o){var l,n,u,c=new ke(t),f=c.fragments,v=null,b=0,D=0,C=0,F=0,q=null,K=new he.Fragment(s,t),ce=-1,Se=!1;for(ie.lastIndex=0,c.m3u8=d;(l=ie.exec(d))!==null;){Se&&(Se=!1,(K=new he.Fragment(s,t)).start=C,K.sn=b,K.cc=F,K.level=r,v&&(K.initSegment=v,K.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null));var Ce=l[1];if(Ce){K.duration=parseFloat(Ce);var Ie=(" "+l[2]).slice(1);K.title=Ie||null,K.tagList.push(Ie?["INF",Ce,Ie]:["INF",Ce])}else if(l[3]){if((0,P.isFiniteNumber)(K.duration)){if(K.start=C,u){K.levelkeys=u;var Pe=c.encryptedFragments;!K.levelkeys||!Object.keys(K.levelkeys).some(function(ei){return K.levelkeys[ei].isCommonEncryption})||Pe.length&&Pe[Pe.length-1].levelkeys===u||Pe.push(K)}K.sn=b,K.level=r,K.cc=F,K.urlId=o,f.push(K),K.relurl=(" "+l[3]).slice(1),Oe(K,q),q=K,C+=K.duration,b++,D=0,Se=!0}}else if(l[4]){var Qe=(" "+l[4]).slice(1);q?K.setByteRange(Qe,q):K.setByteRange(Qe)}else if(l[5])K.rawProgramDateTime=(" "+l[5]).slice(1),K.tagList.push(["PROGRAM-DATE-TIME",K.rawProgramDateTime]),ce===-1&&(ce=f.length);else{if(!(l=l[0].match(Ee))){O.logger.warn("No matches on slow regex match for level playlist!");continue}for(n=1;n<l.length&&l[n]===void 0;n++);var st=(" "+l[n]).slice(1),xe=(" "+l[n+1]).slice(1),ze=l[n+2]?(" "+l[n+2]).slice(1):"";switch(st){case"PLAYLIST-TYPE":c.type=xe.toUpperCase();break;case"MEDIA-SEQUENCE":b=c.startSN=parseInt(xe);break;case"SKIP":var $e=new ye(xe),St=$e.decimalInteger("SKIPPED-SEGMENTS");if((0,P.isFiniteNumber)(St)){c.skippedSegments=St;for(var Gt=St;Gt--;)f.unshift(null);b+=St}var wt=$e.enumeratedString("RECENTLY-REMOVED-DATERANGES");wt&&(c.recentlyRemovedDateranges=wt.split("	"));break;case"TARGETDURATION":c.targetduration=parseFloat(xe);break;case"VERSION":c.version=parseInt(xe);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(xe||ze)&&K.tagList.push(ze?[xe,ze]:[xe]);break;case"DISCONTINUITY":F++,K.tagList.push(["DIS"]);break;case"GAP":K.tagList.push([st]);break;case"BITRATE":K.tagList.push([st,xe]);break;case"DATERANGE":var Ct=new ye(xe),Bt=new z(Ct,c.dateRanges[Ct.ID]);Bt.isValid||c.skippedSegments?c.dateRanges[Bt.id]=Bt:O.logger.warn('Ignoring invalid DATERANGE tag: "'+xe+'"'),K.tagList.push(["EXT-X-DATERANGE",xe]);break;case"DISCONTINUITY-SEQUENCE":F=parseInt(xe);break;case"KEY":var hr=Re(xe,t);if(hr.isSupported()){if(hr.method==="NONE"){u=void 0;break}u||(u={}),u[hr.keyFormat]&&(u=we({},u)),u[hr.keyFormat]=hr}else O.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+xe+'"');break;case"START":var or=new ye(xe).decimalFloatingPoint("TIME-OFFSET");(0,P.isFiniteNumber)(or)&&(c.startTimeOffset=or);break;case"MAP":var er=new ye(xe);if(K.duration){var fr=new he.Fragment(s,t);Be(fr,er,r,u),v=fr,K.initSegment=v,v.rawProgramDateTime&&!K.rawProgramDateTime&&(K.rawProgramDateTime=v.rawProgramDateTime)}else Be(K,er,r,u),v=K,Se=!0;break;case"SERVER-CONTROL":var Hr=new ye(xe);c.canBlockReload=Hr.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=Hr.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&Hr.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=Hr.optionalFloat("PART-HOLD-BACK",0),c.holdBack=Hr.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var so=new ye(xe);c.partTarget=so.decimalFloatingPoint("PART-TARGET");break;case"PART":var oi=c.partList;oi||(oi=c.partList=[]);var Yn=D>0?oi[oi.length-1]:void 0,zn=D++,Xn=new he.Part(new ye(xe),K,t,zn,Yn);oi.push(Xn),K.duration+=Xn.duration;break;case"PRELOAD-HINT":var yt=new ye(xe);c.preloadHint=yt;break;case"RENDITION-REPORT":var kt=new ye(xe);c.renditionReports=c.renditionReports||[],c.renditionReports.push(kt);break;default:O.logger.warn("line parsed but not handled: "+l)}}}q&&!q.relurl?(f.pop(),C-=q.duration,c.partList&&(c.fragmentHint=q)):c.partList&&(Oe(K,q),K.cc=F,c.fragmentHint=K);var fn=f.length,Si=f[0],li=f[fn-1];if((C+=c.skippedSegments*c.targetduration)>0&&fn&&li){c.averagetargetduration=C/fn;var pn=li.sn;c.endSN=pn!=="initSegment"?pn:0,c.live||(li.endList=!0),Si&&(c.startCC=Si.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(C+=c.fragmentHint.duration),c.totalduration=C,c.endCC=F,ce>0&&function(ei,Ai){for(var xi=ei[Ai],zr=Ai;zr--;){var Oi=ei[zr];if(!Oi)return;Oi.programDateTime=xi.programDateTime-1e3*Oi.duration,xi=Oi}}(f,ce),c},p}();function Re(p,d){var t,r,s=new ye(p),o=(t=s.enumeratedString("METHOD"))!=null?t:"",l=s.URI,n=s.hexadecimalInteger("IV"),u=s.enumeratedString("KEYFORMATVERSIONS"),c=(r=s.enumeratedString("KEYFORMAT"))!=null?r:"identity";l&&s.IV&&!n&&O.logger.error("Invalid IV: "+s.IV);var f=l?ue.resolve(l,d):"",v=(u||"1").split("/").map(Number).filter(Number.isFinite);return new He(o,f,c,v,n)}function Le(p,d){["video","audio","text"].forEach(function(t){var r=p.filter(function(o){return function(l,n){var u=le[n];return!!u&&u[l.slice(0,4)]===!0}(o,t)});if(r.length){var s=r.filter(function(o){return o.lastIndexOf("avc1",0)===0||o.lastIndexOf("mp4a",0)===0});d[t+"Codec"]=s.length>0?s[0]:r[0],p=p.filter(function(o){return r.indexOf(o)===-1})}}),d.unknownCodecs=p}function Me(p,d,t){var r=d[t];r&&(p[t]=r)}function Oe(p,d){p.rawProgramDateTime?p.programDateTime=Date.parse(p.rawProgramDateTime):d!=null&&d.programDateTime&&(p.programDateTime=d.endProgramDateTime),(0,P.isFiniteNumber)(p.programDateTime)||(p.programDateTime=null,p.rawProgramDateTime=null)}function Be(p,d,t,r){p.relurl=d.URI,d.BYTERANGE&&p.setByteRange(d.BYTERANGE),p.level=t,p.sn="initSegment",r&&(p.levelkeys=r),p.initSegment=null}var _e=w(308);function Ne(p,d){var t=p.url;return t!==void 0&&t.indexOf("data:")!==0||(t=d.url),t}const Xe=function(){function p(t){this.hls=void 0,this.loaders=Object.create(null),this.hls=t,this.registerListeners()}var d=p.prototype;return d.startLoad=function(t){},d.stopLoad=function(){this.destroyInternalLoaders()},d.registerListeners=function(){var t=this.hls;t.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(g.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(g.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.unregisterListeners=function(){var t=this.hls;t.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(g.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(g.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.createInternalLoader=function(t){var r=this.hls.config,s=r.pLoader,o=r.loader,l=new(s||o)(r);return t.loader=l,this.loaders[t.type]=l,l},d.getInternalLoader=function(t){return this.loaders[t.type]},d.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},d.destroyInternalLoaders=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy(),this.resetInternalLoader(t)}},d.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},d.onManifestLoading=function(t,r){var s=r.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:_e.PlaylistContextType.MANIFEST,url:s,deliveryDirectives:null})},d.onLevelLoading=function(t,r){var s=r.id,o=r.level,l=r.url,n=r.deliveryDirectives;this.load({id:s,groupId:null,level:o,responseType:"text",type:_e.PlaylistContextType.LEVEL,url:l,deliveryDirectives:n})},d.onAudioTrackLoading=function(t,r){var s=r.id,o=r.groupId,l=r.url,n=r.deliveryDirectives;this.load({id:s,groupId:o,level:null,responseType:"text",type:_e.PlaylistContextType.AUDIO_TRACK,url:l,deliveryDirectives:n})},d.onSubtitleTrackLoading=function(t,r){var s=r.id,o=r.groupId,l=r.url,n=r.deliveryDirectives;this.load({id:s,groupId:o,level:null,responseType:"text",type:_e.PlaylistContextType.SUBTITLE_TRACK,url:l,deliveryDirectives:n})},d.load=function(t){var r,s,o,l,n,u,c=this.hls.config,f=this.getInternalLoader(t);if(f){var v=f.context;if(v&&v.url===t.url)return void O.logger.trace("[playlist-loader]: playlist request ongoing");O.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),f.abort()}switch(t.type){case _e.PlaylistContextType.MANIFEST:s=c.manifestLoadingMaxRetry,o=c.manifestLoadingTimeOut,l=c.manifestLoadingRetryDelay,n=c.manifestLoadingMaxRetryTimeout;break;case _e.PlaylistContextType.LEVEL:case _e.PlaylistContextType.AUDIO_TRACK:case _e.PlaylistContextType.SUBTITLE_TRACK:s=0,o=c.levelLoadingTimeOut;break;default:s=c.levelLoadingMaxRetry,o=c.levelLoadingTimeOut,l=c.levelLoadingRetryDelay,n=c.levelLoadingMaxRetryTimeout}if(f=this.createInternalLoader(t),(r=t.deliveryDirectives)!==null&&r!==void 0&&r.part&&(t.type===_e.PlaylistContextType.LEVEL&&t.level!==null?u=this.hls.levels[t.level].details:t.type===_e.PlaylistContextType.AUDIO_TRACK&&t.id!==null?u=this.hls.audioTracks[t.id].details:t.type===_e.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(u=this.hls.subtitleTracks[t.id].details),u)){var b=u.partTarget,D=u.targetduration;b&&D&&(o=Math.min(1e3*Math.max(3*b,.8*D),o))}var C={timeout:o,maxRetry:s,retryDelay:l,maxRetryDelay:n,highWaterMark:0},F={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};f.load(t,C,F)},d.loadsuccess=function(t,r,s,o){o===void 0&&(o=null),this.resetInternalLoader(s.type);var l=t.data;l.indexOf("#EXTM3U")===0?(r.parsing.start=performance.now(),l.indexOf("#EXTINF:")>0||l.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,r,s,o):this.handleMasterPlaylist(t,r,s,o)):this.handleManifestParsingError(t,s,"no EXTM3U delimiter",o)},d.loaderror=function(t,r,s){s===void 0&&(s=null),this.handleNetworkError(r,s,!1,t)},d.loadtimeout=function(t,r,s){s===void 0&&(s=null),this.handleNetworkError(r,s,!0)},d.handleMasterPlaylist=function(t,r,s,o){var l=this.hls,n=t.data,u=Ne(t,s),c=ue.parseMasterPlaylist(n,u),f=c.levels,v=c.sessionData,b=c.sessionKeys;if(f.length){var D=f.map(function(ce){return{id:ce.attrs.AUDIO,audioCodec:ce.audioCodec}}),C=f.map(function(ce){return{id:ce.attrs.SUBTITLES,textCodec:ce.textCodec}}),F=ue.parseMasterPlaylistMedia(n,u,"AUDIO",D),q=ue.parseMasterPlaylistMedia(n,u,"SUBTITLES",C),K=ue.parseMasterPlaylistMedia(n,u,"CLOSED-CAPTIONS");F.length&&(F.some(function(ce){return!ce.url})||!f[0].audioCodec||f[0].attrs.AUDIO||(O.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),F.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ye({}),bitrate:0,url:""}))),l.trigger(g.Events.MANIFEST_LOADED,{levels:f,audioTracks:F,subtitles:q,captions:K,url:u,stats:r,networkDetails:o,sessionData:v,sessionKeys:b})}else this.handleManifestParsingError(t,s,"no level found in manifest",o)},d.handleTrackOrLevelPlaylist=function(t,r,s,o){var l=this.hls,n=s.id,u=s.level,c=s.type,f=Ne(t,s),v=(0,P.isFiniteNumber)(n)?n:0,b=(0,P.isFiniteNumber)(u)?u:v,D=function(q){switch(q.type){case _e.PlaylistContextType.AUDIO_TRACK:return _e.PlaylistLevelType.AUDIO;case _e.PlaylistContextType.SUBTITLE_TRACK:return _e.PlaylistLevelType.SUBTITLE;default:return _e.PlaylistLevelType.MAIN}}(s),C=ue.parseLevelPlaylist(t.data,f,b,D,v);if(C.fragments.length){if(c===_e.PlaylistContextType.MANIFEST){var F={attrs:new ye({}),bitrate:0,details:C,name:"",url:f};l.trigger(g.Events.MANIFEST_LOADED,{levels:[F],audioTracks:[],url:f,stats:r,networkDetails:o,sessionData:null,sessionKeys:null})}r.parsing.end=performance.now(),s.levelDetails=C,this.handlePlaylistLoaded(t,r,s,o)}else l.trigger(g.Events.ERROR,{type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:f,reason:"no fragments found in level",level:typeof s.level=="number"?s.level:void 0})},d.handleManifestParsingError=function(t,r,s,o){this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:r.type===_e.PlaylistContextType.MANIFEST,url:t.url,reason:s,response:t,context:r,networkDetails:o})},d.handleNetworkError=function(t,r,s,o){s===void 0&&(s=!1),O.logger.warn("[playlist-loader]: A network "+(s?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var l=I.ErrorDetails.UNKNOWN,n=!1,u=this.getInternalLoader(t);switch(t.type){case _e.PlaylistContextType.MANIFEST:l=s?I.ErrorDetails.MANIFEST_LOAD_TIMEOUT:I.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case _e.PlaylistContextType.LEVEL:l=s?I.ErrorDetails.LEVEL_LOAD_TIMEOUT:I.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case _e.PlaylistContextType.AUDIO_TRACK:l=s?I.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:I.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1;break;case _e.PlaylistContextType.SUBTITLE_TRACK:l=s?I.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:I.ErrorDetails.SUBTITLE_LOAD_ERROR,n=!1}u&&this.resetInternalLoader(t.type);var c={type:I.ErrorTypes.NETWORK_ERROR,details:l,fatal:n,url:t.url,loader:u,context:t,networkDetails:r};o&&(c.response=o),this.hls.trigger(g.Events.ERROR,c)},d.handlePlaylistLoaded=function(t,r,s,o){var l=s.type,n=s.level,u=s.id,c=s.groupId,f=s.loader,v=s.levelDetails,b=s.deliveryDirectives;if(v!=null&&v.targetduration){if(f)switch(v.live&&(f.getCacheAge&&(v.ageHeader=f.getCacheAge()||0),f.getCacheAge&&!isNaN(v.ageHeader)||(v.ageHeader=0)),l){case _e.PlaylistContextType.MANIFEST:case _e.PlaylistContextType.LEVEL:this.hls.trigger(g.Events.LEVEL_LOADED,{details:v,level:n||0,id:u||0,stats:r,networkDetails:o,deliveryDirectives:b});break;case _e.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(g.Events.AUDIO_TRACK_LOADED,{details:v,id:u||0,groupId:c||"",stats:r,networkDetails:o,deliveryDirectives:b});break;case _e.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(g.Events.SUBTITLE_TRACK_LOADED,{details:v,id:u||0,groupId:c||"",stats:r,networkDetails:o,deliveryDirectives:b})}}else this.handleManifestParsingError(t,s,"invalid target duration",o)},p}();function at(p,d){var t;try{t=new Event("addtrack")}catch{(t=document.createEvent("Event")).initEvent("addtrack",!1,!1)}t.track=p,d.dispatchEvent(t)}function mt(p,d){var t=p.mode;if(t==="disabled"&&(p.mode="hidden"),p.cues&&!p.cues.getCueById(d.id))try{if(p.addCue(d),!p.cues.getCueById(d.id))throw new Error("addCue is failed for: "+d)}catch(s){O.logger.debug("[texttrack-utils]: "+s);var r=new self.TextTrackCue(d.startTime,d.endTime,d.text);r.id=d.id,p.addCue(r)}t==="disabled"&&(p.mode=t)}function gt(p){var d=p.mode;if(d==="disabled"&&(p.mode="hidden"),p.cues)for(var t=p.cues.length;t--;)p.removeCue(p.cues[t]);d==="disabled"&&(p.mode=d)}function Ft(p,d,t,r){var s=p.mode;if(s==="disabled"&&(p.mode="hidden"),p.cues&&p.cues.length>0)for(var o=function(n,u,c){var f=[],v=function(F,q){if(q<F[0].startTime)return 0;var K=F.length-1;if(q>F[K].endTime)return-1;for(var ce=0,Se=K;ce<=Se;){var Ce=Math.floor((Se+ce)/2);if(q<F[Ce].startTime)Se=Ce-1;else{if(!(q>F[Ce].startTime&&ce<K))return Ce;ce=Ce+1}}return F[ce].startTime-q<q-F[Se].startTime?ce:Se}(n,u);if(v>-1)for(var b=v,D=n.length;b<D;b++){var C=n[b];if(C.startTime>=u&&C.endTime<=c)f.push(C);else if(C.startTime>c)return f}return f}(p.cues,d,t),l=0;l<o.length;l++)r&&!r(o[l])||p.removeCue(o[l]);s==="disabled"&&(p.mode=s)}var Mt=w(181),xt=w(856);function Ot(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var ht=function(){var p=Ot();try{new p(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function ct(p,d){return p.getTime()/1e3-d}const Pt=function(){function p(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}var d=p.prototype;return d.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},d._registerListeners=function(){var t=this.hls;t.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d._unregisterListeners=function(){var t=this.hls;t.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d.onMediaAttached=function(t,r){this.media=r.media},d.onMediaDetaching=function(){this.id3Track&&(gt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},d.onManifestLoading=function(){this.dateRangeCuesAppended={}},d.createTrack=function(t){var r=this.getID3Track(t.textTracks);return r.mode="hidden",r},d.getID3Track=function(t){if(this.media){for(var r=0;r<t.length;r++){var s=t[r];if(s.kind==="metadata"&&s.label==="id3")return at(s,this.media),s}return this.media.addTextTrack("metadata","id3")}},d.onFragParsingMetadata=function(t,r){if(this.media){var s=this.hls.config,o=s.enableEmsgMetadataCues,l=s.enableID3MetadataCues;if(o||l){var n=r.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var u=Ot(),c=0;c<n.length;c++){var f=n[c].type;if((f!==xt.MetadataSchema.emsg||o)&&l){var v=Mt.getID3Frames(n[c].data);if(v){var b=n[c].pts,D=b+n[c].duration;D>ht&&(D=ht),D-b<=0&&(D=b+.25);for(var C=0;C<v.length;C++){var F=v[C];if(!Mt.isTimeStampFrame(F)){this.updateId3CueEnds(b);var q=new u(b,D,"");q.value=F,f&&(q.type=f),this.id3Track.addCue(q)}}}}}}}},d.updateId3CueEnds=function(t){var r,s=(r=this.id3Track)===null||r===void 0?void 0:r.cues;if(s)for(var o=s.length;o--;){var l=s[o];l.startTime<t&&l.endTime===ht&&(l.endTime=t)}},d.onBufferFlushing=function(t,r){var s=r.startOffset,o=r.endOffset,l=r.type,n=this.id3Track,u=this.hls;if(u){var c=u.config,f=c.enableEmsgMetadataCues,v=c.enableID3MetadataCues;n&&(f||v)&&Ft(n,s,o,l==="audio"?function(b){return b.type===xt.MetadataSchema.audioId3&&v}:l==="video"?function(b){return b.type===xt.MetadataSchema.emsg&&f}:function(b){return b.type===xt.MetadataSchema.audioId3&&v||b.type===xt.MetadataSchema.emsg&&f})}},d.onLevelUpdated=function(t,r){var s=this,o=r.details;if(this.media&&o.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var l=this.dateRangeCuesAppended,n=this.id3Track,u=o.dateRanges,c=Object.keys(u);if(n)for(var f=Object.keys(l).filter(function(ce){return!c.includes(ce)}),v=function(ce){var Se=f[ce];Object.keys(l[Se].cues).forEach(function(Ce){n.removeCue(l[Se].cues[Ce])}),delete l[Se]},b=f.length;b--;)v(b);var D=o.fragments[o.fragments.length-1];if(c.length!==0&&(0,P.isFiniteNumber)(D==null?void 0:D.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var C=D.programDateTime/1e3-D.start,F=Ot(),q=function(ce){var Se=c[ce],Ce=u[Se],Ie=l[Se],Pe=(Ie==null?void 0:Ie.cues)||{},Qe=(Ie==null?void 0:Ie.durationKnown)||!1,st=ct(Ce.startDate,C),xe=ht,ze=Ce.endDate;if(ze)xe=ct(ze,C),Qe=!0;else if(Ce.endOnNext&&!Qe){var $e=c.reduce(function(or,er){var fr=u[er];return fr.class===Ce.class&&fr.id!==er&&fr.startDate>Ce.startDate&&or.push(fr),or},[]).sort(function(or,er){return or.startDate.getTime()-er.startDate.getTime()})[0];$e&&(xe=ct($e.startDate,C),Qe=!0)}for(var St,Gt=Object.keys(Ce.attr),wt=0;wt<Gt.length;wt++){var Ct=Gt[wt];if(Ct!==U.ID&&Ct!==U.CLASS&&Ct!==U.START_DATE&&Ct!==U.DURATION&&Ct!==U.END_DATE&&Ct!==U.END_ON_NEXT){var Bt=Pe[Ct];if(Bt)Qe&&!Ie.durationKnown&&(Bt.endTime=xe);else{var hr=Ce.attr[Ct];Bt=new F(st,xe,""),Ct!==U.SCTE35_OUT&&Ct!==U.SCTE35_IN||(St=hr,hr=Uint8Array.from(St.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),Bt.value={key:Ct,data:hr},Bt.type=xt.MetadataSchema.dateRange,s.id3Track.addCue(Bt),Pe[Ct]=Bt}}}l[Se]={cues:Pe,dateRange:Ce,durationKnown:Qe}},K=0;K<c.length;K++)q(K)}}},p}();function Ht(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}var qt=function(){function p(s){var o=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return o.timeupdate()},this.hls=s,this.config=s.config,this.registerListeners()}var d,t,r=p.prototype;return r.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},r.registerListeners=function(){this.hls.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(g.Events.ERROR,this.onError,this)},r.unregisterListeners=function(){this.hls.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(g.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(g.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(g.Events.ERROR,this.onError)},r.onMediaAttached=function(s,o){this.media=o.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},r.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},r.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},r.onLevelUpdated=function(s,o){var l=o.details;this.levelDetails=l,l.advanced&&this.timeupdate(),!l.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},r.onError=function(s,o){o.details===I.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,O.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},r.timeupdate=function(){var s=this.media,o=this.levelDetails;if(s&&o){this.currentTime=s.currentTime;var l=this.computeLatency();if(l!==null){this._latency=l;var n=this.config,u=n.lowLatencyMode,c=n.maxLiveSyncPlaybackRate;if(u&&c!==1){var f=this.targetLatency;if(f!==null){var v=l-f,b=v<Math.min(this.maxLatency,f+o.targetduration);if(o.live&&b&&v>.05&&this.forwardBufferLength>1){var D=Math.min(2,Math.max(1,c)),C=Math.round(2/(1+Math.exp(-.75*v-this.edgeStalled))*20)/20;s.playbackRate=Math.min(D,Math.max(1,C))}else s.playbackRate!==1&&s.playbackRate!==0&&(s.playbackRate=1)}}}}},r.estimateLiveEdge=function(){var s=this.levelDetails;return s===null?null:s.edge+s.age},r.computeLatency=function(){var s=this.estimateLiveEdge();return s===null?null:s-this.currentTime},d=p,(t=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var s=this.config,o=this.levelDetails;return s.liveMaxLatencyDuration!==void 0?s.liveMaxLatencyDuration:o?s.liveMaxLatencyDurationCount*o.targetduration:0}},{key:"targetLatency",get:function(){var s=this.levelDetails;if(s===null)return null;var o=s.holdBack,l=s.partHoldBack,n=s.targetduration,u=this.config,c=u.liveSyncDuration,f=u.liveSyncDurationCount,v=u.lowLatencyMode,b=this.hls.userConfig,D=v&&l||o;(b.liveSyncDuration||b.liveSyncDurationCount||D===0)&&(D=c!==void 0?c:f*n);var C=n;return D+Math.min(1*this.stallCount,C)}},{key:"liveSyncPosition",get:function(){var s=this.estimateLiveEdge(),o=this.targetLatency,l=this.levelDetails;if(s===null||o===null||l===null)return null;var n=l.edge,u=s-o-this.edgeStalled,c=n-l.totalduration,f=n-(this.config.lowLatencyMode&&l.partTarget||l.targetduration);return Math.min(Math.max(c,u),f)}},{key:"drift",get:function(){var s=this.levelDetails;return s===null?1:s.drift}},{key:"edgeStalled",get:function(){var s=this.levelDetails;if(s===null)return 0;var o=3*(this.config.lowLatencyMode&&s.partTarget||s.targetduration);return Math.max(s.age-o,0)}},{key:"forwardBufferLength",get:function(){var s=this.media,o=this.levelDetails;if(!s||!o)return 0;var l=s.buffered.length;return(l?s.buffered.end(l-1):o.edge)-this.currentTime}}])&&Ht(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}();function nr(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}var tr,Lr=["NONE","TYPE-0","TYPE-1","TYPE-2",null];(function(p){p.No="",p.Yes="YES",p.v2="v2"})(tr||(tr={}));var ge=function(){function p(d,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=d,this.part=t,this.skip=r}return p.prototype.addDirectives=function(d){var t=new self.URL(d);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},p}(),$=function(){function p(r){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[r.url],this.attrs=r.attrs,this.bitrate=r.bitrate,r.details&&(this.details=r.details),this.id=r.id||0,this.name=r.name,this.width=r.width||0,this.height=r.height||0,this.audioCodec=r.audioCodec,this.videoCodec=r.videoCodec,this.unknownCodecs=r.unknownCodecs,this.codecSet=[r.videoCodec,r.audioCodec].filter(function(s){return s}).join(",").replace(/\.[^.,]+/g,"")}var d,t;return d=p,(t=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(r){var s=r%this.url.length;this._urlId!==s&&(this.details=void 0,this._urlId=s)}}])&&nr(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}();function R(){return R=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},R.apply(this,arguments)}function V(p,d,t){switch(d){case"audio":p.audioGroupIds||(p.audioGroupIds=[]),p.audioGroupIds.push(t);break;case"text":p.textGroupIds||(p.textGroupIds=[]),p.textGroupIds.push(t)}}function j(p){var d={};p.forEach(function(t){var r=t.groupId||"";t.id=d[r]=d[r]||0,d[r]++})}function J(p,d){var t=d.startPTS;if((0,P.isFiniteNumber)(t)){var r,s=0;d.sn>p.sn?(s=t-p.start,r=p):(s=p.start-t,r=d),r.duration!==s&&(r.duration=s)}else d.sn>p.sn?p.cc===d.cc&&p.minEndPTS?d.start=p.start+(p.minEndPTS-p.start):d.start=p.start+p.duration:d.start=Math.max(p.start-d.duration,0)}function pe(p,d,t,r,s,o){r-t<=0&&(O.logger.warn("Fragment should have a positive duration",d),r=t+d.duration,o=s+d.duration);var l=t,n=r,u=d.startPTS,c=d.endPTS;if((0,P.isFiniteNumber)(u)){var f=Math.abs(u-t);(0,P.isFiniteNumber)(d.deltaPTS)?d.deltaPTS=Math.max(f,d.deltaPTS):d.deltaPTS=f,l=Math.max(t,u),t=Math.min(t,u),s=Math.min(s,d.startDTS),n=Math.min(r,c),r=Math.max(r,c),o=Math.max(o,d.endDTS)}d.duration=r-t;var v=t-d.start;d.start=d.startPTS=t,d.maxStartPTS=l,d.startDTS=s,d.endPTS=r,d.minEndPTS=n,d.endDTS=o;var b,D=d.sn;if(!p||D<p.startSN||D>p.endSN)return 0;var C=D-p.startSN,F=p.fragments;for(F[C]=d,b=C;b>0;b--)J(F[b],F[b-1]);for(b=C;b<F.length-1;b++)J(F[b],F[b+1]);return p.fragmentHint&&J(F[F.length-1],p.fragmentHint),p.PTSKnown=p.alignedSliding=!0,v}function ve(p,d){var t=d.startSN+d.skippedSegments-p.startSN,r=p.fragments;t<0||t>=r.length||De(d,r[t].start)}function De(p,d){if(d){for(var t=p.fragments,r=p.skippedSegments;r<t.length;r++)t[r].start+=d;p.fragmentHint&&(p.fragmentHint.start+=d)}}var Fe=function(){function p(t,r){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=O.logger.log.bind(O.logger,r+":"),this.warn=O.logger.warn.bind(O.logger,r+":"),this.hls=t}var d=p.prototype;return d.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},d.onError=function(t,r){!r.fatal||r.type!==I.ErrorTypes.NETWORK_ERROR&&r.type!==I.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},d.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},d.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},d.stopLoad=function(){this.canLoad=!1,this.clearTimer()},d.switchParams=function(t,r){var s=r==null?void 0:r.renditionReports;if(s)for(var o=0;o<s.length;o++){var l=s[o],n=void 0;try{n=new self.URL(l.URI,r.url).href}catch(v){O.logger.warn("Could not construct new URL for Rendition Report: "+v),n=l.URI||""}if(n===t.slice(-n.length)){var u=parseInt(l["LAST-MSN"])||(r==null?void 0:r.lastPartSn),c=parseInt(l["LAST-PART"])||(r==null?void 0:r.lastPartIndex);if(this.hls.config.lowLatencyMode){var f=Math.min(r.age-r.partTarget,r.targetduration);c>=0&&f>r.partTarget&&(c+=1)}return new ge(u,c>=0?c:void 0,tr.No)}}},d.loadPlaylist=function(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},d.shouldLoadTrack=function(t){return this.canLoad&&t&&!!t.url&&(!t.details||t.details.live)},d.playlistLoaded=function(t,r,s){var o=this,l=r.details,n=r.stats,u=self.performance.now(),c=n.loading.first?Math.max(0,u-n.loading.first):0;if(l.advancedDateTime=Date.now()-c,l.live||s!=null&&s.live){if(l.reloaded(s),s&&this.log("live playlist "+t+" "+(l.advanced?"REFRESHED "+l.lastPartSn+"-"+l.lastPartIndex:"MISSED")),s&&l.fragments.length>0&&function(ze,$e){for(var St=null,Gt=ze.fragments,wt=Gt.length-1;wt>=0;wt--){var Ct=Gt[wt].initSegment;if(Ct){St=Ct;break}}ze.fragmentHint&&delete ze.fragmentHint.endPTS;var Bt,hr,or,er,fr,Hr=0;if(function(yt,kt,fn){for(var Si=kt.skippedSegments,li=Math.max(yt.startSN,kt.startSN)-kt.startSN,pn=(yt.fragmentHint?1:0)+(Si?kt.endSN:Math.min(yt.endSN,kt.endSN))-kt.startSN,ei=kt.startSN-yt.startSN,Ai=kt.fragmentHint?kt.fragments.concat(kt.fragmentHint):kt.fragments,xi=yt.fragmentHint?yt.fragments.concat(yt.fragmentHint):yt.fragments,zr=li;zr<=pn;zr++){var Oi=xi[ei+zr],Ma=Ai[zr];Si&&!Ma&&zr<Si&&(Ma=kt.fragments[zr]=Oi),Oi&&Ma&&fn(Oi,Ma)}}(ze,$e,function(yt,kt){yt.relurl&&(Hr=yt.cc-kt.cc),(0,P.isFiniteNumber)(yt.startPTS)&&(0,P.isFiniteNumber)(yt.endPTS)&&(kt.start=kt.startPTS=yt.startPTS,kt.startDTS=yt.startDTS,kt.appendedPTS=yt.appendedPTS,kt.maxStartPTS=yt.maxStartPTS,kt.endPTS=yt.endPTS,kt.endDTS=yt.endDTS,kt.minEndPTS=yt.minEndPTS,kt.duration=yt.endPTS-yt.startPTS,kt.duration&&(Bt=kt),$e.PTSKnown=$e.alignedSliding=!0),kt.elementaryStreams=yt.elementaryStreams,kt.loader=yt.loader,kt.stats=yt.stats,kt.urlId=yt.urlId,yt.initSegment&&(kt.initSegment=yt.initSegment,St=yt.initSegment)}),St&&($e.fragmentHint?$e.fragments.concat($e.fragmentHint):$e.fragments).forEach(function(yt){var kt;yt.initSegment&&yt.initSegment.relurl!==((kt=St)===null||kt===void 0?void 0:kt.relurl)||(yt.initSegment=St)}),$e.skippedSegments)if($e.deltaUpdateFailed=$e.fragments.some(function(yt){return!yt}),$e.deltaUpdateFailed){O.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var so=$e.skippedSegments;so--;)$e.fragments.shift();$e.startSN=$e.fragments[0].sn,$e.startCC=$e.fragments[0].cc}else $e.canSkipDateRanges&&($e.dateRanges=(hr=ze.dateRanges,or=$e.dateRanges,er=$e.recentlyRemovedDateranges,fr=R({},hr),er&&er.forEach(function(yt){delete fr[yt]}),Object.keys(or).forEach(function(yt){var kt=new z(or[yt].attr,fr[yt]);kt.isValid?fr[yt]=kt:O.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(or[yt].attr)+'"')}),fr));var oi=$e.fragments;if(Hr){O.logger.warn("discontinuity sliding from playlist, take drift into account");for(var Yn=0;Yn<oi.length;Yn++)oi[Yn].cc+=Hr}$e.skippedSegments&&($e.startCC=$e.fragments[0].cc),function(yt,kt,fn){if(yt&&kt)for(var Si=0,li=0,pn=yt.length;li<=pn;li++){var ei=yt[li],Ai=kt[li+Si];ei&&Ai&&ei.index===Ai.index&&ei.fragment.sn===Ai.fragment.sn?(xi=ei,(zr=Ai).elementaryStreams=xi.elementaryStreams,zr.stats=xi.stats):Si--}var xi,zr}(ze.partList,$e.partList),Bt?pe($e,Bt,Bt.startPTS,Bt.endPTS,Bt.startDTS,Bt.endDTS):ve(ze,$e),oi.length&&($e.totalduration=$e.edge-oi[0].start),$e.driftStartTime=ze.driftStartTime,$e.driftStart=ze.driftStart;var zn=$e.advancedDateTime;if($e.advanced&&zn){var Xn=$e.edge;$e.driftStart||($e.driftStartTime=zn,$e.driftStart=Xn),$e.driftEndTime=zn,$e.driftEnd=Xn}else $e.driftEndTime=ze.driftEndTime,$e.driftEnd=ze.driftEnd,$e.advancedDateTime=ze.advancedDateTime}(s,l),!this.canLoad||!l.live)return;var f,v=void 0,b=void 0;if(l.canBlockReload&&l.endSN&&l.advanced){var D=this.hls.config.lowLatencyMode,C=l.lastPartSn,F=l.endSN,q=l.lastPartIndex,K=C===F;q!==-1?(v=K?F+1:C,b=K?D?0:q:q+1):v=F+1;var ce=l.age,Se=ce+l.ageHeader,Ce=Math.min(Se-l.partTarget,1.5*l.targetduration);if(Ce>0){if(s&&Ce>s.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+s.tuneInGoal+" to: "+Ce+" with playlist age: "+l.age),Ce=0;else{var Ie=Math.floor(Ce/l.targetduration);v+=Ie,b!==void 0&&(b+=Math.round(Ce%l.targetduration/l.partTarget)),this.log("CDN Tune-in age: "+l.ageHeader+"s last advanced "+ce.toFixed(2)+"s goal: "+Ce+" skip sn "+Ie+" to part "+b)}l.tuneInGoal=Ce}if(f=this.getDeliveryDirectives(l,r.deliveryDirectives,v,b),D||!K)return void this.loadPlaylist(f)}else f=this.getDeliveryDirectives(l,r.deliveryDirectives,v,b);var Pe=this.hls.mainForwardBufferInfo,Qe=Pe?Pe.end-Pe.len:0,st=function(ze,$e){$e===void 0&&($e=1/0);var St=1e3*ze.targetduration;if(ze.updated){var Gt=ze.fragments;if(Gt.length&&4*St>$e){var wt=1e3*Gt[Gt.length-1].duration;wt<St&&(St=wt)}}else St/=2;return Math.round(St)}(l,1e3*(l.edge-Qe));l.updated?u>this.requestScheduled+st&&(this.requestScheduled=n.loading.start):this.requestScheduled=-1,v!==void 0&&l.canBlockReload?this.requestScheduled=n.loading.first+st-(1e3*l.partTarget||1e3):this.requestScheduled=(this.requestScheduled===-1?u:this.requestScheduled)+st;var xe=this.requestScheduled-u;xe=Math.max(0,xe),this.log("reload live playlist "+t+" in "+Math.round(xe)+" ms"),this.timer=self.setTimeout(function(){return o.loadPlaylist(f)},xe)}else this.clearTimer()},d.getDeliveryDirectives=function(t,r,s,o){var l=function(n,u){var c=n.canSkipUntil,f=n.canSkipDateRanges,v=n.endSN;return c&&(u!==void 0?u-v:0)<c?f?tr.v2:tr.Yes:tr.No}(t,s);return r!=null&&r.skip&&t.deltaUpdateFailed&&(s=r.msn,o=r.part,l=tr.No),new ge(s,o,l)},d.retryLoadingOrFail=function(t){var r,s=this,o=this.hls.config,l=this.retryCount<o.levelLoadingMaxRetry;if(l)if(this.requestScheduled=-1,this.retryCount++,t.details.indexOf("LoadTimeOut")>-1&&(r=t.context)!==null&&r!==void 0&&r.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+t.details+'"'),this.loadPlaylist();else{var n=Math.min(Math.pow(2,this.retryCount)*o.levelLoadingRetryDelay,o.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return s.loadPlaylist()},n),this.warn("retry playlist loading #"+this.retryCount+" in "+n+' ms after "'+t.details+'"')}else this.warn('cannot recover from error "'+t.details+'"'),this.clearTimer(),t.fatal=!0;return l},p}();function je(){return je=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},je.apply(this,arguments)}function qe(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function Je(p,d){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Je(p,d)}var Ye,ot=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),Et=function(p){var d,t;function r(n){var u;return(u=p.call(this,n,"[level-controller]")||this)._levels=[],u._firstLevel=-1,u._startLevel=void 0,u.currentLevelIndex=-1,u.manualLevelIndex=-1,u.onParsedComplete=void 0,u._registerListeners(),u}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Je(d,t);var s,o,l=r.prototype;return l._registerListeners=function(){var n=this.hls;n.on(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),n.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.on(g.Events.FRAG_LOADED,this.onFragLoaded,this),n.on(g.Events.ERROR,this.onError,this)},l._unregisterListeners=function(){var n=this.hls;n.off(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),n.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.off(g.Events.FRAG_LOADED,this.onFragLoaded,this),n.off(g.Events.ERROR,this.onError,this)},l.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,p.prototype.destroy.call(this)},l.startLoad=function(){this._levels.forEach(function(n){n.loadError=0}),p.prototype.startLoad.call(this)},l.onManifestLoaded=function(n,u){var c,f,v=[],b=[],D=[],C={},F=!1,q=!1,K=!1;if(u.levels.forEach(function(Ie){var Pe=Ie.attrs;F=F||!(!Ie.width||!Ie.height),q=q||!!Ie.videoCodec,K=K||!!Ie.audioCodec,ot&&Ie.audioCodec&&Ie.audioCodec.indexOf("mp4a.40.34")!==-1&&(Ie.audioCodec=void 0);var Qe=Ie.bitrate+"-"+Ie.attrs.RESOLUTION+"-"+Ie.attrs.CODECS;(f=C[Qe])?f.url.push(Ie.url):(f=new $(Ie),C[Qe]=f,v.push(f)),Pe&&(Pe.AUDIO&&V(f,"audio",Pe.AUDIO),Pe.SUBTITLES&&V(f,"text",Pe.SUBTITLES))}),(F||q)&&K&&(v=v.filter(function(Ie){var Pe=Ie.videoCodec,Qe=Ie.width,st=Ie.height;return!!Pe||!(!Qe||!st)})),v=v.filter(function(Ie){var Pe=Ie.audioCodec,Qe=Ie.videoCodec;return(!Pe||ae(Pe,"audio"))&&(!Qe||ae(Qe,"video"))}),u.audioTracks&&j(b=u.audioTracks.filter(function(Ie){return!Ie.audioCodec||ae(Ie.audioCodec,"audio")})),u.subtitles&&j(D=u.subtitles),v.length>0){c=v[0].bitrate,v.sort(function(Ie,Pe){return Ie.attrs["HDCP-LEVEL"]!==Pe.attrs["HDCP-LEVEL"]?(Ie.attrs["HDCP-LEVEL"]||"")>(Pe.attrs["HDCP-LEVEL"]||"")?1:-1:Ie.bitrate!==Pe.bitrate?Ie.bitrate-Pe.bitrate:Ie.attrs.SCORE!==Pe.attrs.SCORE?Ie.attrs.decimalFloatingPoint("SCORE")-Pe.attrs.decimalFloatingPoint("SCORE"):F&&Ie.height!==Pe.height?Ie.height-Pe.height:0}),this._levels=v;for(var ce=0;ce<v.length;ce++)if(v[ce].bitrate===c){this._firstLevel=ce,this.log("manifest loaded, "+v.length+" level(s) found, first bitrate: "+c);break}var Se=K&&!q,Ce={levels:v,audioTracks:b,subtitleTracks:D,sessionData:u.sessionData,sessionKeys:u.sessionKeys,firstLevel:this._firstLevel,stats:u.stats,audio:K,video:q,altAudio:!Se&&b.some(function(Ie){return!!Ie.url})};this.hls.trigger(g.Events.MANIFEST_PARSED,Ce),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:u.url,reason:"no level with compatible codecs found in manifest"})},l.onError=function(n,u){var c,f;if(p.prototype.onError.call(this,n,u),!u.fatal){var v=u.context,b=this._levels[this.currentLevelIndex];if(v&&(v.type===_e.PlaylistContextType.AUDIO_TRACK&&b.audioGroupIds&&v.groupId===b.audioGroupIds[b.urlId]||v.type===_e.PlaylistContextType.SUBTITLE_TRACK&&b.textGroupIds&&v.groupId===b.textGroupIds[b.urlId]))this.redundantFailover(this.currentLevelIndex);else{var D,C=!1,F=!0;switch(u.details){case I.ErrorDetails.FRAG_LOAD_ERROR:case I.ErrorDetails.FRAG_LOAD_TIMEOUT:case I.ErrorDetails.KEY_LOAD_ERROR:case I.ErrorDetails.KEY_LOAD_TIMEOUT:if(u.frag){var q=u.frag.type===_e.PlaylistLevelType.MAIN?u.frag.level:this.currentLevelIndex,K=this._levels[q];K?(K.fragmentError++,K.fragmentError>this.hls.config.fragLoadingMaxRetry&&(D=q)):D=q}break;case I.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var ce=b.attrs["HDCP-LEVEL"];ce&&(this.hls.maxHdcpLevel=Lr[Lr.indexOf(ce)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case I.ErrorDetails.FRAG_PARSING_ERROR:case I.ErrorDetails.KEY_SYSTEM_NO_SESSION:D=((c=u.frag)===null||c===void 0?void 0:c.type)===_e.PlaylistLevelType.MAIN?u.frag.level:this.currentLevelIndex,u.levelRetry=!1;break;case I.ErrorDetails.LEVEL_LOAD_ERROR:case I.ErrorDetails.LEVEL_LOAD_TIMEOUT:v&&(v.deliveryDirectives&&(F=!1),D=v.level),C=!0;break;case I.ErrorDetails.REMUX_ALLOC_ERROR:D=(f=u.level)!=null?f:this.currentLevelIndex,C=!0}D!==void 0&&this.recoverLevel(u,D,C,F)}}},l.recoverLevel=function(n,u,c,f){var v=n.details,b=this._levels[u];if(b.loadError++,c){if(!this.retryLoadingOrFail(n))return void(this.currentLevelIndex=-1);n.levelRetry=!0}if(f){var D=b.url.length;if(D>1&&b.loadError<D)n.levelRetry=!0,this.redundantFailover(u);else if(this.manualLevelIndex===-1){for(var C=-1,F=this._levels,q=F.length;q--;){var K=(q+this.currentLevelIndex)%F.length;if(K!==this.currentLevelIndex&&F[K].loadError===0){C=K;break}}C>-1&&this.currentLevelIndex!==C?(this.warn(v+": switch to "+C),n.levelRetry=!0,this.hls.nextAutoLevel=C):n.levelRetry===!1&&(n.fatal=!0)}}},l.redundantFailover=function(n){var u=this._levels[n],c=u.url.length;if(c>1){var f=(u.urlId+1)%c;this.warn("Switching to redundant URL-id "+f),this._levels.forEach(function(v){v.urlId=f}),this.level=n}},l.onFragLoaded=function(n,u){var c=u.frag;if(c!==void 0&&c.type===_e.PlaylistLevelType.MAIN){var f=this._levels[c.level];f!==void 0&&(f.fragmentError=0,f.loadError=0)}},l.onLevelLoaded=function(n,u){var c,f,v=u.level,b=u.details,D=this._levels[v];if(!D)return this.warn("Invalid level index "+v),void((f=u.deliveryDirectives)!==null&&f!==void 0&&f.skip&&(b.deltaUpdateFailed=!0));v===this.currentLevelIndex?(D.fragmentError===0&&(D.loadError=0,this.retryCount=0),this.playlistLoaded(v,u,D.details)):(c=u.deliveryDirectives)!==null&&c!==void 0&&c.skip&&(b.deltaUpdateFailed=!0)},l.onAudioTrackSwitched=function(n,u){var c=this.hls.levels[this.currentLevelIndex];if(c&&c.audioGroupIds){for(var f=-1,v=this.hls.audioTracks[u.id].groupId,b=0;b<c.audioGroupIds.length;b++)if(c.audioGroupIds[b]===v){f=b;break}f!==c.urlId&&(c.urlId=f,this.startLoad())}},l.loadPlaylist=function(n){p.prototype.loadPlaylist.call(this);var u=this.currentLevelIndex,c=this._levels[u];if(this.canLoad&&c&&c.url.length>0){var f=c.urlId,v=c.url[f];if(n)try{v=n.addDirectives(v)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("Attempt loading level index "+u+(n?" at sn "+n.msn+" part "+n.part:"")+" with URL-id "+f+" "+v),this.clearTimer(),this.hls.trigger(g.Events.LEVEL_LOADING,{url:v,level:u,id:f,deliveryDirectives:n||null})}},l.removeLevel=function(n,u){var c=function(v,b){return b!==u},f=this._levels.filter(function(v,b){return b!==n||v.url.length>1&&u!==void 0&&(v.url=v.url.filter(c),v.audioGroupIds&&(v.audioGroupIds=v.audioGroupIds.filter(c)),v.textGroupIds&&(v.textGroupIds=v.textGroupIds.filter(c)),v.urlId=0,!0)}).map(function(v,b){var D=v.details;return D!=null&&D.fragments&&D.fragments.forEach(function(C){C.level=b}),v});this._levels=f,this.hls.trigger(g.Events.LEVELS_UPDATED,{levels:f})},s=r,(o=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(n){var u,c=this._levels;if(c.length!==0&&(this.currentLevelIndex!==n||(u=c[n])===null||u===void 0||!u.details)){if(n<0||n>=c.length){var f=n<0;if(this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.OTHER_ERROR,details:I.ErrorDetails.LEVEL_SWITCH_ERROR,level:n,fatal:f,reason:"invalid level idx"}),f)return;n=Math.min(n,c.length-1)}this.clearTimer();var v=this.currentLevelIndex,b=c[v],D=c[n];this.log("switching to level "+n+" from "+v),this.currentLevelIndex=n;var C=je({},D,{level:n,maxBitrate:D.maxBitrate,uri:D.uri,urlId:D.urlId});delete C._urlId,this.hls.trigger(g.Events.LEVEL_SWITCHING,C);var F=D.details;if(!F||F.live){var q=this.switchParams(D.uri,b==null?void 0:b.details);this.loadPlaylist(q)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(n){this.manualLevelIndex=n,this._startLevel===void 0&&(this._startLevel=n),n!==-1&&(this.level=n)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(n){this._firstLevel=n}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var n=this.hls.config.startLevel;return n!==void 0?n:this._firstLevel}return this._startLevel},set:function(n){this._startLevel=n}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(n){this.level=n,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=n)}}])&&qe(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Fe);(function(p){p.NOT_LOADED="NOT_LOADED",p.APPENDING="APPENDING",p.PARTIAL="PARTIAL",p.OK="OK"})(Ye||(Ye={}));var Ut=function(){function p(t){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=t,this._registerListeners()}var d=p.prototype;return d._registerListeners=function(){var t=this.hls;t.on(g.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.on(g.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.on(g.Events.FRAG_LOADED,this.onFragLoaded,this)},d._unregisterListeners=function(){var t=this.hls;t.off(g.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.off(g.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.off(g.Events.FRAG_LOADED,this.onFragLoaded,this)},d.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},d.getAppendedFrag=function(t,r){if(r===_e.PlaylistLevelType.MAIN){var s=this.activeFragment,o=this.activeParts;if(!s)return null;if(o)for(var l=o.length;l--;){var n=o[l],u=n?n.end:s.appendedPTS;if(n.start<=t&&u!==void 0&&t<=u)return l>9&&(this.activeParts=o.slice(l-9)),n}else if(s.start<=t&&s.appendedPTS!==void 0&&t<=s.appendedPTS)return s}return this.getBufferedFrag(t,r)},d.getBufferedFrag=function(t,r){for(var s=this.fragments,o=Object.keys(s),l=o.length;l--;){var n=s[o[l]];if((n==null?void 0:n.body.type)===r&&n.buffered){var u=n.body;if(u.start<=t&&t<=u.end)return u}}return null},d.detectEvictedFragments=function(t,r,s){var o=this;this.timeRanges&&(this.timeRanges[t]=r),Object.keys(this.fragments).forEach(function(l){var n=o.fragments[l];if(n)if(n.buffered||n.loaded){var u=n.range[t];u&&u.time.some(function(c){var f=!o.isTimeBuffered(c.startPTS,c.endPTS,r);return f&&o.removeFragment(n.body),f})}else n.body.type===s&&o.removeFragment(n.body)})},d.detectPartialFragments=function(t){var r=this,s=this.timeRanges,o=t.frag,l=t.part;if(s&&o.sn!=="initSegment"){var n=Nt(o),u=this.fragments[n];u&&(Object.keys(s).forEach(function(c){var f=o.elementaryStreams[c];if(f){var v=s[c],b=l!==null||f.partial===!0;u.range[c]=r.getBufferedTimes(o,l,b,v)}}),u.loaded=null,Object.keys(u.range).length?(u.buffered=!0,u.body.endList&&(this.endListFragments[u.body.type]=u)):this.removeFragment(u.body))}},d.fragBuffered=function(t){var r=Nt(t),s=this.fragments[r];s&&(s.loaded=null,s.buffered=!0)},d.getBufferedTimes=function(t,r,s,o){for(var l={time:[],partial:s},n=r?r.start:t.start,u=r?r.end:t.end,c=t.minEndPTS||u,f=t.maxStartPTS||n,v=0;v<o.length;v++){var b=o.start(v)-this.bufferPadding,D=o.end(v)+this.bufferPadding;if(f>=b&&c<=D){l.time.push({startPTS:Math.max(n,o.start(v)),endPTS:Math.min(u,o.end(v))});break}if(n<D&&u>b)l.partial=!0,l.time.push({startPTS:Math.max(n,o.start(v)),endPTS:Math.min(u,o.end(v))});else if(u<=b)break}return l},d.getPartialFragment=function(t){var r,s,o,l=null,n=0,u=this.bufferPadding,c=this.fragments;return Object.keys(c).forEach(function(f){var v=c[f];v&&rt(v)&&(s=v.body.start-u,o=v.body.end+u,t>=s&&t<=o&&(r=Math.min(t-s,o-t),n<=r&&(l=v.body,n=r)))}),l},d.isEndListAppended=function(t){var r=this.endListFragments[t];return r!==void 0&&(r.buffered||rt(r))},d.getState=function(t){var r=Nt(t),s=this.fragments[r];return s?s.buffered?rt(s)?Ye.PARTIAL:Ye.OK:Ye.APPENDING:Ye.NOT_LOADED},d.isTimeBuffered=function(t,r,s){for(var o,l,n=0;n<s.length;n++){if(o=s.start(n)-this.bufferPadding,l=s.end(n)+this.bufferPadding,t>=o&&r<=l)return!0;if(r<=o)return!1}return!1},d.onFragLoaded=function(t,r){var s=r.frag,o=r.part;if(s.sn!=="initSegment"&&!s.bitrateTest&&!o){var l=Nt(s);this.fragments[l]={body:s,loaded:r,buffered:!1,range:Object.create(null)}}},d.onBufferAppended=function(t,r){var s=this,o=r.frag,l=r.part,n=r.timeRanges;if(o.type===_e.PlaylistLevelType.MAIN)if(this.activeFragment!==o&&(this.activeFragment=o,o.appendedPTS=void 0),l){var u=this.activeParts;u||(this.activeParts=u=[]),u.push(l)}else this.activeParts=null;this.timeRanges=n,Object.keys(n).forEach(function(c){var f=n[c];if(s.detectEvictedFragments(c,f),!l&&o.type===_e.PlaylistLevelType.MAIN){var v=o.elementaryStreams[c];if(!v)return;for(var b=0;b<f.length;b++){var D=f.end(b);D<=v.endPTS&&D>v.startPTS?o.appendedPTS=Math.max(D,o.appendedPTS||0):o.appendedPTS=v.endPTS}}})},d.onFragBuffered=function(t,r){this.detectPartialFragments(r)},d.hasFragment=function(t){var r=Nt(t);return!!this.fragments[r]},d.removeFragmentsInRange=function(t,r,s){var o=this;Object.keys(this.fragments).forEach(function(l){var n=o.fragments[l];if(n&&n.buffered){var u=n.body;u.type===s&&u.start<r&&u.end>t&&o.removeFragment(u)}})},d.removeFragment=function(t){var r=Nt(t);t.stats.loaded=0,t.clearElementaryStreamInfo(),t.appendedPTS=void 0,delete this.fragments[r],t.endList&&delete this.endListFragments[t.type]},d.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},p}();function rt(p){var d,t;return p.buffered&&(((d=p.range.video)===null||d===void 0?void 0:d.partial)||((t=p.range.audio)===null||t===void 0?void 0:t.partial))}function Nt(p){return p.type+"_"+p.level+"_"+p.urlId+"_"+p.sn}function lr(p){var d=typeof Map=="function"?new Map:void 0;return lr=function(t){if(t===null||(r=t,Function.toString.call(r).indexOf("[native code]")===-1))return t;var r;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(t))return d.get(t);d.set(t,s)}function s(){return Wt(t,arguments,dt(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Zt(s,t)},lr(p)}function Wt(p,d,t){return Wt=Vt()?Reflect.construct.bind():function(r,s,o){var l=[null];l.push.apply(l,s);var n=new(Function.bind.apply(r,l));return o&&Zt(n,o.prototype),n},Wt.apply(null,arguments)}function Vt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zt(p,d){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Zt(p,d)}function dt(p){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},dt(p)}var Tr=Math.pow(2,17),Qr=function(){function p(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}var d=p.prototype;return d.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},d.abort=function(){this.loader&&this.loader.abort()},d.load=function(t,r){var s=this,o=t.url;if(!o)return Promise.reject(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,networkDetails:null},"Fragment does not have a "+(o?"part list":"url")));this.abort();var l=this.config,n=l.fLoader,u=l.loader;return new Promise(function(c,f){s.loader&&s.loader.destroy();var v=s.loader=t.loader=n?new n(l):new u(l),b=zt(t),D={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:t.sn==="initSegment"?1/0:Tr};t.stats=v.stats,v.load(b,D,{onSuccess:function(C,F,q,K){s.resetLoader(t,v);var ce=C.data;q.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(ce.slice(0,16)),ce=ce.slice(16)),c({frag:t,part:null,payload:ce,networkDetails:K})},onError:function(C,F,q){s.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:C,networkDetails:q}))},onAbort:function(C,F,q){s.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,networkDetails:q}))},onTimeout:function(C,F,q){s.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,networkDetails:q}))},onProgress:function(C,F,q,K){r&&r({frag:t,part:null,payload:q,networkDetails:K})}})})},d.loadPart=function(t,r,s){var o=this;this.abort();var l=this.config,n=l.fLoader,u=l.loader;return new Promise(function(c,f){o.loader&&o.loader.destroy();var v=o.loader=t.loader=n?new n(l):new u(l),b=zt(t,r),D={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:Tr};r.stats=v.stats,v.load(b,D,{onSuccess:function(C,F,q,K){o.resetLoader(t,v),o.updateStatsFromPart(t,r);var ce={frag:t,part:r,payload:C.data,networkDetails:K};s(ce),c(ce)},onError:function(C,F,q){o.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:r,response:C,networkDetails:q}))},onAbort:function(C,F,q){t.stats.aborted=r.stats.aborted,o.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,part:r,networkDetails:q}))},onTimeout:function(C,F,q){o.resetLoader(t,v),f(new ir({type:I.ErrorTypes.NETWORK_ERROR,details:I.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:r,networkDetails:q}))}})})},d.updateStatsFromPart=function(t,r){var s=t.stats,o=r.stats,l=o.total;if(s.loaded+=o.loaded,l){var n=Math.round(t.duration/r.duration),u=Math.min(Math.round(s.loaded/l),n),c=(n-u)*Math.round(s.loaded/u);s.total=s.loaded+c}else s.total=Math.max(s.loaded,s.total);var f=s.loading,v=o.loading;f.start?f.first+=v.first-v.start:(f.start=v.start,f.first=v.first),f.end=v.end},d.resetLoader=function(t,r){t.loader=null,this.loader===r&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),r.destroy()},p}();function zt(p,d){d===void 0&&(d=null);var t=d||p,r={frag:p,part:d,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if((0,P.isFiniteNumber)(s)&&(0,P.isFiniteNumber)(o)){var l,n=s,u=o;if(p.sn==="initSegment"&&((l=p.decryptdata)===null||l===void 0?void 0:l.method)==="AES-128"){var c=o-s;c%16&&(u=o+(16-c%16)),s!==0&&(r.resetIV=!0,n=s-16)}r.rangeStart=n,r.rangeEnd=u}return r}var ir=function(p){var d,t;function r(s){for(var o,l=arguments.length,n=new Array(l>1?l-1:0),u=1;u<l;u++)n[u-1]=arguments[u];return(o=p.call.apply(p,[this].concat(n))||this).data=void 0,o.data=s,o}return t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Zt(d,t),r}(lr(Error)),Cr=function(){function p(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}var d=p.prototype;return d.abort=function(){for(var t in this.keyUriToKeyInfo){var r=this.keyUriToKeyInfo[t].loader;r&&r.abort()}},d.detach=function(){for(var t in this.keyUriToKeyInfo){var r=this.keyUriToKeyInfo[t];(r.mediaKeySessionContext||r.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}},d.destroy=function(){for(var t in this.detach(),this.keyUriToKeyInfo){var r=this.keyUriToKeyInfo[t].loader;r&&r.destroy()}this.keyUriToKeyInfo={}},d.createKeyLoadError=function(t,r,s,o){return r===void 0&&(r=I.ErrorDetails.KEY_LOAD_ERROR),new ir({type:I.ErrorTypes.NETWORK_ERROR,details:r,fatal:!1,frag:t,networkDetails:s})},d.loadClear=function(t,r){var s=this;if(this.emeController&&this.config.emeEnabled)for(var o=t.sn,l=t.cc,n=function(c){var f=r[c];if(l<=f.cc&&(o==="initSegment"||o<f.sn))return s.emeController.selectKeySystemFormat(f).then(function(v){f.setKeyFormat(v)}),"break"},u=0;u<r.length&&n(u)!=="break";u++);},d.load=function(t){var r=this;return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then(function(s){return r.loadInternal(t,s)}):this.loadInternal(t)},d.loadInternal=function(t,r){var s,o;r&&t.setKeyFormat(r);var l=t.decryptdata;if(!l){var n=r?"Expected frag.decryptdata to be defined after setting format "+r:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(t,I.ErrorDetails.KEY_LOAD_ERROR,null,n))}var u=l.uri;if(!u)return Promise.reject(this.createKeyLoadError(t,I.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+u+'"'));var c,f=this.keyUriToKeyInfo[u];if((s=f)!==null&&s!==void 0&&s.decryptdata.key)return l.key=f.decryptdata.key,Promise.resolve({frag:t,keyInfo:f});if((o=f)!==null&&o!==void 0&&o.keyLoadPromise)switch((c=f.mediaKeySessionContext)===null||c===void 0?void 0:c.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return f.keyLoadPromise}switch(f=this.keyUriToKeyInfo[u]={decryptdata:l,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},l.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return l.keyFormat==="identity"?this.loadKeyHTTP(f,t):this.loadKeyEME(f,t);case"AES-128":return this.loadKeyHTTP(f,t);default:return Promise.reject(this.createKeyLoadError(t,I.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+l.method+'"'))}},d.loadKeyEME=function(t,r){var s={frag:r,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var o=this.emeController.loadKey(s);if(o)return(t.keyLoadPromise=o.then(function(l){return t.mediaKeySessionContext=l,s})).catch(function(l){throw t.keyLoadPromise=null,l})}return Promise.resolve(s)},d.loadKeyHTTP=function(t,r){var s=this,o=this.config,l=new o.loader(o);return r.keyLoader=t.loader=l,t.keyLoadPromise=new Promise(function(n,u){var c={keyInfo:t,frag:r,responseType:"arraybuffer",url:t.decryptdata.uri},f={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout,highWaterMark:0},v={onSuccess:function(b,D,C,F){var q=C.frag,K=C.keyInfo,ce=C.url;if(!q.decryptdata||K!==s.keyUriToKeyInfo[ce])return u(s.createKeyLoadError(q,I.ErrorDetails.KEY_LOAD_ERROR,F,"after key load, decryptdata unset or changed"));K.decryptdata.key=q.decryptdata.key=new Uint8Array(b.data),q.keyLoader=null,K.loader=null,n({frag:q,keyInfo:K})},onError:function(b,D,C){s.resetLoader(D),u(s.createKeyLoadError(r,I.ErrorDetails.KEY_LOAD_ERROR,C))},onTimeout:function(b,D,C){s.resetLoader(D),u(s.createKeyLoadError(r,I.ErrorDetails.KEY_LOAD_TIMEOUT,C))},onAbort:function(b,D,C){s.resetLoader(D),u(s.createKeyLoadError(r,I.ErrorDetails.INTERNAL_ABORTED,C))}};l.load(c,f,v)})},d.resetLoader=function(t){var r=t.frag,s=t.keyInfo,o=t.url,l=s.loader;r.keyLoader===l&&(r.keyLoader=null,s.loader=null),delete this.keyUriToKeyInfo[o],l&&l.destroy()},p}(),Zr=function(){function p(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var d=p.prototype;return d.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},d.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},d.onHandlerDestroyed=function(){},d.hasInterval=function(){return!!this._tickInterval},d.hasNextTick=function(){return!!this._tickTimer},d.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},d.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},d.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},d.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},d.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},d.doTick=function(){},p}(),Ur={length:0,start:function(){return 0},end:function(){return 0}},$t=function(){function p(){}return p.isBuffered=function(d,t){try{if(d){for(var r=p.getBuffered(d),s=0;s<r.length;s++)if(t>=r.start(s)&&t<=r.end(s))return!0}}catch{}return!1},p.bufferInfo=function(d,t,r){try{if(d){var s,o=p.getBuffered(d),l=[];for(s=0;s<o.length;s++)l.push({start:o.start(s),end:o.end(s)});return this.bufferedInfo(l,t,r)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}},p.bufferedInfo=function(d,t,r){t=Math.max(0,t),d.sort(function(F,q){return F.start-q.start||q.end-F.end});var s=[];if(r)for(var o=0;o<d.length;o++){var l=s.length;if(l){var n=s[l-1].end;d[o].start-n<r?d[o].end>n&&(s[l-1].end=d[o].end):s.push(d[o])}else s.push(d[o])}else s=d;for(var u,c=0,f=t,v=t,b=0;b<s.length;b++){var D=s[b].start,C=s[b].end;if(t+r>=D&&t<C)f=D,c=(v=C)-t;else if(t+r<D){u=D;break}}return{len:c,start:f||0,end:v||0,nextStart:u}},p.getBuffered=function(d){try{return d.buffered}catch(t){return O.logger.log("failed to get media.buffered",t),Ur}},p}(),Ln=function(p,d,t,r,s,o){r===void 0&&(r=0),s===void 0&&(s=-1),o===void 0&&(o=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=p,this.sn=d,this.id=t,this.size=r,this.part=s,this.partial=o};function $r(p,d){for(var t=null,r=0,s=p.length;r<s;r++){var o=p[r];if(o&&o.cc===d){t=o;break}}return t}function Rn(p,d){if(p){var t=p.start+d;p.start=p.startPTS=t,p.endPTS=t+p.duration}}function Cn(p,d){for(var t=d.fragments,r=0,s=t.length;r<s;r++)Rn(t[r],p);d.fragmentHint&&Rn(d.fragmentHint,p),d.alignedSliding=!0}function Sa(p,d){if(p.hasProgramDateTime&&d.hasProgramDateTime){var t=p.fragments,r=d.fragments;if(t.length&&r.length){var s=r[Math.round(r.length/2)-1],o=$r(t,s.cc)||t[Math.round(t.length/2)-1],l=s.programDateTime,n=o.programDateTime;l!==null&&n!==null&&Cn((n-l)/1e3-(o.start-s.start),p)}}}const xn=function(p,d){for(var t=0,r=p.length-1,s=null,o=null;t<=r;){var l=d(o=p[s=(t+r)/2|0]);if(l>0)t=s+1;else{if(!(l<0))return o;r=s-1}}return null};function on(p,d,t,r){t===void 0&&(t=0),r===void 0&&(r=0);var s=null;if(p?s=d[p.sn-d[0].sn+1]||null:t===0&&d[0].start===0&&(s=d[0]),s&&si(t,r,s)===0)return s;var o=xn(d,si.bind(null,t,r));return!o||o===p&&s?s:o}function si(p,d,t){if(p===void 0&&(p=0),d===void 0&&(d=0),t.start<=p&&t.start+t.duration>p)return 0;var r=Math.min(d,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=p?1:t.start-r>p&&t.start?-1:0}function Yi(p,d,t){var r=1e3*Math.min(d,t.duration+(t.deltaPTS?t.deltaPTS:0));return(t.endProgramDateTime||0)-r>p}var Ms=w(21);const Ps=function(p){for(var d="",t=p.length,r=0;r<t;r++)d+="["+p.start(r).toFixed(3)+","+p.end(r).toFixed(3)+"]";return d};function ln(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function On(p,d){return On=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},On(p,d)}var Fr="STOPPED",Lt="IDLE",Aa="KEY_LOADING",yi="FRAG_LOADING",Li="FRAG_LOADING_WAITING_RETRY",un="WAITING_TRACK",Nr="PARSING",zi="PARSED",Xi="ENDED",Br="ERROR",Qi="WAITING_INIT_PTS",Ei="WAITING_LEVEL",Mn=function(p){var d,t;function r(n,u,c,f){var v;return(v=p.call(this)||this).hls=void 0,v.fragPrevious=null,v.fragCurrent=null,v.fragmentTracker=void 0,v.transmuxer=null,v._state=Fr,v.media=null,v.mediaBuffer=null,v.config=void 0,v.bitrateTest=!1,v.lastCurrentTime=0,v.nextLoadPosition=0,v.startPosition=0,v.loadedmetadata=!1,v.fragLoadError=0,v.retryDate=0,v.levels=null,v.fragmentLoader=void 0,v.keyLoader=void 0,v.levelLastLoaded=null,v.startFragRequested=!1,v.decrypter=void 0,v.initPTS=[],v.onvseeking=null,v.onvended=null,v.logPrefix="",v.log=void 0,v.warn=void 0,v.logPrefix=f,v.log=O.logger.log.bind(O.logger,f+":"),v.warn=O.logger.warn.bind(O.logger,f+":"),v.hls=n,v.fragmentLoader=new Qr(n.config),v.keyLoader=c,v.fragmentTracker=u,v.config=n.config,v.decrypter=new Ms.default(n.config),n.on(g.Events.LEVEL_SWITCHING,v.onLevelSwitching,function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v)),v}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,On(d,t);var s,o,l=r.prototype;return l.doTick=function(){this.onTickEnd()},l.onTickEnd=function(){},l.startLoad=function(n){},l.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var n=this.fragCurrent;n&&(n.abortRequests(),this.fragmentTracker.removeFragment(n)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Fr},l._streamEnded=function(n,u){if(u.live||n.nextStart||!n.end||!this.media)return!1;var c=u.partList;if(c!=null&&c.length){var f=c[c.length-1];return $t.isBuffered(this.media,f.start+f.duration/2)}var v=u.fragments[u.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(v)},l.getLevelDetails=function(){var n;if(this.levels&&this.levelLastLoaded!==null)return(n=this.levels[this.levelLastLoaded])===null||n===void 0?void 0:n.details},l.onMediaAttached=function(n,u){var c=this.media=this.mediaBuffer=u.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),c.addEventListener("seeking",this.onvseeking),c.addEventListener("ended",this.onvended);var f=this.config;this.levels&&f.autoStartLoad&&this.state===Fr&&this.startLoad(f.startPosition)},l.onMediaDetaching=function(){var n=this.media;n!=null&&n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n&&this.onvseeking&&this.onvended&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},l.onMediaSeeking=function(){var n=this.config,u=this.fragCurrent,c=this.media,f=this.mediaBuffer,v=this.state,b=c?c.currentTime:0,D=$t.bufferInfo(f||c,b,n.maxBufferHole);if(this.log("media seeking to "+((0,P.isFiniteNumber)(b)?b.toFixed(3):b)+", state: "+v),this.state===Xi)this.resetLoadingState();else if(u){var C=n.maxFragLookUpTolerance,F=u.start-C,q=u.start+u.duration+C;if(!D.len||q<D.start||F>D.end){var K=b>q;(b<F||K)&&(K&&u.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),u.abortRequests()),this.resetLoadingState())}}c&&(this.lastCurrentTime=b),this.loadedmetadata||D.len||(this.nextLoadPosition=this.startPosition=b),this.tickImmediate()},l.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},l.onLevelSwitching=function(n,u){this.fragLoadError=0},l.onHandlerDestroying=function(){this.stopLoad(),p.prototype.onHandlerDestroying.call(this)},l.onHandlerDestroyed=function(){this.state=Fr,this.hls.off(g.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,p.prototype.onHandlerDestroyed.call(this)},l.loadFragment=function(n,u,c){this._loadFragForPlayback(n,u,c)},l._loadFragForPlayback=function(n,u,c){var f=this;this._doFragLoad(n,u,c,function(v){if(f.fragContextChanged(n))return f.warn("Fragment "+n.sn+(v.part?" p: "+v.part.index:"")+" of level "+n.level+" was dropped during download."),void f.fragmentTracker.removeFragment(n);n.stats.chunkCount++,f._handleFragmentLoadProgress(v)}).then(function(v){if(v){f.fragLoadError=0;var b=f.state;f.fragContextChanged(n)?(b===yi||!f.fragCurrent&&b===Nr)&&(f.fragmentTracker.removeFragment(n),f.state=Lt):("payload"in v&&(f.log("Loaded fragment "+n.sn+" of level "+n.level),f.hls.trigger(g.Events.FRAG_LOADED,v)),f._handleFragmentLoadComplete(v))}}).catch(function(v){f.state!==Fr&&f.state!==Br&&(f.warn(v),f.resetFragmentLoading(n))})},l.flushMainBuffer=function(n,u,c){if(c===void 0&&(c=null),n-u){var f={startOffset:n,endOffset:u,type:c};this.fragLoadError=0,this.hls.trigger(g.Events.BUFFER_FLUSHING,f)}},l._loadInitSegment=function(n,u){var c=this;this._doFragLoad(n,u).then(function(f){if(!f||c.fragContextChanged(n)||!c.levels)throw new Error("init load aborted");return f}).then(function(f){var v=c.hls,b=f.payload,D=n.decryptdata;if(b&&b.byteLength>0&&D&&D.key&&D.iv&&D.method==="AES-128"){var C=self.performance.now();return c.decrypter.decrypt(new Uint8Array(b),D.key.buffer,D.iv.buffer).then(function(F){var q=self.performance.now();return v.trigger(g.Events.FRAG_DECRYPTED,{frag:n,payload:F,stats:{tstart:C,tdecrypt:q}}),f.payload=F,f})}return f}).then(function(f){var v=c.fragCurrent,b=c.hls,D=c.levels;if(!D)throw new Error("init load aborted, missing levels");var C=n.stats;c.state=Lt,c.fragLoadError=0,n.data=new Uint8Array(f.payload),C.parsing.start=C.buffering.start=self.performance.now(),C.parsing.end=C.buffering.end=self.performance.now(),f.frag===v&&b.trigger(g.Events.FRAG_BUFFERED,{stats:C,frag:v,part:null,id:n.type}),c.tick()}).catch(function(f){c.state!==Fr&&c.state!==Br&&(c.warn(f),c.resetFragmentLoading(n))})},l.fragContextChanged=function(n){var u=this.fragCurrent;return!n||!u||n.level!==u.level||n.sn!==u.sn||n.urlId!==u.urlId},l.fragBufferedComplete=function(n,u){var c,f,v=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+n.type+" sn: "+n.sn+(u?" part: "+u.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+n.level+" "+(v?Ps($t.getBuffered(v)):"(detached)")),this.state=Lt,v&&(!this.loadedmetadata&&n.type==_e.PlaylistLevelType.MAIN&&v.buffered.length&&((c=this.fragCurrent)===null||c===void 0?void 0:c.sn)===((f=this.fragPrevious)===null||f===void 0?void 0:f.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},l.seekToStartPos=function(){},l._handleFragmentLoadComplete=function(n){var u=this.transmuxer;if(u){var c=n.frag,f=n.part,v=n.partsLoaded,b=!v||v.length===0||v.some(function(C){return!C}),D=new Ln(c.level,c.sn,c.stats.chunkCount+1,0,f?f.index:-1,!b);u.flush(D)}},l._handleFragmentLoadProgress=function(n){},l._doFragLoad=function(n,u,c,f){var v,b=this;if(c===void 0&&(c=null),!this.levels)throw new Error("frag load aborted, missing levels");var D=null;if(!n.encrypted||(v=n.decryptdata)!==null&&v!==void 0&&v.key?!n.encrypted&&u.encryptedFragments.length&&this.keyLoader.loadClear(n,u.encryptedFragments):(this.log("Loading key for "+n.sn+" of ["+u.startSN+"-"+u.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+n.level),this.state=Aa,this.fragCurrent=n,D=this.keyLoader.load(n).then(function(ce){if(!b.fragContextChanged(ce.frag))return b.hls.trigger(g.Events.KEY_LOADED,ce),ce}),this.hls.trigger(g.Events.KEY_LOADING,{frag:n}),this.throwIfFragContextChanged("KEY_LOADING")),c=Math.max(n.start,c||0),this.config.lowLatencyMode&&u){var C=u.partList;if(C&&f){c>n.end&&u.fragmentHint&&(n=u.fragmentHint);var F=this.getNextPart(C,n,c);if(F>-1){var q=C[F];return this.log("Loading part sn: "+n.sn+" p: "+q.index+" cc: "+n.cc+" of playlist ["+u.startSN+"-"+u.endSN+"] parts [0-"+F+"-"+(C.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+n.level+", target: "+parseFloat(c.toFixed(3))),this.nextLoadPosition=q.start+q.duration,this.state=yi,this.hls.trigger(g.Events.FRAG_LOADING,{frag:n,part:C[F],targetBufferTime:c}),this.throwIfFragContextChanged("FRAG_LOADING parts"),D?D.then(function(ce){return!ce||b.fragContextChanged(ce.frag)?null:b.doFragPartsLoad(n,C,F,f)}).catch(function(ce){return b.handleFragLoadError(ce)}):this.doFragPartsLoad(n,C,F,f).catch(function(ce){return b.handleFragLoadError(ce)})}if(!n.url||this.loadedEndOfParts(C,c))return Promise.resolve(null)}}this.log("Loading fragment "+n.sn+" cc: "+n.cc+" "+(u?"of ["+u.startSN+"-"+u.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+n.level+", target: "+parseFloat(c.toFixed(3))),(0,P.isFiniteNumber)(n.sn)&&!this.bitrateTest&&(this.nextLoadPosition=n.start+n.duration),this.state=yi,this.hls.trigger(g.Events.FRAG_LOADING,{frag:n,targetBufferTime:c}),this.throwIfFragContextChanged("FRAG_LOADING");var K=this.config.progressive;return K&&D?D.then(function(ce){return!ce||b.fragContextChanged(ce==null?void 0:ce.frag)?null:b.fragmentLoader.load(n,f)}).catch(function(ce){return b.handleFragLoadError(ce)}):Promise.all([this.fragmentLoader.load(n,K?f:void 0),D]).then(function(ce){var Se=ce[0];return!K&&Se&&f&&f(Se),Se}).catch(function(ce){return b.handleFragLoadError(ce)})},l.throwIfFragContextChanged=function(n){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+n)},l.doFragPartsLoad=function(n,u,c,f){var v=this;return new Promise(function(b,D){var C=[];(function F(q){var K=u[q];v.fragmentLoader.loadPart(n,K,f).then(function(ce){C[K.index]=ce;var Se=ce.part;v.hls.trigger(g.Events.FRAG_LOADED,ce);var Ce=u[q+1];if(!Ce||Ce.fragment!==n)return b({frag:n,part:Se,partsLoaded:C});F(q+1)}).catch(D)})(c)})},l.handleFragLoadError=function(n){if("data"in n){var u=n.data;n.data&&u.details===I.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(u.frag,u.part):this.hls.trigger(g.Events.ERROR,u)}else this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.OTHER_ERROR,details:I.ErrorDetails.INTERNAL_EXCEPTION,err:n,fatal:!0});return null},l._handleTransmuxerFlush=function(n){var u=this.getCurrentContext(n);if(u&&this.state===Nr){var c=u.frag,f=u.part,v=u.level,b=self.performance.now();c.stats.parsing.end=b,f&&(f.stats.parsing.end=b),this.updateLevelTiming(c,f,v,n.partial)}else this.fragCurrent||this.state===Fr||this.state===Br||(this.state=Lt)},l.getCurrentContext=function(n){var u=this.levels,c=n.level,f=n.sn,v=n.part;if(!u||!u[c])return this.warn("Levels object was unset while buffering fragment "+f+" of level "+c+". The current chunk will not be buffered."),null;var b=u[c],D=v>-1?function(F,q,K){if(!F||!F.details)return null;var ce=F.details.partList;if(ce)for(var Se=ce.length;Se--;){var Ce=ce[Se];if(Ce.index===K&&Ce.fragment.sn===q)return Ce}return null}(b,f,v):null,C=D?D.fragment:function(F,q,K){if(!F||!F.details)return null;var ce=F.details,Se=ce.fragments[q-ce.startSN];return Se||((Se=ce.fragmentHint)&&Se.sn===q?Se:q<ce.startSN&&K&&K.sn===q?K:null)}(b,f,this.fragCurrent);return C?{frag:C,part:D,level:b}:null},l.bufferFragmentData=function(n,u,c,f){if(n&&this.state===Nr){var v=n.data1,b=n.data2,D=v;if(v&&b&&(D=(0,ne.appendUint8Array)(v,b)),D&&D.length){var C={type:n.type,frag:u,part:c,chunkMeta:f,parent:u.type,data:D};this.hls.trigger(g.Events.BUFFER_APPENDING,C),n.dropped&&n.independent&&!c&&this.flushBufferGap(u)}}},l.flushBufferGap=function(n){var u=this.media;if(u)if($t.isBuffered(u,u.currentTime)){var c=u.currentTime,f=$t.bufferInfo(u,c,0),v=n.duration,b=Math.min(2*this.config.maxFragLookUpTolerance,.25*v),D=Math.max(Math.min(n.start-b,f.end-b),c+b);n.start-D>b&&this.flushMainBuffer(D,n.start)}else this.flushMainBuffer(0,n.start)},l.getFwdBufferInfo=function(n,u){var c=this.config,f=this.getLoadPosition();if(!(0,P.isFiniteNumber)(f))return null;var v=$t.bufferInfo(n,f,c.maxBufferHole);if(v.len===0&&v.nextStart!==void 0){var b=this.fragmentTracker.getBufferedFrag(f,u);if(b&&v.nextStart<b.end)return $t.bufferInfo(n,f,Math.max(v.nextStart,c.maxBufferHole))}return v},l.getMaxBufferLength=function(n){var u,c=this.config;return u=n?Math.max(8*c.maxBufferSize/n,c.maxBufferLength):c.maxBufferLength,Math.min(u,c.maxMaxBufferLength)},l.reduceMaxBufferLength=function(n){var u=this.config,c=n||u.maxBufferLength;return u.maxMaxBufferLength>=c&&(u.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+u.maxMaxBufferLength+"s"),!0)},l.getNextFragment=function(n,u){var c=u.fragments,f=c.length;if(!f)return null;var v,b=this.config,D=c[0].start;if(u.live){var C=b.initialLiveManifestSize;if(f<C)return this.warn("Not enough fragments to start playback (have: "+f+", need: "+C+")"),null;u.PTSKnown||this.startFragRequested||this.startPosition!==-1||(v=this.getInitialLiveFragment(u,c),this.startPosition=v?this.hls.liveSyncPosition||v.start:n)}else n<=D&&(v=c[0]);if(!v){var F=b.lowLatencyMode?u.partEnd:u.fragmentEnd;v=this.getFragmentAtPosition(n,F,u)}return this.mapToInitFragWhenRequired(v)},l.mapToInitFragWhenRequired=function(n){return n==null||!n.initSegment||n!=null&&n.initSegment.data||this.bitrateTest?n:n.initSegment},l.getNextPart=function(n,u,c){for(var f=-1,v=!1,b=!0,D=0,C=n.length;D<C;D++){var F=n[D];if(b=b&&!F.independent,f>-1&&c<F.start)break;var q=F.loaded;q?f=-1:(v||F.independent||b)&&F.fragment===u&&(f=D),v=q}return f},l.loadedEndOfParts=function(n,u){var c=n[n.length-1];return c&&u>c.start&&c.loaded},l.getInitialLiveFragment=function(n,u){var c=this.fragPrevious,f=null;if(c){if(n.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+c.programDateTime),f=function(C,F,q){if(F===null||!Array.isArray(C)||!C.length||!(0,P.isFiniteNumber)(F)||F<(C[0].programDateTime||0)||F>=(C[C.length-1].endProgramDateTime||0))return null;q=q||0;for(var K=0;K<C.length;++K){var ce=C[K];if(Yi(F,q,ce))return ce}return null}(u,c.endProgramDateTime,this.config.maxFragLookUpTolerance)),!f){var v=c.sn+1;if(v>=n.startSN&&v<=n.endSN){var b=u[v-n.startSN];c.cc===b.cc&&(f=b,this.log("Live playlist, switching playlist, load frag with next SN: "+f.sn))}f||(f=function(C,F){return xn(C,function(q){return q.cc<F?1:q.cc>F?-1:0})}(u,c.cc),f&&this.log("Live playlist, switching playlist, load frag with same CC: "+f.sn))}}else{var D=this.hls.liveSyncPosition;D!==null&&(f=this.getFragmentAtPosition(D,this.bitrateTest?n.fragmentEnd:n.edge,n))}return f},l.getFragmentAtPosition=function(n,u,c){var f,v=this.config,b=this.fragPrevious,D=c.fragments,C=c.endSN,F=c.fragmentHint,q=v.maxFragLookUpTolerance,K=!!(v.lowLatencyMode&&c.partList&&F);if(K&&F&&!this.bitrateTest&&(D=D.concat(F),C=F.sn),f=n<u?on(b,D,n,n>u-q?0:q):D[D.length-1]){var ce=f.sn-c.startSN;if(this.fragmentTracker.getState(f)===Ye.OK&&(b=f),b&&f.sn===b.sn&&!K&&b&&f.level===b.level){var Se=D[ce+1];f.sn<C&&this.fragmentTracker.getState(Se)!==Ye.OK?(this.log("SN "+f.sn+" just loaded, load next one: "+Se.sn),f=Se):f=null}}return f},l.synchronizeToLiveEdge=function(n){var u=this.config,c=this.media;if(c){var f=this.hls.liveSyncPosition,v=c.currentTime,b=n.fragments[0].start,D=n.edge,C=v>=b-u.maxFragLookUpTolerance&&v<=D;if(f!==null&&c.duration>f&&(v<f||!C)){var F=u.liveMaxLatencyDuration!==void 0?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*n.targetduration;(!C&&c.readyState<4||v<D-F)&&(this.loadedmetadata||(this.nextLoadPosition=f),c.readyState&&(this.warn("Playback: "+v.toFixed(3)+" is located too far from the end of live sliding playlist: "+D+", reset currentTime to : "+f.toFixed(3)),c.currentTime=f))}}},l.alignPlaylists=function(n,u){var c=this.levels,f=this.levelLastLoaded,v=this.fragPrevious,b=f!==null?c[f]:null,D=n.fragments.length;if(!D)return this.warn("No fragments in live playlist"),0;var C=n.fragments[0].start,F=!u,q=n.alignedSliding&&(0,P.isFiniteNumber)(C);if(F||!q&&!C){(function(ce,Se,Ce){Se&&(function(Ie,Pe,Qe){if(function(xe,ze,$e){return!(!ze.details||!($e.endCC>$e.startCC||xe&&xe.cc<$e.startCC))}(Ie,Qe,Pe)){var st=function(xe,ze,$e){var St=xe.fragments,Gt=ze.fragments;if(Gt.length&&St.length){var wt=$r(St,Gt[0].cc);if(wt&&(!wt||wt.startPTS))return wt;O.logger.log("No frag in previous level to align on")}else O.logger.log("No fragments to align")}(Qe.details,Pe);st&&(0,P.isFiniteNumber)(st.start)&&(O.logger.log("Adjusting PTS using last level due to CC increase within current level "+Pe.url),Cn(st.start,Pe))}}(ce,Ce,Se),!Ce.alignedSliding&&Se.details&&function(Ie,Pe){if(Pe.fragments.length&&Ie.hasProgramDateTime&&Pe.hasProgramDateTime){var Qe=Pe.fragments[0].programDateTime,st=Ie.fragments[0].programDateTime,xe=(st-Qe)/1e3+Pe.fragments[0].start;xe&&(0,P.isFiniteNumber)(xe)&&(O.logger.log("Adjusting PTS using programDateTime delta "+(st-Qe)+"ms, sliding:"+xe.toFixed(3)+" "+Ie.url+" "),Cn(xe,Ie))}}(Ce,Se.details),Ce.alignedSliding||!Se.details||Ce.skippedSegments||ve(Se.details,Ce))})(v,b,n);var K=n.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(u?u.startSN:"na")+"->"+n.startSN+" prev-sn: "+(v?v.sn:"na")+" fragments: "+D),K}return C},l.waitForCdnTuneIn=function(n){return n.live&&n.canBlockReload&&n.partTarget&&n.tuneInGoal>Math.max(n.partHoldBack,3*n.partTarget)},l.setStartPosition=function(n,u){var c=this.startPosition;if(c<u&&(c=-1),c===-1||this.lastCurrentTime===-1){var f=n.startTimeOffset;(0,P.isFiniteNumber)(f)?(c=u+f,f<0&&(c+=n.totalduration),c=Math.min(Math.max(u,c),u+n.totalduration),this.log("Start time offset "+f+" found in playlist, adjust startPosition to "+c),this.startPosition=c):n.live?c=this.hls.liveSyncPosition||u:this.startPosition=c=0,this.lastCurrentTime=c}this.nextLoadPosition=c},l.getLoadPosition=function(){var n=this.media,u=0;return this.loadedmetadata&&n?u=n.currentTime:this.nextLoadPosition&&(u=this.nextLoadPosition),u},l.handleFragLoadAborted=function(n,u){this.transmuxer&&n.sn!=="initSegment"&&n.stats.aborted&&(this.warn("Fragment "+n.sn+(u?" part"+u.index:"")+" of level "+n.level+" was aborted"),this.resetFragmentLoading(n))},l.resetFragmentLoading=function(n){this.fragCurrent&&(this.fragContextChanged(n)||this.state===Li)||(this.state=Lt)},l.onFragmentOrKeyLoadError=function(n,u){if(u.fatal)return this.stopLoad(),void(this.state=Br);var c=this.config;if(u.chunkMeta){var f=this.getCurrentContext(u.chunkMeta);f&&(u.frag=f.frag,u.levelRetry=!0,this.fragLoadError=c.fragLoadingMaxRetry)}var v=u.frag;if(v&&v.type===n)if(this.fragLoadError+1<=c.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var b=Math.min(Math.pow(2,this.fragLoadError)*c.fragLoadingRetryDelay,c.fragLoadingMaxRetryTimeout);this.warn("Fragment "+v.sn+" of "+n+" "+v.level+" failed to load, retrying in "+b+"ms"),this.retryDate=self.performance.now()+b,this.fragLoadError++,this.state=Li}else u.levelRetry?(n===_e.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=Lt):(O.logger.error(u.details+" reaches max retry, redispatch as fatal ..."),u.fatal=!0,this.hls.stopLoad(),this.state=Br)},l.afterBufferFlushed=function(n,u,c){if(n){var f=$t.getBuffered(n);this.fragmentTracker.detectEvictedFragments(u,f,c),this.state===Xi&&this.resetLoadingState()}},l.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Lt},l.resetStartWhenNotLoaded=function(n){if(!this.loadedmetadata){this.startFragRequested=!1;var u=this.levels?this.levels[n].details:null;u!=null&&u.live?(this.startPosition=-1,this.setStartPosition(u,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},l.updateLevelTiming=function(n,u,c,f){var v=this,b=c.details;Object.keys(n.elementaryStreams).reduce(function(D,C){var F=n.elementaryStreams[C];if(F){var q=F.endPTS-F.startPTS;if(q<=0)return v.warn("Could not parse fragment "+n.sn+" "+C+" duration reliably ("+q+")"),D||!1;var K=f?0:pe(b,n,F.startPTS,F.endPTS,F.startDTS,F.endDTS);return v.hls.trigger(g.Events.LEVEL_PTS_UPDATED,{details:b,level:c,drift:K,type:C,frag:n,start:F.startPTS,end:F.endPTS}),!0}return D},!1)||(this.warn("Found no media in fragment "+n.sn+" of level "+c.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=zi,this.hls.trigger(g.Events.FRAG_PARSED,{frag:n,part:u})},l.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},s=r,(o=[{key:"state",get:function(){return this._state},set:function(n){var u=this._state;u!==n&&(this._state=n,this.log(u+"->"+n))}}])&&ln(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Zr);function Zi(){return self.MediaSource||self.WebKitMediaSource}function wa(){return self.SourceBuffer||self.WebKitSourceBuffer}var Pn=function(){var p=ENTRY_MODULE,d={},t=function s(o){var l=d[o];if(l!==void 0)return l.exports;var n=d[o]={exports:{}};return p[o].call(n.exports,n,n.exports,s),n.exports};t.m=p,t.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(o,{a:o}),o},t.d=function(s,o){for(var l in o)t.o(o,l)&&!t.o(s,l)&&Object.defineProperty(s,l,{enumerable:!0,get:o[l]})},t.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},t.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var r=t(ENTRY_MODULE);return r.default||r}.toString().split("ENTRY_MODULE"),ar="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function Ji(p){return(p+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function Us(p,d,t){var r={};r[t]=[];var s=d.toString().replace(/^"[^"]+"/,"function"),o=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||s.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!o)return r;for(var l,n=o[1],u=new RegExp("(\\\\n|\\W)"+Ji(n)+ar,"g");l=u.exec(s);)l[3]!=="dll-reference"&&r[t].push(l[3]);for(u=new RegExp("\\("+Ji(n)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+ar,"g");l=u.exec(s);)p[l[2]]||(r[t].push(l[1]),p[l[2]]=w(l[1]).m),r[l[2]]=r[l[2]]||[],r[l[2]].push(l[4]);for(var c,f=Object.keys(r),v=0;v<f.length;v++)for(var b=0;b<r[f[v]].length;b++)c=r[f[v]][b],isNaN(1*c)||(r[f[v]][b]=1*r[f[v]][b]);return r}function Fs(p){return Object.keys(p).reduce(function(d,t){return d||p[t].length>0},!1)}function ka(p,d,t,r){var s=p[r].map(function(o){return'"'+o+'": '+d[r][o].toString().replace(/^"[^"]+"/,"function")}).join(",");return Pn[0]+"{"+s+"}"+Pn[1]+'"'+t+'"'+Pn[2]}var bi=w(544),_i=w(729),Un=w.n(_i),dn=Zi()||{isTypeSupported:function(){return!1}},Fn=function(){function p(t,r,s,o){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var n=t.config;this.hls=t,this.id=r,this.useWorker=!!n.enableWorker,this.onTransmuxComplete=s,this.onFlush=o;var u=function(b,D){(D=D||{}).frag=l.frag,D.id=l.id,l.hls.trigger(b,D)};this.observer=new _i.EventEmitter,this.observer.on(g.Events.FRAG_DECRYPTED,u),this.observer.on(g.Events.ERROR,u);var c={mp4:dn.isTypeSupported("video/mp4"),mpeg:dn.isTypeSupported("audio/mpeg"),mp3:dn.isTypeSupported('audio/mp4; codecs="mp3"')},f=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){var v;O.logger.log("demuxing in webworker");try{v=this.worker=function(b,D){D=D||{};var C={main:w.m},F=D.all?{main:Object.keys(C.main)}:function(Ce,Ie){for(var Pe={main:[Ie]},Qe={main:[]},st={main:{}};Fs(Pe);)for(var xe=Object.keys(Pe),ze=0;ze<xe.length;ze++){var $e=xe[ze],St=Pe[$e].pop();if(st[$e]=st[$e]||{},!st[$e][St]&&Ce[$e][St]){st[$e][St]=!0,Qe[$e]=Qe[$e]||[],Qe[$e].push(St);for(var Gt=Us(Ce,Ce[$e][St],$e),wt=Object.keys(Gt),Ct=0;Ct<wt.length;Ct++)Pe[wt[Ct]]=Pe[wt[Ct]]||[],Pe[wt[Ct]]=Pe[wt[Ct]].concat(Gt[wt[Ct]])}}return Qe}(C,b),q="";Object.keys(F).filter(function(Ce){return Ce!=="main"}).forEach(function(Ce){for(var Ie=0;F[Ce][Ie];)Ie++;F[Ce].push(Ie),C[Ce][Ie]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",q=q+"var "+Ce+" = ("+ka(F,C,Ie,modules)+`)();
`}),q=q+"new (("+ka(F,C,b,"main")+")())(self);";var K=new window.Blob([q],{type:"text/javascript"}),ce=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(K),Se=new window.Worker(ce);return Se.objectURL=ce,Se}(182),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(b){l.useWorker=!1,O.logger.warn("Exception in webworker, fallback to inline"),l.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.OTHER_ERROR,details:I.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(b.message+"  ("+b.filename+":"+b.lineno+")")})},v.postMessage({cmd:"init",typeSupported:c,vendor:f,id:r,config:JSON.stringify(n)})}catch(b){O.logger.warn("Error in worker:",b),O.logger.error("Error while initializing DemuxerWorker, fallback to inline"),v&&self.URL.revokeObjectURL(v.objectURL),this.transmuxer=new bi.default(this.observer,c,n,f,r),this.worker=null}}else this.transmuxer=new bi.default(this.observer,c,n,f,r)}var d=p.prototype;return d.destroy=function(){var t=this.worker;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.worker=null,this.onwmsg=void 0;else{var r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}var s=this.observer;s&&s.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},d.push=function(t,r,s,o,l,n,u,c,f,v){var b,D,C=this;f.transmuxing.start=self.performance.now();var F=this.transmuxer,q=this.worker,K=n?n.start:l.start,ce=l.decryptdata,Se=this.frag,Ce=!(Se&&l.cc===Se.cc),Ie=!(Se&&f.level===Se.level),Pe=Se?f.sn-Se.sn:-1,Qe=this.part?f.part-this.part.index:-1,st=Pe===0&&f.id>1&&f.id===(Se==null?void 0:Se.stats.chunkCount),xe=!Ie&&(Pe===1||Pe===0&&(Qe===1||st&&Qe<=0)),ze=self.performance.now();(Ie||Pe||l.stats.parsing.start===0)&&(l.stats.parsing.start=ze),!n||!Qe&&xe||(n.stats.parsing.start=ze);var $e=!(Se&&((b=l.initSegment)===null||b===void 0?void 0:b.url)===((D=Se.initSegment)===null||D===void 0?void 0:D.url)),St=new bi.TransmuxState(Ce,xe,c,Ie,K,$e);if(!xe||Ce||$e){O.logger.log("[transmuxer-interface, "+l.type+"]: Starting new transmux session for sn: "+f.sn+" p: "+f.part+" level: "+f.level+" id: "+f.id+`
        discontinuity: `+Ce+`
        trackSwitch: `+Ie+`
        contiguous: `+xe+`
        accurateTimeOffset: `+c+`
        timeOffset: `+K+`
        initSegmentChange: `+$e);var Gt=new bi.TransmuxConfig(s,o,r,u,v);this.configureTransmuxer(Gt)}if(this.frag=l,this.part=n,q)q.postMessage({cmd:"demux",data:t,decryptdata:ce,chunkMeta:f,state:St},t instanceof ArrayBuffer?[t]:[]);else if(F){var wt=F.push(t,ce,f,St);(0,bi.isPromise)(wt)?(F.async=!0,wt.then(function(Ct){C.handleTransmuxComplete(Ct)}).catch(function(Ct){C.transmuxerError(Ct,f,"transmuxer-interface push error")})):(F.async=!1,this.handleTransmuxComplete(wt))}},d.flush=function(t){var r=this;t.transmuxing.start=self.performance.now();var s=this.transmuxer,o=this.worker;if(o)o.postMessage({cmd:"flush",chunkMeta:t});else if(s){var l=s.flush(t);(0,bi.isPromise)(l)||s.async?((0,bi.isPromise)(l)||(l=Promise.resolve(l)),l.then(function(n){r.handleFlushResult(n,t)}).catch(function(n){r.transmuxerError(n,t,"transmuxer-interface flush error")})):this.handleFlushResult(l,t)}},d.transmuxerError=function(t,r,s){this.hls&&this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:r,fatal:!1,error:t,err:t,reason:s})},d.handleFlushResult=function(t,r){var s=this;t.forEach(function(o){s.handleTransmuxComplete(o)}),this.onFlush(r)},d.onWorkerMessage=function(t){var r=t.data,s=this.hls;switch(r.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(r.data);break;case"flush":this.onFlush(r.data);break;case"workerLog":O.logger[r.data.logType]&&O.logger[r.data.logType](r.data.message);break;default:r.data=r.data||{},r.data.frag=this.frag,r.data.id=this.id,s.trigger(r.event,r.data)}},d.configureTransmuxer=function(t){var r=this.worker,s=this.transmuxer;r?r.postMessage({cmd:"configure",config:t}):s&&s.configure(t)},d.handleTransmuxComplete=function(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)},p}(),Ri=function(){function p(t,r,s,o){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=r,this.fragmentTracker=s,this.hls=o}var d=p.prototype;return d.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},d.poll=function(t,r){var s=this.config,o=this.media,l=this.stalled;if(o!==null){var n=o.currentTime,u=o.seeking,c=this.seeking&&!u,f=!this.seeking&&u;if(this.seeking=u,n===t){if((f||c)&&(this.stalled=null),!(o.paused&&!u||o.ended||o.playbackRate===0)&&$t.getBuffered(o).length){var v=$t.bufferInfo(o,n,0),b=v.len>0,D=v.nextStart||0;if(b||D){if(u){var C=v.len>2,F=!D||r&&r.start<=n||D-n>2&&!this.fragmentTracker.getPartialFragment(n);if(C||F)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var q,K=Math.max(D,v.start||0)-n,ce=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,Se=!(ce==null||(q=ce.details)===null||q===void 0)&&q.live?2*ce.details.targetduration:2;if(K>0&&K<=Se)return void this._trySkipBufferHole(null)}var Ce=self.performance.now();if(l!==null){var Ie=Ce-l;if(u||!(Ie>=250)||(this._reportStall(v),this.media)){var Pe=$t.bufferInfo(o,n,s.maxBufferHole);this._tryFixBufferStall(Pe,Ie)}}else this.stalled=Ce}}}else if(this.moved=!0,l!==null){if(this.stallReported){var Qe=self.performance.now()-l;O.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(Qe)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},d._tryFixBufferStall=function(t,r){var s=this.config,o=this.fragmentTracker,l=this.media;if(l!==null){var n=l.currentTime,u=o.getPartialFragment(n);if(u&&(this._trySkipBufferHole(u)||!this.media))return;t.len>s.maxBufferHole&&r>1e3*s.highBufferWatchdogPeriod&&(O.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},d._reportStall=function(t){var r=this.hls,s=this.media;!this.stallReported&&s&&(this.stallReported=!0,O.logger.warn("Playback stalling at @"+s.currentTime+" due to low buffer ("+JSON.stringify(t)+")"),r.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t.len}))},d._trySkipBufferHole=function(t){var r=this.config,s=this.hls,o=this.media;if(o===null)return 0;for(var l=o.currentTime,n=0,u=$t.getBuffered(o),c=0;c<u.length;c++){var f=u.start(c);if(l+r.maxBufferHole>=n&&l<f){var v=Math.max(f+.05,o.currentTime+.1);return O.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+v),this.moved=!0,this.stalled=null,o.currentTime=v,t&&s.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+v,frag:t}),v}n=u.end(c)}return 0},d._tryNudgeBuffer=function(){var t=this.config,r=this.hls,s=this.media,o=this.nudgeRetry;if(s!==null){var l=s.currentTime;if(this.nudgeRetry++,o<t.nudgeMaxRetry){var n=l+(o+1)*t.nudgeOffset;O.logger.warn("Nudging 'currentTime' from "+l+" to "+n),s.currentTime=n,r.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else O.logger.error("Playhead still not moving while enough data buffered @"+l+" after "+t.nudgeMaxRetry+" nudges"),r.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},p}();function Ns(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function Nn(p,d){return Nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Nn(p,d)}var Bs=function(p){var d,t;function r(n,u,c){var f;return(f=p.call(this,n,u,c,"[stream-controller]")||this).audioCodecSwap=!1,f.gapController=null,f.level=-1,f._forceStartLoad=!1,f.altAudio=!1,f.audioOnly=!1,f.fragPlaying=null,f.onvplaying=null,f.onvseeked=null,f.fragLastKbps=0,f.couldBacktrack=!1,f.backtrackFragment=null,f.audioCodecSwitch=!1,f.videoBuffer=null,f._registerListeners(),f}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Nn(d,t);var s,o,l=r.prototype;return l._registerListeners=function(){var n=this.hls;n.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(g.Events.LEVEL_LOADING,this.onLevelLoading,this),n.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(g.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),n.on(g.Events.ERROR,this.onError,this),n.on(g.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.on(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.on(g.Events.BUFFER_CREATED,this.onBufferCreated,this),n.on(g.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.on(g.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),n.on(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l._unregisterListeners=function(){var n=this.hls;n.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(g.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),n.off(g.Events.ERROR,this.onError,this),n.off(g.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.off(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.off(g.Events.BUFFER_CREATED,this.onBufferCreated,this),n.off(g.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.off(g.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),n.off(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},l.startLoad=function(n){if(this.levels){var u=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var f=c.startLevel;f===-1&&(c.config.testBandwidth&&this.levels.length>1?(f=0,this.bitrateTest=!0):f=c.nextAutoLevel),this.level=c.nextLoadLevel=f,this.loadedmetadata=!1}u>0&&n===-1&&(this.log("Override startPosition with lastCurrentTime @"+u.toFixed(3)),n=u),this.state=Lt,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()}else this._forceStartLoad=!0,this.state=Fr},l.stopLoad=function(){this._forceStartLoad=!1,p.prototype.stopLoad.call(this)},l.doTick=function(){switch(this.state){case Lt:this.doTickIdle();break;case Ei:var n,u=this.levels,c=this.level,f=u==null||(n=u[c])===null||n===void 0?void 0:n.details;if(f&&(!f.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(f))break;this.state=Lt;break}break;case Li:var v,b=self.performance.now(),D=this.retryDate;(!D||b>=D||(v=this.media)!==null&&v!==void 0&&v.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=Lt)}this.onTickEnd()},l.onTickEnd=function(){p.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},l.doTickIdle=function(){var n=this.hls,u=this.levelLastLoaded,c=this.levels,f=this.media,v=n.config,b=n.nextLoadLevel;if(u!==null&&(f||!this.startFragRequested&&v.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&c&&c[b]){var D=c[b],C=this.getMainFwdBufferInfo();if(C!==null){var F=this.getLevelDetails();if(F&&this._streamEnded(C,F)){var q={};return this.altAudio&&(q.type="video"),this.hls.trigger(g.Events.BUFFER_EOS,q),void(this.state=Xi)}this.level=n.nextLoadLevel=b;var K=D.details;if(!K||this.state===Ei||K.live&&this.levelLastLoaded!==b)return this.level=b,void(this.state=Ei);if(!(C.len>=this.getMaxBufferLength(D.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>C.end&&(this.backtrackFragment=null);var ce=this.backtrackFragment?this.backtrackFragment.start:C.end,Se=this.getNextFragment(ce,K);if(this.couldBacktrack&&!this.fragPrevious&&Se&&Se.sn!=="initSegment"&&this.fragmentTracker.getState(Se)!==Ye.OK){var Ce,Ie=((Ce=this.backtrackFragment)!=null?Ce:Se).sn-K.startSN,Pe=K.fragments[Ie-1];Pe&&Se.cc===Pe.cc&&(Se=Pe,this.fragmentTracker.removeFragment(Pe))}else this.backtrackFragment&&C.len&&(this.backtrackFragment=null);if(Se&&this.fragmentTracker.getState(Se)===Ye.OK&&this.nextLoadPosition>ce){var Qe=this.audioOnly&&!this.altAudio?he.ElementaryStreamTypes.AUDIO:he.ElementaryStreamTypes.VIDEO,st=(Qe===he.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;st&&this.afterBufferFlushed(st,Qe,_e.PlaylistLevelType.MAIN),Se=this.getNextFragment(this.nextLoadPosition,K)}Se&&(!Se.initSegment||Se.initSegment.data||this.bitrateTest||(Se=Se.initSegment),this.loadFragment(Se,K,ce))}}}},l.loadFragment=function(n,u,c){var f,v=this.fragmentTracker.getState(n);this.fragCurrent=n,v===Ye.NOT_LOADED?n.sn==="initSegment"?this._loadInitSegment(n,u):this.bitrateTest?(this.log("Fragment "+n.sn+" of level "+n.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(n,u)):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,n,u,c)):v===Ye.APPENDING?this.reduceMaxBufferLength(n.duration)&&this.fragmentTracker.removeFragment(n):((f=this.media)===null||f===void 0?void 0:f.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},l.getAppendedFrag=function(n){var u=this.fragmentTracker.getAppendedFrag(n,_e.PlaylistLevelType.MAIN);return u&&"fragment"in u?u.fragment:u},l.getBufferedFrag=function(n){return this.fragmentTracker.getBufferedFrag(n,_e.PlaylistLevelType.MAIN)},l.followingBufferedFrag=function(n){return n?this.getBufferedFrag(n.end+.5):null},l.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},l.nextLevelSwitch=function(){var n=this.levels,u=this.media;if(u!=null&&u.readyState){var c,f=this.getAppendedFrag(u.currentTime);if(f&&f.start>1&&this.flushMainBuffer(0,f.start-1),!u.paused&&n){var v=n[this.hls.nextLoadLevel],b=this.fragLastKbps;c=b&&this.fragCurrent?this.fragCurrent.duration*v.maxBitrate/(1e3*b)+1:0}else c=0;var D=this.getBufferedFrag(u.currentTime+c);if(D){var C=this.followingBufferedFrag(D);if(C){this.abortCurrentFrag();var F=C.maxStartPTS?C.maxStartPTS:C.start,q=C.duration,K=Math.max(D.end,F+Math.min(Math.max(q-this.config.maxFragLookUpTolerance,.5*q),.75*q));this.flushMainBuffer(K,Number.POSITIVE_INFINITY)}}}},l.abortCurrentFrag=function(){var n=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,n&&n.abortRequests(),this.state){case Aa:case yi:case Li:case Nr:case zi:this.state=Lt}this.nextLoadPosition=this.getLoadPosition()},l.flushMainBuffer=function(n,u){p.prototype.flushMainBuffer.call(this,n,u,this.altAudio?"video":null)},l.onMediaAttached=function(n,u){p.prototype.onMediaAttached.call(this,n,u);var c=u.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),c.addEventListener("playing",this.onvplaying),c.addEventListener("seeked",this.onvseeked),this.gapController=new Ri(this.config,c,this.fragmentTracker,this.hls)},l.onMediaDetaching=function(){var n=this.media;n&&this.onvplaying&&this.onvseeked&&(n.removeEventListener("playing",this.onvplaying),n.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),p.prototype.onMediaDetaching.call(this)},l.onMediaPlaying=function(){this.tick()},l.onMediaSeeked=function(){var n=this.media,u=n?n.currentTime:null;(0,P.isFiniteNumber)(u)&&this.log("Media seeked to "+u.toFixed(3)),this.tick()},l.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(g.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},l.onManifestParsed=function(n,u){var c,f,v,b=!1,D=!1;u.levels.forEach(function(C){(c=C.audioCodec)&&(c.indexOf("mp4a.40.2")!==-1&&(b=!0),c.indexOf("mp4a.40.5")!==-1&&(D=!0))}),this.audioCodecSwitch=b&&D&&typeof((v=wa())==null||(f=v.prototype)===null||f===void 0?void 0:f.changeType)!="function",this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=u.levels,this.startFragRequested=!1},l.onLevelLoading=function(n,u){var c=this.levels;if(c&&this.state===Lt){var f=c[u.level];(!f.details||f.details.live&&this.levelLastLoaded!==u.level||this.waitForCdnTuneIn(f.details))&&(this.state=Ei)}},l.onLevelLoaded=function(n,u){var c,f=this.levels,v=u.level,b=u.details,D=b.totalduration;if(f){this.log("Level "+v+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+D);var C=this.fragCurrent;!C||this.state!==yi&&this.state!==Li||C.level!==u.level&&C.loader&&(this.state=Lt,this.backtrackFragment=null,C.abortRequests());var F=f[v],q=0;if(b.live||(c=F.details)!==null&&c!==void 0&&c.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;q=this.alignPlaylists(b,F.details)}if(F.details=b,this.levelLastLoaded=v,this.hls.trigger(g.Events.LEVEL_UPDATED,{details:b,level:v}),this.state===Ei){if(this.waitForCdnTuneIn(b))return;this.state=Lt}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,q),this.tick()}else this.warn("Levels were reset while loading level "+v)},l._handleFragmentLoadProgress=function(n){var u,c=n.frag,f=n.part,v=n.payload,b=this.levels;if(b){var D=b[c.level],C=D.details;if(C){var F=D.videoCodec,q=C.PTSKnown||!C.live,K=(u=c.initSegment)===null||u===void 0?void 0:u.data,ce=this._getAudioCodec(D),Se=this.transmuxer=this.transmuxer||new Fn(this.hls,_e.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),Ce=f?f.index:-1,Ie=Ce!==-1,Pe=new Ln(c.level,c.sn,c.stats.chunkCount,v.byteLength,Ce,Ie),Qe=this.initPTS[c.cc];Se.push(v,K,ce,F,c,f,C.totalduration,q,Pe,Qe)}else this.warn("Dropping fragment "+c.sn+" of level "+c.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+c.sn+" of level "+c.level+" will not be buffered")},l.onAudioTrackSwitching=function(n,u){var c=this.altAudio,f=!!u.url,v=u.id;if(!f){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b&&(this.log("Switching to main audio track, cancel main fragment load"),b.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var D=this.hls;c&&D.trigger(g.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),D.trigger(g.Events.AUDIO_TRACK_SWITCHED,{id:v})}},l.onAudioTrackSwitched=function(n,u){var c=u.id,f=!!this.hls.audioTracks[c].url;if(f){var v=this.videoBuffer;v&&this.mediaBuffer!==v&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=v)}this.altAudio=f,this.tick()},l.onBufferCreated=function(n,u){var c,f,v=u.tracks,b=!1;for(var D in v){var C=v[D];if(C.id==="main"){if(f=D,c=C,D==="video"){var F=v[D];F&&(this.videoBuffer=F.buffer)}}else b=!0}b&&c?(this.log("Alternate track found, use "+f+".buffered to schedule main fragment loading"),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media},l.onFragBuffered=function(n,u){var c=u.frag,f=u.part;if(!c||c.type===_e.PlaylistLevelType.MAIN){if(this.fragContextChanged(c))return this.warn("Fragment "+c.sn+(f?" p: "+f.index:"")+" of level "+c.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===zi&&(this.state=Lt));var v=f?f.stats:c.stats;this.fragLastKbps=Math.round(8*v.total/(v.buffering.end-v.loading.first)),c.sn!=="initSegment"&&(this.fragPrevious=c),this.fragBufferedComplete(c,f)}},l.onError=function(n,u){if(u.type!==I.ErrorTypes.KEY_SYSTEM_ERROR)switch(u.details){case I.ErrorDetails.FRAG_LOAD_ERROR:case I.ErrorDetails.FRAG_LOAD_TIMEOUT:case I.ErrorDetails.FRAG_PARSING_ERROR:case I.ErrorDetails.KEY_LOAD_ERROR:case I.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_e.PlaylistLevelType.MAIN,u);break;case I.ErrorDetails.LEVEL_LOAD_ERROR:case I.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Br&&(u.fatal?(this.warn(""+u.details),this.state=Br):u.levelRetry||this.state!==Ei||(this.state=Lt));break;case I.ErrorDetails.BUFFER_FULL_ERROR:if(u.parent==="main"&&(this.state===Nr||this.state===zi)){var c=!0,f=this.getFwdBufferInfo(this.media,_e.PlaylistLevelType.MAIN);f&&f.len>.5&&(c=!this.reduceMaxBufferLength(f.len)),c&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(_e.PlaylistLevelType.MAIN,u)},l.checkBuffer=function(){var n=this.media,u=this.gapController;if(n&&u&&n.readyState){if(this.loadedmetadata||!$t.getBuffered(n).length){var c=this.state!==Lt?this.fragCurrent:null;u.poll(this.lastCurrentTime,c)}this.lastCurrentTime=n.currentTime}},l.onFragLoadEmergencyAborted=function(){this.state=Lt,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},l.onBufferFlushed=function(n,u){var c=u.type;if(c!==he.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var f=(c===he.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(f,c,_e.PlaylistLevelType.MAIN)}},l.onLevelsUpdated=function(n,u){this.levels=u.levels},l.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},l.seekToStartPos=function(){var n=this.media;if(n){var u=n.currentTime,c=this.startPosition;if(c>=0&&u<c){if(n.seeking)return void this.log("could not seek to "+c+", already seeking at "+u);var f=$t.getBuffered(n),v=(f.length?f.start(0):0)-c;v>0&&(v<this.config.maxBufferHole||v<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+v+" to match buffer start"),c+=v,this.startPosition=c),this.log("seek to target start position "+c+" from current time "+u),n.currentTime=c}}},l._getAudioCodec=function(n){var u=this.config.defaultAudioCodec||n.audioCodec;return this.audioCodecSwap&&u&&(this.log("Swapping audio codec"),u=u.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),u},l._loadBitrateTestFrag=function(n,u){var c=this;n.bitrateTest=!0,this._doFragLoad(n,u).then(function(f){var v=c.hls;if(f&&!v.nextLoadLevel&&!c.fragContextChanged(n)){c.fragLoadError=0,c.state=Lt,c.startFragRequested=!1,c.bitrateTest=!1;var b=n.stats;b.parsing.start=b.parsing.end=b.buffering.start=b.buffering.end=self.performance.now(),v.trigger(g.Events.FRAG_LOADED,f),n.bitrateTest=!1}})},l._handleTransmuxComplete=function(n){var u,c="main",f=this.hls,v=n.remuxResult,b=n.chunkMeta,D=this.getCurrentContext(b);if(!D)return this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(b.level);var C=D.frag,F=D.part,q=D.level,K=v.video,ce=v.text,Se=v.id3,Ce=v.initSegment,Ie=q.details,Pe=this.altAudio?void 0:v.audio;if(!this.fragContextChanged(C)){if(this.state=Nr,Ce){Ce.tracks&&(this._bufferInitSegment(q,Ce.tracks,C,b),f.trigger(g.Events.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:c,tracks:Ce.tracks}));var Qe=Ce.initPTS,st=Ce.timescale;(0,P.isFiniteNumber)(Qe)&&(this.initPTS[C.cc]=Qe,f.trigger(g.Events.INIT_PTS_FOUND,{frag:C,id:c,initPTS:Qe,timescale:st}))}if(K&&v.independent!==!1){if(Ie){var xe=K.startPTS,ze=K.endPTS,$e=K.startDTS,St=K.endDTS;if(F)F.elementaryStreams[K.type]={startPTS:xe,endPTS:ze,startDTS:$e,endDTS:St};else if(K.firstKeyFrame&&K.independent&&b.id===1&&(this.couldBacktrack=!0),K.dropped&&K.independent){var Gt=this.getMainFwdBufferInfo();if((Gt?Gt.end:this.getLoadPosition())+this.config.maxBufferHole<(K.firstKeyFramePTS?K.firstKeyFramePTS:xe)-this.config.maxBufferHole)return void this.backtrack(C);C.setElementaryStreamInfo(K.type,C.start,ze,C.start,St,!0)}C.setElementaryStreamInfo(K.type,xe,ze,$e,St),this.backtrackFragment&&(this.backtrackFragment=C),this.bufferFragmentData(K,C,F,b)}}else if(v.independent===!1)return void this.backtrack(C);if(Pe){var wt=Pe.startPTS,Ct=Pe.endPTS,Bt=Pe.startDTS,hr=Pe.endDTS;F&&(F.elementaryStreams[he.ElementaryStreamTypes.AUDIO]={startPTS:wt,endPTS:Ct,startDTS:Bt,endDTS:hr}),C.setElementaryStreamInfo(he.ElementaryStreamTypes.AUDIO,wt,Ct,Bt,hr),this.bufferFragmentData(Pe,C,F,b)}if(Ie&&Se!=null&&(u=Se.samples)!==null&&u!==void 0&&u.length){var or={id:c,frag:C,details:Ie,samples:Se.samples};f.trigger(g.Events.FRAG_PARSING_METADATA,or)}if(Ie&&ce){var er={id:c,frag:C,details:Ie,samples:ce.samples};f.trigger(g.Events.FRAG_PARSING_USERDATA,er)}}},l._bufferInitSegment=function(n,u,c,f){var v=this;if(this.state===Nr){this.audioOnly=!!u.audio&&!u.video,this.altAudio&&!this.audioOnly&&delete u.audio;var b=u.audio,D=u.video,C=u.audiovideo;if(b){var F=n.audioCodec,q=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(F&&(F=F.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),b.metadata.channelCount!==1&&q.indexOf("firefox")===-1&&(F="mp4a.40.5")),q.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(F="mp4a.40.2",this.log("Android: force audio codec to "+F)),n.audioCodec&&n.audioCodec!==F&&this.log('Swapping manifest audio codec "'+n.audioCodec+'" for "'+F+'"'),b.levelCodec=F,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(F||"")+"/"+(n.audioCodec||"")+"/"+b.codec+"]")}D&&(D.levelCodec=n.videoCodec,D.id="main",this.log("Init video buffer, container:"+D.container+", codecs[level/parsed]=["+(n.videoCodec||"")+"/"+D.codec+"]")),C&&this.log("Init audiovideo buffer, container:"+C.container+", codecs[level/parsed]=["+(n.attrs.CODECS||"")+"/"+C.codec+"]"),this.hls.trigger(g.Events.BUFFER_CODECS,u),Object.keys(u).forEach(function(K){var ce=u[K].initSegment;ce!=null&&ce.byteLength&&v.hls.trigger(g.Events.BUFFER_APPENDING,{type:K,data:ce,frag:c,part:null,chunkMeta:f,parent:c.type})}),this.tick()}},l.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,_e.PlaylistLevelType.MAIN)},l.backtrack=function(n){this.couldBacktrack=!0,this.backtrackFragment=n,this.resetTransmuxer(),this.flushBufferGap(n),this.fragmentTracker.removeFragment(n),this.fragPrevious=null,this.nextLoadPosition=n.start,this.state=Lt},l.checkFragmentChanged=function(){var n=this.media,u=null;if(n&&n.readyState>1&&n.seeking===!1){var c=n.currentTime;if($t.isBuffered(n,c)?u=this.getAppendedFrag(c):$t.isBuffered(n,c+.1)&&(u=this.getAppendedFrag(c+.1)),u){this.backtrackFragment=null;var f=this.fragPlaying,v=u.level;f&&u.sn===f.sn&&f.level===v&&u.urlId===f.urlId||(this.fragPlaying=u,this.hls.trigger(g.Events.FRAG_CHANGED,{frag:u}),f&&f.level===v||this.hls.trigger(g.Events.LEVEL_SWITCHED,{level:v}))}}},s=r,(o=[{key:"nextLevel",get:function(){var n=this.nextBufferedFrag;return n?n.level:-1}},{key:"currentFrag",get:function(){var n=this.media;return n?this.fragPlaying||this.getAppendedFrag(n.currentTime):null}},{key:"currentProgramDateTime",get:function(){var n=this.media;if(n){var u=n.currentTime,c=this.currentFrag;if(c&&(0,P.isFiniteNumber)(u)&&(0,P.isFiniteNumber)(c.programDateTime)){var f=c.programDateTime+1e3*(u-c.start);return new Date(f)}}return null}},{key:"currentLevel",get:function(){var n=this.currentFrag;return n?n.level:-1}},{key:"nextBufferedFrag",get:function(){var n=this.currentFrag;return n?this.followingBufferedFrag(n):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&Ns(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Mn);const cn=function(){function p(t,r,s){r===void 0&&(r=0),s===void 0&&(s=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=r,this.totalWeight_=s}var d=p.prototype;return d.sample=function(t,r){var s=Math.pow(this.alpha_,t);this.estimate_=r*(1-s)+s*this.estimate_,this.totalWeight_+=t},d.getTotalWeight=function(){return this.totalWeight_},d.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_},p}(),Hs=function(){function p(t,r,s){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new cn(t),this.fast_=new cn(r)}var d=p.prototype;return d.update=function(t,r){var s=this.slow_,o=this.fast_;this.slow_.halfLife!==t&&(this.slow_=new cn(t,s.getEstimate(),s.getTotalWeight())),this.fast_.halfLife!==r&&(this.fast_=new cn(r,o.getEstimate(),o.getTotalWeight()))},d.sample=function(t,r){var s=(t=Math.max(t,this.minDelayMs_))/1e3,o=8*r/s;this.fast_.sample(s,o),this.slow_.sample(s,o)},d.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},d.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},d.destroy=function(){},p}();function js(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}const Gs=function(){function p(s){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=s;var o=s.config;this.bwEstimator=new Hs(o.abrEwmaSlowVoD,o.abrEwmaFastVoD,o.abrEwmaDefaultEstimate),this.registerListeners()}var d,t,r=p.prototype;return r.registerListeners=function(){var s=this.hls;s.on(g.Events.FRAG_LOADING,this.onFragLoading,this),s.on(g.Events.FRAG_LOADED,this.onFragLoaded,this),s.on(g.Events.FRAG_BUFFERED,this.onFragBuffered,this),s.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(g.Events.ERROR,this.onError,this)},r.unregisterListeners=function(){var s=this.hls;s.off(g.Events.FRAG_LOADING,this.onFragLoading,this),s.off(g.Events.FRAG_LOADED,this.onFragLoaded,this),s.off(g.Events.FRAG_BUFFERED,this.onFragBuffered,this),s.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(g.Events.ERROR,this.onError,this)},r.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},r.onFragLoading=function(s,o){var l,n=o.frag;n.type===_e.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=n,this.partCurrent=(l=o.part)!=null?l:null,this.timer=self.setInterval(this.onCheck,100)))},r.onLevelLoaded=function(s,o){var l=this.hls.config;o.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},r._abandonRulesCheck=function(){var s=this.fragCurrent,o=this.partCurrent,l=this.hls,n=l.autoLevelEnabled,u=l.media;if(s&&u){var c=o?o.stats:s.stats,f=o?o.duration:s.duration;if(c.aborted||c.loaded&&c.loaded===c.total||s.level===0)return this.clearTimer(),void(this._nextAutoLevel=-1);if(n&&!u.paused&&u.playbackRate&&u.readyState){var v=l.mainForwardBufferInfo;if(v!==null){var b=performance.now()-c.loading.start,D=Math.abs(u.playbackRate);if(!(b<=500*f/D)){var C=c.loaded&&c.loading.first,F=this.bwEstimator.getEstimate(),q=l.levels,K=l.minAutoLevel,ce=q[s.level],Se=c.total||Math.max(c.loaded,Math.round(f*ce.maxBitrate/8)),Ce=C?1e3*c.loaded/b:0,Ie=Ce?(Se-c.loaded)/Ce:8*Se/F,Pe=v.len/D;if(!(Ie<=Pe)){var Qe,st=Number.POSITIVE_INFINITY;for(Qe=s.level-1;Qe>K;Qe--){var xe=q[Qe].maxBitrate;if((st=Ce?f*xe/(6.4*Ce):f*xe/F)<Pe)break}st>=Ie||(O.logger.warn("Fragment "+s.sn+(o?" part "+o.index:"")+" of level "+s.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+Qe+`
      Current BW estimate: `+((0,P.isFiniteNumber)(F)?(F/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+Ie.toFixed(3)+` s
      Estimated load time for the next fragment: `+st.toFixed(3)+` s
      Time to underbuffer: `+Pe.toFixed(3)+" s"),l.nextLoadLevel=Qe,C&&this.bwEstimator.sample(b,c.loaded),this.clearTimer(),(s.loader||s.keyLoader)&&(this.fragCurrent=this.partCurrent=null,s.abortRequests()),l.trigger(g.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:o,stats:c}))}}}}}},r.onFragLoaded=function(s,o){var l=o.frag,n=o.part;if(l.type===_e.PlaylistLevelType.MAIN&&(0,P.isFiniteNumber)(l.sn)){var u=n?n.stats:l.stats,c=n?n.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var f=this.hls.levels[l.level],v=(f.loaded?f.loaded.bytes:0)+u.loaded,b=(f.loaded?f.loaded.duration:0)+c;f.loaded={bytes:v,duration:b},f.realBitrate=Math.round(8*v/b)}if(l.bitrateTest){var D={stats:u,frag:l,part:n,id:l.type};this.onFragBuffered(g.Events.FRAG_BUFFERED,D)}}},r.onFragBuffered=function(s,o){var l=o.frag,n=o.part,u=n?n.stats:l.stats;if(!u.aborted&&l.type===_e.PlaylistLevelType.MAIN&&l.sn!=="initSegment"){var c=u.parsing.end-u.loading.start;this.bwEstimator.sample(c,u.loaded),u.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}},r.onError=function(s,o){var l;if(((l=o.frag)===null||l===void 0?void 0:l.type)===_e.PlaylistLevelType.MAIN){if(o.type===I.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(o.details){case I.ErrorDetails.FRAG_LOAD_ERROR:case I.ErrorDetails.FRAG_LOAD_TIMEOUT:case I.ErrorDetails.KEY_LOAD_ERROR:case I.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},r.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},r.getNextABRAutoLevel=function(){var s=this.fragCurrent,o=this.partCurrent,l=this.hls,n=l.maxAutoLevel,u=l.config,c=l.minAutoLevel,f=l.media,v=o?o.duration:s?s.duration:0,b=f&&f.playbackRate!==0?Math.abs(f.playbackRate):1,D=this.bwEstimator?this.bwEstimator.getEstimate():u.abrEwmaDefaultEstimate,C=l.mainForwardBufferInfo,F=(C?C.len:0)/b,q=this.findBestLevel(D,c,n,F,u.abrBandWidthFactor,u.abrBandWidthUpFactor);if(q>=0)return q;O.logger.trace((F?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var K=v?Math.min(v,u.maxStarvationDelay):u.maxStarvationDelay,ce=u.abrBandWidthFactor,Se=u.abrBandWidthUpFactor;if(!F){var Ce=this.bitrateTestDelay;Ce&&(K=(v?Math.min(v,u.maxLoadingDelay):u.maxLoadingDelay)-Ce,O.logger.trace("bitrate test took "+Math.round(1e3*Ce)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*K)+" ms"),ce=Se=1)}return q=this.findBestLevel(D,c,n,F+K,ce,Se),Math.max(q,0)},r.findBestLevel=function(s,o,l,n,u,c){for(var f,v=this.fragCurrent,b=this.partCurrent,D=this.lastLoadedFragLevel,C=this.hls.levels,F=C[D],q=!(F==null||(f=F.details)===null||f===void 0||!f.live),K=F==null?void 0:F.codecSet,ce=b?b.duration:v?v.duration:0,Se=l;Se>=o;Se--){var Ce=C[Se];if(Ce&&(!K||Ce.codecSet===K)){var Ie,Pe=Ce.details,Qe=(b?Pe==null?void 0:Pe.partTarget:Pe==null?void 0:Pe.averagetargetduration)||ce;Ie=Se<=D?u*s:c*s;var st=C[Se].maxBitrate,xe=st*Qe/Ie;if(O.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+Se+"/"+Math.round(Ie)+"/"+st+"/"+Qe+"/"+n+"/"+xe),Ie>st&&(xe===0||!(0,P.isFiniteNumber)(xe)||q&&!this.bitrateTestDelay||xe<n))return Se}}return-1},d=p,(t=[{key:"nextAutoLevel",get:function(){var s=this._nextAutoLevel,o=this.bwEstimator;if(s!==-1&&!o.canEstimate())return s;var l=this.getNextABRAutoLevel();return s!==-1&&this.hls.levels[l].loadError?s:(s!==-1&&(l=Math.min(s,l)),l)},set:function(s){this._nextAutoLevel=s}}])&&js(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}();var Ia=function(){function p(){this.chunks=[],this.dataLength=0}var d=p.prototype;return d.push=function(t){this.chunks.push(t),this.dataLength+=t.length},d.flush=function(){var t,r=this.chunks,s=this.dataLength;return r.length?(t=r.length===1?r[0]:function(o,l){for(var n=new Uint8Array(l),u=0,c=0;c<o.length;c++){var f=o[c];n.set(f,u),u+=f.length}return n}(r,s),this.reset(),t):new Uint8Array(0)},d.reset=function(){this.chunks.length=0,this.dataLength=0},p}();function hn(){return hn=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},hn.apply(this,arguments)}function Ci(p,d){return Ci=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ci(p,d)}var Bn=function(p){var d,t;function r(o,l,n){var u;return(u=p.call(this,o,l,n,"[audio-stream-controller]")||this).videoBuffer=null,u.videoTrackCC=-1,u.waitingVideoCC=-1,u.audioSwitch=!1,u.trackId=-1,u.waitingData=null,u.mainDetails=null,u.bufferFlushed=!1,u.cachedTrackLoadedData=null,u._registerListeners(),u}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Ci(d,t);var s=r.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var o=this.hls;o.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(g.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.on(g.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.on(g.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(g.Events.ERROR,this.onError,this),o.on(g.Events.BUFFER_RESET,this.onBufferReset,this),o.on(g.Events.BUFFER_CREATED,this.onBufferCreated,this),o.on(g.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.on(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var o=this.hls;o.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(g.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.off(g.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.off(g.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(g.Events.ERROR,this.onError,this),o.off(g.Events.BUFFER_RESET,this.onBufferReset,this),o.off(g.Events.BUFFER_CREATED,this.onBufferCreated,this),o.off(g.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.off(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onInitPtsFound=function(o,l){var n=l.frag,u=l.id,c=l.initPTS;if(u==="main"){var f=n.cc;this.initPTS[n.cc]=c,this.log("InitPTS for cc: "+f+" found from main: "+c),this.videoTrackCC=f,this.state===Qi&&this.tick()}},s.startLoad=function(o){if(!this.levels)return this.startPosition=o,void(this.state=Fr);var l=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,l>0&&o===-1?(this.log("Override startPosition with lastCurrentTime @"+l.toFixed(3)),o=l,this.state=Lt):(this.loadedmetadata=!1,this.state=un),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()},s.doTick=function(){switch(this.state){case Lt:this.doTickIdle();break;case un:var o,l=this.levels,n=this.trackId,u=l==null||(o=l[n])===null||o===void 0?void 0:o.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=Qi}break;case Li:var c,f=performance.now(),v=this.retryDate;(!v||f>=v||(c=this.media)!==null&&c!==void 0&&c.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=Lt);break;case Qi:var b=this.waitingData;if(b){var D=b.frag,C=b.part,F=b.cache,q=b.complete;if(this.initPTS[D.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=yi;var K={frag:D,part:C,payload:F.flush(),networkDetails:null};this._handleFragmentLoadProgress(K),q&&p.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+D.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var ce=this.getLoadPosition(),Se=$t.bufferInfo(this.mediaBuffer,ce,this.config.maxBufferHole);si(Se.end,this.config.maxFragLookUpTolerance,D)<0&&(this.log("Waiting fragment cc ("+D.cc+") @ "+D.start+" cancelled because another fragment at "+Se.end+" is needed"),this.clearWaitingFragment())}}else this.state=Lt}this.onTickEnd()},s.clearWaitingFragment=function(){var o=this.waitingData;o&&(this.fragmentTracker.removeFragment(o.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Lt)},s.resetLoadingState=function(){this.clearWaitingFragment(),p.prototype.resetLoadingState.call(this)},s.onTickEnd=function(){var o=this.media;o&&o.readyState&&(this.lastCurrentTime=o.currentTime)},s.doTickIdle=function(){var o=this.hls,l=this.levels,n=this.media,u=this.trackId,c=o.config;if(l&&l[u]&&(n||!this.startFragRequested&&c.startFragPrefetch)){var f=l[u].details;if(!f||f.live&&this.levelLastLoaded!==u||this.waitForCdnTuneIn(f))this.state=un;else{var v=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&v&&(this.bufferFlushed=!1,this.afterBufferFlushed(v,he.ElementaryStreamTypes.AUDIO,_e.PlaylistLevelType.AUDIO));var b=this.getFwdBufferInfo(v,_e.PlaylistLevelType.AUDIO);if(b!==null){var D=this.audioSwitch;if(!D&&this._streamEnded(b,f))return o.trigger(g.Events.BUFFER_EOS,{type:"audio"}),void(this.state=Xi);var C=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,_e.PlaylistLevelType.MAIN);if(!(b.len>=this.getMaxBufferLength(C==null?void 0:C.len))||D){var F=f.fragments[0].start,q=b.end;if(D&&n){var K=this.getLoadPosition();q=K,f.PTSKnown&&K<F&&(b.end>F||b.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=F+.05)}if(!(C&&q>C.end+f.targetduration)&&(C&&C.len||!b.len)){var ce=this.getNextFragment(q,f);ce?this.loadFragment(ce,f,q):this.bufferFlushed=!0}}}}}},s.getMaxBufferLength=function(o){var l=p.prototype.getMaxBufferLength.call(this);return o?Math.max(l,o):l},s.onMediaDetaching=function(){this.videoBuffer=null,p.prototype.onMediaDetaching.call(this)},s.onAudioTracksUpdated=function(o,l){var n=l.audioTracks;this.resetTransmuxer(),this.levels=n.map(function(u){return new $(u)})},s.onAudioTrackSwitching=function(o,l){var n=!!l.url;this.trackId=l.id;var u=this.fragCurrent;u&&u.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.audioSwitch=!0,this.state=Lt):this.state=Fr,this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},s.onLevelLoaded=function(o,l){this.mainDetails=l.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(g.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},s.onAudioTrackLoaded=function(o,l){var n;if(this.mainDetails!=null){var u=this.levels,c=l.details,f=l.id;if(u){this.log("Track "+f+" loaded ["+c.startSN+","+c.endSN+"],duration:"+c.totalduration);var v=u[f],b=0;if(c.live||(n=v.details)!==null&&n!==void 0&&n.live){var D=this.mainDetails;if(c.fragments[0]||(c.deltaUpdateFailed=!0),c.deltaUpdateFailed||!D)return;!v.details&&c.hasProgramDateTime&&D.hasProgramDateTime?(Sa(c,D),b=c.fragments[0].start):b=this.alignPlaylists(c,v.details)}v.details=c,this.levelLastLoaded=f,this.startFragRequested||!this.mainDetails&&c.live||this.setStartPosition(v.details,b),this.state!==un||this.waitForCdnTuneIn(c)||(this.state=Lt),this.tick()}else this.warn("Audio tracks were reset while loading level "+f)}else this.cachedTrackLoadedData=l},s._handleFragmentLoadProgress=function(o){var l,n=o.frag,u=o.part,c=o.payload,f=this.config,v=this.trackId,b=this.levels;if(b){var D=b[v],C=D.details,F=f.defaultAudioCodec||D.audioCodec||"mp4a.40.2",q=this.transmuxer;q||(q=this.transmuxer=new Fn(this.hls,_e.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var K=this.initPTS[n.cc],ce=(l=n.initSegment)===null||l===void 0?void 0:l.data;if(K!==void 0){var Se=u?u.index:-1,Ce=Se!==-1,Ie=new Ln(n.level,n.sn,n.stats.chunkCount,c.byteLength,Se,Ce);q.push(c,ce,F,"",n,u,C.totalduration,!1,Ie,K)}else this.log("Unknown video PTS for cc "+n.cc+", waiting for video PTS before demuxing audio frag "+n.sn+" of ["+C.startSN+" ,"+C.endSN+"],track "+v),(this.waitingData=this.waitingData||{frag:n,part:u,cache:new Ia,complete:!1}).cache.push(new Uint8Array(c)),this.waitingVideoCC=this.videoTrackCC,this.state=Qi}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+n.sn+" of level "+n.level+" will not be buffered")},s._handleFragmentLoadComplete=function(o){this.waitingData?this.waitingData.complete=!0:p.prototype._handleFragmentLoadComplete.call(this,o)},s.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function(o,l){var n=l.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),l.tracks.video&&(this.videoBuffer=l.tracks.video.buffer||null)},s.onFragBuffered=function(o,l){var n,u=l.frag,c=l.part;u.type===_e.PlaylistLevelType.AUDIO?this.fragContextChanged(u)?this.warn("Fragment "+u.sn+(c?" p: "+c.index:"")+" of level "+u.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(u.sn!=="initSegment"&&(this.fragPrevious=u,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(g.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(u,c)):this.loadedmetadata||u.type!==_e.PlaylistLevelType.MAIN||(n=this.videoBuffer||this.media)!==null&&n!==void 0&&n.buffered.length&&(this.loadedmetadata=!0)},s.onError=function(o,l){if(l.type!==I.ErrorTypes.KEY_SYSTEM_ERROR)switch(l.details){case I.ErrorDetails.FRAG_LOAD_ERROR:case I.ErrorDetails.FRAG_LOAD_TIMEOUT:case I.ErrorDetails.FRAG_PARSING_ERROR:case I.ErrorDetails.KEY_LOAD_ERROR:case I.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_e.PlaylistLevelType.AUDIO,l);break;case I.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case I.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==Br&&this.state!==Fr&&(this.state=l.fatal?Br:Lt,this.warn(l.details+" while loading frag, switching to "+this.state+" state"));break;case I.ErrorDetails.BUFFER_FULL_ERROR:if(l.parent==="audio"&&(this.state===Nr||this.state===zi)){var n=!0,u=this.getFwdBufferInfo(this.mediaBuffer,_e.PlaylistLevelType.AUDIO);u&&u.len>.5&&(n=!this.reduceMaxBufferLength(u.len)),n&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(_e.PlaylistLevelType.AUDIO,l)},s.onBufferFlushed=function(o,l){l.type===he.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===Xi&&(this.state=Lt))},s._handleTransmuxComplete=function(o){var l,n="audio",u=this.hls,c=o.remuxResult,f=o.chunkMeta,v=this.getCurrentContext(f);if(!v)return this.warn("The loading context changed while buffering fragment "+f.sn+" of level "+f.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(f.level);var b=v.frag,D=v.part,C=v.level.details,F=c.audio,q=c.text,K=c.id3,ce=c.initSegment;if(!this.fragContextChanged(b)&&C){if(this.state=Nr,this.audioSwitch&&F&&this.completeAudioSwitch(),ce!=null&&ce.tracks&&(this._bufferInitSegment(ce.tracks,b,f),u.trigger(g.Events.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:ce.tracks})),F){var Se=F.startPTS,Ce=F.endPTS,Ie=F.startDTS,Pe=F.endDTS;D&&(D.elementaryStreams[he.ElementaryStreamTypes.AUDIO]={startPTS:Se,endPTS:Ce,startDTS:Ie,endDTS:Pe}),b.setElementaryStreamInfo(he.ElementaryStreamTypes.AUDIO,Se,Ce,Ie,Pe),this.bufferFragmentData(F,b,D,f)}if(K!=null&&(l=K.samples)!==null&&l!==void 0&&l.length){var Qe=hn({id:n,frag:b,details:C},K);u.trigger(g.Events.FRAG_PARSING_METADATA,Qe)}if(q){var st=hn({id:n,frag:b,details:C},q);u.trigger(g.Events.FRAG_PARSING_USERDATA,st)}}},s._bufferInitSegment=function(o,l,n){if(this.state===Nr){o.video&&delete o.video;var u=o.audio;if(u){u.levelCodec=u.codec,u.id="audio",this.log("Init audio buffer, container:"+u.container+", codecs[parsed]=["+u.codec+"]"),this.hls.trigger(g.Events.BUFFER_CODECS,o);var c=u.initSegment;if(c!=null&&c.byteLength){var f={type:"audio",frag:l,part:null,chunkMeta:n,parent:l.type,data:c};this.hls.trigger(g.Events.BUFFER_APPENDING,f)}this.tick()}}},s.loadFragment=function(o,l,n){var u=this.fragmentTracker.getState(o);this.fragCurrent=o,(this.audioSwitch||u===Ye.NOT_LOADED||u===Ye.PARTIAL)&&(o.sn==="initSegment"?this._loadInitSegment(o,l):l.live&&!(0,P.isFiniteNumber)(this.initPTS[o.cc])?(this.log("Waiting for video PTS in continuity counter "+o.cc+" of live stream before loading audio fragment "+o.sn+" of level "+this.trackId),this.state=Qi):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,o,l,n)))},s.completeAudioSwitch=function(){var o=this.hls,l=this.media,n=this.trackId;l&&(this.log("Switching audio track : flushing all audio"),p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,o.trigger(g.Events.AUDIO_TRACK_SWITCHED,{id:n})},r}(Mn);const Da=Bn;function Hn(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function jn(p,d){return jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},jn(p,d)}const Vs=function(p){var d,t;function r(n){var u;return(u=p.call(this,n,"[audio-track-controller]")||this).tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.trackName="",u.selectDefaultTrack=!0,u.registerListeners(),u}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,jn(d,t);var s,o,l=r.prototype;return l.registerListeners=function(){var n=this.hls;n.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(g.Events.LEVEL_LOADING,this.onLevelLoading,this),n.on(g.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),n.on(g.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.on(g.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var n=this.hls;n.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(g.Events.LEVEL_LOADING,this.onLevelLoading,this),n.off(g.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),n.off(g.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.off(g.Events.ERROR,this.onError,this)},l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,p.prototype.destroy.call(this)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},l.onManifestParsed=function(n,u){this.tracks=u.audioTracks||[]},l.onAudioTrackLoaded=function(n,u){var c=u.id,f=u.details,v=this.tracksInGroup[c];if(v){var b=v.details;v.details=u.details,this.log("audioTrack "+c+" loaded ["+f.startSN+"-"+f.endSN+"]"),c===this.trackId&&(this.retryCount=0,this.playlistLoaded(c,u,b))}else this.warn("Invalid audio track id "+c)},l.onLevelLoading=function(n,u){this.switchLevel(u.level)},l.onLevelSwitching=function(n,u){this.switchLevel(u.level)},l.switchLevel=function(n){var u=this.hls.levels[n];if(u!=null&&u.audioGroupIds){var c=u.audioGroupIds[u.urlId];if(this.groupId!==c){this.groupId=c;var f=this.tracks.filter(function(b){return!c||b.groupId===c});this.selectDefaultTrack&&!f.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=f;var v={audioTracks:f};this.log("Updating audio tracks, "+f.length+' track(s) found in "'+c+'" group-id'),this.hls.trigger(g.Events.AUDIO_TRACKS_UPDATED,v),this.selectInitialTrack()}}},l.onError=function(n,u){p.prototype.onError.call(this,n,u),!u.fatal&&u.context&&u.context.type===_e.PlaylistContextType.AUDIO_TRACK&&u.context.id===this.trackId&&u.context.groupId===this.groupId&&this.retryLoadingOrFail(u)},l.setAudioTrack=function(n){var u=this.tracksInGroup;if(n<0||n>=u.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var c=u[this.trackId];this.log("Now switching to audio-track index "+n);var f=u[n],v=f.id,b=f.groupId,D=b===void 0?"":b,C=f.name,F=f.type,q=f.url;if(this.trackId=n,this.trackName=C,this.selectDefaultTrack=!1,this.hls.trigger(g.Events.AUDIO_TRACK_SWITCHING,{id:v,groupId:D,name:C,type:F,url:q}),!f.details||f.details.live){var K=this.switchParams(f.url,c==null?void 0:c.details);this.loadPlaylist(K)}}},l.selectInitialTrack=function(){var n=this.trackName,u=this.findTrackId(n)||this.findTrackId();u!==-1?this.setAudioTrack(u):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},l.findTrackId=function(n){for(var u=this.tracksInGroup,c=0;c<u.length;c++){var f=u[c];if((!this.selectDefaultTrack||f.default)&&(!n||n===f.name))return f.id}return-1},l.loadPlaylist=function(n){p.prototype.loadPlaylist.call(this);var u=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(u)){var c=u.id,f=u.groupId,v=u.url;if(n)try{v=n.addDirectives(v)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+c),this.clearTimer(),this.hls.trigger(g.Events.AUDIO_TRACK_LOADING,{url:v,id:c,groupId:f,deliveryDirectives:n||null})}},s=r,(o=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(n){this.selectDefaultTrack=!1,this.setAudioTrack(n)}}])&&Hn(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Fe);function Ks(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function Gn(p,d){return Gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Gn(p,d)}var qs=function(p){var d,t;function r(n,u,c){var f;return(f=p.call(this,n,u,c,"[subtitle-stream-controller]")||this).levels=[],f.currentTrackId=-1,f.tracksBuffered=[],f.mainDetails=null,f._registerListeners(),f}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Gn(d,t);var s,o,l=r.prototype;return l.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},l._registerListeners=function(){var n=this.hls;n.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(g.Events.ERROR,this.onError,this),n.on(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),n.on(g.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),n.on(g.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),n.on(g.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),n.on(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.on(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l._unregisterListeners=function(){var n=this.hls;n.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(g.Events.ERROR,this.onError,this),n.off(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),n.off(g.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),n.off(g.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),n.off(g.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),n.off(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.off(g.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l.startLoad=function(n){this.stopLoad(),this.state=Lt,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()},l.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},l.onLevelLoaded=function(n,u){this.mainDetails=u.details},l.onSubtitleFragProcessed=function(n,u){var c=u.frag,f=u.success;if(this.fragPrevious=c,this.state=Lt,f){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var b,D=c.start,C=0;C<v.length;C++)if(D>=v[C].start&&D<=v[C].end){b=v[C];break}var F=c.start+c.duration;b?b.end=F:(b={start:D,end:F},v.push(b)),this.fragmentTracker.fragBuffered(c)}}},l.onBufferFlushing=function(n,u){var c=u.startOffset,f=u.endOffset;if(c===0&&f!==Number.POSITIVE_INFINITY){var v=this.currentTrackId,b=this.levels;if(!b.length||!b[v]||!b[v].details)return;var D=f-b[v].details.targetduration;if(D<=0)return;u.endOffsetSubtitles=Math.max(0,D),this.tracksBuffered.forEach(function(C){for(var F=0;F<C.length;)if(C[F].end<=D)C.shift();else{if(!(C[F].start<D))break;C[F].start=D,F++}}),this.fragmentTracker.removeFragmentsInRange(c,D,_e.PlaylistLevelType.SUBTITLE)}},l.onFragBuffered=function(n,u){var c;this.loadedmetadata||u.frag.type!==_e.PlaylistLevelType.MAIN||(c=this.media)!==null&&c!==void 0&&c.buffered.length&&(this.loadedmetadata=!0)},l.onError=function(n,u){var c=u.frag;c&&c.type===_e.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=Lt)},l.onSubtitleTracksUpdated=function(n,u){var c=this,f=u.subtitleTracks;this.tracksBuffered=[],this.levels=f.map(function(v){return new $(v)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(v){c.tracksBuffered[v.id]=[]}),this.mediaBuffer=null},l.onSubtitleTrackSwitch=function(n,u){if(this.currentTrackId=u.id,this.levels.length&&this.currentTrackId!==-1){var c=this.levels[this.currentTrackId];c!=null&&c.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,c&&this.setInterval(500)}else this.clearInterval()},l.onSubtitleTrackLoaded=function(n,u){var c,f=u.details,v=u.id,b=this.currentTrackId,D=this.levels;if(D.length){var C=D[b];if(!(v>=D.length||v!==b)&&C){this.mediaBuffer=this.mediaBufferTimeRanges;var F=0;if(f.live||(c=C.details)!==null&&c!==void 0&&c.live){var q=this.mainDetails;if(f.deltaUpdateFailed||!q)return;var K=q.fragments[0];C.details?(F=this.alignPlaylists(f,C.details))===0&&K&&De(f,F=K.start):f.hasProgramDateTime&&q.hasProgramDateTime?(Sa(f,q),F=f.fragments[0].start):K&&De(f,F=K.start)}C.details=f,this.levelLastLoaded=v,this.startFragRequested||!this.mainDetails&&f.live||this.setStartPosition(C.details,F),this.tick(),f.live&&!this.fragCurrent&&this.media&&this.state===Lt&&(on(null,f.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),C.details=void 0))}}},l._handleFragmentLoadComplete=function(n){var u=this,c=n.frag,f=n.payload,v=c.decryptdata,b=this.hls;if(!this.fragContextChanged(c)&&f&&f.byteLength>0&&v&&v.key&&v.iv&&v.method==="AES-128"){var D=performance.now();this.decrypter.decrypt(new Uint8Array(f),v.key.buffer,v.iv.buffer).then(function(C){var F=performance.now();b.trigger(g.Events.FRAG_DECRYPTED,{frag:c,payload:C,stats:{tstart:D,tdecrypt:F}})}).catch(function(C){u.warn(C.name+": "+C.message),u.state=Lt})}},l.doTick=function(){if(this.media){if(this.state===Lt){var n=this.currentTrackId,u=this.levels;if(!u.length||!u[n]||!u[n].details)return;var c=u[n].details,f=c.targetduration,v=this.config,b=this.getLoadPosition(),D=$t.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],b-f,v.maxBufferHole),C=D.end,F=D.len,q=this.getFwdBufferInfo(this.media,_e.PlaylistLevelType.MAIN);if(F>this.getMaxBufferLength(q==null?void 0:q.len)+f)return;var K=c.fragments,ce=K.length,Se=c.edge,Ce=null,Ie=this.fragPrevious;if(C<Se){var Pe=v.maxFragLookUpTolerance;!(Ce=on(Ie,K,Math.max(K[0].start,C),Pe))&&Ie&&Ie.start<K[0].start&&(Ce=K[0])}else Ce=K[ce-1];if(!Ce)return;Ce=this.mapToInitFragWhenRequired(Ce),this.fragmentTracker.getState(Ce)===Ye.NOT_LOADED&&this.loadFragment(Ce,c,C)}}else this.state=Lt},l.getMaxBufferLength=function(n){var u=p.prototype.getMaxBufferLength.call(this);return n?Math.max(u,n):u},l.loadFragment=function(n,u,c){this.fragCurrent=n,n.sn==="initSegment"?this._loadInitSegment(n,u):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,n,u,c))},s=r,(o=[{key:"mediaBufferTimeRanges",get:function(){return new Ws(this.tracksBuffered[this.currentTrackId]||[])}}])&&Ks(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Mn),Ws=function(p){this.buffered=void 0;var d=function(t,r,s){if((r>>>=0)>s-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+s+")");return p[r][t]};this.buffered={get length(){return p.length},end:function(t){return d("end",t,p.length)},start:function(t){return d("start",t,p.length)}}};function $s(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function Vn(p,d){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Vn(p,d)}function Kn(p){for(var d=[],t=0;t<p.length;t++){var r=p[t];r.kind==="subtitles"&&r.label&&d.push(p[t])}return d}const La=function(p){var d,t;function r(n){var u;return(u=p.call(this,n,"[subtitle-track-controller]")||this).media=null,u.tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.selectDefaultTrack=!0,u.queuedDefaultTrack=-1,u.trackChangeListener=function(){return u.onTextTracksChanged()},u.asyncPollTrackChange=function(){return u.pollTrackChange(0)},u.useTextTrackPolling=!1,u.subtitlePollingInterval=-1,u._subtitleDisplay=!0,u.registerListeners(),u}t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Vn(d,t);var s,o,l=r.prototype;return l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,p.prototype.destroy.call(this)},l.registerListeners=function(){var n=this.hls;n.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(g.Events.LEVEL_LOADING,this.onLevelLoading,this),n.on(g.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),n.on(g.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),n.on(g.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var n=this.hls;n.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(g.Events.LEVEL_LOADING,this.onLevelLoading,this),n.off(g.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),n.off(g.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),n.off(g.Events.ERROR,this.onError,this)},l.onMediaAttached=function(n,u){this.media=u.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},l.pollTrackChange=function(n){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,n)},l.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Kn(this.media.textTracks).forEach(function(n){gt(n)}),this.subtitleTrack=-1,this.media=null)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},l.onManifestParsed=function(n,u){this.tracks=u.subtitleTracks},l.onSubtitleTrackLoaded=function(n,u){var c=u.id,f=u.details,v=this.trackId,b=this.tracksInGroup[v];if(b){var D=b.details;b.details=u.details,this.log("subtitle track "+c+" loaded ["+f.startSN+"-"+f.endSN+"]"),c===this.trackId&&(this.retryCount=0,this.playlistLoaded(c,u,D))}else this.warn("Invalid subtitle track id "+c)},l.onLevelLoading=function(n,u){this.switchLevel(u.level)},l.onLevelSwitching=function(n,u){this.switchLevel(u.level)},l.switchLevel=function(n){var u=this.hls.levels[n];if(u!=null&&u.textGroupIds){var c=u.textGroupIds[u.urlId];if(this.groupId!==c){var f=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,v=this.tracks.filter(function(C){return!c||C.groupId===c});this.tracksInGroup=v;var b=this.findTrackId(f==null?void 0:f.name)||this.findTrackId();this.groupId=c;var D={subtitleTracks:v};this.log("Updating subtitle tracks, "+v.length+' track(s) found in "'+c+'" group-id'),this.hls.trigger(g.Events.SUBTITLE_TRACKS_UPDATED,D),b!==-1&&this.setSubtitleTrack(b,f)}}},l.findTrackId=function(n){for(var u=this.tracksInGroup,c=0;c<u.length;c++){var f=u[c];if((!this.selectDefaultTrack||f.default)&&(!n||n===f.name))return f.id}return-1},l.onError=function(n,u){p.prototype.onError.call(this,n,u),!u.fatal&&u.context&&u.context.type===_e.PlaylistContextType.SUBTITLE_TRACK&&u.context.id===this.trackId&&u.context.groupId===this.groupId&&this.retryLoadingOrFail(u)},l.loadPlaylist=function(n){p.prototype.loadPlaylist.call(this);var u=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(u)){var c=u.id,f=u.groupId,v=u.url;if(n)try{v=n.addDirectives(v)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("Loading subtitle playlist for id "+c),this.hls.trigger(g.Events.SUBTITLE_TRACK_LOADING,{url:v,id:c,groupId:f,deliveryDirectives:n||null})}},l.toggleTrackModes=function(n){var u=this,c=this.media,f=this.trackId;if(c){var v=Kn(c.textTracks),b=v.filter(function(F){return F.groupId===u.groupId});if(n===-1)[].slice.call(v).forEach(function(F){F.mode="disabled"});else{var D=b[f];D&&(D.mode="disabled")}var C=b[n];C&&(C.mode=this.subtitleDisplay?"showing":"hidden")}},l.setSubtitleTrack=function(n,u){var c,f=this.tracksInGroup;if(this.media){if(this.trackId!==n&&this.toggleTrackModes(n),!(this.trackId===n&&(n===-1||(c=f[n])!==null&&c!==void 0&&c.details)||n<-1||n>=f.length)){this.clearTimer();var v=f[n];if(this.log("Switching to subtitle track "+n),this.trackId=n,v){var b=v.id,D=v.groupId,C=D===void 0?"":D,F=v.name,q=v.type,K=v.url;this.hls.trigger(g.Events.SUBTITLE_TRACK_SWITCH,{id:b,groupId:C,name:F,type:q,url:K});var ce=this.switchParams(v.url,u==null?void 0:u.details);this.loadPlaylist(ce)}else this.hls.trigger(g.Events.SUBTITLE_TRACK_SWITCH,{id:n})}}else this.queuedDefaultTrack=n},l.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var n=-1,u=Kn(this.media.textTracks),c=0;c<u.length;c++)if(u[c].mode==="hidden")n=c;else if(u[c].mode==="showing"){n=c;break}this.subtitleTrack!==n&&(this.subtitleTrack=n)}},s=r,(o=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(n){this._subtitleDisplay=n,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(n){this.selectDefaultTrack=!1;var u=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(n,u)}}])&&$s(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),r}(Fe);var ft,en=function(){function p(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}var d=p.prototype;return d.append=function(t,r){var s=this.queues[r];s.push(t),s.length===1&&this.buffers[r]&&this.executeNext(r)},d.insertAbort=function(t,r){this.queues[r].unshift(t),this.executeNext(r)},d.appendBlocker=function(t){var r,s=new Promise(function(l){r=l}),o={execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(o,t),s},d.executeNext=function(t){var r=this.buffers,s=this.queues,o=r[t],l=s[t];if(l.length){var n=l[0];try{n.execute()}catch(u){O.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),n.onError(u),o&&o.updating||(l.shift(),this.executeNext(t))}}},d.shiftAndExecuteNext=function(t){this.queues[t].shift(),this.executeNext(t)},d.current=function(t){return this.queues[t][0]},p}(),Ra=Zi(),Ca=/([ha]vc.)(?:\.[^.,]+)+/,S=function(){function p(t){var r=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var s=r.hls,o=r.media,l=r.mediaSource;O.logger.log("[buffer-controller]: Media source opened"),o&&(r.updateMediaElementDuration(),s.trigger(g.Events.MEDIA_ATTACHED,{media:o})),l&&l.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},this._onMediaSourceClose=function(){O.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){O.logger.log("[buffer-controller]: Media source ended")},this.hls=t,this._initSourceBuffer(),this.registerListeners()}var d=p.prototype;return d.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},d.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},d.registerListeners=function(){var t=this.hls;t.on(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.Events.BUFFER_RESET,this.onBufferReset,this),t.on(g.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(g.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(g.Events.BUFFER_EOS,this.onBufferEos,this),t.on(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(g.Events.FRAG_PARSED,this.onFragParsed,this),t.on(g.Events.FRAG_CHANGED,this.onFragChanged,this)},d.unregisterListeners=function(){var t=this.hls;t.off(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.Events.BUFFER_RESET,this.onBufferReset,this),t.off(g.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(g.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(g.Events.BUFFER_EOS,this.onBufferEos,this),t.off(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(g.Events.FRAG_PARSED,this.onFragParsed,this),t.off(g.Events.FRAG_CHANGED,this.onFragChanged,this)},d._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new en(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},d.onManifestParsed=function(t,r){var s=2;(r.audio&&!r.video||!r.altAudio)&&(s=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=s,this.details=null,O.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},d.onMediaAttaching=function(t,r){var s=this.media=r.media;if(s&&Ra){var o=this.mediaSource=new Ra;o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),s.src=self.URL.createObjectURL(o),this._objectUrl=s.src}},d.onMediaDetaching=function(){var t=this.media,r=this.mediaSource,s=this._objectUrl;if(r){if(O.logger.log("[buffer-controller]: media source detaching"),r.readyState==="open")try{r.endOfStream()}catch(o){O.logger.warn("[buffer-controller]: onMediaDetaching: "+o.message+" while calling endOfStream")}this.onBufferReset(),r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(s&&self.URL.revokeObjectURL(s),t.src===s?(t.removeAttribute("src"),t.load()):O.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(g.Events.MEDIA_DETACHED,void 0)},d.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(r){var s=t.sourceBuffer[r];try{s&&(t.removeBufferListeners(r),t.mediaSource&&t.mediaSource.removeSourceBuffer(s),t.sourceBuffer[r]=void 0)}catch(o){O.logger.warn("[buffer-controller]: Failed to reset the "+r+" buffer",o)}}),this._initSourceBuffer()},d.onBufferCodecs=function(t,r){var s=this,o=this.getSourceBufferTypes().length;Object.keys(r).forEach(function(l){if(o){var n=s.tracks[l];if(n&&typeof n.buffer.changeType=="function"){var u=r[l],c=u.id,f=u.codec,v=u.levelCodec,b=u.container,D=u.metadata,C=(n.levelCodec||n.codec).replace(Ca,"$1"),F=(v||f).replace(Ca,"$1");if(C!==F){var q=b+";codecs="+(v||f);s.appendChangeType(l,q),O.logger.log("[buffer-controller]: switching codec "+C+" to "+F),s.tracks[l]={buffer:n.buffer,codec:f,container:b,levelCodec:v,metadata:D,id:c}}}}else s.pendingTracks[l]=r[l]}),o||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},d.appendChangeType=function(t,r){var s=this,o=this.operationQueue,l={execute:function(){var n=s.sourceBuffer[t];n&&(O.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+r),n.changeType(r)),o.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(n){O.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",n)}};o.append(l,t)},d.onBufferAppending=function(t,r){var s=this,o=this.hls,l=this.operationQueue,n=this.tracks,u=r.data,c=r.type,f=r.frag,v=r.part,b=r.chunkMeta,D=b.buffering[c],C=self.performance.now();D.start=C;var F=f.stats.buffering,q=v?v.stats.buffering:null;F.start===0&&(F.start=C),q&&q.start===0&&(q.start=C);var K=n.audio,ce=!1;c==="audio"&&(K==null?void 0:K.container)==="audio/mpeg"&&(ce=!this.lastMpegAudioChunk||b.id===1||this.lastMpegAudioChunk.sn!==b.sn,this.lastMpegAudioChunk=b);var Se=f.start,Ce={execute:function(){if(D.executeStart=self.performance.now(),ce){var Ie=s.sourceBuffer[c];if(Ie){var Pe=Se-Ie.timestampOffset;Math.abs(Pe)>=.1&&(O.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+Se+" (delta: "+Pe+") sn: "+f.sn+")"),Ie.timestampOffset=Se)}}s.appendExecutor(u,c)},onStart:function(){},onComplete:function(){var Ie=self.performance.now();D.executeEnd=D.end=Ie,F.first===0&&(F.first=Ie),q&&q.first===0&&(q.first=Ie);var Pe=s.sourceBuffer,Qe={};for(var st in Pe)Qe[st]=$t.getBuffered(Pe[st]);s.appendError=0,s.hls.trigger(g.Events.BUFFER_APPENDED,{type:c,frag:f,part:v,chunkMeta:b,parent:f.type,timeRanges:Qe})},onError:function(Ie){O.logger.error("[buffer-controller]: Error encountered while trying to append to the "+c+" SourceBuffer",Ie);var Pe={type:I.ErrorTypes.MEDIA_ERROR,parent:f.type,details:I.ErrorDetails.BUFFER_APPEND_ERROR,err:Ie,fatal:!1};Ie.code===DOMException.QUOTA_EXCEEDED_ERR?Pe.details=I.ErrorDetails.BUFFER_FULL_ERROR:(s.appendError++,Pe.details=I.ErrorDetails.BUFFER_APPEND_ERROR,s.appendError>o.config.appendErrorMaxRetry&&(O.logger.error("[buffer-controller]: Failed "+o.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),Pe.fatal=!0,o.stopLoad())),o.trigger(g.Events.ERROR,Pe)}};l.append(Ce,c)},d.onBufferFlushing=function(t,r){var s=this,o=this.operationQueue,l=function(n){return{execute:s.removeExecutor.bind(s,n,r.startOffset,r.endOffset),onStart:function(){},onComplete:function(){s.hls.trigger(g.Events.BUFFER_FLUSHED,{type:n})},onError:function(u){O.logger.warn("[buffer-controller]: Failed to remove from "+n+" SourceBuffer",u)}}};r.type?o.append(l(r.type),r.type):this.getSourceBufferTypes().forEach(function(n){o.append(l(n),n)})},d.onFragParsed=function(t,r){var s=this,o=r.frag,l=r.part,n=[],u=l?l.elementaryStreams:o.elementaryStreams;u[he.ElementaryStreamTypes.AUDIOVIDEO]?n.push("audiovideo"):(u[he.ElementaryStreamTypes.AUDIO]&&n.push("audio"),u[he.ElementaryStreamTypes.VIDEO]&&n.push("video")),n.length===0&&O.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+o.type+" level: "+o.level+" sn: "+o.sn),this.blockBuffers(function(){var c=self.performance.now();o.stats.buffering.end=c,l&&(l.stats.buffering.end=c);var f=l?l.stats:o.stats;s.hls.trigger(g.Events.FRAG_BUFFERED,{frag:o,part:l,stats:f,id:o.type})},n)},d.onFragChanged=function(t,r){this.flushBackBuffer()},d.onBufferEos=function(t,r){var s=this;this.getSourceBufferTypes().reduce(function(o,l){var n=s.sourceBuffer[l];return!n||r.type&&r.type!==l||(n.ending=!0,n.ended||(n.ended=!0,O.logger.log("[buffer-controller]: "+l+" sourceBuffer now EOS"))),o&&!(n&&!n.ended)},!0)&&(O.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){s.getSourceBufferTypes().forEach(function(l){var n=s.sourceBuffer[l];n&&(n.ending=!1)});var o=s.mediaSource;o&&o.readyState==="open"?(O.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),o.endOfStream()):o&&O.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+o.readyState)}))},d.onLevelUpdated=function(t,r){var s=r.details;s.fragments.length&&(this.details=s,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},d.flushBackBuffer=function(){var t=this.hls,r=this.details,s=this.media,o=this.sourceBuffer;if(s&&r!==null){var l=this.getSourceBufferTypes();if(l.length){var n=r.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if((0,P.isFiniteNumber)(n)&&!(n<0)){var u=s.currentTime,c=r.levelTargetDuration,f=Math.max(n,c),v=Math.floor(u/c)*c-f;l.forEach(function(b){var D=o[b];if(D){var C=$t.getBuffered(D);if(C.length>0&&v>C.start(0)){if(t.trigger(g.Events.BACK_BUFFER_REACHED,{bufferEnd:v}),r.live)t.trigger(g.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:v});else if(D.ended&&C.end(C.length-1)-u<2*c)return void O.logger.info("[buffer-controller]: Cannot flush "+b+" back buffer while SourceBuffer is in ended state");t.trigger(g.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:v,type:b})}}})}}}},d.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var t=this.details,r=this.hls,s=this.media,o=this.mediaSource,l=t.fragments[0].start+t.totalduration,n=s.duration,u=(0,P.isFiniteNumber)(o.duration)?o.duration:0;t.live&&r.config.liveDurationInfinity?(O.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),o.duration=1/0,this.updateSeekableRange(t)):(l>u&&l>n||!(0,P.isFiniteNumber)(n))&&(O.logger.log("[buffer-controller]: Updating Media Source duration to "+l.toFixed(3)),o.duration=l)}},d.updateSeekableRange=function(t){var r=this.mediaSource,s=t.fragments;if(s.length&&t.live&&r!=null&&r.setLiveSeekableRange){var o=Math.max(0,s[0].start),l=Math.max(o,o+t.totalduration);r.setLiveSeekableRange(o,l)}},d.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,r=this.operationQueue,s=this.pendingTracks,o=Object.keys(s).length;if(o&&!t||o===2){this.createSourceBuffers(s),this.pendingTracks={};var l=this.getSourceBufferTypes();if(l.length===0)return void this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});l.forEach(function(n){r.executeNext(n)})}},d.createSourceBuffers=function(t){var r=this.sourceBuffer,s=this.mediaSource;if(!s)throw Error("createSourceBuffers called when mediaSource was null");var o=0;for(var l in t)if(!r[l]){var n=t[l];if(!n)throw Error("source buffer exists for track "+l+", however track does not");var u=n.levelCodec||n.codec,c=n.container+";codecs="+u;O.logger.log("[buffer-controller]: creating sourceBuffer("+c+")");try{var f=r[l]=s.addSourceBuffer(c),v=l;this.addBufferListener(v,"updatestart",this._onSBUpdateStart),this.addBufferListener(v,"updateend",this._onSBUpdateEnd),this.addBufferListener(v,"error",this._onSBUpdateError),this.tracks[l]={buffer:f,codec:u,container:n.container,levelCodec:n.levelCodec,metadata:n.metadata,id:n.id},o++}catch(b){O.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+b.message),this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:b,mimeType:c})}}o&&this.hls.trigger(g.Events.BUFFER_CREATED,{tracks:this.tracks})},d._onSBUpdateStart=function(t){this.operationQueue.current(t).onStart()},d._onSBUpdateEnd=function(t){var r=this.operationQueue;r.current(t).onComplete(),r.shiftAndExecuteNext(t)},d._onSBUpdateError=function(t,r){O.logger.error("[buffer-controller]: "+t+" SourceBuffer error",r),this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var s=this.operationQueue.current(t);s&&s.onError(r)},d.removeExecutor=function(t,r,s){var o=this.media,l=this.mediaSource,n=this.operationQueue,u=this.sourceBuffer[t];if(!o||!l||!u)return O.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),void n.shiftAndExecuteNext(t);var c=(0,P.isFiniteNumber)(o.duration)?o.duration:1/0,f=(0,P.isFiniteNumber)(l.duration)?l.duration:1/0,v=Math.max(0,r),b=Math.min(s,c,f);b>v&&!u.ending?(u.ended=!1,O.logger.log("[buffer-controller]: Removing ["+v+","+b+"] from the "+t+" SourceBuffer"),u.remove(v,b)):n.shiftAndExecuteNext(t)},d.appendExecutor=function(t,r){var s=this.operationQueue,o=this.sourceBuffer[r];if(!o)return O.logger.warn("[buffer-controller]: Attempting to append to the "+r+" SourceBuffer, but it does not exist"),void s.shiftAndExecuteNext(r);o.ended=!1,o.appendBuffer(t)},d.blockBuffers=function(t,r){var s=this;if(r===void 0&&(r=this.getSourceBufferTypes()),!r.length)return O.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(t);var o=this.operationQueue,l=r.map(function(n){return o.appendBlocker(n)});Promise.all(l).then(function(){t(),r.forEach(function(n){var u=s.sourceBuffer[n];u&&u.updating||o.shiftAndExecuteNext(n)})})},d.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},d.addBufferListener=function(t,r,s){var o=this.sourceBuffer[t];if(o){var l=s.bind(this,t);this.listeners[t].push({event:r,listener:l}),o.addEventListener(r,l)}},d.removeBufferListeners=function(t){var r=this.sourceBuffer[t];r&&this.listeners[t].forEach(function(s){r.removeEventListener(s.event,s.listener)})},p}(),y={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},_=function(p){var d=p;return y.hasOwnProperty(p)&&(d=y[p]),String.fromCharCode(d)},E=15,M=100,ee={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},H={17:2,18:4,21:6,22:8,23:10,19:13,20:15},be={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},oe={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ve=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(function(p){p[p.ERROR=0]="ERROR",p[p.TEXT=1]="TEXT",p[p.WARNING=2]="WARNING",p[p.INFO=2]="INFO",p[p.DEBUG=3]="DEBUG",p[p.DATA=3]="DATA"})(ft||(ft={}));var nt=function(){function p(){this.time=null,this.verboseLevel=ft.ERROR}return p.prototype.log=function(d,t){if(this.verboseLevel>=d){var r=typeof t=="function"?t():t;O.logger.log(this.time+" ["+d+"] "+r)}},p}(),ut=function(p){for(var d=[],t=0;t<p.length;t++)d.push(p[t].toString(16));return d},bt=function(){function p(t,r,s,o,l){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=r||!1,this.italics=s||!1,this.background=o||"black",this.flash=l||!1}var d=p.prototype;return d.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},d.setStyles=function(t){for(var r=["foreground","underline","italics","background","flash"],s=0;s<r.length;s++){var o=r[s];t.hasOwnProperty(o)&&(this[o]=t[o])}},d.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},d.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},d.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},d.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},p}(),Ze=function(){function p(t,r,s,o,l,n){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new bt(r,s,o,l,n)}var d=p.prototype;return d.reset=function(){this.uchar=" ",this.penState.reset()},d.setChar=function(t,r){this.uchar=t,this.penState.copy(r)},d.setPenState=function(t){this.penState.copy(t)},d.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},d.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},d.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},p}(),pt=function(){function p(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var r=0;r<M;r++)this.chars.push(new Ze);this.logger=t,this.pos=0,this.currPenState=new bt}var d=p.prototype;return d.equals=function(t){for(var r=!0,s=0;s<M;s++)if(!this.chars[s].equals(t.chars[s])){r=!1;break}return r},d.copy=function(t){for(var r=0;r<M;r++)this.chars[r].copy(t.chars[r])},d.isEmpty=function(){for(var t=!0,r=0;r<M;r++)if(!this.chars[r].isEmpty()){t=!1;break}return t},d.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(ft.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>M&&(this.logger.log(ft.DEBUG,"Too large cursor position "+this.pos),this.pos=M)},d.moveCursor=function(t){var r=this.pos+t;if(t>1)for(var s=this.pos+1;s<r+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(r)},d.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},d.insertChar=function(t){var r=this;t>=144&&this.backSpace();var s=_(t);this.pos>=M?this.logger.log(ft.ERROR,function(){return"Cannot insert "+t.toString(16)+" ("+s+") at position "+r.pos+". Skipping it!"}):(this.chars[this.pos].setChar(s,this.currPenState),this.moveCursor(1))},d.clearFromPos=function(t){var r;for(r=t;r<M;r++)this.chars[r].reset()},d.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},d.clearToEndOfRow=function(){this.clearFromPos(this.pos)},d.getTextString=function(){for(var t=[],r=!0,s=0;s<M;s++){var o=this.chars[s].uchar;o!==" "&&(r=!1),t.push(o)}return r?"":t.join("")},d.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},p}(),_t=function(){function p(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var r=0;r<E;r++)this.rows.push(new pt(t));this.logger=t,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var d=p.prototype;return d.reset=function(){for(var t=0;t<E;t++)this.rows[t].clear();this.currRow=14},d.equals=function(t){for(var r=!0,s=0;s<E;s++)if(!this.rows[s].equals(t.rows[s])){r=!1;break}return r},d.copy=function(t){for(var r=0;r<E;r++)this.rows[r].copy(t.rows[r])},d.isEmpty=function(){for(var t=!0,r=0;r<E;r++)if(!this.rows[r].isEmpty()){t=!1;break}return t},d.backSpace=function(){this.rows[this.currRow].backSpace()},d.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},d.insertChar=function(t){this.rows[this.currRow].insertChar(t)},d.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},d.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},d.setCursor=function(t){this.logger.log(ft.INFO,"setCursor: "+t),this.rows[this.currRow].setCursor(t)},d.setPAC=function(t){this.logger.log(ft.INFO,function(){return"pacData = "+JSON.stringify(t)});var r=t.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1&&(r=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==r){for(var s=0;s<E;s++)this.rows[s].clear();var o=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){var n=l.rows[o].cueStartTime,u=this.logger.time;if(n&&u!==null&&n<u)for(var c=0;c<this.nrRollUpRows;c++)this.rows[r-this.nrRollUpRows+c+1].copy(l.rows[o+c])}}this.currRow=r;var f=this.rows[this.currRow];if(t.indent!==null){var v=t.indent,b=Math.max(v-1,0);f.setCursor(t.indent),t.color=f.chars[b].penState.foreground}var D={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(D)},d.setBkgData=function(t){this.logger.log(ft.INFO,function(){return"bkgData = "+JSON.stringify(t)}),this.backSpace(),this.setPen(t),this.insertChar(32)},d.setRollUpRows=function(t){this.nrRollUpRows=t},d.rollUp=function(){var t=this;if(this.nrRollUpRows!==null){this.logger.log(ft.TEXT,function(){return t.getDisplayText()});var r=this.currRow+1-this.nrRollUpRows,s=this.rows.splice(r,1)[0];s.clear(),this.rows.splice(this.currRow,0,s),this.logger.log(ft.INFO,"Rolling up")}else this.logger.log(ft.DEBUG,"roll_up but nrRollUpRows not set yet")},d.getDisplayText=function(t){t=t||!1;for(var r=[],s="",o=-1,l=0;l<E;l++){var n=this.rows[l].getTextString();n&&(o=l+1,t?r.push("Row "+o+": '"+n+"'"):r.push(n.trim()))}return r.length>0&&(s=t?"["+r.join(" | ")+"]":r.join(`
`)),s},d.getTextAndFormat=function(){return this.rows},p}(),ur=function(){function p(t,r,s){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new _t(s),this.nonDisplayedMemory=new _t(s),this.lastOutputScreen=new _t(s),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=s}var d=p.prototype;return d.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},d.getHandler=function(){return this.outputFilter},d.setHandler=function(t){this.outputFilter=t},d.setPAC=function(t){this.writeScreen.setPAC(t)},d.setBkgData=function(t){this.writeScreen.setBkgData(t)},d.setMode=function(t){t!==this.mode&&(this.mode=t,this.logger.log(ft.INFO,function(){return"MODE="+t}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},d.insertChars=function(t){for(var r=this,s=0;s<t.length;s++)this.writeScreen.insertChar(t[s]);var o=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(ft.INFO,function(){return o+": "+r.writeScreen.getDisplayText(!0)}),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(ft.TEXT,function(){return"DISPLAYED: "+r.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},d.ccRCL=function(){this.logger.log(ft.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},d.ccBS=function(){this.logger.log(ft.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},d.ccAOF=function(){},d.ccAON=function(){},d.ccDER=function(){this.logger.log(ft.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},d.ccRU=function(t){this.logger.log(ft.INFO,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},d.ccFON=function(){this.logger.log(ft.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},d.ccRDC=function(){this.logger.log(ft.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},d.ccTR=function(){this.logger.log(ft.INFO,"TR"),this.setMode("MODE_TEXT")},d.ccRTD=function(){this.logger.log(ft.INFO,"RTD"),this.setMode("MODE_TEXT")},d.ccEDM=function(){this.logger.log(ft.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},d.ccCR=function(){this.logger.log(ft.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},d.ccENM=function(){this.logger.log(ft.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},d.ccEOC=function(){var t=this;if(this.logger.log(ft.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var r=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=r,this.writeScreen=this.nonDisplayedMemory,this.logger.log(ft.TEXT,function(){return"DISP: "+t.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},d.ccTO=function(t){this.logger.log(ft.INFO,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},d.ccMIDROW=function(t){var r={flash:!1};if(r.underline=t%2==1,r.italics=t>=46,r.italics)r.foreground="white";else{var s=Math.floor(t/2)-16;r.foreground=["white","green","blue","cyan","red","yellow","magenta"][s]}this.logger.log(ft.INFO,"MIDROW: "+JSON.stringify(r)),this.writeScreen.setPen(r)},d.outputDataUpdate=function(t){t===void 0&&(t=!1);var r=this.logger.time;r!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,r,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:r):this.cueStartTime=r,this.lastOutputScreen.copy(this.displayedMemory))},d.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},p}(),dr=function(){function p(t,r,s){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var o=new nt;this.channels=[null,new ur(t,r,o),new ur(t+1,s,o)],this.cmdHistory={a:null,b:null},this.logger=o}var d=p.prototype;return d.getHandler=function(t){return this.channels[t].getHandler()},d.setHandler=function(t,r){this.channels[t].setHandler(r)},d.addData=function(t,r){var s,o,l,n=!1;this.logger.time=t;for(var u=0;u<r.length;u+=2)if(o=127&r[u],l=127&r[u+1],o!==0||l!==0){if(this.logger.log(ft.DATA,"["+ut([r[u],r[u+1]])+"] -> ("+ut([o,l])+")"),(s=this.parseCmd(o,l))||(s=this.parseMidrow(o,l)),s||(s=this.parsePAC(o,l)),s||(s=this.parseBackgroundAttributes(o,l)),!s&&(n=this.parseChars(o,l))){var c=this.currentChannel;c&&c>0?this.channels[c].insertChars(n):this.logger.log(ft.WARNING,"No channel found yet. TEXT-MODE?")}s||n||this.logger.log(ft.WARNING,"Couldn't parse cleaned data "+ut([o,l])+" orig: "+ut([r[u],r[u+1]]))}},d.parseCmd=function(t,r){var s=this.cmdHistory;if(!((t===20||t===28||t===21||t===29)&&r>=32&&r<=47||(t===23||t===31)&&r>=33&&r<=35))return!1;if(It(t,r,s))return Jt(null,null,s),this.logger.log(ft.DEBUG,"Repeated command ("+ut([t,r])+") is dropped"),!0;var o=t===20||t===21||t===23?1:2,l=this.channels[o];return t===20||t===21||t===28||t===29?r===32?l.ccRCL():r===33?l.ccBS():r===34?l.ccAOF():r===35?l.ccAON():r===36?l.ccDER():r===37?l.ccRU(2):r===38?l.ccRU(3):r===39?l.ccRU(4):r===40?l.ccFON():r===41?l.ccRDC():r===42?l.ccTR():r===43?l.ccRTD():r===44?l.ccEDM():r===45?l.ccCR():r===46?l.ccENM():r===47&&l.ccEOC():l.ccTO(r-32),Jt(t,r,s),this.currentChannel=o,!0},d.parseMidrow=function(t,r){var s=0;if((t===17||t===25)&&r>=32&&r<=47){if((s=t===17?1:2)!==this.currentChannel)return this.logger.log(ft.ERROR,"Mismatch channel in midrow parsing"),!1;var o=this.channels[s];return!!o&&(o.ccMIDROW(r),this.logger.log(ft.DEBUG,"MIDROW ("+ut([t,r])+")"),!0)}return!1},d.parsePAC=function(t,r){var s,o=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&r>=64&&r<=127||(t===16||t===24)&&r>=64&&r<=95))return!1;if(It(t,r,o))return Jt(null,null,o),!0;var l=t<=23?1:2;s=r>=64&&r<=95?l===1?ee[t]:be[t]:l===1?H[t]:oe[t];var n=this.channels[l];return!!n&&(n.setPAC(this.interpretPAC(s,r)),Jt(t,r,o),this.currentChannel=l,!0)},d.interpretPAC=function(t,r){var s,o={color:null,italics:!1,indent:null,underline:!1,row:t};return s=r>95?r-96:r-64,o.underline=(1&s)==1,s<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(o.italics=!0,o.color="white"):o.indent=4*Math.floor((s-16)/2),o},d.parseChars=function(t,r){var s,o,l=null,n=null;if(t>=25?(s=2,n=t-8):(s=1,n=t),n>=17&&n<=19?(o=n===17?r+80:n===18?r+112:r+144,this.logger.log(ft.INFO,"Special char '"+_(o)+"' in channel "+s),l=[o]):t>=32&&t<=127&&(l=r===0?[t]:[t,r]),l){var u=ut(l);this.logger.log(ft.DEBUG,"Char codes =  "+u.join(",")),Jt(t,r,this.cmdHistory)}return l},d.parseBackgroundAttributes=function(t,r){var s;if(!((t===16||t===24)&&r>=32&&r<=47||(t===23||t===31)&&r>=45&&r<=47))return!1;var o={};t===16||t===24?(s=Math.floor((r-32)/2),o.background=Ve[s],r%2==1&&(o.background=o.background+"_semi")):r===45?o.background="transparent":(o.foreground="black",r===47&&(o.underline=!0));var l=t<=23?1:2;return this.channels[l].setBkgData(o),Jt(t,r,this.cmdHistory),!0},d.reset=function(){for(var t=0;t<Object.keys(this.channels).length;t++){var r=this.channels[t];r&&r.reset()}this.cmdHistory={a:null,b:null}},d.cueSplitAtTime=function(t){for(var r=0;r<this.channels.length;r++){var s=this.channels[r];s&&s.cueSplitAtTime(t)}},p}();function Jt(p,d,t){t.a=p,t.b=d}function It(p,d,t){return t.a===p&&t.b===d}const sr=dr;var rr=function(){function p(t,r){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=r}var d=p.prototype;return d.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},d.newCue=function(t,r,s){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=r,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)},d.reset=function(){this.cueRanges=[],this.startTime=null},p}();const Rt=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var p=["","lr","rl"],d=["start","middle","end","left","right"];function t(l,n){if(typeof n!="string"||!Array.isArray(l))return!1;var u=n.toLowerCase();return!!~l.indexOf(u)&&u}function r(l){return t(d,l)}function s(l){for(var n=arguments.length,u=new Array(n>1?n-1:0),c=1;c<n;c++)u[c-1]=arguments[c];for(var f=1;f<arguments.length;f++){var v=arguments[f];for(var b in v)l[b]=v[b]}return l}function o(l,n,u){var c=this,f={enumerable:!0};c.hasBeenReset=!1;var v="",b=!1,D=l,C=n,F=u,q=null,K="",ce=!0,Se="auto",Ce="start",Ie=50,Pe="middle",Qe=50,st="middle";Object.defineProperty(c,"id",s({},f,{get:function(){return v},set:function(xe){v=""+xe}})),Object.defineProperty(c,"pauseOnExit",s({},f,{get:function(){return b},set:function(xe){b=!!xe}})),Object.defineProperty(c,"startTime",s({},f,{get:function(){return D},set:function(xe){if(typeof xe!="number")throw new TypeError("Start time must be set to a number.");D=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},f,{get:function(){return C},set:function(xe){if(typeof xe!="number")throw new TypeError("End time must be set to a number.");C=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},f,{get:function(){return F},set:function(xe){F=""+xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},f,{get:function(){return q},set:function(xe){q=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},f,{get:function(){return K},set:function(xe){var ze=function($e){return t(p,$e)}(xe);if(ze===!1)throw new SyntaxError("An invalid or illegal string was specified.");K=ze,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},f,{get:function(){return ce},set:function(xe){ce=!!xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},f,{get:function(){return Se},set:function(xe){if(typeof xe!="number"&&xe!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");Se=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},f,{get:function(){return Ce},set:function(xe){var ze=r(xe);if(!ze)throw new SyntaxError("An invalid or illegal string was specified.");Ce=ze,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},f,{get:function(){return Ie},set:function(xe){if(xe<0||xe>100)throw new Error("Position must be between 0 and 100.");Ie=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},f,{get:function(){return Pe},set:function(xe){var ze=r(xe);if(!ze)throw new SyntaxError("An invalid or illegal string was specified.");Pe=ze,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},f,{get:function(){return Qe},set:function(xe){if(xe<0||xe>100)throw new Error("Size must be between 0 and 100.");Qe=xe,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},f,{get:function(){return st},set:function(xe){var ze=r(xe);if(!ze)throw new SyntaxError("An invalid or illegal string was specified.");st=ze,this.hasBeenReset=!0}})),c.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();var tt=function(){function p(){}return p.prototype.decode=function(d,t){if(!d)return"";if(typeof d!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(d))},p}();function Tt(p){function d(r,s,o,l){return 3600*(0|r)+60*(0|s)+(0|o)+parseFloat(l||0)}var t=p.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?d(t[2],t[3],0,t[4]):d(t[1],t[2],t[3],t[4]):null}var it=function(){function p(){this.values=Object.create(null)}var d=p.prototype;return d.set=function(t,r){this.get(t)||r===""||(this.values[t]=r)},d.get=function(t,r,s){return s?this.has(t)?this.values[t]:r[s]:this.has(t)?this.values[t]:r},d.has=function(t){return t in this.values},d.alt=function(t,r,s){for(var o=0;o<s.length;++o)if(r===s[o]){this.set(t,r);break}},d.integer=function(t,r){/^-?\d+$/.test(r)&&this.set(t,parseInt(r,10))},d.percent=function(t,r){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(r)){var s=parseFloat(r);if(s>=0&&s<=100)return this.set(t,s),!0}return!1},p}();function vt(p,d,t,r){var s=r?p.split(r):[p];for(var o in s)if(typeof s[o]=="string"){var l=s[o].split(t);l.length===2&&d(l[0],l[1])}}var Yt=new Rt(0,0,""),Xt=Yt.align==="middle"?"middle":"center";function Er(p,d,t){var r=p;function s(){var l=Tt(p);if(l===null)throw new Error("Malformed timestamp: "+r);return p=p.replace(/^[^\sa-zA-Z-]+/,""),l}function o(){p=p.replace(/^\s+/,"")}if(o(),d.startTime=s(),o(),p.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);p=p.slice(3),o(),d.endTime=s(),o(),function(l,n){var u=new it;vt(l,function(v,b){var D;switch(v){case"region":for(var C=t.length-1;C>=0;C--)if(t[C].id===b){u.set(v,t[C].region);break}break;case"vertical":u.alt(v,b,["rl","lr"]);break;case"line":D=b.split(","),u.integer(v,D[0]),u.percent(v,D[0])&&u.set("snapToLines",!1),u.alt(v,D[0],["auto"]),D.length===2&&u.alt("lineAlign",D[1],["start",Xt,"end"]);break;case"position":D=b.split(","),u.percent(v,D[0]),D.length===2&&u.alt("positionAlign",D[1],["start",Xt,"end","line-left","line-right","auto"]);break;case"size":u.percent(v,b);break;case"align":u.alt(v,b,["start",Xt,"end","left","right"])}},/:/,/\s/),n.region=u.get("region",null),n.vertical=u.get("vertical","");var c=u.get("line","auto");c==="auto"&&Yt.line===-1&&(c=-1),n.line=c,n.lineAlign=u.get("lineAlign","start"),n.snapToLines=u.get("snapToLines",!0),n.size=u.get("size",100),n.align=u.get("align",Xt);var f=u.get("position","auto");f==="auto"&&Yt.position===50&&(f=n.align==="start"||n.align==="left"?0:n.align==="end"||n.align==="right"?100:50),n.position=f}(p,d)}function mr(p){return p.replace(/<br(?: \/)?>/gi,`
`)}var Ar=function(){function p(){this.state="INITIAL",this.buffer="",this.decoder=new tt,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var d=p.prototype;return d.parse=function(t){var r=this;function s(){var c=r.buffer,f=0;for(c=mr(c);f<c.length&&c[f]!=="\r"&&c[f]!==`
`;)++f;var v=c.slice(0,f);return c[f]==="\r"&&++f,c[f]===`
`&&++f,r.buffer=c.slice(f),v}t&&(r.buffer+=r.decoder.decode(t,{stream:!0}));try{var o="";if(r.state==="INITIAL"){if(!/\r\n|\n/.test(r.buffer))return this;var l=(o=s()).match(/^()?WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new Error("Malformed WebVTT signature.");r.state="HEADER"}for(var n=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(n?n=!1:o=s(),r.state){case"HEADER":/:/.test(o)?vt(o,function(c,f){},/:/):o||(r.state="ID");continue;case"NOTE":o||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){r.state="NOTE";break}if(!o)continue;if(r.cue=new Rt(0,0,""),r.state="CUE",o.indexOf("-->")===-1){r.cue.id=o;continue}case"CUE":if(!r.cue){r.state="BADCUE";continue}try{Er(o,r.cue,r.regionList)}catch{r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var u=o.indexOf("-->")!==-1;if(!o||u&&(n=!0)){r.oncue&&r.cue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}if(r.cue===null)continue;r.cue.text&&(r.cue.text+=`
`),r.cue.text+=o;continue;case"BADCUE":o||(r.state="ID")}}}catch{r.state==="CUETEXT"&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state=r.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},d.flush=function(){var t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(r){t.onparsingerror&&t.onparsingerror(r)}return t.onflush&&t.onflush(),this},p}(),Sr=w(673),Yr=w(524),cr=/\r\n|\n\r|\n|\r/g,wr=function(p,d,t){return t===void 0&&(t=0),p.slice(t,t+d.length)===d},tn=function(p){for(var d=5381,t=p.length;t;)d=33*d^p.charCodeAt(--t);return(d>>>0).toString()};function xr(p,d,t){return tn(p.toString())+tn(d.toString())+tn(t)}function Ti(){return Ti=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},Ti.apply(this,arguments)}var qn="stpp.ttml.im1t",Sl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Al=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Gh={left:"start",center:"center",right:"end",start:"start",end:"end"};function wl(p,d,t,r,s){var o=(0,ne.findBox)(new Uint8Array(p),["mdat"]);if(o.length!==0){var l=o.map(function(u){return(0,Mt.utf8ArrayToStr)(u)}),n=(0,Sr.toTimescaleFromScale)(d,1,t);try{l.forEach(function(u){return r(function(c,f){var v=new DOMParser().parseFromString(c,"text/xml").getElementsByTagName("tt")[0];if(!v)throw new Error("Invalid ttml");var b={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},D=Object.keys(b).reduce(function(ce,Se){return ce[Se]=v.getAttribute("ttp:"+Se)||b[Se],ce},{}),C=v.getAttribute("xml:space")!=="preserve",F=kl(Ys(v,"styling","style")),q=kl(Ys(v,"layout","region")),K=Ys(v,"body","[begin]");return[].map.call(K,function(ce){var Se=Il(ce,C);if(!Se||!ce.hasAttribute("begin"))return null;var Ce=Xs(ce.getAttribute("begin"),D),Ie=Xs(ce.getAttribute("dur"),D),Pe=Xs(ce.getAttribute("end"),D);if(Ce===null)throw Dl(ce);if(Pe===null){if(Ie===null)throw Dl(ce);Pe=Ce+Ie}var Qe=new Rt(Ce-f,Pe-f,Se);Qe.id=xr(Qe.startTime,Qe.endTime,Qe.text);var st=function($e,St,Gt){var wt="http://www.w3.org/ns/ttml#styling",Ct=null,Bt=$e!=null&&$e.hasAttribute("style")?$e.getAttribute("style"):null;return Bt&&Gt.hasOwnProperty(Bt)&&(Ct=Gt[Bt]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(hr,or){var er=zs(St,wt,or)||zs($e,wt,or)||zs(Ct,wt,or);return er&&(hr[or]=er),hr},{})}(q[ce.getAttribute("region")],F[ce.getAttribute("style")],F),xe=st.textAlign;if(xe){var ze=Gh[xe];ze&&(Qe.lineAlign=ze),Qe.align=xe}return Ti(Qe,st),Qe}).filter(function(ce){return ce!==null})}(u,n))})}catch(u){s(u)}}else s(new Error("Could not parse IMSC1 mdat"))}function Ys(p,d,t){var r=p.getElementsByTagName(d)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function kl(p){return p.reduce(function(d,t){var r=t.getAttribute("xml:id");return r&&(d[r]=t),d},{})}function Il(p,d){return[].slice.call(p.childNodes).reduce(function(t,r,s){var o;return r.nodeName==="br"&&s?t+`
`:(o=r.childNodes)!==null&&o!==void 0&&o.length?Il(r,d):d?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function zs(p,d,t){return p&&p.hasAttributeNS(d,t)?p.getAttributeNS(d,t):null}function Dl(p){return new Error("Could not parse ttml timestamp "+p)}function Xs(p,d){if(!p)return null;var t=Tt(p);return t===null&&(Sl.test(p)?t=function(r,s){var o=Sl.exec(r),l=(0|o[4])+(0|o[5])/s.subFrameRate;return 3600*(0|o[1])+60*(0|o[2])+(0|o[3])+l/s.frameRate}(p,d):Al.test(p)&&(t=function(r,s){var o=Al.exec(r),l=Number(o[1]);switch(o[2]){case"h":return 3600*l;case"m":return 60*l;case"ms":return 1e3*l;case"f":return l/s.frameRate;case"t":return l/s.tickRate}return l}(p,d))),t}var Vh=function(){function p(t){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var r=new rr(this,"textTrack1"),s=new rr(this,"textTrack2"),o=new rr(this,"textTrack3"),l=new rr(this,"textTrack4");this.cea608Parser1=new sr(1,r,s),this.cea608Parser2=new sr(3,o,l)}t.on(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(g.Events.FRAG_LOADING,this.onFragLoading,this),t.on(g.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(g.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(g.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(g.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var d=p.prototype;return d.destroy=function(){var t=this.hls;t.off(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(g.Events.FRAG_LOADING,this.onFragLoading,this),t.off(g.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(g.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(g.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(g.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},d.addCues=function(t,r,s,o,l){for(var n,u,c,f,v=!1,b=l.length;b--;){var D=l[b],C=(n=D[0],u=D[1],c=r,f=s,Math.min(u,f)-Math.max(n,c));if(C>=0&&(D[0]=Math.min(D[0],r),D[1]=Math.max(D[1],s),v=!0,C/(s-r)>.5))return}if(v||l.push([r,s]),this.config.renderTextTracksNatively){var F=this.captionsTracks[t];this.Cues.newCue(F,r,s,o)}else{var q=this.Cues.newCue(null,r,s,o);this.hls.trigger(g.Events.CUES_PARSED,{type:"captions",cues:q,track:t})}},d.onInitPtsFound=function(t,r){var s=this,o=r.frag,l=r.id,n=r.initPTS,u=r.timescale,c=this.unparsedVttFrags;l==="main"&&(this.initPTS[o.cc]=n,this.timescale[o.cc]=u),c.length&&(this.unparsedVttFrags=[],c.forEach(function(f){s.onFragLoaded(g.Events.FRAG_LOADED,f)}))},d.getExistingTrack=function(t){var r=this.media;if(r)for(var s=0;s<r.textTracks.length;s++){var o=r.textTracks[s];if(o[t])return o}return null},d.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},d.createNativeTrack=function(t){if(!this.captionsTracks[t]){var r=this.captionsProperties,s=this.captionsTracks,o=this.media,l=r[t],n=l.label,u=l.languageCode,c=this.getExistingTrack(t);if(c)s[t]=c,gt(s[t]),at(s[t],o);else{var f=this.createTextTrack("captions",n,u);f&&(f[t]=!0,s[t]=f)}}},d.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var r=this.captionsProperties[t];if(r){var s={_id:t,label:r.label,kind:"captions",default:!!r.media&&!!r.media.default,closedCaptions:r.media};this.nonNativeCaptionsTracks[t]=s,this.hls.trigger(g.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},d.createTextTrack=function(t,r,s){var o=this.media;if(o)return o.addTextTrack(t,r,s)},d.onMediaAttaching=function(t,r){this.media=r.media,this._cleanTracks()},d.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(r){gt(t[r]),delete t[r]}),this.nonNativeCaptionsTracks={}},d.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},d._cleanTracks=function(){var t=this.media;if(t){var r=t.textTracks;if(r)for(var s=0;s<r.length;s++)gt(r[s])}},d.onSubtitleTracksUpdated=function(t,r){var s=this;this.textTracks=[];var o=r.subtitleTracks||[],l=o.some(function(f){return f.textCodec===qn});if(this.config.enableWebVTT||l&&this.config.enableIMSC1){var n=this.tracks&&o&&this.tracks.length===o.length;if(this.tracks=o||[],this.config.renderTextTracksNatively){var u=this.media?this.media.textTracks:[];this.tracks.forEach(function(f,v){var b;if(v<u.length){for(var D=null,C=0;C<u.length;C++)if(Kh(u[C],f)){D=u[C];break}D&&(b=D)}if(b)gt(b);else{var F=s._captionsOrSubtitlesFromCharacteristics(f);(b=s.createTextTrack(F,f.name,f.lang))&&(b.mode="disabled")}b&&(b.groupId=f.groupId,s.textTracks.push(b))})}else if(!n&&this.tracks&&this.tracks.length){var c=this.tracks.map(function(f){return{label:f.name,kind:f.type.toLowerCase(),default:f.default,subtitleTrack:f}});this.hls.trigger(g.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}},d._captionsOrSubtitlesFromCharacteristics=function(t){var r;if((r=t.attrs)!==null&&r!==void 0&&r.CHARACTERISTICS){var s=/transcribes-spoken-dialog/gi.test(t.attrs.CHARACTERISTICS),o=/describes-music-and-sound/gi.test(t.attrs.CHARACTERISTICS);if(s&&o)return"captions"}return"subtitles"},d.onManifestLoaded=function(t,r){var s=this;this.config.enableCEA708Captions&&r.captions&&r.captions.forEach(function(o){var l=/(?:CC|SERVICE)([1-4])/.exec(o.instreamId);if(l){var n="textTrack"+l[1],u=s.captionsProperties[n];u&&(u.label=o.name,o.lang&&(u.languageCode=o.lang),u.media=o)}})},d.closedCaptionsForLevel=function(t){var r=this.hls.levels[t.level];return r==null?void 0:r.attrs["CLOSED-CAPTIONS"]},d.onFragLoading=function(t,r){var s=this.cea608Parser1,o=this.cea608Parser2,l=this.lastSn,n=this.lastPartIndex;if(this.enabled&&s&&o&&r.frag.type===_e.PlaylistLevelType.MAIN){var u,c,f=r.frag.sn,v=(u=r==null||(c=r.part)===null||c===void 0?void 0:c.index)!=null?u:-1;f===l+1||f===l&&v===n+1||(s.reset(),o.reset()),this.lastSn=f,this.lastPartIndex=v}},d.onFragLoaded=function(t,r){var s=r.frag,o=r.payload,l=this.initPTS,n=this.unparsedVttFrags;if(s.type===_e.PlaylistLevelType.SUBTITLE)if(o.byteLength){if(!(0,P.isFiniteNumber)(l[s.cc]))return n.push(r),void(l.length&&this.hls.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Missing initial subtitle PTS")}));var u=s.decryptdata,c="stats"in r;if(u==null||!u.encrypted||c){var f=this.tracks[s.level],v=this.vttCCs;v[s.cc]||(v[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),f&&f.textCodec===qn?this._parseIMSC1(s,o):this._parseVTTs(s,o,v)}}else this.hls.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})},d._parseIMSC1=function(t,r){var s=this,o=this.hls;wl(r,this.initPTS[t.cc],this.timescale[t.cc],function(l){s._appendCues(l,t.level),o.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(l){O.logger.log("Failed to parse IMSC1: "+l),o.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:l})})},d._parseVTTs=function(t,r,s){var o,l=this,n=this.hls;(function(u,c,f,v,b,D,C,F){var q,K=new Ar,ce=(0,Mt.utf8ArrayToStr)(new Uint8Array(u)).trim().replace(cr,`
`).split(`
`),Se=[],Ce=(0,Sr.toMpegTsClockFromTimescale)(c,f),Ie="00:00.000",Pe=0,Qe=0,st=!0;K.oncue=function(xe){var ze=v[b],$e=v.ccOffset,St=(Pe-Ce)/9e4;ze!=null&&ze.new&&(Qe!==void 0?$e=v.ccOffset=ze.start:function(Bt,hr,or){var er=Bt[hr],fr=Bt[er.prevCC];if(!fr||!fr.new&&er.new)return Bt.ccOffset=Bt.presentationOffset=er.start,void(er.new=!1);for(;(Hr=fr)!==null&&Hr!==void 0&&Hr.new;){var Hr;Bt.ccOffset+=er.start-fr.start,er.new=!1,fr=Bt[(er=fr).prevCC]}Bt.presentationOffset=or}(v,b,St)),St&&($e=St-v.presentationOffset);var Gt=xe.endTime-xe.startTime,wt=(0,Yr.normalizePts)(9e4*(xe.startTime+$e-Qe),9e4*D)/9e4;xe.startTime=Math.max(wt,0),xe.endTime=Math.max(wt+Gt,0);var Ct=xe.text.trim();xe.text=decodeURIComponent(encodeURIComponent(Ct)),xe.id||(xe.id=xr(xe.startTime,xe.endTime,Ct)),xe.endTime>0&&Se.push(xe)},K.onparsingerror=function(xe){q=xe},K.onflush=function(){q?F(q):C(Se)},ce.forEach(function(xe){if(st){if(wr(xe,"X-TIMESTAMP-MAP=")){st=!1,xe.slice(16).split(",").forEach(function(ze){wr(ze,"LOCAL:")?Ie=ze.slice(6):wr(ze,"MPEGTS:")&&(Pe=parseInt(ze.slice(7)))});try{Qe=function(ze){var $e=parseInt(ze.slice(-3)),St=parseInt(ze.slice(-6,-4)),Gt=parseInt(ze.slice(-9,-7)),wt=ze.length>9?parseInt(ze.substring(0,ze.indexOf(":"))):0;if(!((0,P.isFiniteNumber)($e)&&(0,P.isFiniteNumber)(St)&&(0,P.isFiniteNumber)(Gt)&&(0,P.isFiniteNumber)(wt)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+ze);return $e+=1e3*St,($e+=6e4*Gt)+36e5*wt}(Ie)/1e3}catch(ze){q=ze}return}xe===""&&(st=!1)}K.parse(xe+`
`)}),K.flush()})((o=t.initSegment)!==null&&o!==void 0&&o.data?(0,ne.appendUint8Array)(t.initSegment.data,new Uint8Array(r)):r,this.initPTS[t.cc],this.timescale[t.cc],s,t.cc,t.start,function(u){l._appendCues(u,t.level),n.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(u){l._fallbackToIMSC1(t,r),O.logger.log("Failed to parse VTT cue: "+u),n.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:u})})},d._fallbackToIMSC1=function(t,r){var s=this,o=this.tracks[t.level];o.textCodec||wl(r,this.initPTS[t.cc],this.timescale[t.cc],function(){o.textCodec=qn,s._parseIMSC1(t,r)},function(){o.textCodec="wvtt"})},d._appendCues=function(t,r){var s=this.hls;if(this.config.renderTextTracksNatively){var o=this.textTracks[r];if(!o||o.mode==="disabled")return;t.forEach(function(u){return mt(o,u)})}else{var l=this.tracks[r];if(!l)return;var n=l.default?"default":"subtitles"+r;s.trigger(g.Events.CUES_PARSED,{type:"subtitles",cues:t,track:n})}},d.onFragDecrypted=function(t,r){var s=r.frag;if(s.type===_e.PlaylistLevelType.SUBTITLE){if(!(0,P.isFiniteNumber)(this.initPTS[s.cc]))return void this.unparsedVttFrags.push(r);this.onFragLoaded(g.Events.FRAG_LOADED,r)}},d.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},d.onFragParsingUserdata=function(t,r){var s=this.cea608Parser1,o=this.cea608Parser2;if(this.enabled&&s&&o){var l=r.frag,n=r.samples;if(l.type!==_e.PlaylistLevelType.MAIN||this.closedCaptionsForLevel(l)!=="NONE")for(var u=0;u<n.length;u++){var c=n[u].bytes;if(c){var f=this.extractCea608Data(c);s.addData(n[u].pts,f[0]),o.addData(n[u].pts,f[1])}}}},d.onBufferFlushing=function(t,r){var s=r.startOffset,o=r.endOffset,l=r.endOffsetSubtitles,n=r.type,u=this.media;if(u&&!(u.currentTime<o)){if(!n||n==="video"){var c=this.captionsTracks;Object.keys(c).forEach(function(v){return Ft(c[v],s,o)})}if(this.config.renderTextTracksNatively&&s===0&&l!==void 0){var f=this.textTracks;Object.keys(f).forEach(function(v){return Ft(f[v],s,l)})}}},d.extractCea608Data=function(t){for(var r=[[],[]],s=31&t[0],o=2,l=0;l<s;l++){var n=t[o++],u=127&t[o++],c=127&t[o++];if((u!==0||c!==0)&&4&n){var f=3&n;f!==0&&f!==1||(r[f].push(u),r[f].push(c))}}return r},p}();function Kh(p,d){return p&&p.label===d.name&&!(p.textTrack1||p.textTrack2)}function qh(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}const Wh=function(){function p(s){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=s,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var d,t,r=p.prototype;return r.setStreamController=function(s){this.streamController=s},r.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},r.registerListeners=function(){var s=this.hls;s.on(g.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.on(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.on(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.on(g.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},r.unregisterListener=function(){var s=this.hls;s.off(g.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.off(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.off(g.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.off(g.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},r.onFpsDropLevelCapping=function(s,o){p.isLevelAllowed(o.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(o.droppedLevel)},r.onMediaAttaching=function(s,o){this.media=o.media instanceof HTMLVideoElement?o.media:null,this.clientRect=null},r.onManifestParsed=function(s,o){var l=this.hls;this.restrictedLevels=[],this.firstLevel=o.firstLevel,l.config.capLevelToPlayerSize&&o.video&&this.startCapping()},r.onBufferCodecs=function(s,o){this.hls.config.capLevelToPlayerSize&&o.video&&this.startCapping()},r.onMediaDetaching=function(){this.stopCapping()},r.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var s=this.hls.levels;if(s.length){var o=this.hls;o.autoLevelCapping=this.getMaxLevel(s.length-1),o.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=o.autoLevelCapping}}},r.getMaxLevel=function(s){var o=this,l=this.hls.levels;if(!l.length)return-1;var n=l.filter(function(u,c){return p.isLevelAllowed(c,o.restrictedLevels)&&c<=s});return this.clientRect=null,p.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},r.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},r.getDimensions=function(){if(this.clientRect)return this.clientRect;var s=this.media,o={width:0,height:0};if(s){var l=s.getBoundingClientRect();o.width=l.width,o.height=l.height,o.width||o.height||(o.width=l.right-l.left||s.width||0,o.height=l.bottom-l.top||s.height||0)}return this.clientRect=o,o},p.isLevelAllowed=function(s,o){return o===void 0&&(o=[]),o.indexOf(s)===-1},p.getMaxLevelByMediaSize=function(s,o,l){if(!s||!s.length)return-1;for(var n,u,c=s.length-1,f=0;f<s.length;f+=1){var v=s[f];if((v.width>=o||v.height>=l)&&(n=v,!(u=s[f+1])||n.width!==u.width||n.height!==u.height)){c=f;break}}return c},d=p,(t=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var s=1;if(!this.hls.config.ignoreDevicePixelRatio)try{s=self.devicePixelRatio}catch{}return s}}])&&qh(d.prototype,t),Object.defineProperty(d,"prototype",{writable:!1}),p}(),$h=function(){function p(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}var d=p.prototype;return d.setStreamController=function(t){this.streamController=t},d.registerListeners=function(){this.hls.on(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},d.unregisterListeners=function(){this.hls.off(g.Events.MEDIA_ATTACHING,this.onMediaAttaching)},d.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},d.onMediaAttaching=function(t,r){var s=this.hls.config;if(s.capLevelOnFPSDrop){var o=r.media instanceof self.HTMLVideoElement?r.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}},d.checkFPS=function(t,r,s){var o=performance.now();if(r){if(this.lastTime){var l=o-this.lastTime,n=s-this.lastDroppedFrames,u=r-this.lastDecodedFrames,c=1e3*n/l,f=this.hls;if(f.trigger(g.Events.FPS_DROP,{currentDropped:n,currentDecoded:u,totalDroppedFrames:s}),c>0&&n>f.config.fpsDroppedMonitoringThreshold*u){var v=f.currentLevel;O.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+v),v>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=v)&&(v-=1,f.trigger(g.Events.FPS_DROP_LEVEL_CAPPING,{level:v,droppedLevel:f.currentLevel}),f.autoLevelCapping=v,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=s,this.lastDecodedFrames=r}},d.checkFPSInterval=function(){var t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){var r=t.getVideoPlaybackQuality();this.checkFPS(t,r.totalVideoFrames,r.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},p}();var rn=w(300);function Qs(p){var d=typeof Map=="function"?new Map:void 0;return Qs=function(t){if(t===null||(r=t,Function.toString.call(r).indexOf("[native code]")===-1))return t;var r;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(t))return d.get(t);d.set(t,s)}function s(){return Zs(t,arguments,Js(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Wn(s,t)},Qs(p)}function Zs(p,d,t){return Zs=Yh()?Reflect.construct.bind():function(r,s,o){var l=[null];l.push.apply(l,s);var n=new(Function.bind.apply(r,l));return o&&Wn(n,o.prototype),n},Zs.apply(null,arguments)}function Yh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wn(p,d){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Wn(p,d)}function Js(p){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},Js(p)}var xa="[eme]",Ll=function(){function p(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=p.CDMCleanupPromise?[p.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=O.logger.debug.bind(O.logger,xa),this.log=O.logger.log.bind(O.logger,xa),this.warn=O.logger.warn.bind(O.logger,xa),this.error=O.logger.error.bind(O.logger,xa),this.hls=t,this.config=t.config,this.registerListeners()}var d=p.prototype;return d.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},d.registerListeners=function(){this.hls.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},d.unregisterListeners=function(){this.hls.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},d.getLicenseServerUrl=function(t){var r=this.config,s=r.drmSystems,o=r.widevineLicenseUrl,l=s[t];if(l)return l.licenseUrl;if(t===Y.WIDEVINE&&o)return o;throw new Error('no license server URL configured for key-system "'+t+'"')},d.getServerCertificateUrl=function(t){var r=this.config.drmSystems[t];if(r)return r.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+t+'"]')},d.attemptKeySystemAccess=function(t){var r=this,s=this.hls.levels,o=function(u,c,f){return!!u&&f.indexOf(u)===c},l=s.map(function(u){return u.audioCodec}).filter(o),n=s.map(function(u){return u.videoCodec}).filter(o);return l.length+n.length===0&&n.push("avc1.42e01e"),new Promise(function(u,c){(function f(v){var b=v.shift();r.getMediaKeysPromise(b,l,n).then(function(D){return u({keySystem:b,mediaKeys:D})}).catch(function(D){v.length?f(v):c(D instanceof Jr?D:new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:D,fatal:!0},D.message))})})(t)})},d.requestMediaKeySystemAccess=function(t,r){var s=this.config.requestMediaKeySystemAccessFunc;if(typeof s!="function"){var o="Configured requestMediaKeySystemAccess is not a function "+s;return fe===null&&self.location.protocol==="http:"&&(o="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(o))}return s(t,r)},d.getMediaKeysPromise=function(t,r,s){var o=this,l=function(f,v,b,D){var C;switch(f){case Y.FAIRPLAY:C=["cenc","sinf"];break;case Y.WIDEVINE:case Y.PLAYREADY:C=["cenc"];break;case Y.CLEARKEY:C=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+f)}return function(F,q,K,ce){return[{initDataTypes:F,persistentState:ce.persistentState||"not-allowed",distinctiveIdentifier:ce.distinctiveIdentifier||"not-allowed",sessionTypes:ce.sessionTypes||[ce.sessionType||"temporary"],audioCapabilities:q.map(function(Se){return{contentType:'audio/mp4; codecs="'+Se+'"',robustness:ce.audioRobustness||"",encryptionScheme:ce.audioEncryptionScheme||null}}),videoCapabilities:K.map(function(Se){return{contentType:'video/mp4; codecs="'+Se+'"',robustness:ce.videoRobustness||"",encryptionScheme:ce.videoEncryptionScheme||null}})}]}(C,v,b,D)}(t,r,s,this.config.drmSystemOptions),n=this.keySystemAccessPromises[t],u=n==null?void 0:n.keySystemAccess;if(!u){this.log('Requesting encrypted media "'+t+'" key-system access with config: '+JSON.stringify(l)),u=this.requestMediaKeySystemAccess(t,l);var c=this.keySystemAccessPromises[t]={keySystemAccess:u};return u.catch(function(f){o.log('Failed to obtain access to key-system "'+t+'": '+f)}),u.then(function(f){o.log('Access for key-system "'+f.keySystem+'" obtained');var v=o.fetchServerCertificate(t);return o.log('Create media-keys for "'+t+'"'),c.mediaKeys=f.createMediaKeys().then(function(b){return o.log('Media-keys created for "'+t+'"'),v.then(function(D){return D?o.setMediaKeysServerCertificate(b,t,D):b})}),c.mediaKeys.catch(function(b){o.error('Failed to create media-keys for "'+t+'"}: '+b)}),c.mediaKeys})}return u.then(function(){return n.mediaKeys})},d.createMediaKeySessionContext=function(t){var r=t.decryptdata,s=t.keySystem,o=t.mediaKeys;this.log('Creating key-system session "'+s+'" keyId: '+rn.default.hexDump(r.keyId||[]));var l=o.createSession(),n={decryptdata:r,keySystem:s,mediaKeys:o,mediaKeysSession:l,keyStatus:"status-pending"};return this.mediaKeySessions.push(n),n},d.renewKeySession=function(t){var r=t.decryptdata;if(r.pssh){var s=this.createMediaKeySessionContext(t),o=this.getKeyIdString(r);this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(s,"cenc",r.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)},d.getKeyIdString=function(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return rn.default.hexDump(t.keyId)},d.updateKeySession=function(t,r){var s,o=t.mediaKeysSession;return this.log('Updating key-session "'+o.sessionId+'" for keyID '+rn.default.hexDump(((s=t.decryptdata)===null||s===void 0?void 0:s.keyId)||[])+`
      } (data length: `+(r&&r.byteLength)+")"),o.update(r)},d.selectKeySystemFormat=function(t){var r=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+t.sn+" "+t.type+": "+t.level+") key formats "+r.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(r)),this.keyFormatPromise},d.getKeyFormatPromise=function(t){var r=this;return new Promise(function(s,o){var l=se(r.config),n=t.map(W).filter(function(u){return!!u&&l.indexOf(u)!==-1});return r.getKeySystemSelectionPromise(n).then(function(u){var c=u.keySystem,f=B(c);f?s(f):o(new Error('Unable to find format for key-system "'+c+'"'))}).catch(o)})},d.loadKey=function(t){var r=this,s=t.keyInfo.decryptdata,o=this.getKeyIdString(s),l="(keyId: "+o+' format: "'+s.keyFormat+'" method: '+s.method+" uri: "+s.uri+")";this.log("Starting session for key "+l);var n=this.keyIdToKeySessionPromise[o];return n||(n=this.keyIdToKeySessionPromise[o]=this.getKeySystemForKeyPromise(s).then(function(u){var c=u.keySystem,f=u.mediaKeys;return r.throwIfDestroyed(),r.log("Handle encrypted media sn: "+t.frag.sn+" "+t.frag.type+": "+t.frag.level+" using key "+l),r.attemptSetMediaKeys(c,f).then(function(){r.throwIfDestroyed();var v=r.createMediaKeySessionContext({keySystem:c,mediaKeys:f,decryptdata:s});return r.generateRequestWithPreferredKeySession(v,"cenc",s.pssh,"playlist-key")})})).catch(function(u){return r.handleError(u)}),n},d.throwIfDestroyed=function(t){if(!this.hls)throw new Error("invalid state")},d.handleError=function(t){this.hls&&(this.error(t.message),t instanceof Jr?this.hls.trigger(g.Events.ERROR,t.data):this.hls.trigger(g.Events.ERROR,{type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))},d.getKeySystemForKeyPromise=function(t){var r=this.getKeyIdString(t),s=this.keyIdToKeySessionPromise[r];if(!s){var o=W(t.keyFormat),l=o?[o]:se(this.config);return this.attemptKeySystemAccess(l)}return s},d.getKeySystemSelectionPromise=function(t){if(t.length||(t=se(this.config)),t.length===0)throw new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(t)},d._onMediaEncrypted=function(t){var r=this,s=t.initDataType,o=t.initData;if(this.debug('"'+t.type+'" event: init data type: "'+s+'"'),o!==null){var l,n;if(s==="sinf"&&this.config.drmSystems[Y.FAIRPLAY]){var u=(0,ne.bin2str)(new Uint8Array(o));try{var c=Q(JSON.parse(u).sinf),f=(0,ne.parseSinf)(new Uint8Array(c));if(!f)return;l=f.subarray(8,24),n=Y.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var v=(0,ne.parsePssh)(o);if(v===null)return;v.version===0&&v.systemId===Ae.WIDEVINE&&v.data&&(l=v.data.subarray(8,24)),n=function(Se){if(Se===Ae.WIDEVINE)return Y.WIDEVINE}(v.systemId)}if(n&&l){for(var b=rn.default.hexDump(l),D=this.keyIdToKeySessionPromise,C=this.mediaKeySessions,F=D[b],q=function(Se){var Ce=C[Se],Ie=Ce.decryptdata;if(Ie.pssh||!Ie.keyId)return"continue";var Pe=rn.default.hexDump(Ie.keyId);return b===Pe||Ie.uri.replace(/-/g,"").indexOf(b)!==-1?(F=D[Pe],delete D[Pe],Ie.pssh=new Uint8Array(o),Ie.keyId=l,F=D[b]=F.then(function(){return r.generateRequestWithPreferredKeySession(Ce,s,o,"encrypted-event-key-match")}),"break"):void 0},K=0;K<C.length;K++){var ce=q(K);if(ce!=="continue"&&ce==="break")break}F||(F=D[b]=this.getKeySystemSelectionPromise([n]).then(function(Se){var Ce,Ie=Se.keySystem,Pe=Se.mediaKeys;r.throwIfDestroyed();var Qe=new He("ISO-23001-7",b,(Ce=B(Ie))!=null?Ce:"");return Qe.pssh=new Uint8Array(o),Qe.keyId=l,r.attemptSetMediaKeys(Ie,Pe).then(function(){r.throwIfDestroyed();var st=r.createMediaKeySessionContext({decryptdata:Qe,keySystem:Ie,mediaKeys:Pe});return r.generateRequestWithPreferredKeySession(st,s,o,"encrypted-event-no-match")})})),F.catch(function(Se){return r.handleError(Se)})}}},d._onWaitingForKey=function(t){this.log('"'+t.type+'" event')},d.attemptSetMediaKeys=function(t,r){var s=this,o=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+t+'"');var l=Promise.all(o).then(function(){if(!s.media)throw new Error("Attempted to set mediaKeys without media element attached");return s.media.setMediaKeys(r)});return this.setMediaKeysQueue.push(l),l.then(function(){s.log('Media-keys set for "'+t+'"'),o.push(l),s.setMediaKeysQueue=s.setMediaKeysQueue.filter(function(n){return o.indexOf(n)===-1})})},d.generateRequestWithPreferredKeySession=function(t,r,s,o){var l,n,u=this,c=(l=this.config.drmSystems)===null||l===void 0||(n=l[t.keySystem])===null||n===void 0?void 0:n.generateRequest;if(c)try{var f=c.call(this.hls,r,s,t);if(!f)throw new Error("Invalid response from configured generateRequest filter");r=f.initDataType,s=t.decryptdata.pssh=f.initData?new Uint8Array(f.initData):null}catch(F){var v;if(this.warn(F.message),(v=this.hls)!==null&&v!==void 0&&v.config.debug)throw F}if(s===null)return this.log('Skipping key-session request for "'+o+'" (no initData)'),Promise.resolve(t);var b=this.getKeyIdString(t.decryptdata);this.log('Generating key-session request for "'+o+'": '+b+" (init data type: "+r+" length: "+(s?s.byteLength:null)+")");var D=new(Un());t.mediaKeysSession.onmessage=function(F){var q=t.mediaKeysSession;if(q){var K=F.messageType,ce=F.message;u.log('"'+K+'" message event for session "'+q.sessionId+'" message size: '+ce.byteLength),K==="license-request"||K==="license-renewal"?u.renewLicense(t,ce).catch(function(Se){u.handleError(Se),D.emit("error",Se)}):K==="license-release"?t.keySystem===Y.FAIRPLAY&&(u.updateKeySession(t,L("acknowledged")),u.removeSession(t)):u.warn('unhandled media key message type "'+K+'"')}else D.emit("error",new Error("invalid state"))},t.mediaKeysSession.onkeystatuseschange=function(F){if(t.mediaKeysSession){u.onKeyStatusChange(t);var q=t.keyStatus;D.emit("keyStatus",q),q==="expired"&&(u.warn(t.keySystem+" expired for key "+b),u.renewKeySession(t))}else D.emit("error",new Error("invalid state"))};var C=new Promise(function(F,q){D.on("error",q),D.on("keyStatus",function(K){K.startsWith("usable")?F():K==="output-restricted"?q(new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):K==="internal-error"?q(new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+K+'"')):K==="expired"?q(new Error("key expired while generating request")):u.warn('unhandled key status change "'+K+'"')})});return t.mediaKeysSession.generateRequest(r,s).then(function(){var F;u.log('Request generated for key-session "'+((F=t.mediaKeysSession)===null||F===void 0?void 0:F.sessionId)+'" keyId: '+b)}).catch(function(F){throw new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:F,fatal:!1},"Error generating key-session request: "+F)}).then(function(){return C}).catch(function(F){throw D.removeAllListeners(),u.removeSession(t),F}).then(function(){return D.removeAllListeners(),t})},d.onKeyStatusChange=function(t){var r=this;t.mediaKeysSession.keyStatuses.forEach(function(s,o){r.log('key status change "'+s+'" for keyStatuses keyId: '+rn.default.hexDump("buffer"in o?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o))+" session keyId: "+rn.default.hexDump(new Uint8Array(t.decryptdata.keyId||[]))+" uri: "+t.decryptdata.uri),t.keyStatus=s})},d.fetchServerCertificate=function(t){var r=this;return new Promise(function(s,o){var l=r.getServerCertificateUrl(t);if(!l)return s();r.log('Fetching serverCertificate for "'+t+'"');var n=new XMLHttpRequest;n.open("GET",l,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(n.status===200?s(n.response):o(new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n},'"'+t+'" certificate request XHR failed ('+l+"). Status: "+n.status+" ("+n.statusText+")")))},n.send()})},d.setMediaKeysServerCertificate=function(t,r,s){var o=this;return new Promise(function(l,n){t.setServerCertificate(s).then(function(u){o.log("setServerCertificate "+(u?"success":"not supported by CDM")+" ("+(s==null?void 0:s.byteLength)+') on "'+r+'"'),l(t)}).catch(function(u){n(new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:u,fatal:!0},u.message))})})},d.renewLicense=function(t,r){var s=this;return this.requestLicense(t,new Uint8Array(r)).then(function(o){return s.updateKeySession(t,new Uint8Array(o)).catch(function(l){throw new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:l,fatal:!0},l.message)})})},d.setupLicenseXHR=function(t,r,s,o){var l=this,n=this.config.licenseXhrSetup;return n?Promise.resolve().then(function(){if(!s.decryptdata)throw new Error("Key removed");return n.call(l.hls,t,r,s,o)}).catch(function(u){if(!s.decryptdata)throw u;return t.open("POST",r,!0),n.call(l.hls,t,r,s,o)}).then(function(u){return t.readyState||t.open("POST",r,!0),{xhr:t,licenseChallenge:u||o}}):(t.open("POST",r,!0),Promise.resolve({xhr:t,licenseChallenge:o}))},d.requestLicense=function(t,r){var s=this;return new Promise(function(o,l){var n=s.getLicenseServerUrl(t.keySystem);s.log("Sending license request to URL: "+n);var u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=function(){if(!s.hls||!t.mediaKeysSession)return l(new Error("invalid state"));if(u.readyState===4)if(u.status===200){s._requestLicenseFailureCount=0;var c=u.response;s.log("License received "+(c instanceof ArrayBuffer?c.byteLength:c));var f=s.config.licenseResponseCallback;if(f)try{c=f.call(s.hls,u,n,t)}catch(b){s.error(b)}o(c)}else if(s._requestLicenseFailureCount++,s._requestLicenseFailureCount>3||u.status>=400&&u.status<500)l(new Jr({type:I.ErrorTypes.KEY_SYSTEM_ERROR,details:I.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u},"License Request XHR failed ("+n+"). Status: "+u.status+" ("+u.statusText+")"));else{var v=3-s._requestLicenseFailureCount+1;s.warn("Retrying license request, "+v+" attempts left"),s.requestLicense(t,r).then(o,l)}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=u,s.setupLicenseXHR(u,n,t,r).then(function(c){var f=c.xhr,v=c.licenseChallenge;f.send(v)})})},d.onMediaAttached=function(t,r){if(this.config.emeEnabled){var s=r.media;this.media=s,s.addEventListener("encrypted",this.onMediaEncrypted),s.addEventListener("waitingforkey",this.onWaitingForKey)}},d.onMediaDetached=function(){var t=this,r=this.media,s=this.mediaKeySessions;r&&(r.removeEventListener("encrypted",this.onMediaEncrypted),r.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},He.clearKeyUriToKeyIdMap();var o=s.length;p.CDMCleanupPromise=Promise.all(s.map(function(l){return t.removeSession(l)}).concat(r==null?void 0:r.setMediaKeys(null).catch(function(l){t.log("Could not clear media keys: "+l+". media.src: "+(r==null?void 0:r.src))}))).then(function(){o&&(t.log("finished closing key sessions and clearing media keys"),s.length=0)}).catch(function(l){t.log("Could not close sessions and clear media keys: "+l+". media.src: "+(r==null?void 0:r.src))})},d.onManifestLoaded=function(t,r){var s=r.sessionKeys;if(s&&this.config.emeEnabled&&!this.keyFormatPromise){var o=s.reduce(function(l,n){return l.indexOf(n.keyFormat)===-1&&l.push(n.keyFormat),l},[]);this.log("Selecting key-system from session-keys "+o.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(o)}},d.removeSession=function(t){var r=this,s=t.mediaKeysSession,o=t.licenseXhr;if(s){this.log("Remove licenses and keys and close session "+s.sessionId),s.onmessage=null,s.onkeystatuseschange=null,o&&o.readyState!==XMLHttpRequest.DONE&&o.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;var l=this.mediaKeySessions.indexOf(t);return l>-1&&this.mediaKeySessions.splice(l,1),s.remove().catch(function(n){r.log("Could not remove session: "+n)}).then(function(){return s.close()}).catch(function(n){r.log("Could not close session: "+n)})}},p}();Ll.CDMCleanupPromise=void 0;var Jr=function(p){var d,t;function r(s,o){var l;return(l=p.call(this,o)||this).data=void 0,l.data=s,s.err=s.error,l}return t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,Wn(d,t),r}(Qs(Error));const zh=Ll;var kr,eo,Rl;function Cl(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}function xl(p,d,t){return d&&Cl(p.prototype,d),t&&Cl(p,t),Object.defineProperty(p,"prototype",{writable:!1}),p}function Ol(p,d){var t=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(t)return(t=t.call(p)).next.bind(t);if(Array.isArray(p)||(t=function(s,o){if(s){if(typeof s=="string")return Ml(s,o);var l=Object.prototype.toString.call(s).slice(8,-1);return l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set"?Array.from(s):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?Ml(s,o):void 0}}(p))||d&&p&&typeof p.length=="number"){t&&(p=t);var r=0;return function(){return r>=p.length?{done:!0}:{done:!1,value:p[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ml(p,d){(d==null||d>p.length)&&(d=p.length);for(var t=0,r=new Array(d);t<d;t++)r[t]=p[t];return r}function Oa(){return Oa=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},Oa.apply(this,arguments)}(function(p){p.MANIFEST="m",p.AUDIO="a",p.VIDEO="v",p.MUXED="av",p.INIT="i",p.CAPTION="c",p.TIMED_TEXT="tt",p.KEY="k",p.OTHER="o"})(kr||(kr={})),function(p){p.DASH="d",p.HLS="h",p.SMOOTH="s",p.OTHER="o"}(eo||(eo={})),function(p){p.VOD="v",p.LIVE="l"}(Rl||(Rl={}));var Xh=function(){function p(t){var r=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){r.initialized&&(r.starved=!0),r.buffering=!0},this.onPlaying=function(){r.initialized||(r.initialized=!0),r.buffering=!1},this.applyPlaylistData=function(l){try{r.apply(l,{ot:kr.MANIFEST,su:!r.initialized})}catch(n){O.logger.warn("Could not generate manifest CMCD data.",n)}},this.applyFragmentData=function(l){try{var n=l.frag,u=r.hls.levels[n.level],c=r.getObjectType(n),f={d:1e3*n.duration,ot:c};c!==kr.VIDEO&&c!==kr.AUDIO&&c!=kr.MUXED||(f.br=u.bitrate/1e3,f.tb=r.getTopBandwidth(c)/1e3,f.bl=r.getBufferLength(c)),r.apply(l,f)}catch(v){O.logger.warn("Could not generate segment CMCD data.",v)}},this.hls=t;var s=this.config=t.config,o=s.cmcd;o!=null&&(s.pLoader=this.createPlaylistLoader(),s.fLoader=this.createFragmentLoader(),this.sid=o.sessionId||p.uuid(),this.cid=o.contentId,this.useHeaders=o.useHeaders===!0,this.registerListeners())}var d=p.prototype;return d.registerListeners=function(){var t=this.hls;t.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(g.Events.BUFFER_CREATED,this.onBufferCreated,this)},d.unregisterListeners=function(){var t=this.hls;t.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(g.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},d.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},d.onMediaAttached=function(t,r){this.media=r.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},d.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},d.onBufferCreated=function(t,r){var s,o;this.audioBuffer=(s=r.tracks.audio)===null||s===void 0?void 0:s.buffer,this.videoBuffer=(o=r.tracks.video)===null||o===void 0?void 0:o.buffer},d.createData=function(){var t;return{v:1,sf:eo.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},d.apply=function(t,r){r===void 0&&(r={}),Oa(r,this.createData());var s=r.ot===kr.INIT||r.ot===kr.VIDEO||r.ot===kr.MUXED;if(this.starved&&s&&(r.bs=!0,r.su=!0,this.starved=!1),r.su==null&&(r.su=this.buffering),this.useHeaders){var o=p.toHeaders(r);if(!Object.keys(o).length)return;t.headers||(t.headers={}),Oa(t.headers,o)}else{var l=p.toQuery(r);if(!l)return;t.url=p.appendQueryToUri(t.url,l)}},d.getObjectType=function(t){var r=t.type;return r==="subtitle"?kr.TIMED_TEXT:t.sn==="initSegment"?kr.INIT:r==="audio"?kr.AUDIO:r==="main"?this.hls.audioTracks.length?kr.VIDEO:kr.MUXED:void 0},d.getTopBandwidth=function(t){var r,s=0,o=this.hls;if(t===kr.AUDIO)r=o.audioTracks;else{var l=o.maxAutoLevel,n=l>-1?l+1:o.levels.length;r=o.levels.slice(0,n)}for(var u,c=Ol(r);!(u=c()).done;){var f=u.value;f.bitrate>s&&(s=f.bitrate)}return s>0?s:NaN},d.getBufferLength=function(t){var r=this.hls.media,s=t===kr.AUDIO?this.audioBuffer:this.videoBuffer;return s&&r?1e3*$t.bufferInfo(s,r.currentTime,this.config.maxBufferHole).len:NaN},d.createPlaylistLoader=function(){var t=this.config.pLoader,r=this.applyPlaylistData,s=t||this.config.loader;return function(){function o(n){this.loader=void 0,this.loader=new s(n)}var l=o.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(n,u,c){r(n),this.loader.load(n,u,c)},xl(o,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),o}()},d.createFragmentLoader=function(){var t=this.config.fLoader,r=this.applyFragmentData,s=t||this.config.loader;return function(){function o(n){this.loader=void 0,this.loader=new s(n)}var l=o.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(n,u,c){r(n),this.loader.load(n,u,c)},xl(o,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),o}()},p.uuid=function(){var t=URL.createObjectURL(new Blob),r=t.toString();return URL.revokeObjectURL(t),r.slice(r.lastIndexOf("/")+1)},p.serialize=function(t){for(var r,s=[],o=function(F){return!Number.isNaN(F)&&F!=null&&F!==""&&F!==!1},l=function(F){return Math.round(F)},n=function(F){return 100*l(F/100)},u={br:l,d:l,bl:n,dl:n,mtp:n,nor:function(F){return encodeURIComponent(F)},rtp:n,tb:l},c=Ol(Object.keys(t||{}).sort());!(r=c()).done;){var f=r.value,v=t[f];if(o(v)&&!(f==="v"&&v===1||f=="pr"&&v===1)){var b=u[f];b&&(v=b(v));var D,C=typeof v;D=f==="ot"||f==="sf"||f==="st"?f+"="+v:C==="boolean"?f:C==="number"?f+"="+v:f+"="+JSON.stringify(v),s.push(D)}}return s.join(",")},p.toHeaders=function(t){for(var r={},s=["Object","Request","Session","Status"],o=[{},{},{},{}],l={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},n=0,u=Object.keys(t);n<u.length;n++){var c=u[n];o[l[c]!=null?l[c]:1][c]=t[c]}for(var f=0;f<o.length;f++){var v=p.serialize(o[f]);v&&(r["CMCD-"+s[f]]=v)}return r},p.toQuery=function(t){return"CMCD="+encodeURIComponent(p.serialize(t))},p.appendQueryToUri=function(t,r){if(!r)return t;var s=t.includes("?")?"&":"?";return""+t+s+r},p}(),Pl=w(408),Qh=/^age:\s*[\d.]+\s*$/m;const Ul=function(){function p(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t?t.xhrSetup:null,this.stats=new Pl.LoadStats,this.retryDelay=0}var d=p.prototype;return d.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},d.abortInternal=function(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))},d.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!==null&&t!==void 0&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},d.load=function(t,r,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=r,this.callbacks=s,this.retryDelay=r.retryDelay,this.loadInternal()},d.loadInternal=function(){var t=this.config,r=this.context;if(t){var s=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0;var l=this.xhrSetup;try{if(l)try{l(s,r.url)}catch{s.open("GET",r.url,!0),l(s,r.url)}s.readyState||s.open("GET",r.url,!0);var n=this.context.headers;if(n)for(var u in n)s.setRequestHeader(u,n[u])}catch(c){return void this.callbacks.onError({code:s.status,text:c.message},r,s)}r.rangeEnd&&s.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),s.onreadystatechange=this.readystatechange.bind(this),s.onprogress=this.loadprogress.bind(this),s.responseType=r.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.timeout),s.send()}},d.readystatechange=function(){var t=this.context,r=this.loader,s=this.stats;if(t&&r){var o=r.readyState,l=this.config;if(!s.aborted&&o>=2)if(self.clearTimeout(this.requestTimeout),s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start)),o===4){r.onreadystatechange=null,r.onprogress=null;var n=r.status,u=r.responseType==="arraybuffer";if(n>=200&&n<300&&(u&&r.response||r.responseText!==null)){var c,f;if(s.loading.end=Math.max(self.performance.now(),s.loading.first),f=u?(c=r.response).byteLength:(c=r.responseText).length,s.loaded=s.total=f,!this.callbacks)return;var v=this.callbacks.onProgress;if(v&&v(s,t,c,r),!this.callbacks)return;var b={url:r.responseURL,data:c};this.callbacks.onSuccess(b,s,t,r)}else s.retry>=l.maxRetry||n>=400&&n<499?(O.logger.error(n+" while loading "+t.url),this.callbacks.onError({code:n,text:r.statusText},t,r)):(O.logger.warn(n+" while loading "+t.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,l.maxRetryDelay),s.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),l.timeout)}},d.loadtimeout=function(){O.logger.warn("timeout while loading "+this.context.url);var t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))},d.loadprogress=function(t){var r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total)},d.getCacheAge=function(){var t=null;if(this.loader&&Qh.test(this.loader.getAllResponseHeaders())){var r=this.loader.getResponseHeader("age");t=r?parseFloat(r):null}return t},p}();function to(p){var d=typeof Map=="function"?new Map:void 0;return to=function(t){if(t===null||(r=t,Function.toString.call(r).indexOf("[native code]")===-1))return t;var r;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(t))return d.get(t);d.set(t,s)}function s(){return ro(t,arguments,io(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),$n(s,t)},to(p)}function ro(p,d,t){return ro=Zh()?Reflect.construct.bind():function(r,s,o){var l=[null];l.push.apply(l,s);var n=new(Function.bind.apply(r,l));return o&&$n(n,o.prototype),n},ro.apply(null,arguments)}function Zh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $n(p,d){return $n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},$n(p,d)}function io(p){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},io(p)}function no(){return no=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},no.apply(this,arguments)}var Jh=function(){function p(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||ef,this.controller=new self.AbortController,this.stats=new Pl.LoadStats}var d=p.prototype;return d.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},d.abortInternal=function(){var t=this.response;t&&t.ok||(this.stats.aborted=!0,this.controller.abort())},d.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!==null&&t!==void 0&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},d.load=function(t,r,s){var o=this,l=this.stats;if(l.loading.start)throw new Error("Loader can only be used once.");l.loading.start=self.performance.now();var n=function(v,b){var D={method:"GET",mode:"cors",credentials:"same-origin",signal:b,headers:new self.Headers(no({},v.headers))};return v.rangeEnd&&D.headers.set("Range","bytes="+v.rangeStart+"-"+String(v.rangeEnd-1)),D}(t,this.controller.signal),u=s.onProgress,c=t.responseType==="arraybuffer",f=c?"byteLength":"length";this.context=t,this.config=r,this.callbacks=s,this.request=this.fetchSetup(t,n),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){o.abortInternal(),s.onTimeout(l,t,o.response)},r.timeout),self.fetch(this.request).then(function(v){if(o.response=o.loader=v,!v.ok){var b=v.status,D=v.statusText;throw new tf(D||"fetch, bad network response",b,v)}return l.loading.first=Math.max(self.performance.now(),l.loading.start),l.total=parseInt(v.headers.get("Content-Length")||"0"),u&&(0,P.isFiniteNumber)(r.highWaterMark)?o.loadProgressively(v,l,t,r.highWaterMark,u):c?v.arrayBuffer():v.text()}).then(function(v){var b=o.response;self.clearTimeout(o.requestTimeout),l.loading.end=Math.max(self.performance.now(),l.loading.first);var D=v[f];D&&(l.loaded=l.total=D);var C={url:b.url,data:v};u&&!(0,P.isFiniteNumber)(r.highWaterMark)&&u(l,t,v,b),s.onSuccess(C,l,t,b)}).catch(function(v){if(self.clearTimeout(o.requestTimeout),!l.aborted){var b=v&&v.code||0,D=v?v.message:null;s.onError({code:b,text:D},t,v?v.details:null)}})},d.getCacheAge=function(){var t=null;if(this.response){var r=this.response.headers.get("age");t=r?parseFloat(r):null}return t},d.loadProgressively=function(t,r,s,o,l){o===void 0&&(o=0);var n=new Ia,u=t.body.getReader();return function c(){return u.read().then(function(f){if(f.done)return n.dataLength&&l(r,s,n.flush(),t),Promise.resolve(new ArrayBuffer(0));var v=f.value,b=v.length;return r.loaded+=b,b<o||n.dataLength?(n.push(v),n.dataLength>=o&&l(r,s,n.flush(),t)):l(r,s,v,t),c()}).catch(function(){return Promise.reject()})}()},p}();function ef(p,d){return new self.Request(p.url,d)}var tf=function(p){var d,t;function r(s,o,l){var n;return(n=p.call(this,s)||this).code=void 0,n.details=void 0,n.code=o,n.details=l,n}return t=p,(d=r).prototype=Object.create(t.prototype),d.prototype.constructor=d,$n(d,t),r}(to(Error));const Fl=Jh;var rf=/\s/;function ao(){return ao=Object.assign?Object.assign.bind():function(p){for(var d=1;d<arguments.length;d++){var t=arguments[d];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(p[r]=t[r])}return p},ao.apply(this,arguments)}function Nl(p,d){var t=Object.keys(p);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(p);d&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(p,s).enumerable})),t.push.apply(t,r)}return t}function Bl(p){for(var d=1;d<arguments.length;d++){var t=arguments[d]!=null?arguments[d]:{};d%2?Nl(Object(t),!0).forEach(function(r){nf(p,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(t)):Nl(Object(t)).forEach(function(r){Object.defineProperty(p,r,Object.getOwnPropertyDescriptor(t,r))})}return p}function nf(p,d,t){return(d=function(r){var s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r,"string");return typeof s=="symbol"?s:String(s)}(d))in p?Object.defineProperty(p,d,{value:t,enumerable:!0,configurable:!0,writable:!0}):p[d]=t,p}var af=Bl(Bl({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ul,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Gs,bufferController:S,capLevelController:Wh,fpsController:$h,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:fe,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:{newCue:function(p,d,t,r){for(var s,o,l,n,u,c=[],f=self.VTTCue||self.TextTrackCue,v=0;v<r.rows.length;v++)if(l=!0,n=0,u="",!(s=r.rows[v]).isEmpty()){for(var b=0;b<s.chars.length;b++)rf.test(s.chars[b].uchar)&&l?n++:(u+=s.chars[b].uchar,l=!1);s.cueStartTime=d,d===t&&(t+=1e-4),n>=16?n--:n++;var D=mr(u.trim()),C=xr(d,t,D);p&&p.cues&&p.cues.getCueById(C)||((o=new f(d,t,D)).id=C,o.line=v+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*n/32)),c.push(o))}return p&&c.length&&(c.sort(function(F,q){return F.line==="auto"||q.line==="auto"?0:F.line>8&&q.line>8?q.line-F.line:F.line-q.line}),c.forEach(function(F){return mt(p,F)})),c}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:qs,subtitleTrackController:La,timelineController:Vh,audioStreamController:Da,audioTrackController:Vs,emeController:zh,cmcdController:Xh});function Hl(p,d){for(var t=0;t<d.length;t++){var r=d[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(p,typeof(s=function(o,l){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var u=n.call(o,l);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key,"string"))=="symbol"?s:String(s),r)}var s}var jl=function(){function p(o){o===void 0&&(o={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new _i.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var l=this.config=function(xe,ze){if((ze.liveSyncDurationCount||ze.liveMaxLatencyDurationCount)&&(ze.liveSyncDuration||ze.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(ze.liveMaxLatencyDurationCount!==void 0&&(ze.liveSyncDurationCount===void 0||ze.liveMaxLatencyDurationCount<=ze.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(ze.liveMaxLatencyDuration!==void 0&&(ze.liveSyncDuration===void 0||ze.liveMaxLatencyDuration<=ze.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return ao({},xe,ze)}(p.DefaultConfig,o);this.userConfig=o,(0,O.enableLogs)(l.debug,"Hls instance"),this._autoLevelCapping=-1,l.progressive&&function(xe){var ze=xe.loader;ze!==Fl&&ze!==Ul?(O.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),xe.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(xe.loader=Fl,xe.progressive=!0,xe.enableSoftwareAES=!0,O.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}(l);var n=l.abrController,u=l.bufferController,c=l.capLevelController,f=l.fpsController,v=this.abrController=new n(this),b=this.bufferController=new u(this),D=this.capLevelController=new c(this),C=new f(this),F=new Xe(this),q=new Pt(this),K=this.levelController=new Et(this),ce=new Ut(this),Se=new Cr(this.config),Ce=this.streamController=new Bs(this,ce,Se);D.setStreamController(Ce),C.setStreamController(Ce);var Ie=[F,K,Ce];this.networkControllers=Ie;var Pe=[v,b,D,C,q,ce];this.audioTrackController=this.createController(l.audioTrackController,Ie);var Qe=l.audioStreamController;Qe&&Ie.push(new Qe(this,ce,Se)),this.subtitleTrackController=this.createController(l.subtitleTrackController,Ie);var st=l.subtitleStreamController;st&&Ie.push(new st(this,ce,Se)),this.createController(l.timelineController,Pe),Se.emeController=this.emeController=this.createController(l.emeController,Pe),this.cmcdController=this.createController(l.cmcdController,Pe),this.latencyController=this.createController(qt,Pe),this.coreComponents=Pe}p.isSupported=function(){return function(){var o=Zi();if(!o)return!1;var l=wa(),n=o&&typeof o.isTypeSupported=="function"&&o.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),u=!l||l.prototype&&typeof l.prototype.appendBuffer=="function"&&typeof l.prototype.remove=="function";return!!n&&!!u}()};var d,t,r,s=p.prototype;return s.createController=function(o,l){if(o){var n=new o(this);return l&&l.push(n),n}return null},s.on=function(o,l,n){n===void 0&&(n=this),this._emitter.on(o,l,n)},s.once=function(o,l,n){n===void 0&&(n=this),this._emitter.once(o,l,n)},s.removeAllListeners=function(o){this._emitter.removeAllListeners(o)},s.off=function(o,l,n,u){n===void 0&&(n=this),this._emitter.off(o,l,n,u)},s.listeners=function(o){return this._emitter.listeners(o)},s.emit=function(o,l,n){return this._emitter.emit(o,l,n)},s.trigger=function(o,l){if(this.config.debug)return this.emit(o,o,l);try{return this.emit(o,o,l)}catch(n){O.logger.error("An internal error happened while handling event "+o+'. Error message: "'+n.message+'". Here is a stacktrace:',n),this.trigger(g.Events.ERROR,{type:I.ErrorTypes.OTHER_ERROR,details:I.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:o,error:n})}return!1},s.listenerCount=function(o){return this._emitter.listenerCount(o)},s.destroy=function(){O.logger.log("destroy"),this.trigger(g.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(o){return o.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(o){return o.destroy()}),this.coreComponents.length=0},s.attachMedia=function(o){O.logger.log("attachMedia"),this._media=o,this.trigger(g.Events.MEDIA_ATTACHING,{media:o})},s.detachMedia=function(){O.logger.log("detachMedia"),this.trigger(g.Events.MEDIA_DETACHING,void 0),this._media=null},s.loadSource=function(o){this.stopLoad();var l=this.media,n=this.url,u=this.url=x.buildAbsoluteURL(self.location.href,o,{alwaysNormalize:!0});O.logger.log("loadSource:"+u),l&&n&&n!==u&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(l)),this.trigger(g.Events.MANIFEST_LOADING,{url:o})},s.startLoad=function(o){o===void 0&&(o=-1),O.logger.log("startLoad("+o+")"),this.networkControllers.forEach(function(l){l.startLoad(o)})},s.stopLoad=function(){O.logger.log("stopLoad"),this.networkControllers.forEach(function(o){o.stopLoad()})},s.swapAudioCodec=function(){O.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},s.recoverMediaError=function(){O.logger.log("recoverMediaError");var o=this._media;this.detachMedia(),o&&this.attachMedia(o)},s.removeLevel=function(o,l){l===void 0&&(l=0),this.levelController.removeLevel(o,l)},d=p,r=[{key:"version",get:function(){return"1.3.1"}},{key:"Events",get:function(){return g.Events}},{key:"ErrorTypes",get:function(){return I.ErrorTypes}},{key:"ErrorDetails",get:function(){return I.ErrorDetails}},{key:"DefaultConfig",get:function(){return p.defaultConfig?p.defaultConfig:af},set:function(o){p.defaultConfig=o}}],(t=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(o){O.logger.log("set currentLevel:"+o),this.loadLevel=o,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(o){O.logger.log("set nextLevel:"+o),this.levelController.manualLevel=o,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(o){O.logger.log("set loadLevel:"+o),this.levelController.manualLevel=o}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(o){this.levelController.nextLoadLevel=o}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(o){O.logger.log("set firstLevel:"+o),this.levelController.firstLevel=o}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(o){O.logger.log("set startLevel:"+o),o!==-1&&(o=Math.max(o,this.minAutoLevel)),this.levelController.startLevel=o}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(o){var l=!!o;l!==this.config.capLevelToPlayerSize&&(l?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=l)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(o){this._autoLevelCapping!==o&&(O.logger.log("set autoLevelCapping:"+o),this._autoLevelCapping=o)}},{key:"bandwidthEstimate",get:function(){var o=this.abrController.bwEstimator;return o?o.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(o){Lr.indexOf(o)>-1&&(this._maxHdcpLevel=o)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var o=this.levels,l=this.config.minAutoBitrate;if(!o)return 0;for(var n=o.length,u=0;u<n;u++)if(o[u].maxBitrate>=l)return u;return 0}},{key:"maxAutoLevel",get:function(){var o,l=this.levels,n=this.autoLevelCapping,u=this.maxHdcpLevel;if(o=n===-1&&l&&l.length?l.length-1:n,u)for(var c=o;c--;){var f=l[c].attrs["HDCP-LEVEL"];if(f&&f<=u)return c}return o}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(o){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,o)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var o=this.audioTrackController;return o?o.audioTracks:[]}},{key:"audioTrack",get:function(){var o=this.audioTrackController;return o?o.audioTrack:-1},set:function(o){var l=this.audioTrackController;l&&(l.audioTrack=o)}},{key:"subtitleTracks",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTrack:-1},set:function(o){var l=this.subtitleTrackController;l&&(l.subtitleTrack=o)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var o=this.subtitleTrackController;return!!o&&o.subtitleDisplay},set:function(o){var l=this.subtitleTrackController;l&&(l.subtitleDisplay=o)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(o){this.config.lowLatencyMode=o}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&Hl(d.prototype,t),r&&Hl(d,r),Object.defineProperty(d,"prototype",{writable:!1}),p}();jl.defaultConfig=void 0},923:(k,A,w)=>{w.r(A),w.d(A,{BaseSegment:()=>ye,ElementaryStreamTypes:()=>U,Fragment:()=>de,Part:()=>re});var U,x=w(965),P=w(945),g=w(408);function I(z,he){z.prototype=Object.create(he.prototype),z.prototype.constructor=z,O(z,he)}function O(z,he){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(G,Y){return G.__proto__=Y,G},O(z,he)}function X(z,he){for(var G=0;G<he.length;G++){var Y=he[G];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(z,typeof(me=function(Ae,ke){if(typeof Ae!="object"||Ae===null)return Ae;var Q=Ae[Symbol.toPrimitive];if(Q!==void 0){var L=Q.call(Ae,ke);if(typeof L!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ae)}(Y.key,"string"))=="symbol"?me:String(me),Y)}var me}function N(z,he,G){return he&&X(z.prototype,he),G&&X(z,G),Object.defineProperty(z,"prototype",{writable:!1}),z}(function(z){z.AUDIO="audio",z.VIDEO="video",z.AUDIOVIDEO="audiovideo"})(U||(U={}));var ye=function(){function z(he){var G;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((G={})[U.AUDIO]=null,G[U.VIDEO]=null,G[U.AUDIOVIDEO]=null,G),this.baseurl=he}return z.prototype.setByteRange=function(he,G){var Y=he.split("@",2),me=[];Y.length===1?me[0]=G?G.byteRangeEndOffset:0:me[0]=parseInt(Y[1]),me[1]=parseInt(Y[0])+me[0],this._byteRange=me},N(z,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,P.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(he){this._url=he}}]),z}(),de=function(z){function he(Y,me){var Ae;return(Ae=z.call(this,me)||this)._decryptdata=null,Ae.rawProgramDateTime=null,Ae.programDateTime=null,Ae.tagList=[],Ae.duration=0,Ae.sn=0,Ae.levelkeys=void 0,Ae.type=void 0,Ae.loader=null,Ae.keyLoader=null,Ae.level=-1,Ae.cc=0,Ae.startPTS=void 0,Ae.endPTS=void 0,Ae.appendedPTS=void 0,Ae.startDTS=void 0,Ae.endDTS=void 0,Ae.start=0,Ae.deltaPTS=void 0,Ae.maxStartPTS=void 0,Ae.minEndPTS=void 0,Ae.stats=new g.LoadStats,Ae.urlId=0,Ae.data=void 0,Ae.bitrateTest=!1,Ae.title=null,Ae.initSegment=null,Ae.endList=void 0,Ae.type=Y,Ae}I(he,z);var G=he.prototype;return G.setKeyFormat=function(Y){if(this.levelkeys){var me=this.levelkeys[Y];me&&!this._decryptdata&&(this._decryptdata=me.getDecryptData(this.sn))}},G.abortRequests=function(){var Y,me;(Y=this.loader)===null||Y===void 0||Y.abort(),(me=this.keyLoader)===null||me===void 0||me.abort()},G.setElementaryStreamInfo=function(Y,me,Ae,ke,Q,L){L===void 0&&(L=!1);var W=this.elementaryStreams,B=W[Y];B?(B.startPTS=Math.min(B.startPTS,me),B.endPTS=Math.max(B.endPTS,Ae),B.startDTS=Math.min(B.startDTS,ke),B.endDTS=Math.max(B.endDTS,Q)):W[Y]={startPTS:me,endPTS:Ae,startDTS:ke,endDTS:Q,partial:L}},G.clearElementaryStreamInfo=function(){var Y=this.elementaryStreams;Y[U.AUDIO]=null,Y[U.VIDEO]=null,Y[U.AUDIOVIDEO]=null},N(he,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var Y=this.levelkeys.identity;if(Y)this._decryptdata=Y.getDecryptData(this.sn);else{var me=Object.keys(this.levelkeys);if(me.length===1)return this._decryptdata=this.levelkeys[me[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,x.isFiniteNumber)(this.programDateTime))return null;var Y=(0,x.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*Y}},{key:"encrypted",get:function(){var Y;if((Y=this._decryptdata)!==null&&Y!==void 0&&Y.encrypted)return!0;if(this.levelkeys){var me=Object.keys(this.levelkeys),Ae=me.length;if(Ae>1||Ae===1&&this.levelkeys[me[0]].encrypted)return!0}return!1}}]),he}(ye),re=function(z){function he(G,Y,me,Ae,ke){var Q;(Q=z.call(this,me)||this).fragOffset=0,Q.duration=0,Q.gap=!1,Q.independent=!1,Q.relurl=void 0,Q.fragment=void 0,Q.index=void 0,Q.stats=new g.LoadStats,Q.duration=G.decimalFloatingPoint("DURATION"),Q.gap=G.bool("GAP"),Q.independent=G.bool("INDEPENDENT"),Q.relurl=G.enumeratedString("URI"),Q.fragment=Y,Q.index=Ae;var L=G.enumeratedString("BYTERANGE");return L&&Q.setByteRange(L,ke),ke&&(Q.fragOffset=ke.fragOffset+ke.duration),Q}return I(he,z),N(he,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var G=this.elementaryStreams;return!!(G.audio||G.video||G.audiovideo)}}]),he}(ye)},408:(k,A,w)=>{w.r(A),w.d(A,{LoadStats:()=>U});var U=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},965:(k,A,w)=>{w.r(A),w.d(A,{MAX_SAFE_INTEGER:()=>x,isFiniteNumber:()=>U});var U=Number.isFinite||function(P){return typeof P=="number"&&isFinite(P)},x=Number.MAX_SAFE_INTEGER||9007199254740991},524:(k,A,w)=>{w.r(A),w.d(A,{default:()=>G,flushTextTrackMetadataCueSamples:()=>me,flushTextTrackUserdataCueSamples:()=>Ae,normalizePts:()=>Y});var U=w(965);const x=function(){function L(){}return L.getSilentFrame=function(W,B){if(W==="mp4a.40.2"){if(B===1)return new Uint8Array([0,200,0,128,35,128]);if(B===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(B===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(B===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(B===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(B===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(B===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(B===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(B===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},L}();var P=Math.pow(2,32)-1,g=function(){function L(){}return L.init=function(){var W;for(W in L.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},L.types)L.types.hasOwnProperty(W)&&(L.types[W]=[W.charCodeAt(0),W.charCodeAt(1),W.charCodeAt(2),W.charCodeAt(3)]);var B=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),se=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);L.HDLR_TYPES={video:B,audio:se};var fe=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ne=new Uint8Array([0,0,0,0,0,0,0,0]);L.STTS=L.STSC=L.STCO=ne,L.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),L.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),L.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),L.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var Te=new Uint8Array([105,115,111,109]),He=new Uint8Array([97,118,99,49]),le=new Uint8Array([0,0,0,1]);L.FTYP=L.box(L.types.ftyp,Te,le,Te,He),L.DINF=L.box(L.types.dinf,L.box(L.types.dref,fe))},L.box=function(W){for(var B=8,se=arguments.length,fe=new Array(se>1?se-1:0),ne=1;ne<se;ne++)fe[ne-1]=arguments[ne];for(var Te=fe.length,He=Te;Te--;)B+=fe[Te].byteLength;var le=new Uint8Array(B);for(le[0]=B>>24&255,le[1]=B>>16&255,le[2]=B>>8&255,le[3]=255&B,le.set(W,4),Te=0,B=8;Te<He;Te++)le.set(fe[Te],B),B+=fe[Te].byteLength;return le},L.hdlr=function(W){return L.box(L.types.hdlr,L.HDLR_TYPES[W])},L.mdat=function(W){return L.box(L.types.mdat,W)},L.mdhd=function(W,B){B*=W;var se=Math.floor(B/(P+1)),fe=Math.floor(B%(P+1));return L.box(L.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,W>>24&255,W>>16&255,W>>8&255,255&W,se>>24,se>>16&255,se>>8&255,255&se,fe>>24,fe>>16&255,fe>>8&255,255&fe,85,196,0,0]))},L.mdia=function(W){return L.box(L.types.mdia,L.mdhd(W.timescale,W.duration),L.hdlr(W.type),L.minf(W))},L.mfhd=function(W){return L.box(L.types.mfhd,new Uint8Array([0,0,0,0,W>>24,W>>16&255,W>>8&255,255&W]))},L.minf=function(W){return W.type==="audio"?L.box(L.types.minf,L.box(L.types.smhd,L.SMHD),L.DINF,L.stbl(W)):L.box(L.types.minf,L.box(L.types.vmhd,L.VMHD),L.DINF,L.stbl(W))},L.moof=function(W,B,se){return L.box(L.types.moof,L.mfhd(W),L.traf(se,B))},L.moov=function(W){for(var B=W.length,se=[];B--;)se[B]=L.trak(W[B]);return L.box.apply(null,[L.types.moov,L.mvhd(W[0].timescale,W[0].duration)].concat(se).concat(L.mvex(W)))},L.mvex=function(W){for(var B=W.length,se=[];B--;)se[B]=L.trex(W[B]);return L.box.apply(null,[L.types.mvex].concat(se))},L.mvhd=function(W,B){B*=W;var se=Math.floor(B/(P+1)),fe=Math.floor(B%(P+1)),ne=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,W>>24&255,W>>16&255,W>>8&255,255&W,se>>24,se>>16&255,se>>8&255,255&se,fe>>24,fe>>16&255,fe>>8&255,255&fe,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return L.box(L.types.mvhd,ne)},L.sdtp=function(W){var B,se,fe=W.samples||[],ne=new Uint8Array(4+fe.length);for(B=0;B<fe.length;B++)se=fe[B].flags,ne[B+4]=se.dependsOn<<4|se.isDependedOn<<2|se.hasRedundancy;return L.box(L.types.sdtp,ne)},L.stbl=function(W){return L.box(L.types.stbl,L.stsd(W),L.box(L.types.stts,L.STTS),L.box(L.types.stsc,L.STSC),L.box(L.types.stsz,L.STSZ),L.box(L.types.stco,L.STCO))},L.avc1=function(W){var B,se,fe,ne=[],Te=[];for(B=0;B<W.sps.length;B++)fe=(se=W.sps[B]).byteLength,ne.push(fe>>>8&255),ne.push(255&fe),ne=ne.concat(Array.prototype.slice.call(se));for(B=0;B<W.pps.length;B++)fe=(se=W.pps[B]).byteLength,Te.push(fe>>>8&255),Te.push(255&fe),Te=Te.concat(Array.prototype.slice.call(se));var He=L.box(L.types.avcC,new Uint8Array([1,ne[3],ne[4],ne[5],255,224|W.sps.length].concat(ne).concat([W.pps.length]).concat(Te))),le=W.width,ae=W.height,we=W.pixelRatio[0],Ke=W.pixelRatio[1];return L.box(L.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,le>>8&255,255&le,ae>>8&255,255&ae,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),He,L.box(L.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),L.box(L.types.pasp,new Uint8Array([we>>24,we>>16&255,we>>8&255,255&we,Ke>>24,Ke>>16&255,Ke>>8&255,255&Ke])))},L.esds=function(W){var B=W.config.length;return new Uint8Array([0,0,0,0,3,23+B,0,1,0,4,15+B,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([B]).concat(W.config).concat([6,1,2]))},L.mp4a=function(W){var B=W.samplerate;return L.box(L.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,W.channelCount,0,16,0,0,0,0,B>>8&255,255&B,0,0]),L.box(L.types.esds,L.esds(W)))},L.mp3=function(W){var B=W.samplerate;return L.box(L.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,W.channelCount,0,16,0,0,0,0,B>>8&255,255&B,0,0]))},L.stsd=function(W){return W.type==="audio"?W.segmentCodec==="mp3"&&W.codec==="mp3"?L.box(L.types.stsd,L.STSD,L.mp3(W)):L.box(L.types.stsd,L.STSD,L.mp4a(W)):L.box(L.types.stsd,L.STSD,L.avc1(W))},L.tkhd=function(W){var B=W.id,se=W.duration*W.timescale,fe=W.width,ne=W.height,Te=Math.floor(se/(P+1)),He=Math.floor(se%(P+1));return L.box(L.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,B>>24&255,B>>16&255,B>>8&255,255&B,0,0,0,0,Te>>24,Te>>16&255,Te>>8&255,255&Te,He>>24,He>>16&255,He>>8&255,255&He,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,fe>>8&255,255&fe,0,0,ne>>8&255,255&ne,0,0]))},L.traf=function(W,B){var se=L.sdtp(W),fe=W.id,ne=Math.floor(B/(P+1)),Te=Math.floor(B%(P+1));return L.box(L.types.traf,L.box(L.types.tfhd,new Uint8Array([0,0,0,0,fe>>24,fe>>16&255,fe>>8&255,255&fe])),L.box(L.types.tfdt,new Uint8Array([1,0,0,0,ne>>24,ne>>16&255,ne>>8&255,255&ne,Te>>24,Te>>16&255,Te>>8&255,255&Te])),L.trun(W,se.length+16+20+8+16+8+8),se)},L.trak=function(W){return W.duration=W.duration||4294967295,L.box(L.types.trak,L.tkhd(W),L.mdia(W))},L.trex=function(W){var B=W.id;return L.box(L.types.trex,new Uint8Array([0,0,0,0,B>>24,B>>16&255,B>>8&255,255&B,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},L.trun=function(W,B){var se,fe,ne,Te,He,le,ae=W.samples||[],we=ae.length,Ke=12+16*we,We=new Uint8Array(Ke);for(B+=8+Ke,We.set([W.type==="video"?1:0,0,15,1,we>>>24&255,we>>>16&255,we>>>8&255,255&we,B>>>24&255,B>>>16&255,B>>>8&255,255&B],0),se=0;se<we;se++)ne=(fe=ae[se]).duration,Te=fe.size,He=fe.flags,le=fe.cts,We.set([ne>>>24&255,ne>>>16&255,ne>>>8&255,255&ne,Te>>>24&255,Te>>>16&255,Te>>>8&255,255&Te,He.isLeading<<2|He.dependsOn,He.isDependedOn<<6|He.hasRedundancy<<4|He.paddingValue<<1|He.isNonSync,61440&He.degradPrio,15&He.degradPrio,le>>>24&255,le>>>16&255,le>>>8&255,255&le],12+16*se);return L.box(L.types.trun,We)},L.initSegment=function(W){L.types||L.init();var B=L.moov(W),se=new Uint8Array(L.FTYP.byteLength+B.byteLength);return se.set(L.FTYP),se.set(B,L.FTYP.byteLength),se},L}();g.types=void 0,g.HDLR_TYPES=void 0,g.STTS=void 0,g.STSC=void 0,g.STCO=void 0,g.STSZ=void 0,g.VMHD=void 0,g.SMHD=void 0,g.STSD=void 0,g.FTYP=void 0,g.DINF=void 0;const I=g;var O=w(851),X=w(973),N=w(93),ye=w(308),de=w(673);function re(){return re=Object.assign?Object.assign.bind():function(L){for(var W=1;W<arguments.length;W++){var B=arguments[W];for(var se in B)Object.prototype.hasOwnProperty.call(B,se)&&(L[se]=B[se])}return L},re.apply(this,arguments)}var z=null,he=null,G=function(){function L(B,se,fe,ne){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=B,this.config=se,this.typeSupported=fe,this.ISGenerated=!1,z===null){var Te=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);z=Te?parseInt(Te[1]):0}if(he===null){var He=navigator.userAgent.match(/Safari\/(\d+)/i);he=He?parseInt(He[1]):0}}var W=L.prototype;return W.destroy=function(){},W.resetTimeStamp=function(B){N.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=B},W.resetNextTimestamp=function(){N.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},W.resetInitSegment=function(){N.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},W.getVideoStartPts=function(B){var se=!1,fe=B.reduce(function(ne,Te){var He=Te.pts-ne;return He<-4294967296?(se=!0,Y(ne,Te.pts)):He>0?ne:Te.pts},B[0].pts);return se&&N.logger.debug("PTS rollover detected"),fe},W.remux=function(B,se,fe,ne,Te,He,le,ae){var we,Ke,We,ie,Ee,ue,Re=Te,Le=Te,Me=B.pid>-1,Oe=se.pid>-1,Be=se.samples.length,_e=B.samples.length>0,Ne=le&&Be>0||Be>1;if((!Me||_e)&&(!Oe||Ne)||this.ISGenerated||le){this.ISGenerated||(We=this.generateIS(B,se,Te));var Xe,at=this.isVideoContiguous,mt=-1;if(Ne&&(mt=function(Ot){for(var ht=0;ht<Ot.length;ht++)if(Ot[ht].key)return ht;return-1}(se.samples),!at&&this.config.forceKeyFrameOnDiscontinuity))if(ue=!0,mt>0){N.logger.warn("[mp4-remuxer]: Dropped "+mt+" out of "+Be+" video samples due to a missing keyframe");var gt=this.getVideoStartPts(se.samples);se.samples=se.samples.slice(mt),se.dropped+=mt,Xe=Le+=(se.samples[0].pts-gt)/se.inputTimeScale}else mt===-1&&(N.logger.warn("[mp4-remuxer]: No keyframe found out of "+Be+" video samples"),ue=!1);if(this.ISGenerated){if(_e&&Ne){var Ft=this.getVideoStartPts(se.samples),Mt=(Y(B.samples[0].pts,Ft)-Ft)/se.inputTimeScale;Re+=Math.max(0,Mt),Le+=Math.max(0,-Mt)}if(_e){if(B.samplerate||(N.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),We=this.generateIS(B,se,Te)),Ke=this.remuxAudio(B,Re,this.isAudioContiguous,He,Oe||Ne||ae===ye.PlaylistLevelType.AUDIO?Le:void 0),Ne){var xt=Ke?Ke.endPTS-Ke.startPTS:0;se.inputTimeScale||(N.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),We=this.generateIS(B,se,Te)),we=this.remuxVideo(se,Le,at,xt)}}else Ne&&(we=this.remuxVideo(se,Le,at,0));we&&(we.firstKeyFrame=mt,we.independent=mt!==-1,we.firstKeyFramePTS=Xe)}}return this.ISGenerated&&(fe.samples.length&&(Ee=me(fe,Te,this._initPTS,this._initDTS)),ne.samples.length&&(ie=Ae(ne,Te,this._initPTS))),{audio:Ke,video:we,initSegment:We,independent:ue,text:ie,id3:Ee}},W.generateIS=function(B,se,fe){var ne,Te,He,le=B.samples,ae=se.samples,we=this.typeSupported,Ke={},We=!(0,U.isFiniteNumber)(this._initPTS),ie="audio/mp4";if(We&&(ne=Te=1/0),B.config&&le.length&&(B.timescale=B.samplerate,B.segmentCodec==="mp3"&&(we.mpeg?(ie="audio/mpeg",B.codec=""):we.mp3&&(B.codec="mp3")),Ke.audio={id:"audio",container:ie,codec:B.codec,initSegment:B.segmentCodec==="mp3"&&we.mpeg?new Uint8Array(0):I.initSegment([B]),metadata:{channelCount:B.channelCount}},We&&(He=B.inputTimeScale,ne=Te=le[0].pts-Math.round(He*fe))),se.sps&&se.pps&&ae.length&&(se.timescale=se.inputTimeScale,Ke.video={id:"main",container:"video/mp4",codec:se.codec,initSegment:I.initSegment([se]),metadata:{width:se.width,height:se.height}},We)){He=se.inputTimeScale;var Ee=this.getVideoStartPts(ae),ue=Math.round(He*fe);Te=Math.min(Te,Y(ae[0].dts,Ee)-ue),ne=Math.min(ne,Ee-ue)}if(Object.keys(Ke).length)return this.ISGenerated=!0,We&&(this._initPTS=ne,this._initDTS=Te),{tracks:Ke,initPTS:ne,timescale:He}},W.remuxVideo=function(B,se,fe,ne){var Te,He,le=B.inputTimeScale,ae=B.samples,we=[],Ke=ae.length,We=this._initPTS,ie=this.nextAvcDts,Ee=8,ue=this.videoSampleDuration,Re=Number.POSITIVE_INFINITY,Le=Number.NEGATIVE_INFINITY,Me=!1;fe&&ie!==null||(ie=se*le-(ae[0].pts-Y(ae[0].dts,ae[0].pts)));for(var Oe=0;Oe<Ke;Oe++){var Be=ae[Oe];Be.pts=Y(Be.pts-We,ie),Be.dts=Y(Be.dts-We,ie),Be.dts<ae[Oe>0?Oe-1:Oe].dts&&(Me=!0)}Me&&ae.sort(function(ir,Cr){var Zr=ir.dts-Cr.dts,Ur=ir.pts-Cr.pts;return Zr||Ur}),Te=ae[0].dts;var _e=ae[ae.length-1].dts-Te,Ne=_e?Math.round(_e/(Ke-1)):ue||B.inputTimeScale/30;if(fe){var Xe=Te-ie,at=Xe>Ne,mt=Xe<-1;if((at||mt)&&(at?N.logger.warn("AVC: "+(0,de.toMsFromMpegTsClock)(Xe,!0)+" ms ("+Xe+"dts) hole between fragments detected, filling it"):N.logger.warn("AVC: "+(0,de.toMsFromMpegTsClock)(-Xe,!0)+" ms ("+Xe+"dts) overlapping between fragments detected"),!mt||ie>ae[0].pts)){Te=ie;var gt=ae[0].pts-Xe;ae[0].dts=Te,ae[0].pts=gt,N.logger.log("Video: First PTS/DTS adjusted: "+(0,de.toMsFromMpegTsClock)(gt,!0)+"/"+(0,de.toMsFromMpegTsClock)(Te,!0)+", delta: "+(0,de.toMsFromMpegTsClock)(Xe,!0)+" ms")}}Te=Math.max(0,Te);for(var Ft=0,Mt=0,xt=0;xt<Ke;xt++){for(var Ot=ae[xt],ht=Ot.units,ct=ht.length,Pt=0,Ht=0;Ht<ct;Ht++)Pt+=ht[Ht].data.length;Mt+=Pt,Ft+=ct,Ot.length=Pt,Ot.dts=Math.max(Ot.dts,Te),Re=Math.min(Ot.pts,Re),Le=Math.max(Ot.pts,Le)}He=ae[Ke-1].dts;var qt,nr=Mt+4*Ft+8;try{qt=new Uint8Array(nr)}catch{return void this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:X.ErrorTypes.MUX_ERROR,details:X.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:nr,reason:"fail allocating video mdat "+nr})}var tr=new DataView(qt.buffer);tr.setUint32(0,nr),qt.set(I.types.mdat,4);for(var Lr=!1,ge=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,V=Number.NEGATIVE_INFINITY,j=0;j<Ke;j++){for(var J=ae[j],pe=J.units,ve=0,De=0,Fe=pe.length;De<Fe;De++){var je=pe[De],qe=je.data,Je=je.data.byteLength;tr.setUint32(Ee,Je),Ee+=4,qt.set(qe,Ee),Ee+=Je,ve+=4+Je}var Ye=void 0;if(j<Ke-1)ue=ae[j+1].dts-J.dts,Ye=ae[j+1].pts-J.pts;else{var ot=this.config,Et=j>0?J.dts-ae[j-1].dts:Ne;if(Ye=j>0?J.pts-ae[j-1].pts:Ne,ot.stretchShortVideoTrack&&this.nextAudioPts!==null){var Ut=Math.floor(ot.maxBufferHole*le),rt=(ne?Re+ne*le:this.nextAudioPts)-J.pts;rt>Ut?((ue=rt-Et)<0?ue=Et:Lr=!0,N.logger.log("[mp4-remuxer]: It is approximately "+rt/90+" ms to the next segment; using duration "+ue/90+" ms for the last video frame.")):ue=Et}else ue=Et}var Nt=Math.round(J.pts-J.dts);ge=Math.min(ge,ue),R=Math.max(R,ue),$=Math.min($,Ye),V=Math.max(V,Ye),we.push(new ke(J.key,ue,ve,Nt))}if(we.length){if(z){if(z<70){var lr=we[0].flags;lr.dependsOn=2,lr.isNonSync=0}}else if(he&&V-$<R-ge&&Ne/R<.025&&we[0].cts===0){N.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Wt=Te,Vt=0,Zt=we.length;Vt<Zt;Vt++){var dt=Wt+we[Vt].duration,Tr=Wt+we[Vt].cts;if(Vt<Zt-1){var Qr=dt+we[Vt+1].cts;we[Vt].duration=Qr-Tr}else we[Vt].duration=Vt?we[Vt-1].duration:Ne;we[Vt].cts=0,Wt=dt}}}ue=Lr||!ue?Ne:ue,this.nextAvcDts=ie=He+ue,this.videoSampleDuration=ue,this.isVideoContiguous=!0;var zt={data1:I.moof(B.sequenceNumber++,Te,re({},B,{samples:we})),data2:qt,startPTS:Re/le,endPTS:(Le+ue)/le,startDTS:Te/le,endDTS:ie/le,type:"video",hasAudio:!1,hasVideo:!0,nb:we.length,dropped:B.dropped};return B.samples=[],B.dropped=0,zt},W.remuxAudio=function(B,se,fe,ne,Te){var He=B.inputTimeScale,le=He/(B.samplerate?B.samplerate:He),ae=B.segmentCodec==="aac"?1024:1152,we=ae*le,Ke=this._initPTS,We=B.segmentCodec==="mp3"&&this.typeSupported.mpeg,ie=[],Ee=Te!==void 0,ue=B.samples,Re=We?0:8,Le=this.nextAudioPts||-1,Me=se*He;if(this.isAudioContiguous=fe=fe||ue.length&&Le>0&&(ne&&Math.abs(Me-Le)<9e3||Math.abs(Y(ue[0].pts-Ke,Me)-Le)<20*we),ue.forEach(function(De){De.pts=Y(De.pts-Ke,Me)}),!fe||Le<0){if(ue=ue.filter(function(De){return De.pts>=0}),!ue.length)return;Le=Te===0?0:ne&&!Ee?Math.max(0,Me):ue[0].pts}if(B.segmentCodec==="aac")for(var Oe=this.config.maxAudioFramesDrift,Be=0,_e=Le;Be<ue.length;Be++){var Ne=ue[Be],Xe=Ne.pts,at=Xe-_e,mt=Math.abs(1e3*at/He);if(at<=-Oe*we&&Ee)Be===0&&(N.logger.warn("Audio frame @ "+(Xe/He).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*at/He)+" ms."),this.nextAudioPts=Le=_e=Xe);else if(at>=Oe*we&&mt<1e4&&Ee){var gt=Math.round(at/we);(_e=Xe-gt*we)<0&&(gt--,_e+=we),Be===0&&(this.nextAudioPts=Le=_e),N.logger.warn("[mp4-remuxer]: Injecting "+gt+" audio frame @ "+(_e/He).toFixed(3)+"s due to "+Math.round(1e3*at/He)+" ms gap.");for(var Ft=0;Ft<gt;Ft++){var Mt=Math.max(_e,0),xt=x.getSilentFrame(B.manifestCodec||B.codec,B.channelCount);xt||(N.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),xt=Ne.unit.subarray()),ue.splice(Be,0,{unit:xt,pts:Mt}),_e+=we,Be++}}Ne.pts=_e,_e+=we}for(var Ot,ht=null,ct=null,Pt=0,Ht=ue.length;Ht--;)Pt+=ue[Ht].unit.byteLength;for(var qt=0,nr=ue.length;qt<nr;qt++){var tr=ue[qt],Lr=tr.unit,ge=tr.pts;if(ct!==null)ie[qt-1].duration=Math.round((ge-ct)/le);else{if(fe&&B.segmentCodec==="aac"&&(ge=Le),ht=ge,!(Pt>0))return;Pt+=Re;try{Ot=new Uint8Array(Pt)}catch{return void this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:X.ErrorTypes.MUX_ERROR,details:X.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Pt,reason:"fail allocating audio mdat "+Pt})}We||(new DataView(Ot.buffer).setUint32(0,Pt),Ot.set(I.types.mdat,4))}Ot.set(Lr,Re);var $=Lr.byteLength;Re+=$,ie.push(new ke(!0,ae,$,0)),ct=ge}var R=ie.length;if(R){var V=ie[ie.length-1];this.nextAudioPts=Le=ct+le*V.duration;var j=We?new Uint8Array(0):I.moof(B.sequenceNumber++,ht/le,re({},B,{samples:ie}));B.samples=[];var J=ht/He,pe=Le/He,ve={data1:j,data2:Ot,startPTS:J,endPTS:pe,startDTS:J,endDTS:pe,type:"audio",hasAudio:!0,hasVideo:!1,nb:R};return this.isAudioContiguous=!0,ve}},W.remuxEmptyAudio=function(B,se,fe,ne){var Te=B.inputTimeScale,He=Te/(B.samplerate?B.samplerate:Te),le=this.nextAudioPts,ae=(le!==null?le:ne.startDTS*Te)+this._initDTS,we=ne.endDTS*Te+this._initDTS,Ke=1024*He,We=Math.ceil((we-ae)/Ke),ie=x.getSilentFrame(B.manifestCodec||B.codec,B.channelCount);if(N.logger.warn("[mp4-remuxer]: remux empty Audio"),ie){for(var Ee=[],ue=0;ue<We;ue++){var Re=ae+ue*Ke;Ee.push({unit:ie,pts:Re,dts:Re})}return B.samples=Ee,this.remuxAudio(B,se,fe,!1)}N.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},L}();function Y(L,W){var B;if(W===null)return L;for(B=W<L?-8589934592:8589934592;Math.abs(L-W)>4294967296;)L+=B;return L}function me(L,W,B,se){var fe=L.samples.length;if(fe){for(var ne=L.inputTimeScale,Te=0;Te<fe;Te++){var He=L.samples[Te];He.pts=Y(He.pts-B,W*ne)/ne,He.dts=Y(He.dts-se,W*ne)/ne}var le=L.samples;return L.samples=[],{samples:le}}}function Ae(L,W,B){var se=L.samples.length;if(se){for(var fe=L.inputTimeScale,ne=0;ne<se;ne++){var Te=L.samples[ne];Te.pts=Y(Te.pts-B,W*fe)/fe}L.samples.sort(function(le,ae){return le.pts-ae.pts});var He=L.samples;return L.samples=[],{samples:He}}}var ke=function(L,W,B,se){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=W,this.size=B,this.cts=se,this.flags=new Q(L)},Q=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},856:(k,A,w)=>{var U;w.r(A),w.d(A,{MetadataSchema:()=>U}),function(x){x.audioId3="org.id3",x.dateRange="com.apple.quicktime.HLS",x.emsg="https://aomedia.org/emsg/ID3"}(U||(U={}))},308:(k,A,w)=>{var U,x;w.r(A),w.d(A,{PlaylistContextType:()=>U,PlaylistLevelType:()=>x}),function(P){P.MANIFEST="manifest",P.LEVEL="level",P.AUDIO_TRACK="audioTrack",P.SUBTITLE_TRACK="subtitleTrack"}(U||(U={})),function(P){P.MAIN="main",P.AUDIO="audio",P.SUBTITLE="subtitle"}(x||(x={}))},300:(k,A,w)=>{w.r(A),w.d(A,{default:()=>U});const U={hexDump:function(x){for(var P="",g=0;g<x.length;g++){var I=x[g].toString(16);I.length<2&&(I="0"+I),P+=I}return P}}},93:(k,A,w)=>{w.r(A),w.d(A,{enableLogs:()=>I,logger:()=>O});var U=function(){},x={trace:U,debug:U,log:U,warn:U,info:U,error:U},P=x;function g(X){var N=self.console[X];return N?N.bind(self.console,"["+X+"] >"):U}function I(X,N){if(self.console&&X===!0||typeof X=="object"){(function(ye){for(var de=arguments.length,re=new Array(de>1?de-1:0),z=1;z<de;z++)re[z-1]=arguments[z];re.forEach(function(he){P[he]=ye[he]?ye[he].bind(ye):g(he)})})(X,"debug","log","info","warn","error");try{P.log('Debug logs enabled for "'+N+'"')}catch{P=x}}else P=x}var O=x},63:(k,A,w)=>{w.r(A),w.d(A,{RemuxerTrackIdConfig:()=>N,appendUint8Array:()=>fe,bin2str:()=>ye,computeRawDurationFromSamples:()=>W,discardEPB:()=>le,findBox:()=>G,getDuration:()=>L,getStartDTS:()=>Q,mp4Box:()=>we,mp4pssh:()=>Ke,offsetStartDTS:()=>B,parseEmsg:()=>ae,parseInitSegment:()=>me,parsePssh:()=>We,parseSEIMessageFromNALu:()=>He,parseSamples:()=>ne,parseSegmentIndex:()=>Y,parseSinf:()=>ke,patchEncyptionData:()=>Ae,readSint32:()=>z,readUint16:()=>de,readUint32:()=>re,segmentValidRange:()=>se,writeUint32:()=>he});var U=w(923),x=w(145),P=w(181),g=w(93),I=w(300),O=Math.pow(2,32)-1,X=[].push,N={video:1,audio:2,id3:3,text:4};function ye(ie){return String.fromCharCode.apply(null,ie)}function de(ie,Ee){var ue=ie[Ee]<<8|ie[Ee+1];return ue<0?65536+ue:ue}function re(ie,Ee){var ue=z(ie,Ee);return ue<0?4294967296+ue:ue}function z(ie,Ee){return ie[Ee]<<24|ie[Ee+1]<<16|ie[Ee+2]<<8|ie[Ee+3]}function he(ie,Ee,ue){ie[Ee]=ue>>24,ie[Ee+1]=ue>>16&255,ie[Ee+2]=ue>>8&255,ie[Ee+3]=255&ue}function G(ie,Ee){var ue=[];if(!Ee.length)return ue;for(var Re=ie.byteLength,Le=0;Le<Re;){var Me=re(ie,Le),Oe=Me>1?Le+Me:Re;if(ye(ie.subarray(Le+4,Le+8))===Ee[0])if(Ee.length===1)ue.push(ie.subarray(Le+8,Oe));else{var Be=G(ie.subarray(Le+8,Oe),Ee.slice(1));Be.length&&X.apply(ue,Be)}Le=Oe}return ue}function Y(ie){var Ee=[],ue=ie[0],Re=8,Le=re(ie,Re);Re+=4,Re+=ue===0?8:16,Re+=2;var Me=ie.length+0,Oe=de(ie,Re);Re+=2;for(var Be=0;Be<Oe;Be++){var _e=Re,Ne=re(ie,_e);_e+=4;var Xe=2147483647&Ne;if((2147483648&Ne)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var at=re(ie,_e);_e+=4,Ee.push({referenceSize:Xe,subsegmentDuration:at,info:{duration:at/Le,start:Me,end:Me+Xe-1}}),Me+=Xe,Re=_e+=4}return{earliestPresentationTime:0,timescale:Le,version:ue,referencesCount:Oe,references:Ee}}function me(ie){for(var Ee=[],ue=G(ie,["moov","trak"]),Re=0;Re<ue.length;Re++){var Le=ue[Re],Me=G(Le,["tkhd"])[0];if(Me){var Oe=Me[0],Be=Oe===0?12:20,_e=re(Me,Be),Ne=G(Le,["mdia","mdhd"])[0];if(Ne){var Xe=re(Ne,Be=(Oe=Ne[0])===0?12:20),at=G(Le,["mdia","hdlr"])[0];if(at){var mt=ye(at.subarray(8,12)),gt={soun:U.ElementaryStreamTypes.AUDIO,vide:U.ElementaryStreamTypes.VIDEO}[mt];if(gt){var Ft=G(Le,["mdia","minf","stbl","stsd"])[0],Mt=void 0;Ft&&(Mt=ye(Ft.subarray(12,16))),Ee[_e]={timescale:Xe,type:gt},Ee[gt]={timescale:Xe,id:_e,codec:Mt}}}}}}return G(ie,["moov","mvex","trex"]).forEach(function(xt){var Ot=re(xt,4),ht=Ee[Ot];ht&&(ht.default={duration:re(xt,12),flags:re(xt,20)})}),Ee}function Ae(ie,Ee){if(!ie||!Ee)return ie;var ue=Ee.keyId;return ue&&Ee.isCommonEncryption&&G(ie,["moov","trak"]).forEach(function(Re){var Le=G(Re,["mdia","minf","stbl","stsd"])[0].subarray(8),Me=G(Le,["enca"]),Oe=Me.length>0;Oe||(Me=G(Le,["encv"])),Me.forEach(function(Be){G(Oe?Be.subarray(28):Be.subarray(78),["sinf"]).forEach(function(_e){var Ne=ke(_e);if(Ne){var Xe=Ne.subarray(8,24);Xe.some(function(at){return at!==0})||(g.logger.log("[eme] Patching keyId in 'enc"+(Oe?"a":"v")+">sinf>>tenc' box: "+I.default.hexDump(Xe)+" -> "+I.default.hexDump(ue)),Ne.set(ue,8))}})})}),ie}function ke(ie){var Ee=G(ie,["schm"])[0];if(Ee){var ue=ye(Ee.subarray(4,8));if(ue==="cbcs"||ue==="cenc")return G(ie,["schi","tenc"])[0]}return g.logger.error("[eme] missing 'schm' box"),null}function Q(ie,Ee){return G(Ee,["moof","traf"]).reduce(function(ue,Re){var Le=G(Re,["tfdt"])[0],Me=Le[0],Oe=G(Re,["tfhd"]).reduce(function(Be,_e){var Ne=re(_e,4),Xe=ie[Ne];if(Xe){var at=re(Le,4);Me===1&&(at*=Math.pow(2,32),at+=re(Le,8));var mt=at/(Xe.timescale||9e4);if(isFinite(mt)&&(Be===null||mt<Be))return mt}return Be},null);return Oe!==null&&isFinite(Oe)&&(ue===null||Oe<ue)?Oe:ue},null)||0}function L(ie,Ee){for(var ue=0,Re=0,Le=0,Me=G(ie,["moof","traf"]),Oe=0;Oe<Me.length;Oe++){var Be=Me[Oe],_e=G(Be,["tfhd"])[0],Ne=Ee[re(_e,4)];if(Ne){var Xe=Ne.default,at=re(_e,0)|(Xe==null?void 0:Xe.flags),mt=Xe==null?void 0:Xe.duration;8&at&&(mt=re(_e,2&at?12:8));for(var gt=Ne.timescale||9e4,Ft=G(Be,["trun"]),Mt=0;Mt<Ft.length;Mt++)!(ue=W(Ft[Mt]))&&mt&&(ue=mt*re(Ft[Mt],4)),Ne.type===U.ElementaryStreamTypes.VIDEO?Re+=ue/gt:Ne.type===U.ElementaryStreamTypes.AUDIO&&(Le+=ue/gt)}}if(Re===0&&Le===0){for(var xt=0,Ot=G(ie,["sidx"]),ht=0;ht<Ot.length;ht++){var ct=Y(Ot[ht]);ct!=null&&ct.references&&(xt+=ct.references.reduce(function(Pt,Ht){return Pt+Ht.info.duration||0},0))}return xt}return Re||Le}function W(ie){var Ee=re(ie,0),ue=8;1&Ee&&(ue+=4),4&Ee&&(ue+=4);for(var Re=0,Le=re(ie,4),Me=0;Me<Le;Me++)256&Ee&&(Re+=re(ie,ue),ue+=4),512&Ee&&(ue+=4),1024&Ee&&(ue+=4),2048&Ee&&(ue+=4);return Re}function B(ie,Ee,ue){G(Ee,["moof","traf"]).forEach(function(Re){G(Re,["tfhd"]).forEach(function(Le){var Me=re(Le,4),Oe=ie[Me];if(Oe){var Be=Oe.timescale||9e4;G(Re,["tfdt"]).forEach(function(_e){var Ne=_e[0],Xe=re(_e,4);if(Ne===0)Xe-=ue*Be,he(_e,4,Xe=Math.max(Xe,0));else{Xe*=Math.pow(2,32),Xe+=re(_e,8),Xe-=ue*Be,Xe=Math.max(Xe,0);var at=Math.floor(Xe/(O+1)),mt=Math.floor(Xe%(O+1));he(_e,4,at),he(_e,8,mt)}})}})})}function se(ie){var Ee={valid:null,remainder:null},ue=G(ie,["moof"]);if(!ue)return Ee;if(ue.length<2)return Ee.remainder=ie,Ee;var Re=ue[ue.length-1];return Ee.valid=(0,x.sliceUint8)(ie,0,Re.byteOffset-8),Ee.remainder=(0,x.sliceUint8)(ie,Re.byteOffset-8),Ee}function fe(ie,Ee){var ue=new Uint8Array(ie.length+Ee.length);return ue.set(ie),ue.set(Ee,ie.length),ue}function ne(ie,Ee){var ue=[],Re=Ee.samples,Le=Ee.timescale,Me=Ee.id,Oe=!1;return G(Re,["moof"]).map(function(Be){var _e=Be.byteOffset-8;G(Be,["traf"]).map(function(Ne){var Xe=G(Ne,["tfdt"]).map(function(at){var mt=at[0],gt=re(at,4);return mt===1&&(gt*=Math.pow(2,32),gt+=re(at,8)),gt/Le})[0];return Xe!==void 0&&(ie=Xe),G(Ne,["tfhd"]).map(function(at){var mt=re(at,4),gt=16777215&re(at,0),Ft=0,Mt=(16&gt)!=0,xt=0,Ot=(32&gt)!=0,ht=8;mt===Me&&(1&gt&&(ht+=8),2&gt&&(ht+=4),8&gt&&(Ft=re(at,ht),ht+=4),Mt&&(xt=re(at,ht),ht+=4),Ot&&(ht+=4),Ee.type==="video"&&(Oe=function(ct){if(!ct)return!1;var Pt=ct.indexOf("."),Ht=Pt<0?ct:ct.substring(0,Pt);return Ht==="hvc1"||Ht==="hev1"||Ht==="dvh1"||Ht==="dvhe"}(Ee.codec)),G(Ne,["trun"]).map(function(ct){var Pt=ct[0],Ht=16777215&re(ct,0),qt=(1&Ht)!=0,nr=0,tr=(4&Ht)!=0,Lr=(256&Ht)!=0,ge=0,$=(512&Ht)!=0,R=0,V=(1024&Ht)!=0,j=(2048&Ht)!=0,J=0,pe=re(ct,4),ve=8;qt&&(nr=re(ct,ve),ve+=4),tr&&(ve+=4);for(var De=nr+_e,Fe=0;Fe<pe;Fe++){if(Lr?(ge=re(ct,ve),ve+=4):ge=Ft,$?(R=re(ct,ve),ve+=4):R=xt,V&&(ve+=4),j&&(J=Pt===0?re(ct,ve):z(ct,ve),ve+=4),Ee.type===U.ElementaryStreamTypes.VIDEO)for(var je=0;je<R;){var qe=re(Re,De);Te(Oe,Re[De+=4])&&He(Re.subarray(De,De+qe),Oe?2:1,ie+J/Le,ue),De+=qe,je+=qe+4}ie+=ge/Le}}))})})}),ue}function Te(ie,Ee){if(ie){var ue=Ee>>1&63;return ue===39||ue===40}return(31&Ee)==6}function He(ie,Ee,ue,Re){var Le=le(ie),Me=0;Me+=Ee;for(var Oe=0,Be=0,_e=!1,Ne=0;Me<Le.length;){Oe=0;do{if(Me>=Le.length)break;Oe+=Ne=Le[Me++]}while(Ne===255);Be=0;do{if(Me>=Le.length)break;Be+=Ne=Le[Me++]}while(Ne===255);var Xe=Le.length-Me;if(!_e&&Oe===4&&Me<Le.length){if(_e=!0,Le[Me++]===181){var at=de(Le,Me);if(Me+=2,at===49){var mt=re(Le,Me);if(Me+=4,mt===1195456820){var gt=Le[Me++];if(gt===3){var Ft=Le[Me++],Mt=64&Ft,xt=Mt?2+3*(31&Ft):0,Ot=new Uint8Array(xt);if(Mt){Ot[0]=Ft;for(var ht=1;ht<xt;ht++)Ot[ht]=Le[Me++]}Re.push({type:gt,payloadType:Oe,pts:ue,bytes:Ot})}}}}}else if(Oe===5&&Be<Xe){if(_e=!0,Be>16){for(var ct=[],Pt=0;Pt<16;Pt++){var Ht=Le[Me++].toString(16);ct.push(Ht.length==1?"0"+Ht:Ht),Pt!==3&&Pt!==5&&Pt!==7&&Pt!==9||ct.push("-")}for(var qt=Be-16,nr=new Uint8Array(qt),tr=0;tr<qt;tr++)nr[tr]=Le[Me++];Re.push({payloadType:Oe,pts:ue,uuid:ct.join(""),userData:(0,P.utf8ArrayToStr)(nr),userDataBytes:nr})}}else if(Be<Xe)Me+=Be;else if(Be>Xe)break}}function le(ie){for(var Ee=ie.byteLength,ue=[],Re=1;Re<Ee-2;)ie[Re]===0&&ie[Re+1]===0&&ie[Re+2]===3?(ue.push(Re+2),Re+=2):Re++;if(ue.length===0)return ie;var Le=Ee-ue.length,Me=new Uint8Array(Le),Oe=0;for(Re=0;Re<Le;Oe++,Re++)Oe===ue[0]&&(Oe++,ue.shift()),Me[Re]=ie[Oe];return Me}function ae(ie){var Ee=ie[0],ue="",Re="",Le=0,Me=0,Oe=0,Be=0,_e=0,Ne=0;if(Ee===0){for(;ye(ie.subarray(Ne,Ne+1))!=="\0";)ue+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;for(ue+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;ye(ie.subarray(Ne,Ne+1))!=="\0";)Re+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;Re+=ye(ie.subarray(Ne,Ne+1)),Ne+=1,Le=re(ie,12),Me=re(ie,16),Be=re(ie,20),_e=re(ie,24),Ne=28}else if(Ee===1){Le=re(ie,Ne+=4);var Xe=re(ie,Ne+=4),at=re(ie,Ne+=4);for(Ne+=4,Oe=Math.pow(2,32)*Xe+at,Number.isSafeInteger(Oe)||(Oe=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),Be=re(ie,Ne),_e=re(ie,Ne+=4),Ne+=4;ye(ie.subarray(Ne,Ne+1))!=="\0";)ue+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;for(ue+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;ye(ie.subarray(Ne,Ne+1))!=="\0";)Re+=ye(ie.subarray(Ne,Ne+1)),Ne+=1;Re+=ye(ie.subarray(Ne,Ne+1)),Ne+=1}return{schemeIdUri:ue,value:Re,timeScale:Le,presentationTime:Oe,presentationTimeDelta:Me,eventDuration:Be,id:_e,payload:ie.subarray(Ne,ie.byteLength)}}function we(ie){for(var Ee=arguments.length,ue=new Array(Ee>1?Ee-1:0),Re=1;Re<Ee;Re++)ue[Re-1]=arguments[Re];for(var Le=ue.length,Me=8,Oe=Le;Oe--;)Me+=ue[Oe].byteLength;var Be=new Uint8Array(Me);for(Be[0]=Me>>24&255,Be[1]=Me>>16&255,Be[2]=Me>>8&255,Be[3]=255&Me,Be.set(ie,4),Oe=0,Me=8;Oe<Le;Oe++)Be.set(ue[Oe],Me),Me+=ue[Oe].byteLength;return Be}function Ke(ie,Ee,ue){if(ie.byteLength!==16)throw new RangeError("Invalid system id");var Re,Le,Me;if(Ee){Re=1,Le=new Uint8Array(16*Ee.length);for(var Oe=0;Oe<Ee.length;Oe++){var Be=Ee[Oe];if(Be.byteLength!==16)throw new RangeError("Invalid key");Le.set(Be,16*Oe)}}else Re=0,Le=new Uint8Array;Re>0?(Me=new Uint8Array(4),Ee.length>0&&new DataView(Me.buffer).setUint32(0,Ee.length,!1)):Me=new Uint8Array;var _e=new Uint8Array(4);return ue&&ue.byteLength>0&&new DataView(_e.buffer).setUint32(0,ue.byteLength,!1),we([112,115,115,104],new Uint8Array([Re,0,0,0]),ie,Me,Le,_e,ue||new Uint8Array)}function We(ie){if(!(ie instanceof ArrayBuffer)||ie.byteLength<32)return null;var Ee={version:0,systemId:"",kids:null,data:null},ue=new DataView(ie),Re=ue.getUint32(0);if(ie.byteLength!==Re&&Re>44||ue.getUint32(4)!==1886614376||(Ee.version=ue.getUint32(8)>>>24,Ee.version>1))return null;Ee.systemId=I.default.hexDump(new Uint8Array(ie,12,16));var Le=ue.getUint32(28);if(Ee.version===0){if(Re-32<Le)return null;Ee.data=new Uint8Array(ie,32,Le)}else if(Ee.version===1){Ee.kids=[];for(var Me=0;Me<Le;Me++)Ee.kids.push(new Uint8Array(ie,32+16*Me,16))}return Ee}},673:(k,A,w)=>{function U(I,O,X,N){X===void 0&&(X=1),N===void 0&&(N=!1);var ye=I*O*X;return N?Math.round(ye):ye}function x(I,O,X,N){return X===void 0&&(X=1),N===void 0&&(N=!1),U(I,O,1/X,N)}function P(I,O){return O===void 0&&(O=!1),U(I,1e3,11111111111111112e-21,O)}function g(I,O){return O===void 0&&(O=1),U(I,9e4,1/O)}w.r(A),w.d(A,{toMpegTsClockFromTimescale:()=>g,toMsFromMpegTsClock:()=>P,toTimescaleFromBase:()=>U,toTimescaleFromScale:()=>x})},145:(k,A,w)=>{function U(x,P,g){return Uint8Array.prototype.slice?x.slice(P,g):new Uint8Array(Array.prototype.slice.call(x,P,g))}w.r(A),w.d(A,{sliceUint8:()=>U})},729:k=>{var A=Object.prototype.hasOwnProperty,w="~";function U(){}function x(O,X,N){this.fn=O,this.context=X,this.once=N||!1}function P(O,X,N,ye,de){if(typeof N!="function")throw new TypeError("The listener must be a function");var re=new x(N,ye||O,de),z=w?w+X:X;return O._events[z]?O._events[z].fn?O._events[z]=[O._events[z],re]:O._events[z].push(re):(O._events[z]=re,O._eventsCount++),O}function g(O,X){--O._eventsCount==0?O._events=new U:delete O._events[X]}function I(){this._events=new U,this._eventsCount=0}Object.create&&(U.prototype=Object.create(null),new U().__proto__||(w=!1)),I.prototype.eventNames=function(){var O,X,N=[];if(this._eventsCount===0)return N;for(X in O=this._events)A.call(O,X)&&N.push(w?X.slice(1):X);return Object.getOwnPropertySymbols?N.concat(Object.getOwnPropertySymbols(O)):N},I.prototype.listeners=function(O){var X=w?w+O:O,N=this._events[X];if(!N)return[];if(N.fn)return[N.fn];for(var ye=0,de=N.length,re=new Array(de);ye<de;ye++)re[ye]=N[ye].fn;return re},I.prototype.listenerCount=function(O){var X=w?w+O:O,N=this._events[X];return N?N.fn?1:N.length:0},I.prototype.emit=function(O,X,N,ye,de,re){var z=w?w+O:O;if(!this._events[z])return!1;var he,G,Y=this._events[z],me=arguments.length;if(Y.fn){switch(Y.once&&this.removeListener(O,Y.fn,void 0,!0),me){case 1:return Y.fn.call(Y.context),!0;case 2:return Y.fn.call(Y.context,X),!0;case 3:return Y.fn.call(Y.context,X,N),!0;case 4:return Y.fn.call(Y.context,X,N,ye),!0;case 5:return Y.fn.call(Y.context,X,N,ye,de),!0;case 6:return Y.fn.call(Y.context,X,N,ye,de,re),!0}for(G=1,he=new Array(me-1);G<me;G++)he[G-1]=arguments[G];Y.fn.apply(Y.context,he)}else{var Ae,ke=Y.length;for(G=0;G<ke;G++)switch(Y[G].once&&this.removeListener(O,Y[G].fn,void 0,!0),me){case 1:Y[G].fn.call(Y[G].context);break;case 2:Y[G].fn.call(Y[G].context,X);break;case 3:Y[G].fn.call(Y[G].context,X,N);break;case 4:Y[G].fn.call(Y[G].context,X,N,ye);break;default:if(!he)for(Ae=1,he=new Array(me-1);Ae<me;Ae++)he[Ae-1]=arguments[Ae];Y[G].fn.apply(Y[G].context,he)}}return!0},I.prototype.on=function(O,X,N){return P(this,O,X,N,!1)},I.prototype.once=function(O,X,N){return P(this,O,X,N,!0)},I.prototype.removeListener=function(O,X,N,ye){var de=w?w+O:O;if(!this._events[de])return this;if(!X)return g(this,de),this;var re=this._events[de];if(re.fn)re.fn!==X||ye&&!re.once||N&&re.context!==N||g(this,de);else{for(var z=0,he=[],G=re.length;z<G;z++)(re[z].fn!==X||ye&&!re[z].once||N&&re[z].context!==N)&&he.push(re[z]);he.length?this._events[de]=he.length===1?he[0]:he:g(this,de)}return this},I.prototype.removeAllListeners=function(O){var X;return O?(X=w?w+O:O,this._events[X]&&g(this,X)):(this._events=new U,this._eventsCount=0),this},I.prototype.off=I.prototype.removeListener,I.prototype.addListener=I.prototype.on,I.prefixed=w,I.EventEmitter=I,k.exports=I},945:function(k){var A,w,U,x,P;A=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,w=/^(?=([^\/?#]*))\1([^]*)$/,U=/(?:\/|^)\.(?=\/)/g,x=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,P={buildAbsoluteURL:function(g,I,O){if(O=O||{},g=g.trim(),!(I=I.trim())){if(!O.alwaysNormalize)return g;var X=P.parseURL(g);if(!X)throw new Error("Error trying to parse base URL.");return X.path=P.normalizePath(X.path),P.buildURLFromParts(X)}var N=P.parseURL(I);if(!N)throw new Error("Error trying to parse relative URL.");if(N.scheme)return O.alwaysNormalize?(N.path=P.normalizePath(N.path),P.buildURLFromParts(N)):I;var ye=P.parseURL(g);if(!ye)throw new Error("Error trying to parse base URL.");if(!ye.netLoc&&ye.path&&ye.path[0]!=="/"){var de=w.exec(ye.path);ye.netLoc=de[1],ye.path=de[2]}ye.netLoc&&!ye.path&&(ye.path="/");var re={scheme:ye.scheme,netLoc:N.netLoc,path:null,params:N.params,query:N.query,fragment:N.fragment};if(!N.netLoc&&(re.netLoc=ye.netLoc,N.path[0]!=="/"))if(N.path){var z=ye.path,he=z.substring(0,z.lastIndexOf("/")+1)+N.path;re.path=P.normalizePath(he)}else re.path=ye.path,N.params||(re.params=ye.params,N.query||(re.query=ye.query));return re.path===null&&(re.path=O.alwaysNormalize?P.normalizePath(N.path):N.path),P.buildURLFromParts(re)},parseURL:function(g){var I=A.exec(g);return I?{scheme:I[1]||"",netLoc:I[2]||"",path:I[3]||"",params:I[4]||"",query:I[5]||"",fragment:I[6]||""}:null},normalizePath:function(g){for(g=g.split("").reverse().join("").replace(U,"");g.length!==(g=g.replace(x,"")).length;);return g.split("").reverse().join("")},buildURLFromParts:function(g){return g.scheme+g.netLoc+g.path+g.params+g.query+g.fragment}},k.exports=P}},h={};function m(k){var A=h[k];if(A!==void 0)return A.exports;var w=h[k]={exports:{}};return a[k].call(w.exports,w,w.exports,m),w.exports}m.m=a,m.n=k=>{var A=k&&k.__esModule?()=>k.default:()=>k;return m.d(A,{a:A}),A},m.d=(k,A)=>{for(var w in A)m.o(A,w)&&!m.o(k,w)&&Object.defineProperty(k,w,{enumerable:!0,get:A[w]})},m.o=(k,A)=>Object.prototype.hasOwnProperty.call(k,A),m.r=k=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(k,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(k,"__esModule",{value:!0})};var T=m(76);return T.default})())})(Ay);var Kr=Th(il),sa=class extends Error{constructor(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sa.MEDIA_ERR_CUSTOM,a=arguments.length>2?arguments[2]:void 0;var h;super(i),this.name="MediaError",this.code=e,this.fatal=a??(e>=sa.MEDIA_ERR_NETWORK&&e<=sa.MEDIA_ERR_ENCRYPTED),this.message||(this.message=(h=sa.defaultMessages[this.code])!=null?h:"")}},Vr=sa;Vr.MEDIA_ERR_ABORTED=1,Vr.MEDIA_ERR_NETWORK=2,Vr.MEDIA_ERR_DECODE=3,Vr.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Vr.MEDIA_ERR_ENCRYPTED=5,Vr.MEDIA_ERR_CUSTOM=100,Vr.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail.",3:"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.",4:"An unsupported error occurred. The server or network failed, or your browser does not support this format.",5:"The media is encrypted and there are no keys to decrypt it."};var wy=i=>i==null,wh=(i,e)=>wy(e)?!1:i in e,nl={ANY:"any",MUTED:"muted"},oa={VOD:"on-demand",ON_DEMAND:"on-demand",LIVE:"live",LL_LIVE:"ll-live",DVR:"live:dvr",LL_DVR:"ll-live:dvr"},al={MSE:"mse",NATIVE:"native"},sl={HEADER:"header",QUERY:"query",NONE:"none"};Object.values(sl);var Dn={M3U8:"application/vnd.apple.mpegurl",MP4:"video/mp4"},od={HLS:Dn.M3U8},ky=[...Object.values(Dn),"hls","HLS"],Tn=function(i,e,a,h){let m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:i;m.addEventListener(e,a,h),i.addEventListener("teardown",()=>{m.removeEventListener(e,a)},{once:!0})};function Iy(i,e,a){e&&a>e&&(a=e);for(let h=0;h<i.length;h++)if(i.start(h)<=a&&i.end(h)>=a)return!0;return!1}var Dy=i=>{let e=i.indexOf("?");if(e<0)return[i];let a=i.slice(0,e),h=i.slice(e);return[a,h]},kh=i=>{let e=i.type;if(e){let h=e.toUpperCase();return wh(h,od)?od[h]:e}let{src:a}=i;return a?Ly(a):""},Ly=i=>{let e="";try{e=new URL(i).pathname}catch{console.error("invalid url")}let a=e.lastIndexOf(".");if(a<0)return"";let h=e.slice(a+1).toUpperCase();return wh(h,Dn)?Dn[h]:""},Ry=Object.values(nl),ld=i=>typeof i=="boolean"||typeof i=="string"&&Ry.includes(i),Cy=(i,e,a)=>{let{autoplay:h}=i,m=!1,T=!1,k=ld(h)?h:!!h,A=()=>{m||Tn(e,"playing",()=>{m=!0},{once:!0})};if(A(),Tn(e,"loadstart",()=>{m=!1,A(),Ro(e,k)},{once:!0}),Tn(e,"loadstart",()=>{a||(T=!Number.isFinite(e.duration)),Ro(e,k)},{once:!0}),a&&a.once(Kr.Events.LEVEL_LOADED,(w,U)=>{var x;T=(x=U.details.live)!=null?x:!1}),!k){let w=()=>{!T||(a!=null&&a.liveSyncPosition?e.currentTime=a.liveSyncPosition:Number.isFinite(e.seekable.end(0))&&(e.currentTime=e.seekable.end(0)))};a&&Tn(e,"play",()=>{e.preload==="metadata"?a.once(Kr.Events.LEVEL_UPDATED,w):w()},{once:!0})}return w=>{m||(k=ld(w)?w:!!w,Ro(e,k))}},Ro=(i,e)=>{if(!e)return;let a=i.muted,h=()=>i.muted=a;switch(e){case nl.ANY:i.play().catch(()=>{i.muted=!0,i.play().catch(h)});break;case nl.MUTED:i.muted=!0,i.play().catch(h);break;default:i.play().catch(()=>{});break}},xy=(i,e,a)=>{let{preload:h,src:m}=i,T=g=>{g!=null&&["","none","metadata","auto"].includes(g)?e.setAttribute("preload",g):e.removeAttribute("preload")};if(!a)return T(h),T;let k=!1,A=!1,w=a.config.maxBufferLength,U=a.config.maxBufferSize,x=g=>{T(g);let I=g??e.preload;A||I==="none"||(I==="metadata"?(a.config.maxBufferLength=1,a.config.maxBufferSize=1):(a.config.maxBufferLength=w,a.config.maxBufferSize=U),P())},P=()=>{!k&&m&&(k=!0,a.loadSource(m))};return Tn(e,"play",()=>{A=!0,a.config.maxBufferLength=w,a.config.maxBufferSize=U,P()},{once:!0}),x(h),x};function Oy(i,e){e.on(Kr.Events.NON_NATIVE_TEXT_TRACKS_FOUND,(m,T)=>{let{tracks:k}=T;k.forEach(A=>{var w;let U=(w=A.subtitleTrack)!=null?w:A.closedCaptions,x=e.subtitleTracks.findIndex(P=>{let{lang:g,name:I,type:O}=P;return g==(U==null?void 0:U.lang)&&I===A.label&&O.toLowerCase()===A.kind});Ih(i,A.kind,A.label,U==null?void 0:U.lang,"".concat(A.kind).concat(x))})});let a=()=>{var m;if(!e.subtitleTracks.length)return;let T=Array.from(i.textTracks).find(A=>A.id&&A.mode==="showing"&&["subtitles","captions"].includes(A.kind)),k="".concat((m=e.subtitleTracks[e.subtitleTrack])==null?void 0:m.type.toLowerCase()).concat(e.subtitleTrack);if(T&&(e.subtitleTrack<0||(T==null?void 0:T.id)!==k)){let A=e.subtitleTracks.findIndex(w=>{let{lang:U,name:x,type:P}=w;return U==T.language&&x===T.label&&P.toLowerCase()===T.kind});e.subtitleTrack=A}T&&(T==null?void 0:T.id)===k&&T.cues&&Array.from(T.cues).forEach(A=>{T.addCue(A)})};i.textTracks.addEventListener("change",a),e.on(Kr.Events.CUES_PARSED,(m,T)=>{let{track:k,cues:A}=T,w=i.textTracks.getTrackById(k);if(!w)return;let U=w.mode==="disabled";U&&(w.mode="hidden"),A.forEach(x=>{var P;(P=w.cues)!=null&&P.getCueById(x.id)||w.addCue(x)}),U&&(w.mode="disabled")}),e.once(Kr.Events.DESTROYING,()=>{i.textTracks.removeEventListener("change",a),i.querySelectorAll("track[data-removeondestroy]").forEach(m=>{m.remove()})});let h=()=>{Array.from(i.textTracks).forEach(m=>{var T,k;if(!["subtitles","caption"].includes(m.kind)&&m.label==="thumbnails"){if(!((T=m.cues)!=null&&T.length)){let A=i.querySelector('track[label="thumbnails"]'),w=(k=A==null?void 0:A.getAttribute("src"))!=null?k:"";A==null||A.removeAttribute("src"),setTimeout(()=>{A==null||A.setAttribute("src",w)},0)}m.mode!=="hidden"&&(m.mode="hidden")}})};e.once(Kr.Events.MANIFEST_LOADED,h),e.once(Kr.Events.MEDIA_ATTACHED,h)}function Ih(i,e,a,h,m){let T=document.createElement("track");return T.kind=e,T.label=a,h&&(T.srclang=h),m&&(T.id=m),T.track.mode="disabled",T.setAttribute("data-removeondestroy",""),i.append(T),T.track}var Os="cuepoints",Tl=Object.freeze({label:Os}),Dh=function(i){let{label:e=Os}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tl;var a;return(a=Array.from(i.querySelectorAll("track")).find(h=>h.track.label===e&&h.track.kind==="metadata"))==null?void 0:a.track};async function My(i,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tl,h=Dh(i,a);if(!h){let{label:m=Os}=a;h=Ih(i,"metadata",m),h.mode="hidden",await new Promise(T=>setTimeout(()=>T(void 0),0))}return[...e].sort((m,T)=>{let{time:k}=m,{time:A}=T;return A-k}).forEach(m=>{let{time:T,value:k}=m;var A,w;let U=Array.prototype.findIndex.call(h==null?void 0:h.cues,O=>O.startTime>=T),x=(A=h==null?void 0:h.cues)==null?void 0:A[U],P=x?x.startTime:Number.isFinite(i.duration)?i.duration:Number.MAX_SAFE_INTEGER,g=(w=h==null?void 0:h.cues)==null?void 0:w[U-1];g&&(g.endTime=T);let I=new VTTCue(T,P,JSON.stringify(k??null));h.addCue(I)}),h}var Py=i=>({time:i.startTime,value:JSON.parse(i.text)});function Uy(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{label:Os};var a;let h=Dh(i,e);if((a=h==null?void 0:h.activeCues)!=null&&a.length)return Py(h.activeCues[0])}async function Fy(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tl,a=await My(i,[],e);return Tn(i,"cuechange",()=>{let h=Uy(i);if(h){let m=new CustomEvent("cuepointchange",{composed:!0,bubbles:!0,detail:h});i.dispatchEvent(m)}},{},a),a}var ud,dd,Ny=(dd=(ud=globalThis==null?void 0:globalThis.navigator)==null?void 0:ud.userAgent)!=null?dd:"",By=Ny.toLowerCase().indexOf("android")!==-1,Ta=new WeakMap,Lh="mux.com",cd,hd,Rh=(hd=(cd=Kr).isSupported)==null?void 0:hd.call(cd),Hy=By,jy=()=>_l.utils.now(),Gy=_l.utils.generateUUID,fd=function(i){let{domain:e=Lh}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!i)return;let[a,h=""]=Dy(i);return"https://stream.".concat(e,"/").concat(a,".m3u8").concat(h)},Vy=i=>{if(!i)return;let[e]=i.split("?");return e||void 0},Ky=i=>{if(!i||!i.startsWith("https://stream."))return;let[e]=new URL(i).pathname.slice(1).split(".m3u8");return e||void 0},qy=i=>{var e,a,h;return(e=i==null?void 0:i.metadata)!=null&&e.video_id?i.metadata.video_id:Oh(i)&&(h=(a=Vy(i.playbackId))!=null?a:Ky(i.src))!=null?h:i.src},Wy=(i,e,a)=>{Ch(e,a);let{metadata:h={}}=i,{view_session_id:m=Gy()}=h,T=qy(i);h.view_session_id=m,h.video_id=T,i.metadata=h,Ta.set(e,{});let k=$y(i,e);zy(i,e,k),Xy(i,e,k),Fy(e);let A=Cy(i,e,k),w=xy(i,e,k);return{engine:k,setAutoplay:A,setPreload:w}},Ch=(i,e)=>{let a=e==null?void 0:e.engine;a&&(a.detachMedia(),a.destroy()),i!=null&&i.mux&&!i.mux.deleted&&(i.mux.destroy(),delete i.mux),i&&(i.removeAttribute("src"),i.load(),i.removeEventListener("error",Ph),i.removeEventListener("error",ol),i.removeEventListener("durationchange",Mh),Ta.delete(i),i.dispatchEvent(new Event("teardown")))};function xh(i,e){var a;let h=kh(i);if(h!==Dn.M3U8)return!0;let m=!h||((a=e.canPlayType(h))!=null?a:!0),{preferPlayback:T}=i,k=T===al.MSE,A=T===al.NATIVE;return m&&(A||!(Rh&&(k||Hy)))}var $y=(i,e)=>{let{debug:a,streamType:h,startTime:m=-1,metadata:T,preferCmcd:k}=i,A=kh(i)===Dn.M3U8,w=xh(i,e);if(A&&!w&&Rh){let U={backBufferLength:30,renderTextTracksNatively:!1,liveDurationInfinity:!0},x=Yy(h),P=k!==sl.NONE?{useHeaders:k===sl.HEADER,sessionId:T.view_session_id,contentId:T.video_id}:void 0;return new Kr({debug:a,startPosition:m,cmcd:P,...U,...x})}},Yy=i=>[oa.LIVE,oa.DVR].includes(i)?{backBufferLength:8}:[oa.LL_LIVE,oa.LL_DVR].includes(i)?{backBufferLength:4,maxFragLookUpTolerance:.001}:{},Oh=i=>{let{playbackId:e,src:a,customDomain:h}=i;if(e)return!0;if(typeof a!="string")return!1;let m=window==null?void 0:window.location.href,T=new URL(a,m).hostname.toLocaleLowerCase();return T.includes(Lh)||!!h&&T.includes(h.toLocaleLowerCase())},zy=(i,e,a)=>{var h;let{envKey:m}=i,T=Oh(i);if(m||T){let{playerInitTime:k,playerSoftwareName:A,playerSoftwareVersion:w,beaconCollectionDomain:U,debug:x,disableCookies:P}=i,g={...i.metadata,video_title:((h=i==null?void 0:i.metadata)==null?void 0:h.video_title)||void 0},I=O=>typeof O.player_error_code=="string"?!1:typeof i.errorTranslator=="function"?i.errorTranslator(O):O;_l.monitor(e,{debug:x,beaconCollectionDomain:U,hlsjs:a,Hls:a?Kr:void 0,automaticErrorTracking:!1,errorTranslator:I,disableCookies:P,data:{...m?{env_key:m}:{},player_software_name:A,player_software:A,player_software_version:w,player_init_time:k,...g}})}},Xy=(i,e,a)=>{var h;let m=xh(i,e),{src:T}=i;e&&m?(typeof T=="string"?(e.setAttribute("src",T),i.startTime&&(((h=Ta.get(e))!=null?h:{}).startTime=i.startTime,e.addEventListener("durationchange",Mh,{once:!0}))):e.removeAttribute("src"),e.addEventListener("error",Ph),e.addEventListener("error",ol)):a&&T?(a.on(Kr.Events.ERROR,(k,A)=>{let w={[Kr.ErrorTypes.NETWORK_ERROR]:Vr.MEDIA_ERR_NETWORK,[Kr.ErrorTypes.MEDIA_ERROR]:Vr.MEDIA_ERR_DECODE},U=new Vr("",w[A.type]);U.fatal=A.fatal,U.data=A,e.dispatchEvent(new CustomEvent("error",{detail:U}))}),e.addEventListener("error",ol),Oy(e,a),a.attachMedia(e)):console.error("It looks like the video you're trying to play will not work on this system! If possible, try upgrading to the newest versions of your browser or software.")};function Mh(i){var e;let a=i.target,h=(e=Ta.get(a))==null?void 0:e.startTime;if(h&&Iy(a.seekable,a.duration,h)){let m=a.preload==="auto";m&&(a.preload="none"),a.currentTime=h,m&&(a.preload="auto")}}async function Ph(i){if(!i.isTrusted)return;i.stopImmediatePropagation();let e=i.target;if(!(e!=null&&e.error))return;let{message:a,code:h}=e.error,m=new Vr(a,h);if(e.src&&(h!==Vr.MEDIA_ERR_DECODE||h!==void 0))try{let{status:T}=await fetch(e.src);m.data={response:{code:T}}}catch{}e.dispatchEvent(new CustomEvent("error",{detail:m}))}function ol(i){var e,a;if(!(i instanceof CustomEvent)||!(i.detail instanceof Vr))return;let h=i.target,m=i.detail;!m||!m.fatal||(((e=Ta.get(h))!=null?e:{}).error=m,(a=h.mux)==null||a.emit("error",{player_error_code:m.code,player_error_message:m.message}))}var Qy=function(){for(var i=arguments.length,e=new Array(i),a=0;a<i;a++)e[a]=arguments[a];let h=Ue.useRef(null);return Ue.useEffect(()=>{e.forEach(m=>{!m||(typeof m=="function"?m(h.current):m.current=h.current)})},[e]),h},Zy=()=>{try{return"0.7.4"}catch{}return"UNKNOWN"},Jy=Zy(),eE=()=>Jy,tE=eE(),rE="mux-video-react",Uh=et.forwardRef((i,e)=>{var a;let{playbackId:h,src:m,children:T,autoPlay:k,preload:A,...w}=i,[U]=Ue.useState(jy()),[x,P]=Ue.useState((a=fd(h))!=null?a:m),g=Ue.useRef(void 0),I=Ue.useRef(null),O=Qy(I,e);return Ue.useEffect(()=>{var X;P((X=fd(h))!=null?X:m)},[m,h]),Ue.useEffect(()=>{let X={...i,src:x,playerInitTime:U,playerSoftwareName:rE,playerSoftwareVersion:tE,autoplay:k},N=O.current;return N&&(g.current=Wy(X,N,g.current)),()=>{Ch(N,g.current),N=void 0,g.current=void 0}},[x]),Ue.useEffect(()=>{var X;(X=g.current)==null||X.setAutoplay(k)},[k]),Ue.useEffect(()=>{var X;(X=g.current)==null||X.setPreload(A)},[A]),et.createElement("video",{ref:O,...w},T)});Uh.propTypes={envKey:Gr.string,debug:Gr.bool,disableCookies:Gr.bool,metadata:Gr.any,beaconCollectionDomain:Gr.string,playbackId:Gr.string,playerInitTime:Gr.number,preferPlayback:Gr.oneOf(Object.values(al)),type:Gr.oneOf(ky),streamType:Gr.oneOf(Object.values(oa)),startTime:Gr.number};var iE=Uh;const nE=(i,e)=>{const a=gi();return Ue.useCallback(()=>{i&&(e(As.from(bd())),i.assetId&&Eh(a,i.assetId),i._id&&a.delete(i._id))},[i,a,e])};function aE(i){let{asset:e,client:a}=i;const h=Rd(e),m=new URLSearchParams;if(cl(e)==="signed"){const T=Cd(a,h,"v");m.set("token",T)}return"https://stream.mux.com/".concat(h,".m3u8?").concat(m)}function sE(i){let{asset:e,getCurrentTime:a,setDialogState:h}=i;const m=gi(),T="EditThumbnailDialog".concat(Ue.useId()),k=Ue.useMemo(()=>a(),[a]),A=Ue.useMemo(()=>({...e,thumbTime:k}),[e,k]),[w,U]=Ue.useState(!1),[x,P]=Ue.useState(null),g=Ue.useCallback(()=>{U(!0),m.patch(e._id).set({thumbTime:k}).commit({returnDocuments:!1}).then(()=>void h(!1)).catch(P).finally(()=>void U(!1))},[m,e._id,k,h]),I=300*dl({maxDpr:2});if(x)throw x;return te(ws,{id:T,header:"Edit thumbnail",onClose:()=>h(!1),footer:te(qr,{padding:3,children:te(Rr,{mode:"ghost",tone:"primary",loading:w,onClick:g,text:"Set new thumbnail"},"thumbnail")}),children:lt(qr,{space:3,padding:3,children:[lt(qr,{space:2,children:[te(vr,{size:1,weight:"semibold",children:"Current:"}),te(ps,{asset:e,width:I})]}),lt(qr,{space:2,children:[te(vr,{size:1,weight:"semibold",children:"New:"}),te(ps,{asset:A,width:I})]})]})})}function oE(i){let{asset:e,client:a}=i;const h=Rd(e),m=new URLSearchParams;if(cl(e)==="signed"){const T=Cd(a,h,"s");m.set("token",T)}return"https://image.mux.com/".concat(h,"/storyboard.vtt?").concat(m)}const lE=gr(Pr)(Nu||(Nu=yr([`
  position: relative;
  min-height: 150px;
  aspect-ratio: 16 / 9;
  overflow: hidden;
  border-radius: 1px;
  media-airplay-button[media-airplay-unavailable] {
    display: none;
  }
  media-volume-range[media-volume-unavailable] {
    display: none;
  }
  media-pip-button[media-pip-unavailable] {
    display: none;
  }
  media-controller {
    --media-control-background: transparent;
    --media-control-hover-background: transparent;
    --media-range-track-background-color: rgba(255, 255, 255, 0.5);
    --media-range-track-border-radius: 3px;
    width: 100%;
    height: 100%;
    background-color: transparent;
  }
  media-control-bar {
    --media-button-icon-width: 18px;
    --media-preview-time-margin: 0px;
  }
  media-control-bar:not([slot]) :is([role='button'], [role='switch'], button) {
    height: 44px;
  }
  .size-extra-small media-control-bar [role='button'],
  .size-extra-small media-control-bar [role='switch'] {
    height: auto;
    padding: 4.4% 3.2%;
  }
  .mxp-spacer {
    flex-grow: 1;
    height: 100%;
    background-color: var(--media-control-background, rgba(20, 20, 30, 0.7));
  }
  media-controller::part(vertical-layer) {
    transition: background-color 1s;
  }
  media-controller:is([media-paused], :not([user-inactive]))::part(vertical-layer) {
    background-color: rgba(0, 0, 0, 0.6);
    transition: background-color 0.25s;
  }
  .mxp-center-controls {
    --media-background-color: transparent;
    --media-button-icon-width: 100%;
    --media-button-icon-height: auto;
    pointer-events: none;
    width: 100%;
    display: flex;
    flex-flow: row;
    align-items: center;
    justify-content: center;
  }
  .mxp-center-controls media-play-button {
    --media-control-background: transparent;
    --media-control-hover-background: transparent;
    padding: 0;
    width: max(27px, min(9%, 90px));
  }
  .mxp-center-controls media-seek-backward-button,
  .mxp-center-controls media-seek-forward-button {
    --media-control-background: transparent;
    --media-control-hover-background: transparent;
    padding: 0;
    margin: 0 10%;
    width: min(7%, 70px);
  }
  media-loading-indicator {
    --media-loading-icon-width: 100%;
    --media-button-icon-height: auto;
    pointer-events: none;
    position: absolute;
    width: min(15%, 150px);
    display: flex;
    flex-flow: row;
    align-items: center;
    justify-content: center;
  }
  /* Intentionally don't target the div for transition but the children
 of the div. Prevents messing with media-chrome's autohide feature. */
  media-loading-indicator + div * {
    transition: opacity 0.15s;
    opacity: 1;
  }
  media-loading-indicator[media-loading]:not([media-paused]) ~ div > * {
    opacity: 0;
    transition-delay: 400ms;
  }
  media-volume-range {
    width: min(100%, 100px);
  }
  media-time-display {
    white-space: nowrap;
  }
  :is(media-time-display, media-text-display, media-playback-rate-button) {
    color: inherit;
  }
  media-controller:fullscreen media-control-bar[slot='top-chrome'] {
    /* Hide menus and buttons that trigger modals when in full-screen */
    display: none;
  }
  video {
    background: transparent;
  }
  media-controller:not(:fullscreen) video {
    aspect-ratio: 16 / 9;
  }
  media-controller:not(:-webkit-full-screen) video {
    aspect-ratio: 16 / 9;
  }
`]))),uE=gr.div(Bu||(Bu=yr([`
  && {
    --media-background-color: transparent;
    --media-button-icon-width: 100%;
    --media-button-icon-height: auto;
    pointer-events: none;
    width: 100%;
    display: flex;
    flex-flow: row;
    align-items: center;
    justify-content: center;
    media-play-button {
      --media-control-background: transparent;
      --media-control-hover-background: transparent;
      padding: 0;
      width: max(27px, min(9%, 90px));
    }
  }
`]))),dE=gr(yh)(Hu||(Hu=yr([`
  justify-content: flex-end;
  button {
    height: auto;
  }
`])));function cE(i){let{asset:e}=i;const a=gi(),h=Ue.useRef(null),m=Ue.useMemo(()=>Nf({client:a,asset:e,width:1920,height:1080}),[a,e]);return Ue.useEffect(()=>{var T;if(h.current){const k=document.createElement("style");k.innerHTML="img { object-fit: contain; }",(T=h.current)!=null&&T.shadowRoot&&h.current.shadowRoot.appendChild(k)}},[]),te(Pg,{ref:h,slot:"poster",src:m})}function hE(i){let{asset:e}=i;const a=gi(),[h]=Ue.useState(()=>oE({asset:e,client:a}));return te("track",{label:"thumbnails",default:!0,kind:"metadata",src:h})}const fE=gr(Pr)(ju||(ju=yr([`
  min-height: 82px;
  box-sizing: border-box;
`]))),pE=gr(Dr)(Gu||(Gu=yr([`
  text-overflow: ellipsis;
  overflow: hidden;
`]))),vE=gr(qr)(Vu||(Vu=yr([`
  position: relative;
  width: 60%;
`]))),mE=gr(gd)(Ku||(Ku=yr([`
  position: relative;
  width: 100%;

  code {
    overflow: hidden;
    text-overflow: ellipsis;
    position: relative;
    max-width: 200px;
  }
`]))),Fh=i=>{let{progress:e=100,onCancel:a,filename:h,text:m="Uploading"}=i;return te(fE,{tone:"primary",padding:4,border:!0,height:"fill",children:lt(pE,{align:"center",justify:"space-between",height:"fill",direction:"row",gap:2,children:[lt(vE,{children:[te(Dr,{justify:"center",gap:[3,3,2,2],direction:["column","column","row"],children:te(vr,{size:1,children:lt(sn,{space:2,children:[m,te(mE,{size:1,children:h||"..."})]})})}),te(Pr,{marginTop:3,radius:5,shadow:1,children:te(Cf,{value:e})})]}),a?te(Rr,{fontSize:2,text:"Cancel upload",mode:"ghost",tone:"critical",onClick:a}):null]})})};var gE="sanity-plugin-mux-input",yE="2.0.11",EE="An input component that integrates Sanity Studio with Mux video encoding/hosting service.",bE=["sanity","video","mux","input","plugin","sanity-plugin","media"],_E="https://github.com/sanity-io/sanity-plugin-mux-input#readme",TE={url:"https://github.com/sanity-io/sanity-plugin-mux-input/issues"},SE={type:"git",url:"git@github.com:sanity-io/sanity-plugin-mux-input.git"},AE="MIT",wE="Sanity.io <hello@sanity.io>",kE=!1,IE="module",DE={".":{types:"./lib/index.d.ts",source:"./src/index.ts",require:"./lib/index.cjs",node:{import:"./lib/index.cjs.js",require:"./lib/index.cjs"},import:"./lib/index.js",default:"./lib/index.js"},"./package.json":"./package.json"},LE="./lib/index.cjs",RE="./lib/index.js",CE="./src/index.ts",xE="./lib/index.d.ts",OE=["lib","sanity.json","src","v2-incompatible.js"],ME={build:"run-s clean && plugin-kit verify-package --silent && pkg-utils build --strict && pkg-utils --strict",clean:"rimraf lib",dev:"next dev","link-watch":"plugin-kit link-watch",lint:"eslint .",prepare:"husky install || true",prepublishOnly:"run-s build",test:"npm run lint && npm run type-check && npm run build","type-check":"tsc --noEmit",watch:"pkg-utils watch --strict",format:"prettier --write --cache --ignore-unknown ."},PE={"@mux/mux-video-react":"^0.7","@mux/upchunk":"^3","@sanity/icons":"^2","@sanity/incompatible-plugin":"^1","@sanity/ui":"^1","@sanity/uuid":"^3",classnames:"^2.3.2","jsonwebtoken-esm":"^2.0.1","media-chrome":"^0.18.2",motion:"^10",rxjs:"^7","scroll-into-view-if-needed":"^3","suspend-react":"^0.0.9",swr:"^2.0.3","use-device-pixel-ratio":"^1.1.2","use-error-boundary":"^2.0.6"},UE={"@commitlint/cli":"^17.4.2","@commitlint/config-conventional":"^17.4.2","@rollup/plugin-alias":"^4.0.3","@sanity/pkg-utils":"^2.2.3","@sanity/plugin-kit":"^3.1.4","@sanity/semantic-release-preset":"^4.0.0","@sanity/vision":"^3.2.6","@types/react":"^18.0.27","@types/styled-components":"^5.1.26","@typescript-eslint/eslint-plugin":"^5.50.0","@typescript-eslint/parser":"^5.50.0","cz-conventional-changelog":"^3.3.0",eslint:"^8.33.0","eslint-config-prettier":"^8.6.0","eslint-config-react-app":"^7.0.1","eslint-config-sanity":"^6.0.0","eslint-plugin-import":"^2.27.5","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-simple-import-sort":"^10.0.0",husky:"^8.0.3","lint-staged":"^13.1.0",next:"^13.1.6","next-sanity":"^4.1.2","npm-run-all":"^4.1.5",prettier:"^2.8.3","prettier-plugin-packagejson":"^2.4.2",react:"^18.2.0","react-dom":"^18.2.0","react-is":"^18.2.0",rimraf:"^4.1.2",rollup:"^3.13.0",sanity:"^3.2.6","styled-components":"^5.3.6","type-fest":"^3.5.5",typescript:"^4.9.5"},FE={react:"^18","react-is":"^18",sanity:"^3","styled-components":"^5.2"},NE={node:">=14"},BE={access:"public"},HE="https://www.sanity.io/plugins/sanity-plugin-mux-input",jE={name:gE,version:yE,description:EE,keywords:bE,homepage:_E,bugs:TE,repository:SE,license:AE,author:wE,sideEffects:kE,type:IE,exports:DE,main:LE,module:RE,source:CE,types:xE,files:OE,scripts:ME,dependencies:PE,devDependencies:UE,peerDependencies:FE,engines:NE,publishConfig:BE,sanityExchangeUrl:HE};const GE=i=>{let{asset:e,buttons:a,readOnly:h,onChange:m,dialogState:T,setDialogState:k}=i;var A,w,U,x;const P=gi(),g=Ue.useMemo(()=>(e==null?void 0:e.status)==="preparing"?"Preparing the video":(e==null?void 0:e.status)==="waiting_for_upload"?"Waiting for upload to start":(e==null?void 0:e.status)==="waiting"?"Processing upload":!((e==null?void 0:e.status)==="ready"||typeof(e==null?void 0:e.status)>"u"),[e]),I=Ue.useMemo(()=>{var me,Ae,ke,Q;return((Ae=(me=e==null?void 0:e.data)==null?void 0:me.static_renditions)==null?void 0:Ae.status)==="preparing"?!0:(((Q=(ke=e==null?void 0:e.data)==null?void 0:ke.static_renditions)==null?void 0:Q.status)==="ready",!1)},[(w=(A=e==null?void 0:e.data)==null?void 0:A.static_renditions)==null?void 0:w.status]),O=Ue.useMemo(()=>e.playbackId&&aE({client:P,asset:e}),[e,P]),[X,N]=Ue.useState(null),ye=Ue.useCallback(me=>N(me.currentTarget.error),[]),de=Ue.useRef(null),re=Ue.useRef(null),z=Ue.useRef(null),he=Ue.useCallback(()=>{var me,Ae;return(Ae=(me=z.current)==null?void 0:me.currentTime)!=null?Ae:0},[z]),G=nE(e,m);Ue.useEffect(()=>{var me,Ae;const ke=document.createElement("style");ke.innerHTML="button svg { vertical-align: middle; }",(me=de.current)!=null&&me.shadowRoot&&de.current.shadowRoot.appendChild(ke),(Ae=re==null?void 0:re.current)!=null&&Ae.shadowRoot&&re.current.shadowRoot.appendChild(ke.cloneNode(!0))},[]),Ue.useEffect(()=>{var me,Ae,ke;if((e==null?void 0:e.status)==="errored")throw G(),new Error((ke=(Ae=(me=e.data)==null?void 0:me.errors)==null?void 0:Ae.messages)==null?void 0:ke.join(" "))},[(x=(U=e.data)==null?void 0:U.errors)==null?void 0:x.messages,e==null?void 0:e.status,G]);const Y=Ue.useMemo(()=>{try{return new URL(O).searchParams.get("token")}catch{return!1}},[O]);if(X)throw X;return!e||!e.status?null:g?te(Fh,{progress:100,filename:e==null?void 0:e.filename,text:g!==!0&&g||"Waiting for Mux to complete the file",onCancel:h?void 0:()=>G()}):lt(Ki,{children:[lt(lE,{shadow:1,tone:"transparent",scheme:"dark",children:[lt(Lg,{children:[te(iE,{playsInline:!0,ref:z,playbackId:"".concat(e.playbackId).concat(Y?"?token=".concat(Y):""),onError:ye,slot:"media",preload:"metadata",crossOrigin:"anonymous",metadata:{player_name:"Sanity Admin Dashboard",player_version:jE.version,page_type:"Preview Player"},children:te(hE,{asset:e})}),te(cE,{asset:e}),te(Fg,{slot:"centered-chrome",noAutoHide:!0}),te(uE,{slot:"centered-chrome",children:te(Mg,{})}),a&&te(dE,{slot:"top-chrome",children:a}),lt(yh,{children:[te(Og,{}),te(Cg,{}),te(Ug,{}),te(Rg,{}),te(xg,{})]})]}),I&&te(Pr,{padding:2,radius:1,style:{background:"var(--card-fg-color)",position:"absolute",top:"0.5em",left:"0.5em"},children:te(vr,{size:1,style:{color:"var(--card-bg-color)"},children:"MUX is preparing static renditions, please stand by"})})]}),T==="edit-thumbnail"&&te(sE,{asset:e,getCurrentTime:he,setDialogState:k})]})};function Nh(i){return"inset 0 0 0 ".concat(i.width,"px ").concat(i.color)}function Bh(i){const{base:e,border:a,focusRing:h}=i,m=h.offset+h.width,T=0-h.offset,k=e?e.bg:"var(--card-bg-color)";return[T>0&&"inset 0 0 0 ".concat(T,"px var(--card-focus-ring-color)"),a&&Nh(a),T<0&&"0 0 0 ".concat(0-T,"px ").concat(k),m>0&&"0 0 0 ".concat(m,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}const VE=gr(la)(i=>{let{theme:e}=i;const{focusRing:a}=e.sanity,h=e.sanity.color.base,m={width:1,color:"var(--card-border-color)"};return yd(qu||(qu=yr([`
    position: relative;

    &:not([data-disabled='true']) {
      &:focus-within {
        box-shadow: `,`;
      }
    }

    & input {
      overflow: hidden;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      position: absolute;
      min-width: 0;
      display: block;
      appearance: none;
      padding: 0;
      margin: 0;
      border: 0;
      opacity: 0;
    }
  `])),Bh({base:h,border:m,focusRing:a}))}),KE=et.forwardRef(function(e,a){const{icon:h,id:m,accept:T,capture:k,fontSize:A,multiple:w,onSelect:U,padding:x=3,space:P=3,textAlign:g,text:I,disabled:O,...X}=e,N=Ue.useId(),ye=m||N,de=et.useCallback(z=>{U&&z.target.files&&U(Array.from(z.target.files))},[U]),re=lt(Dr,{align:"center",justify:"flex-start",padding:x,children:[h&&te(ni,{marginRight:I?P:void 0,children:lt(vr,{size:A,children:[Ue.isValidElement(h)&&h,of.isValidElementType(h)&&Ue.createElement(h)]})}),I&&te(vr,{align:g,size:A,textOverflow:"ellipsis",children:I})]});return lt(VE,{...X,htmlFor:ye,padding:0,fontSize:2,disabled:O,ref:a,children:[re,te("input",{"data-testid":"file-button-input",accept:T,capture:k,id:ye,multiple:w,onChange:de,type:"file",value:"",disabled:O})]})}),qE=gr(Pr)(Wu||(Wu=yr([`
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0.6;
  mix-blend-mode: screen;
  background: transparent;
`]))),WE=gr(Rr)($u||($u=yr([`
  background: transparent;
  color: white;
`])));function $E(i){const{asset:e,readOnly:a,dialogState:h,setDialogState:m,onChange:T,onUpload:k}=i,[A,w]=Ue.useState(!1),[U,x]=Ue.useState(null),P=Ue.useMemo(()=>cl(e)==="signed",[e]),g=Ue.useCallback(()=>T(As.from(bd([]))),[T]);return Ue.useEffect(()=>{A&&h&&w(!1)},[h,A]),_d(Ue.useCallback(()=>w(!1),[]),[U]),lt(sn,{space:1,padding:2,children:[P&&te(lf,{content:te(ni,{padding:2,children:te(vr,{muted:!0,size:1,children:"Signed playback policy"})}),placement:"right",portal:!0,children:te(qE,{radius:2,margin:2,scheme:"dark",tone:"positive",children:te(WE,{icon:uf,mode:"bleed",tone:"positive"})})}),!a&&te(Rr,{icon:df,mode:"ghost",onClick:()=>m("edit-thumbnail")}),te(cf,{content:lt(Td,{ref:x,children:[te(ni,{padding:2,children:te(hf,{muted:!0,size:1,children:"Replace"})}),te(KE,{accept:"video/*",icon:Sd,mode:"bleed",onSelect:k,text:"Upload",disabled:a,fontSize:2}),te(la,{icon:Ad,text:"Browse",onClick:()=>m("select-video")}),te(Gl,{}),te(la,{icon:ll,text:"Configure API",onClick:()=>m("secrets")}),te(Gl,{}),te(la,{tone:"critical",icon:ff,text:"Clear field",onClick:g,disabled:a})]}),portal:!0,open:A,children:te(Rr,{icon:wd,mode:"ghost",onClick:()=>{m(!1),w(!0)}})})]})}var YE=Ue.memo($E);function zE(i){return gr(i)(e=>{const a={width:e.$border?1:0,color:"var(--card-border-color)"};return yd(Yu||(Yu=yr([`
        --card-focus-box-shadow: `,`;

        border-radius: `,`;
        outline: none;
        box-shadow: var(--card-focus-box-shadow);

        &:focus {
          --card-focus-box-shadow: `,`;
        }
      `])),Nh(a),pf(e.theme.sanity.radius[1]),Bh({base:e.theme.sanity.color.base,border:a,focusRing:e.theme.sanity.focusRing}))})}const pd=17,vd=91,XE=zE(Pr),QE=Ue.forwardRef((i,e)=>{let{children:a,tone:h,onPaste:m,onDrop:T,onDragEnter:k,onDragLeave:A,onDragOver:w}=i;const U=Ue.useRef(!1),x=Ue.useRef(null),P=Ue.useCallback(I=>{(I.keyCode==pd||I.keyCode==vd)&&(U.current=!0);const O=86;U.current&&I.keyCode==O&&x.current.focus()},[]),g=Ue.useCallback(I=>{(I.keyCode==pd||I.keyCode==vd)&&(U.current=!1)},[]);return lt(XE,{tone:h,height:"fill",ref:e,padding:0,radius:2,shadow:0,tabIndex:0,onKeyDown:P,onKeyUp:g,onPaste:m,onDrop:T,onDragEnter:k,onDragLeave:A,onDragOver:w,children:[te(ZE,{ref:x,onPaste:m}),a]})}),ZE=gr.input.attrs({type:"text"})(zu||(zu=yr([`
  position: absolute;
  border: 0;
  color: white;
  opacity: 0;

  &:focus {
    outline: none;
  }
`]))),JE=gr.input(Xu||(Xu=yr([`
  overflow: hidden;
  width: 0.1px;
  height: 0.1px;
  opacity: 0;
  position: absolute;
  z-index: -1;
`]))),e0=gr.label(Qu||(Qu=yr([`
  position: relative;
`]))),t0=i=>{let{onSelect:e,...a}=i;const h="FileSelect".concat(Ue.useId()),m=Ue.useRef(null),T=Ue.useCallback(A=>{e&&e(A.target.files)},[e]),k=Ue.useCallback(()=>{var A;return(A=m.current)==null?void 0:A.click()},[]);return lt(e0,{htmlFor:h,children:[te(JE,{accept:"video/*",ref:m,tabIndex:0,type:"file",id:h,onChange:T,value:""}),te(Rr,{onClick:k,mode:"default",tone:"primary",style:{width:"100%"},...a})]})},r0=gr(Pr)(Zu||(Zu=yr([`
  && {
    border-style: dashed;
  }
`]))),i0=gr(ni)(Ju||(Ju=yr([`
  position: absolute;
  top: 0;
  right: 0;
`])));function n0(i){const{setDialogState:e,readOnly:a,onSelect:h,hovering:m,needsSetup:T}=i,k=Ue.useCallback(()=>e("select-video"),[e]),A=Ue.useCallback(()=>e("secrets"),[e]);return te(ni,{style:{padding:1,position:"relative"},height:"stretch",children:lt(r0,{sizing:"border",height:"fill",tone:a?"transparent":"inherit",border:!0,padding:3,style:m?{borderColor:"transparent"}:void 0,children:[te(i0,{padding:3,children:te(Rr,{padding:3,radius:3,tone:T?"critical":void 0,onClick:A,icon:ll,mode:"bleed"})}),lt(Dr,{align:"center",justify:"space-between",gap:4,direction:["column","column","row"],paddingY:[2,2,0],sizing:"border",height:"fill",children:[lt(Dr,{align:"center",justify:"center",gap:2,flex:1,children:[te(Dr,{justify:"center",children:te(vr,{muted:!0,children:te(xf,{})})}),te(Dr,{justify:"center",children:te(vr,{size:1,muted:!0,children:"Drag video or paste URL here"})})]}),lt(sn,{space:2,children:[te(t0,{mode:"ghost",tone:"default",icon:Sd,text:"Upload",onSelect:h}),te(Rr,{mode:"ghost",icon:Ad,text:"Select",onClick:k})]})]})]})})}class a0 extends Ue.Component{constructor(){super(...arguments),this.state={isDraggingOver:!1,invalidPaste:!1,invalidFile:!1,uploadProgress:null,fileInfo:null,uuid:null,error:null,url:null},this.dragEnteredEls=[],this.ctrlDown=!1,this.upload=null,this.container=et.createRef(),this.handleProgress=e=>{this.setState({uploadProgress:e.percent})},this.onUpload=e=>{this.setState({uploadProgress:0,fileInfo:null,uuid:null}),this.upload=zg(this.props.config,this.props.client,e[0],{enableSignedUrls:this.props.secrets.enableSignedUrls}).pipe(Af(this.onCancelUploadButtonClick$.pipe(wf(()=>{this.state.uuid&&this.props.client.delete(this.state.uuid)})))).subscribe({complete:()=>{this.setState({error:null,uploadProgress:null,uuid:null})},next:a=>{this.handleUploadEvent(a)},error:a=>{this.setState({error:a,uploadProgress:null,uuid:null})}})},this.handleUploadEvent=e=>{switch(e.type){case"success":return this.handleUploadSuccess(e.asset);case"progress":return this.handleProgress(e);case"file":return this.setState({fileInfo:e.file});case"uuid":return this.setState({uuid:e.uuid});case"url":return this.setState({url:e.url,uploadProgress:100});default:return null}},this.handleUploadSuccess=e=>{this.setState({uploadProgress:100}),this.props.onChange(As.from([Id({asset:{}}),Dd({_type:"reference",_weak:!0,_ref:e._id},["asset"])]))},this.handlePaste=e=>{const h=(e.clipboardData||window.clipboardData).getData("text"),m={enableSignedUrls:this.props.secrets.enableSignedUrls};this.upload=Yg(this.props.config,this.props.client,h,m).subscribe({complete:()=>{this.setState({error:null,uploadProgress:null,url:null})},next:T=>{this.handleUploadEvent(T)},error:T=>{let k;T.message.toLowerCase().match("invalid url")||(k=T),this.setState({invalidPaste:!0,error:k},()=>{setTimeout(()=>{this.setState({invalidPaste:!1,uploadProgress:null})},2e3)})}})},this.handleDrop=e=>{this.setState({isDraggingOver:!1}),e.preventDefault(),e.stopPropagation(),ry(e.nativeEvent.dataTransfer).then(a=>{a&&this.onUpload(a)})},this.handleDragOver=e=>{e.preventDefault(),e.stopPropagation()},this.handleDragEnter=e=>{var a,h;e.stopPropagation(),this.dragEnteredEls.push(e.target),this.setState({isDraggingOver:!0});const m=(h=(a=e.dataTransfer.items)==null?void 0:a[0])==null?void 0:h.type;this.setState({invalidFile:!m.startsWith("video/")})},this.handleDragLeave=e=>{e.stopPropagation();const a=this.dragEnteredEls.indexOf(e.target);a>-1&&this.dragEnteredEls.splice(a,1),this.dragEnteredEls.length===0&&this.setState({isDraggingOver:!1})}}componentWillUnmount(){this.unSubscribeToUpload()}componentDidMount(){const e=new kf;this.onCancelUploadButtonClick$=e.asObservable(),this.handleCancelUploadButtonClick=a=>e.next(a)}unSubscribeToUpload(){this.upload&&!this.upload.closed&&this.upload.unsubscribe()}render(){var e;if(this.state.uploadProgress!==null)return te(Fh,{onCancel:this.handleCancelUploadButtonClick,progress:this.state.uploadProgress,filename:((e=this.state.fileInfo)==null?void 0:e.name)||this.state.url});if(this.state.error)throw this.state.error;return lt(Ki,{children:[te(QE,{tone:this.state.isDraggingOver&&(this.state.invalidPaste||this.state.invalidFile)?"critical":this.state.isDraggingOver?"positive":void 0,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDragEnter:this.handleDragEnter,onPaste:this.handlePaste,ref:this.container,children:this.props.asset?te(GE,{readOnly:this.props.readOnly,asset:this.props.asset,onChange:this.props.onChange,dialogState:this.props.dialogState,setDialogState:this.props.setDialogState,buttons:te(YE,{asset:this.props.asset,dialogState:this.props.dialogState,setDialogState:this.props.setDialogState,onChange:this.props.onChange,onUpload:this.onUpload,readOnly:this.props.readOnly})}):te(n0,{hovering:this.state.isDraggingOver,onSelect:this.onUpload,readOnly:this.props.readOnly,setDialogState:this.props.setDialogState,needsSetup:this.props.needsSetup})}),this.props.dialogState==="select-video"&&te(vy,{asset:this.props.asset,onChange:this.props.onChange,setDialogState:this.props.setDialogState})]})}}const s0=(i,e)=>Ue.useCallback(async a=>{let{token:h,secretKey:m,enableSignedUrls:T}=a,{signingKeyId:k,signingKeyPrivate:A}=e;try{await td(i,h,m,T,k,A);const w=await qg(i);if(!(w!=null&&w.status)&&h&&m)throw new Error("Invalid secrets")}catch(w){throw console.error("Error while trying to save secrets:",w),w}if(T&&!await Wg(i,k,A))try{const{data:U}=await Kg(i);k=U.id,A=U.private_key,await td(i,h,m,T,k,A)}catch(U){throw console.log("Error while creating and saving signing key:",U==null?void 0:U.message),U}return{token:h,secretKey:m,enableSignedUrls:T,signingKeyId:k,signingKeyPrivate:A}},[i,e]);function Hh(i){let{token:e,secretKey:a,enableSignedUrls:h}=i;return{submitting:!1,error:null,token:e??"",secretKey:a??"",enableSignedUrls:h??!1}}function o0(i,e){switch(e==null?void 0:e.type){case"submit":return{...i,submitting:!0,error:null};case"error":return{...i,submitting:!1,error:e.payload};case"reset":return Hh(e.payload);case"change":return{...i,[e.payload.name]:e.payload.value};default:throw new Error("Unknown action type: ".concat(e==null?void 0:e.type))}}const l0=i=>Ue.useReducer(o0,i,Hh),u0=["title","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r"];function jh(i){let{height:e=26}=i;const a=Ue.useId(),[h,m,T,k,A,w,U,x,P,g,I,O,X,N,ye,de,re,z,he]=Ue.useMemo(()=>u0.map(G=>"".concat(a,"-").concat(G)),[a]);return lt("svg",{"aria-labelledby":h,role:"img",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"92.08878326416016 102.66712188720703 692.76123046875 219.99948120117188",style:{height:"".concat(e,"px")},children:[te("title",{id:h,children:"Mux Logo"}),lt("defs",{children:[lt("linearGradient",{id:k,spreadMethod:"pad",gradientTransform:"matrix(528.38055 0 0 -528.38055 63.801 159.5)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:A,spreadMethod:"pad",gradientTransform:"matrix(523.66766 0 0 -523.66766 67.897 159.5)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:x,spreadMethod:"pad",gradientTransform:"rotate(180 296.075 79.75) scale(524.84045)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:g,spreadMethod:"pad",gradientTransform:"matrix(524.84045 0 0 -524.84045 63.801 159.5)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:I,spreadMethod:"pad",gradientTransform:"matrix(523.08514 0 0 -523.08514 67.897 224.446)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:O,spreadMethod:"pad",gradientTransform:"matrix(524.84045 0 0 -524.84045 63.801 94.553)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:X,spreadMethod:"pad",gradientTransform:"matrix(524.84045 0 0 -524.84045 63.801 159.5)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:N,spreadMethod:"pad",gradientTransform:"matrix(524.84045 0 0 -524.84045 63.801 94.554)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:re,spreadMethod:"pad",gradientTransform:"matrix(521.97632 0 0 -521.97632 69.067 191.973)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:z,spreadMethod:"pad",gradientTransform:"matrix(523.09039 0 0 -523.09039 67.312 191.973)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),lt("linearGradient",{id:he,spreadMethod:"pad",gradientTransform:"matrix(524.84045 0 0 -524.84045 63.801 159.5)",gradientUnits:"userSpaceOnUse",y2:0,x2:1,y1:0,x1:0,children:[te("stop",{offset:0,style:{stopOpacity:1,stopColor:"#ff4e00"}}),te("stop",{offset:1,style:{stopOpacity:1,stopColor:"#ff1791"}})]}),te("clipPath",{id:m,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M0 319h657.706V0H0Z"})}),te("clipPath",{id:T,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M423.64 242h164.999V77H423.64Z"})}),te("clipPath",{id:w,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M0 319h657.706V0H0Z"})}),te("clipPath",{id:U,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M311.3 242h93.031V77H311.3Z"})}),te("clipPath",{id:P,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M198.96 242h35.106V77H198.96Z"})}),te("clipPath",{id:ye,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M0 319h657.706V0H0Z"})}),te("clipPath",{id:de,clipPathUnits:"userSpaceOnUse",children:te("path",{d:"M69.067 242H169.12V141.947H69.067Z"})})]}),te("g",{clipPath:"url(#".concat(m,")"),transform:"matrix(1.33333 0 0 -1.33333 0 425.333)",children:te("g",{style:{opacity:.69999701},clipPath:"url(#".concat(T,")"),children:te("path",{style:{fill:"url(#".concat(k,")"),stroke:"none"},d:"M558.674 82.142c6.855-6.855 17.969-6.855 24.824 0 6.854 6.855 6.854 17.969 0 24.823L453.605 236.858c-6.855 6.855-17.969 6.855-24.824 0s-6.855-17.969 0-24.823z"})})}),te("path",{style:{fill:"url(#".concat(A,")"),stroke:"none"},d:"M558.674 236.858 428.781 106.966c-6.855-6.855-6.855-17.969 0-24.825 6.855-6.854 17.969-6.854 24.823 0l129.894 129.894c6.854 6.855 6.854 17.968 0 24.823A17.498 17.498 0 0 1 571.086 242a17.495 17.495 0 0 1-12.412-5.142",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),lt("g",{clipPath:"url(#".concat(w,")"),transform:"matrix(1.33333 0 0 -1.33333 0 425.333)",children:[te("g",{style:{opacity:.69999701},clipPath:"url(#".concat(U,")"),children:te("path",{style:{fill:"url(#".concat(x,")"),stroke:"none"},d:"M328.853 112.107c22.297 0 40.372 18.075 40.372 40.372v71.315c0 10.054 7.505 18.206 17.554 18.206 10.048 0 17.552-8.152 17.552-18.206v-71.315c0-41.686-33.793-75.479-75.478-75.479-9.694 0-17.553 7.859-17.553 17.554 0 9.694 7.859 17.553 17.553 17.553"})}),te("g",{style:{opacity:.69999701},clipPath:"url(#".concat(P,")"),children:te("path",{style:{fill:"url(#".concat(g,")"),stroke:"none"},d:"M216.513 242c-10.049 0-17.553-8.152-17.553-18.206V95.206c0-10.054 7.504-18.206 17.553-18.206 10.048 0 17.553 8.152 17.553 18.206v128.588c0 10.054-7.505 18.206-17.553 18.206"})})]}),te("path",{style:{fill:"url(#".concat(I,")"),stroke:"none"},d:"M369.225 224.447c0-9.694 7.859-17.553 17.553-17.553 9.695 0 17.553 7.859 17.553 17.553s-7.858 17.552-17.553 17.552c-9.694 0-17.553-7.858-17.553-17.552",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),te("path",{style:{fill:"url(#".concat(O,")"),stroke:"none"},d:"M553.532 94.554c0-9.695 7.859-17.554 17.553-17.554 9.695 0 17.554 7.859 17.554 17.554 0 9.694-7.859 17.552-17.554 17.552-9.694 0-17.553-7.858-17.553-17.552",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),te("path",{style:{fill:"url(#".concat(X,")"),stroke:"none"},d:"M69.067 223.794V95.206C69.067 85.152 76.571 77 86.62 77c10.048 0 17.553 8.152 17.553 18.206v128.588c0 10.055-7.505 18.205-17.553 18.205-10.049 0-17.553-8.15-17.553-18.205",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),te("path",{style:{fill:"url(#".concat(N,")"),stroke:"none"},d:"M198.96 94.554c0-9.695 7.859-17.554 17.553-17.554 9.695 0 17.554 7.859 17.554 17.554 0 9.694-7.859 17.553-17.554 17.553-9.694 0-17.553-7.859-17.553-17.553",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),te("g",{clipPath:"url(#".concat(ye,")"),transform:"matrix(1.33333 0 0 -1.33333 0 425.333)",children:te("g",{style:{opacity:.69999701},clipPath:"url(#".concat(de,")"),children:te("path",{style:{fill:"url(#".concat(re,")"),stroke:"none"},d:"M139.155 147.088c6.855-6.855 17.969-6.855 24.824 0s6.855 17.969 0 24.824l-64.947 64.946c-6.855 6.855-17.969 6.855-24.824 0s-6.855-17.969 0-24.823z"})})}),te("path",{style:{fill:"url(#".concat(z,")"),stroke:"none"},d:"m204.101 236.858-64.947-64.946c-6.854-6.855-6.854-17.969 0-24.824 6.856-6.855 17.97-6.855 24.824 0l64.947 64.947c6.855 6.855 6.855 17.968 0 24.823A17.495 17.495 0 0 1 216.513 242a17.498 17.498 0 0 1-12.412-5.142",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"}),te("path",{style:{fill:"url(#".concat(he,")"),stroke:"none"},d:"M253.374 223.794v-71.315c0-41.685 33.793-75.479 75.479-75.479 9.695 0 17.553 7.859 17.553 17.554 0 9.694-7.858 17.553-17.553 17.553-22.297 0-40.372 18.075-40.372 40.372v71.315c0 10.055-7.505 18.205-17.554 18.205s-17.553-8.15-17.553-18.205",transform:"matrix(1.33333 0 0 -1.33333 0 425.333)"})]})}const d0=gr.span(ed||(ed=yr([`
  display: inline-block;
  height: 0.8em;
  margin-right: 1em;
  transform: translate(0.3em, -0.2em);
`]))),c0=()=>lt(Ki,{children:[te(d0,{children:te(jh,{height:13})}),"API Credentials"]});function h0(i){const{children:e,title:a,description:h,inputId:m}=i;return lt(qr,{space:1,children:[te(Dr,{align:"flex-end",children:te(ni,{flex:1,paddingY:2,children:te(qr,{space:2,children:lt(Dr,{children:[te(vr,{as:"label",htmlFor:m,weight:"semibold",size:1,children:a||te("em",{children:"Untitled"})}),h&&te(vr,{muted:!0,size:1,children:h})]})})})}),te("div",{children:e})]})}var md=Ue.memo(h0);const f0=["token","secretKey","enableSignedUrls"];function p0(i){let{secrets:e,setDialogState:a}=i;var h,m;const T=gi(),[k,A]=l0(e),w=Ue.useMemo(()=>e.token&&e.secretKey,[e]),U=Ue.useCallback(()=>a(!1),[a]),x=Ue.useMemo(()=>e.token!==k.token||e.secretKey!==k.secretKey||e.enableSignedUrls!==k.enableSignedUrls,[e,k]),P="ConfigureApi".concat(Ue.useId()),[g,I,O]=Ue.useMemo(()=>f0.map(G=>"".concat(P,"-").concat(G)),[P]),X=Ue.useRef(null),N=s0(T,e),ye=Ue.useRef(!1),de=Ue.useCallback(G=>{if(G.preventDefault(),!ye.current&&G.currentTarget.reportValidity()){ye.current=!0,A({type:"submit"});const{token:Y,secretKey:me,enableSignedUrls:Ae}=k;N({token:Y,secretKey:me,enableSignedUrls:Ae}).then(ke=>{const{projectId:Q,dataset:L}=T.config();vf([Kl,ql,Q,L]),mf(()=>Promise.resolve(ke),[Kl,ql,Q,L]),a(!1)}).catch(ke=>A({type:"error",payload:ke.message})).finally(()=>{ye.current=!1})}},[T,A,N,a,k]),re=Ue.useCallback(G=>{A({type:"change",payload:{name:"token",value:G.currentTarget.value}})},[A]),z=Ue.useCallback(G=>{A({type:"change",payload:{name:"secretKey",value:G.currentTarget.value}})},[A]),he=Ue.useCallback(G=>{A({type:"change",payload:{name:"enableSignedUrls",value:G.currentTarget.checked}})},[A]);return Ue.useEffect(()=>{X.current&&X.current.focus()},[X]),te(ws,{id:P,onClose:U,header:te(c0,{}),width:0,children:te(ni,{padding:4,style:{position:"relative"},children:te("form",{onSubmit:de,noValidate:!0,children:lt(qr,{space:4,children:[!w&&te(Pr,{padding:[3,3,3],radius:2,shadow:1,tone:"primary",children:lt(qr,{space:3,children:[lt(vr,{size:1,children:["To set up a new access token, go to your"," ",te("a",{href:"https://dashboard.mux.com/settings/access-tokens",target:"_blank",rel:"noreferrer noopener",children:"account on mux.com"}),"."]}),lt(vr,{size:1,children:["The access token needs permissions: ",te("strong",{children:"Mux Video "}),"(Full Access) and ",te("strong",{children:"Mux Data"})," (Read)",te("br",{}),"The credentials will be stored safely in a hidden document only available to editors."]})]})}),te(md,{title:"Access Token",inputId:g,children:te(Vl,{id:g,ref:X,onChange:re,type:"text",value:(h=k.token)!=null?h:"",required:!!k.secretKey||k.enableSignedUrls})}),te(md,{title:"Secret Key",inputId:I,children:te(Vl,{id:I,onChange:z,type:"text",value:(m=k.secretKey)!=null?m:"",required:!!k.token||k.enableSignedUrls})}),lt(qr,{space:4,children:[lt(Dr,{align:"center",children:[te(Co,{id:O,onChange:he,checked:k.enableSignedUrls,style:{display:"block"}}),te(ni,{flex:1,paddingLeft:3,children:te(vr,{children:te("label",{htmlFor:O,children:"Enable Signed Urls"})})})]}),e.signingKeyId&&k.enableSignedUrls?te(Pr,{padding:[3,3,3],radius:2,shadow:1,tone:"caution",children:lt(qr,{space:3,children:[te(vr,{size:1,children:"The signing key ID that Sanity will use is:"}),te(gd,{size:1,children:e.signingKeyId}),lt(vr,{size:1,children:["This key is only used for previewing content in the Sanity UI.",te("br",{}),"You should generate a different key to use in your application server."]})]})}):null]}),lt(sn,{space:2,children:[te(Rr,{text:"Save",disabled:!x,loading:k.submitting,tone:"primary",mode:"default",type:"submit"}),te(Rr,{disabled:k.submitting,text:"Cancel",mode:"bleed",onClick:U})]}),k.error&&te(Pr,{padding:[3,3,3],radius:2,shadow:1,tone:"critical",children:te(vr,{children:k.error})})]})})})})}var v0=Ue.memo(p0);function m0(i){const{setDialogState:e}=i,a=Ue.useCallback(()=>e("secrets"),[e]);return te(Ki,{children:te("div",{style:{padding:2},children:te(Pr,{display:"flex",sizing:"border",style:{aspectRatio:"16/9",width:"100%",boxShadow:"var(--card-bg-color) 0 0 0 2px"},paddingX:[2,3,4,4],radius:1,tone:"transparent",children:te(Dr,{justify:"flex-start",align:"center",children:lt(xo,{columns:1,gap:[2,3,4,4],children:[te(sn,{paddingY:1,children:te("div",{style:{height:"32px"},children:te(jh,{})})}),te(sn,{paddingY:1,children:te(If,{size:[0,1,2,2],children:"Upload and preview videos directly from your studio."})}),te(sn,{paddingY:1,children:te(Rr,{mode:"ghost",icon:ll,text:"Configure API",onClick:a})})]})})})})})}const g0=i=>{var e;const a=gi(),h=jg(),m=Ff((e=i.value)==null?void 0:e.asset),T=Bg(i.readOnly?void 0:(m==null?void 0:m.value)||void 0),[k,A]=Ng(),w=h.error||m.error||T.error;if(w)throw w;const U=h.isLoading||m.isLoading;return te(Ki,{children:U?te(gf,{}):lt(Ki,{children:[h.value.needsSetup&&!m.value?te(m0,{setDialogState:A}):te(a0,{...i,config:i.config,onChange:i.onChange,client:a,secrets:h.value.secrets,asset:m.value,dialogState:k,setDialogState:A,needsSetup:h.value.needsSetup}),k==="secrets"&&te(v0,{setDialogState:A,secrets:h.value.secrets})]})})};var H0=Ue.memo(g0);export{H0 as default};
